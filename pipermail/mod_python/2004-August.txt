From wip at rpgmaker.net  Sun Aug  1 13:30:20 2004
From: wip at rpgmaker.net (August T. Bigelow)
Date: Sun Aug  1 14:30:35 2004
Subject: [mod_python] Problems with PSP
Message-ID: <410D36BC.9060502@rpgmaker.net>

I was testing out the PSP example site on my own webserver. Everything 
works except for when I try the "View Source Code" link on the site. It 
gives me an import error on PyFontify. However, this error does not 
appear on the PSP example site uploaded to mod_python.org. What do I 
have wrong?
From vmanera at manord.com  Mon Aug  2 11:40:18 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Mon Aug  2 04:58:13 2004
Subject: [mod_python] servlet
Message-ID: <52DC70C1C1575C418CB033523A29CF14104990@exchange2000.manord.com>

>Message: 2
>Date: Fri, 30 Jul 2004 13:50:16 -0400
>From: Daniel Popowich <dpopowich@comcast.net>
>Subject: Re: [mod_python] servlet
..
> firt af all some little problem:
> 1) If I leave in httpd.conf "ServerName localew.manord.com" when I start
the
> tutorial an alert tell me that:localew.manord.com can't be found, with
this
> statement comment all work fine

Does this address resolve via DNS otherwise?

I added localew.manord.com in the dns and now it work
properly<-----------------

  
> Forbidden You don't have permission to access /tutorial/ on this server

Does the apache process have access to this physical directory?

Sorry I forgot to add allow from ... in the apache directive now it work
<--------

....
Actually, I just thought of a problem.  Servlet instances span
requests, so when you set self.use_session = True in your prep()
method, then it will be True for the next request, as well.  You
probably want this:
     def prep(self):
     	 self.use_session = False
         HTMLPage.prep(self) 
         self.session = adatta_ha.sessione(self.req,....)
         self.use_session=True

Make sense?
	 
Daniel	 

Yes!! thank you very very much 

Villiam

From yrbahn at nhncorp.jp  Tue Aug  3 00:19:34 2004
From: yrbahn at nhncorp.jp (=?ks_c_5601-1987?B?ud2/tbfP?=)
Date: Mon Aug  2 10:19:40 2004
Subject: [mod_python] mod_python keeps infinite loop..
Message-ID: <008501c4789b$bc477480$020ba8c0@yrbahn>

i am using mod_python 3.1.3 at apache2.0.50.
sometimes, apache process( prefork ) keeps inifinite loop. 
i donot understand this status.
the following is strace's output.

futex(0x818cb30, FUTEX_WAKE, 1, {1, 1077529472}) = 0
futex(0x818cb30, FUTEX_WAKE, 1, NULL)   = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, {1, 1077529472}) = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, NULL)   = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, {1, 1077529472}) = 0
futex(0x818cb30, FUTEX_WAKE, 1, NULL)   = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, {1, 1077529472}) = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error
{...})  = 0
futex(0x818cb30, FUTEX_WAKE, 1, NULL)   = 0
futex(0x818cb30, FUTEX_WAKE, 1, {1108, 1077419008}) = 0
futex(0x818cb30, FUTEX_WAKE, 1, {1, 1077529472}) = 0
futex(0x818cb30, FUTEX_WAKE, 1, NULL)   = 0
futex(0x818cb30, FUTEX_WAKE, 1, ptrace: umoven: Input/output error

had anyone seen this status?
plz help me..

From vmanera at manord.com  Mon Aug  2 16:37:24 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Mon Aug  2 10:55:03 2004
Subject: [mod_python] servlet possible little bug?
Message-ID: <52DC70C1C1575C418CB033523A29CF14104992@exchange2000.manord.com>

at line 278 of servlet.py:
		assert (isinstance(default, (list, dict, str)),
					('Argument default value must be a
string, '
					'list or dict (or subclass
thereof)'))
but:
	def testAssert(default):
		assert (isinstance(default, (list, dict, str)),
					('Argument default value must be a
string, '
					'list or dict (or subclass
thereof)'))
		print 'ok assert'

	testAssert('ciao')
	testAssert(1)
	>ok assert
	>ok assert

	def testAssert1(default):
		assert isinstance(default, (list, dict, str)),\
					('Argument default value must be a
string, '
					'list or dict (or subclass
thereof)')
		print 'ok assert'
	

	testAssert1('ciao')
	testAssert1(1)
	>ok assert
	>Traceback (most recent call last):
  File "C:\Sviluppo\python\test_prove\driver data base\stm.py", line 74, in
?
    testAssert1(1)
  File "C:\Sviluppo\python\test_prove\driver data base\stm.py", line 67, in
testAssert1
    assert isinstance(default, (list, dict, str)),\
AssertionError: Argument default value must be a string, list or dict (or
subclass thereof)
Process completed with exit code 1

Villiam

From list at joreybump.com  Mon Aug  2 12:23:47 2004
From: list at joreybump.com (Jorey Bump)
Date: Mon Aug  2 11:24:00 2004
Subject: [mod_python] servlet possible little bug?
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104992@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104992@exchange2000.manord.com>
Message-ID: <410E5C83.9090104@joreybump.com>

Manera, Villiam wrote:

>   File "C:\Sviluppo\python\test_prove\driver data base\stm.py", line 67, in
> testAssert1
>     assert isinstance(default, (list, dict, str)),\
              ^ missing left parenthesis
> AssertionError: Argument default value must be a string, list or dict (or
> subclass thereof)
> Process completed with exit code 1


From KJohnson at eclypse.org  Mon Aug  2 12:48:59 2004
From: KJohnson at eclypse.org (Ken Johnson)
Date: Mon Aug  2 12:49:20 2004
Subject: [mod_python] mptest.py is displayed, not interpreted
In-Reply-To: <7A80AC83-E1B3-11D8-B956-000A95D2D288@apache.org>
Message-ID: <200408021649.i72GnF28000940@host13.apollohosting.com>


Scott,

Thank you for pointing out this error.

mptest.py is interpreted and displays
the expected output once the <Directory ...>
declaration was corrected.

KLJ

-----Original Message-----
From: Scott Sanders [mailto:sanders@apache.org] 
Sent: Thursday, July 29, 2004 6:03 PM
To: mod_python user mailing list; KJohnson@eclypse.org
Subject: Re: [mod_python] mptest.py is displayed, not interpreted


On Jul 29, 2004, at 3:22 PM, Ken Johnson wrote:

> Pointing my browser at http://192.168.1.8:8081/py-test/mptest.py
> displays the contents of modules/py-test/mptest.py.
>

<snip>

> <Directory "/usr/local/apache_2.0.50/htdocs/test>
>     AddHandler mod_python .py
>     PythonHandler mptest
>     PythonDebug On
> </Directory>
>

One is /py-test/, and one is /test/, which one is correct?

Scott Sanders



From vmanera at manord.com  Mon Aug  2 20:10:01 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Mon Aug  2 13:56:08 2004
Subject: [mod_python] servlet _HTML little bug
Message-ID: <52DC70C1C1575C418CB033523A29CF1401A769B9@exchange2000.manord.com>

al line 711 of _HTML:

def Image(src, **attrs):
    i = apply(IMG, (), a)<------- a instead of attrs



Villiam

From dpopowich at comcast.net  Mon Aug  2 16:09:35 2004
From: dpopowich at comcast.net (Daniel Popowich)
Date: Mon Aug  2 15:09:50 2004
Subject: [mod_python] servlet _HTML little bug
In-Reply-To: <52DC70C1C1575C418CB033523A29CF1401A769B9@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF1401A769B9@exchange2000.manord.com>
Message-ID: <16654.37231.231573.401730@fenway.local.>


> al line 711 of _HTML:
> 
> def Image(src, **attrs):
>     i = apply(IMG, (), a)<------- a instead of attrs
> 

As I mentioned in the tutorial, _HTML.py is a re-packaging of
HyperText (http://dustman.net/andy/python/HyperText) in one module,
so I could easily include it in my tutorial without having to require
users to download a third-party package.

Anyway, this bug is in his package.  I will pass it on.

Daniel
-----------------------------------------------
http://home.comcast.net/~d.popowich/mpservlets/

PS

If you are actively developing with the code in _HTML.py I'd
recommend switching to the real HyperText python package.  I make no
guarantees for it other than it works for my tutorial!


From vmanera at manord.com  Tue Aug  3 11:21:42 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Tue Aug  3 04:45:48 2004
Subject: [mod_python] R: servlet possible little bug
Message-ID: <52DC70C1C1575C418CB033523A29CF14104993@exchange2000.manord.com>

Date: Mon, 02 Aug 2004 11:23:47 -0400
From: Jorey Bump <list@joreybump.com>
Subject: Re: [mod_python] servlet possible little bug?
To: mod_python user mailing list <mod_python@modpython.org>
Message-ID: <410E5C83.9090104@joreybump.com>
Content-Type: text/plain; charset=us-ascii; format=flowed

Jorey Bump wrote:

>     assert isinstance(default, (list, dict, str)),\
              ^ missing left parenthesis

Without left parenthesis it work fine. with parenthesis the assert dont'
work properly.

in my previous example I call the assert with a string and it print ok
after with a number and it also print ok instead of raise error.

without left parenthesis it work properly, it print ok with string, but it
raise error with number.

for me servlet.py has to be corret in order to work properly.

Villiam

From vmanera at manord.com  Tue Aug  3 15:38:59 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Tue Aug  3 09:05:45 2004
Subject: [mod_python] get_cookies in servlet
Message-ID: <52DC70C1C1575C418CB033523A29CF14104994@exchange2000.manord.com>

I added this code in prep():
 
def prep(self):
    .....
  cookies = self.get_cookies()
  COOKIE_NAME = 'backgroundcolor'
  if cookies.has_key(COOKIE_NAME):
                 self.body_attrs['BGCOLOR']=cookies[COOKIE_NAME].value
 
in order to achieve what I wont I had to modify the servlet.py get_cookies:
    def get_cookies(self, klass=Cookie.Cookie, **kw):
        ...       
     return Cookie.get_cookies(self.req, klass)
     #return Cookie.get_cookies(self.req, klass, kw) <--- with kw :
 
   File "C:\PROGRA~1\Python23\lib\site-packages\mod_python\servlet.py", line
484, in get_cookies
    return Cookie.get_cookies(self.req, klass, kw)

TypeError: get_cookies() takes at most 2 arguments (3 given)
 
any Idea?

Villiam Manera 
Manifatture del Nord srl 
via Mazzacurati 6

42100 Reggio Emilia RE 
ITALY 

Tel. +39 0522 358200 
Fax +39 0522 268700 
email : vmanera@manord.com 
www.pennyblack.com 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040803/63a6c881/attachment.html
From dpopowich at comcast.net  Tue Aug  3 10:25:12 2004
From: dpopowich at comcast.net (Daniel Popowich)
Date: Tue Aug  3 09:25:19 2004
Subject: [mod_python] servlet possible little bug?
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104992@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104992@exchange2000.manord.com>
Message-ID: <16655.37432.788373.37771@fenway.local.>


Congratulations!  You found the first servlet bug!!  I will put out a
new package, but in the meantime you can apply the patch attached below.

The problem is with the parens around two assert statements which make
the assertion tests always be a non-empty tuple, that is, true.  Duh.
(I've been trying to think how that happened as I know I extensively
tested all the assertions in my code and the only thing I can think of
is that I placed the parens there just before releasing as I was doing
a formatting sweep of the code: I tend to format long lines using
parens instead of backslash-newline.  *sigh*)

Thanks for finding this.

Daniel
---------------------------------------------------
| Mod_python Servlets                             |
| http://home.comcast.net/~d.popowich/mpservlets/ |
---------------------------------------------------

-------------- next part --------------
*** servlet.py  2004/05/27 19:34:14     1.9
--- servlet.py  2004/08/03 13:07:00
*************** class Servlet:
*** 275,283 ****
          assert NAME.match(name), ('Argument name must be a legal '
                                    'python identifier')
  
!         assert (isinstance(default, (list, dict, str)),
!                 ('Argument default value must be a string, '
!                  'list or dict (or subclass thereof)'))
          
          if isinstance(default, list):
              for i in default:
--- 275,283 ----
          assert NAME.match(name), ('Argument name must be a legal '
                                    'python identifier')
  
!         assert isinstance(default, (list, dict, str)), \
!                ('Argument default value must be a string, '
!                 'list or dict (or subclass thereof)')
          
          if isinstance(default, list):
              for i in default:
*************** class Servlet:
*** 287,295 ****
              for k,v in default.iteritems():
                  assert type(k) is str, ('Default keys of dicts must '
                                          'be strings')
!                 assert (isinstance(v, (str, list)),
!                         ('Default values of dicts must have values of lists '
!                          'or strings'))
                          
          assert conv is None or callable(conv), ('Argument conversion must '
                                                  'be None or callable')
--- 287,295 ----
              for k,v in default.iteritems():
                  assert type(k) is str, ('Default keys of dicts must '
                                          'be strings')
!                 assert isinstance(v, (str, list)), \
!                        ('Default values of dicts must have values of lists '
!                         'or strings')
                          
          assert conv is None or callable(conv), ('Argument conversion must '
                                                  'be None or callable')
From vomjom at vomjom.org  Tue Aug  3 11:38:12 2004
From: vomjom at vomjom.org (Jonathan Hseu)
Date: Tue Aug  3 11:33:51 2004
Subject: [mod_python] Strange errors...
Message-ID: <20040803153812.GA13778@vomjom.org>

Okay, most of the time my page works fine... I use psp content embedded
within other psp pages, just like in the example on the web page.

Maybe around 5% of the time, though, I get a weird "error".. but when I
reload the page, it's fixed.  Both times, the page should have generated
the same way (because nothing has changed).
In Firefox 0.9.1, it just shows a "0" on the screen, and that's it.

In Firefox 0.8, it showed something like:
0HTTP1.1...<insert random apache HTTP headers here>
<some generated html code _from a particular psp.PSP call_>
<insert random number here, e.g. 213>
<some generated html code _from a particular psp.PSP call_>
<insert random number here>

etc...

Anyone else get this problem? (is it Firefox?  I haven't tried IE yet)

Jonathan Hseu
From vmanera at manord.com  Tue Aug  3 20:06:58 2004
From: vmanera at manord.com (Manera, Villiam)
Date: Tue Aug  3 13:42:48 2004
Subject: [mod_python] servlet HTMLPage write_js
Message-ID: <52DC70C1C1575C418CB033523A29CF1401A769C3@exchange2000.manord.com>

I had subclassed write_js in HTMLPage in order to have link as css_links 
 
 def write_js(self):
  '''
  Writes javascript to the client in the HEAD.
  @see: L{js_links}
  @see: L{js}
  '''
  for link in  self.js_links:
   self.writeln('<SCRIPT LANGUAGE="JavaScript" SRC="%s"></SCRIPT>' %link) 
  if self.js:
   self.__write_head_tag('script', 'text/javascript', self.js)

 
 
 
It would be better to add it in HTMLPage
 
Villiam
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040803/33d2c974/attachment.html
From jryan at qutang.net  Wed Aug  4 16:26:12 2004
From: jryan at qutang.net (Justin Ryan)
Date: Wed Aug  4 16:26:16 2004
Subject: [mod_python] Status of Mac OS X / Apache 1.3 / mod_python 2.7.10.
In-Reply-To: <A1AF44AE-E2EC-11D8-963D-000A95AC6C3C@Memora.com>
References: <7FA61E8F-E2C9-11D8-B9D4-000393DCF16E@dscpl.com.au>
	<A1AF44AE-E2EC-11D8-963D-000A95AC6C3C@Memora.com>
Message-ID: <8747578C-E654-11D8-A593-000D93AD1DB8@qutang.net>

Be careful when playing with the file/directory/link/whateva that is 
/System/Library/Frameworks/Python.Framework.  I ran into some wierdness 
trying to change this into a symlink and move it around (i.e. change it 
back and forth from pointing to Apple's python and my own).

Also, take care when using the 'python' command after installing your 
own framework build.  It's kind of a pain to get a framework build to 
stick python, pythonw, etc.. in /usr/bin - all of my stuff was in 
/usr/local/bin, even though I passed --prefix=/usr to the configure 
script.

Sure would be rad if there were a doc outlining how exactly apple 
builds python for inclusion into OSX. ;)

Cheers,

-=JR

On Jul 31, 2004, at 7:24 AM, Antonio Rodriguez wrote:

> Graham,
>
> I was able to get it 2.7.10 to work on the stock apache with OSX by 
> just downloading the latest python and doing a framework build (after 
> moving aside the one that comes with OSX). This seems like it might 
> have caused a lot of headaches but std. python build as a framework 
> does pretty well on OSX.
>
> AR
>
>
> On Jul 31, 2004, at 4:13 AM, Graham Dumpleton wrote:
>
>> I wanted to get mod_python working with the standard version of 
>> Apache (1.3) that
>> comes with Mac OS 10.3 but before I even tried I noted a number of 
>> posts in various
>> places on the net asking how to get it to work since they weren't 
>> even able to
>> get it to compile or if they did, the apache process died when 
>> mod_python was
>> loaded. In my search, I couldn't find anyone indicating that they had 
>> solved the
>> problem. The only positive indication was someone making available a 
>> prebuilt
>> version of mod_python but this was for Mac OS 10.1 and it has since 
>> been removed
>> from the net.
>>
>> Actually trying it myself, I fixed the obvious problems with the 
>> makefiles and build
>> process but also found that the apache process died. Digging further, 
>> I found the
>> underlying problem was that Py_IsInitialized() always returned true, 
>> even on the
>> first time it was called from the python_init() function in 
>> mod_python.c. As such,
>> the required call to Py_Initialize() never occurred, nor did setup 
>> for threading.
>> Because initialisation of the interpreter never occurred, Python 
>> subsequently died
>> the first time a Python function was actually called. Adding a 
>> separate initialisation
>> flag in python_init() fixed the problem and so far on a simple 
>> example it is working
>> okay.
>>
>> That said, what is the official status of mod_python 2.7.10 on Mac OS 
>> X with the
>> version of Apache (1.3) that comes with the OS?
>>
>> Can post instructions/patch later if there is the interest.
>>
>>
>> --
>> Graham Dumpleton (grahamd@dscpl.com.au)
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From grahamd at dscpl.com.au  Wed Aug  4 22:37:15 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Aug  4 23:37:18 2004
Subject: [mod_python] Status of Mac OS X / Apache 1.3 / mod_python 2.7.10.
In-Reply-To: <8747578C-E654-11D8-A593-000D93AD1DB8@qutang.net>
Message-ID: <1091677032.58339@dscpl.com.au>

On Aug 04 15:26, Justin Ryan <jryan@qutang.net> wrote:
>
> Subject: Re: [mod_python] Status of Mac OS X / Apache 1.3 / mod_python 2.7.10.
>
> Be careful when playing with the file/directory/link/whateva that is 
> /System/Library/Frameworks/Python.Framework.  I ran into some wierdness 
> trying to change this into a symlink and move it around (i.e. change it 
> back and forth from pointing to Apple's python and my own).
> 
> Also, take care when using the 'python' command after installing your 
> own framework build.  It's kind of a pain to get a framework build to 
> stick python, pythonw, etc.. in /usr/bin - all of my stuff was in 
> /usr/local/bin, even though I passed --prefix=/usr to the configure 
> script.

I would agree and why I didn't want to go down the path of having to replace
the standard version of Python on MacOSX with a newer version to get mod_python
to work. Similarly, I didn't want to be replacing their version of Apache.

Anyway, listed below is the changes I had to make to get it to build and work
on MacOSX (10.3.3) with the standard Python (2.3) and Apache (1.3) that come
with the operating system.

First off, after running configure, change "src/Makefile" and replace:

  /System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/config/libpython2.3.a

with:

  -framework Python

in LIBS variable.

Second, in the same makefile, change CFLAGS and add in:

  -DEAPI

as a compiler option.

This will allow mod_python to build, but the result will crash.

Final step is to modify src/mod_python.c. The diff is below. There are
more comments after that diff as to why the original code is wrong anyway.


*** mod_python.c.dist   Tue May 29 06:00:41 2001
--- mod_python.c        Thu Aug  5 13:21:22 2004
***************
*** 260,265 ****
--- 260,268 ----
  
      char buff[255];
  
+     /* fudge for Mac OS X with Apache 1.3 where Py_IsInitialized() broke */
+     static int initialized = 0;
+ 
      /* pool given to us in ChildInit. We use it for 
         server.register_cleanup() */
      pool *child_init_pool = NULL;
***************
*** 272,279 ****
      ap_add_version_component(buff);
  
      /* initialize global Python interpreter if necessary */
!     if (! Py_IsInitialized()) 
      {
  
        /* initialze the interpreter */
        Py_Initialize();
--- 275,283 ----
      ap_add_version_component(buff);
  
      /* initialize global Python interpreter if necessary */
!     if (initialized == 0 || ! Py_IsInitialized())
      {
+         initialized = 1;
  
        /* initialze the interpreter */
        Py_Initialize();


The problem on MacOSX is that Py_IsInitialized() is returning true on the
first time it is called even though Python hadn't up until that point actually
been initialised. This means initialisation is skipped and the first time
something tries to use Python methods later, it crashes.

To my mind the use of Py_IsInitialized() is partly bogus anyway. This is
because if someone did come up with a different apache module which
also tried to use Python and it got loaded first and called Py_Initialize(),
it would mean when mod_python got loaded it would skip initialisation
and wouldn't initialise as a result the "interpreters" dictionary nor would
it necessarily initialise threading if the other module didn't do it.

Thus, even though people might reckon that this patch may only be
relevant to the MacOSX problem I have, I would disagree, because I would
say the code is wrong anyway.

As a demonstration, you might modify the code and add an extra call to
Py_Initialize() just prior to the "if" statement where Py_IsInitialized() is
called as if it was done somewhere else. Do this and mod_python should
by observation break since "interpreters" will never get set as described above.

--
Graham Dumpleton (grahamd@dscpl.com.au)
From rtjohan at syspres.com  Thu Aug  5 01:42:19 2004
From: rtjohan at syspres.com (rtjohan@syspres.com)
Date: Thu Aug  5 03:42:30 2004
Subject: [mod_python] Run mod_python on MacOSX by using DarwinPorts
Message-ID: <FB0F728E-E6B2-11D8-94E7-000A95A89CC8@syspres.com>

Hi Everyone, new to this list.

Noticed some discussions about getting mod_python working on MacOSX.

I used the DarwinPorts,  http://darwinports.opendarwin.org/, to install  
mod_python and it installed all the dependencies for me including  
apache2 on a PowerMac G5 running MacOSX 10.3.4. All I did was: "port  
install mod_python" and got: Apache/2.0.49 (Unix) DAV/2  
mod_python/3.1.3 Python/2.3.4.

I just disabled the built-in Apache via the /etc/hostsconfig file.  
There might be some other things I should also do, like modify the  
path, but haven't tried that yet - seems to work without it. If there  
are things I should modify please let me know.

Been using DarwinPorts for a few months and seems to work pretty well.  
Prefer that over Fink since more experience with FreeBSD & their port  
system and DarwinPorts is based on FreeBSD ports to some degree.

Only thing I did after that is to add following to  
/opt/local/apache2/conf/httpd.conf:
------------------------------------------------------------------------ 
---------
LoadModule python_module /opt/local/apache2/modules/mod_python.so

Alias /ais  "/opt/local/apache2/htdocs/ais/"
Alias /ais/ "/opt/local/apache2/htdocs/ais/"
<Directory "/opt/local/apache2/htdocs/ais">
     AddHandler mod_python .psp .psp_
     PythonHandler mod_python.psp
     PythonDebug On
     Options Indexes MultiViews
     AllowOverride None
     Order allow,deny
     Allow from all
</Directory>

DirectoryIndex index.psp index.html index.htm
------------------------------------------------------------------------ 
---------
Good news is, mod_python w/ psp seems to work with the DarwinPorts  
defult build.

The issue I get, might be since I haven't messed with path changes yet:
When I need to modify the httpd.conf file, I can't just use the  
"/opt/local/apache2/bin/apachectl graceful", since will "Internal  
Server Error". But, if reboot the machine, then a valid httpd.conf will  
make mod_python + psp work just fine. Might be some interaction with  
the built-in python/apache.

Here are the details:
Before the graceful restart of apache, when go to login.psp page loads  
fine and access_log shows:
192.168.1.110 - - [04/Aug/2004:23:53:51 -0700] "POST /ais/login.psp  
HTTP/1.1" 200 4700
But after restart and go to page get Internal Server Error and get this  
from access_log:
192.168.1.110 - - [05/Aug/2004:00:24:01 -0700] "POST /ais/login.psp  
HTTP/1.1" 500 650

If reboot machine, this error doesn't occur till I try to restart  
apache again.
The only other way to get passed this error is to comment out:
  #    PythonHandler mod_python.psp
When do a apache restart after this change, the page does load and  
provides errors about psp of-course, but page loads.

So at least it works, although annoying problem. Probably a simple fix  
for this I imagine, just not that knowledgeable with Apache2.

If there is anything further I can do to test or modify please let me  
know.

Thanks,
Richard

From waterthrill at yahoo.no  Thu Aug  5 11:22:16 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Thu Aug  5 04:18:36 2004
Subject: [mod_python] Frames using psp
Message-ID: <4111EE38.9060009@yahoo.no>

Hi.

I am making a web-application, and I've choosed to use mod_python.

Here is my mod_python.conf
% -------  Snip of mod_python.conf: ---------%
<Directory /var/www/html/psp>
  AddHandler mod_python .psp .psp_
  PythonHandler mod_python.psp
  PythonDebug On
</Directory>
% ------- End of snip ----------------%

The configuration is working.
I have splitted html-files in an html-folder, psp-related and 
python-code into a psp-folder.

I will give a short description on what I would like to make:

I want two frames, where one frame is sending POSTS to second frame.

A layout sketch:

--------------------------------
Frame 1: Consists configuration-elements to Frame2, sent as POST'S?
input1 =  number1
input2 = number2
--------------------------------
Frame 2: Receive POSTS from GET
2.  Use Data received.
3. Add Frame1.number1 + Frame1.number2
-------------------------------

End of layout sketch.

The layout of these two frames are pretty static, while the content are 
not...

Is this possible?
Do someone have a smart solution to this problem of mine?
Maybe a short example can be sent to me, so I can continue work on that 
skeleton?
That would be awesome..


Thank you in advance.

Cheers,

Ole



From aplisson-modpython at stochastique.net  Thu Aug  5 11:43:38 2004
From: aplisson-modpython at stochastique.net (Adrien Plisson)
Date: Thu Aug  5 04:48:26 2004
Subject: [mod_python] Frames using psp
In-Reply-To: <4111EE38.9060009@yahoo.no>
References: <4111EE38.9060009@yahoo.no>
Message-ID: <4111F33A.5040608@stochastique.net>

Ole Jacob Hagen wrote:

 > --------------------------------
 > Frame 1: Consists configuration-elements to Frame2, sent as POST'S?
 > input1 =  number1
 > input2 = number2
 > --------------------------------
 > Frame 2: Receive POSTS from GET
 > 2.  Use Data received.
 > 3. Add Frame1.number1 + Frame1.number2
 > -------------------------------
 >
 > End of layout sketch.
 >
 > The layout of these two frames are pretty static, while the content are not...
 >
 > Is this possible?


It is possible, but it seems more an html problem than a mod_python/psp related 
problem.

 > Do someone have a smart solution to this problem of mine?


use the "target" attribute of the "form" html tag, like this:
<form action="frame2.psp" method="POST" target="frame2">
</form>

regards,

-- 
rien

From waterthrill at yahoo.no  Fri Aug  6 00:52:45 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Thu Aug  5 18:48:03 2004
Subject: [mod_python] Frames using psp
In-Reply-To: <4111F33A.5040608@stochastique.net>
References: <4111EE38.9060009@yahoo.no> <4111F33A.5040608@stochastique.net>
Message-ID: <4112AC2D.6000600@yahoo.no>

Hi,

I 've just tried out your suggestion, but a new Frame pops up. It is not 
using the same bottom frame as I'd like to...
How do I receive and handles the form data from top_frame in bot_frame? 
I would also like to keep my frameset.

How can I accomplish this?

Cheers,

Ole J.

> It is possible, but it seems more an html problem than a 
> mod_python/psp related problem.
>
> > Do someone have a smart solution to this problem of mine?
>
>
> use the "target" attribute of the "form" html tag, like this:
> <form action="frame2.psp" method="POST" target="frame2">
> </form>
>
> regards,
>

From arnaudsj at mac.com  Thu Aug  5 23:54:51 2004
From: arnaudsj at mac.com (=?ISO-8859-1?Q?S=E9bastien_Arnaud?=)
Date: Thu Aug  5 23:54:56 2004
Subject: [mod_python] HTTP-Keep alive bug?
Message-ID: <5E669572-E75C-11D8-B8DB-003065966802@mac.com>

Hi,

I wonder if anybody else had been getting the same problem that I 
noticed with http keep alive request being not answered properly by 
mod_python. If you take the very simple mptest example, and use ab to 
benchmark/stress this trivial example, you may notice that even though 
you are requesting to use http-keep alive (-k option in ab), the 
resulting page (http://yourserver/test/mptest.py) is forcing the 
connection to close (inspect the HTTP headers and see Connection: 
Close).

HTTP keep alive is rather important if you are trying to high 
performance/scalable apps since the clients don't have to open/close 
the http connection at each request (well, as long as they are don't 
exceed the time-out value you set in apache). Anyway, would anybody 
else mind running some similar tests to see if it is an actual bug or 
just my config (or me ;)? I am been able to verify this misbehavior on 
both OS 10.3.4 (Apache 2.0.50/mod_python 3.1.3) and Gentoo Linux 
(Apache 2.0.50/mod_python 3.1.3).

For reference here is what I run:
ab -c 7 -t 15 -k http://gentoolinux/test/mptest.py

I already verified that requesting simple .html files on this same 
apache server using the http keep-alive directive works properly.

Thanks,

S?bastien

-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 155 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040805/138232f6/PGP.bin
From vomjom at vomjom.org  Fri Aug  6 03:18:19 2004
From: vomjom at vomjom.org (Jonathan Hseu)
Date: Fri Aug  6 03:13:55 2004
Subject: [mod_python] HTTP-Keep alive bug?
In-Reply-To: <5E669572-E75C-11D8-B8DB-003065966802@mac.com>
References: <5E669572-E75C-11D8-B8DB-003065966802@mac.com>
Message-ID: <20040806071819.GA20246@vomjom.org>

On Thu, Aug 05, 2004 at 10:54:51PM -0500, S?bastien Arnaud wrote:
> Hi,
> 
> I wonder if anybody else had been getting the same problem that I 
> noticed with http keep alive request being not answered properly by 
> mod_python. If you take the very simple mptest example, and use ab to 
> benchmark/stress this trivial example, you may notice that even though 
> you are requesting to use http-keep alive (-k option in ab), the 
> resulting page (http://yourserver/test/mptest.py) is forcing the 
> connection to close (inspect the HTTP headers and see Connection: 
> Close).
> 

Well, I don't know if this is related, but I do experience an issue with
keep-alive and mod_python (although, I just assumed it was firefox's
problem, even though I don't get that bug with anything but firefox).
Basically, on some keep-alive requests, firefox gives me the HTTP
headers and other stuff and renders that as text instead of the actual
page.  Most likely, this is related to your keep-alive bug, since this
only happens _after_ the first request in a keep-alive request.

Jonathan Hseu
From aplisson-modpython at stochastique.net  Fri Aug  6 11:23:43 2004
From: aplisson-modpython at stochastique.net (Adrien Plisson)
Date: Fri Aug  6 04:28:29 2004
Subject: [mod_python] Frames using psp
In-Reply-To: <4112AC2D.6000600@yahoo.no>
References: <4111EE38.9060009@yahoo.no> <4111F33A.5040608@stochastique.net>
	<4112AC2D.6000600@yahoo.no>
Message-ID: <4113400F.7090303@stochastique.net>

Ole Jacob Hagen wrote:
> Hi,

hello !

> I 've just tried out your suggestion, but a new Frame pops up. It is not 
> using the same bottom frame as I'd like to...

well, you may have mistyped the name of the frames.


 > How do I receive and handles the form data from top_frame in bot_frame?
 > I would also like to keep my frameset.
 >
 > How can I accomplish this?


in your main file (index.html or such) you declare your frameset:
<frameset rows="50%, 50%">
     <frame name="top_frame" src="top_frame.html"/>
     <frame name="bot_frame" src="bot_frame.psp"/>
     <!-- notice the name of the frames -->
</frameset>

in top_frame.html you declare you form:
<!-- the target attribute should match the name of the frame you would like to 
see your results in. the action attribute is the name of the file whose output 
will be displayed in the target frame -->
<form action="bot_frame.psp" method="POST" target="bot_frame">
     <!-- put here any form control you want -->
     <input type="submit" value="update"/>
</form>

in bot_frame.psp, just process the data, don't even think of where it's coming 
from or where it's going to, the browser handles that.


for a more practical example goto:
http://www.stochastique.net/~rien/test_frames/

index.html declares the frameset, frame1.html and frame2.cgi are the content of 
the frames. try them in place, or download them to study the code.
it has not been written using psp (i don't have mod_python on this host), but 
using straight python as a cgi. anyway, the method to have form handled in 
other frames is not mod_python specific, but rather client-side specific, so 
any languages should give the same result.


hope this helps.
regards,

-- 
rien

From waterthrill at yahoo.no  Fri Aug  6 12:14:40 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Fri Aug  6 05:10:55 2004
Subject: [mod_python] mod_pythons answer to PHP's _POST['variable']?
Message-ID: <41134C00.2080507@yahoo.no>

Hi.

I am making server pages, and solved my last questions.

I forgot to name the frames...;-)

Well, now I would like to receive the _POST['variable'] as I know from 
PHP, but how can I do the same in PSP?

I would like to have a short example of usage.

What is the analogy of _POST['php_self'] in mod_python/psp?


Cheers,

Ole J.
From manfred.stienstra at dwerg.net  Fri Aug  6 13:19:36 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Aug  6 06:19:43 2004
Subject: [mod_python] mod_pythons answer to PHP's _POST['variable']?
In-Reply-To: <41134C00.2080507@yahoo.no>
References: <41134C00.2080507@yahoo.no>
Message-ID: <1091787576.11303.23.camel@ack.dwerg.net>

On Fri, 2004-08-06 at 11:14, Ole Jacob Hagen wrote:
> Hi.
> 
> I am making server pages, and solved my last questions.
> 
> I forgot to name the frames...;-)
> 
> Well, now I would like to receive the _POST['variable'] as I know from 
> PHP, but how can I do the same in PSP?
> 
> I would like to have a short example of usage.
> 
> What is the analogy of _POST['php_self'] in mod_python/psp?

Take a look at the FieldStorage class in the modpython documentation.

http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html

Also, for more understanding read rfc 2616. It could look a little
daunting, but it's worth the read.

http://www.w3.org/Protocols/rfc2616/rfc2616.html

Manfred

From waterthrill at yahoo.no  Fri Aug  6 13:33:21 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Fri Aug  6 06:29:39 2004
Subject: [mod_python] mod_pythons answer to PHP's _POST['variable']?
In-Reply-To: <41134C00.2080507@yahoo.no>
References: <41134C00.2080507@yahoo.no>
Message-ID: <41135E71.7050207@yahoo.no>

I can get the _POST using req.read() in psp...

Ole

Ole Jacob Hagen wrote:

> Hi.
>
> I am making server pages, and solved my last questions.
>
> I forgot to name the frames...;-)
>
> Well, now I would like to receive the _POST['variable'] as I know from 
> PHP, but how can I do the same in PSP?
>
> I would like to have a short example of usage.
>
> What is the analogy of _POST['php_self'] in mod_python/psp?
>
>
> Cheers,
>
> Ole J.
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From waterthrill at yahoo.no  Fri Aug  6 13:40:33 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Fri Aug  6 06:36:51 2004
Subject: [mod_python] mod_pythons answer to PHP's _POST['variable']?
In-Reply-To: <1091787576.11303.23.camel@ack.dwerg.net>
References: <41134C00.2080507@yahoo.no>
	<1091787576.11303.23.camel@ack.dwerg.net>
Message-ID: <41136021.1080408@yahoo.no>

Hi, Manfred.

Thanks.

Is it sufficient to use req.read() ?

Ole

Manfred Stienstra wrote:

>On Fri, 2004-08-06 at 11:14, Ole Jacob Hagen wrote:
>  
>
>>Hi.
>>
>>I am making server pages, and solved my last questions.
>>
>>I forgot to name the frames...;-)
>>
>>Well, now I would like to receive the _POST['variable'] as I know from 
>>PHP, but how can I do the same in PSP?
>>
>>I would like to have a short example of usage.
>>
>>What is the analogy of _POST['php_self'] in mod_python/psp?
>>    
>>
>
>Take a look at the FieldStorage class in the modpython documentation.
>
>http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html
>
>Also, for more understanding read rfc 2616. It could look a little
>daunting, but it's worth the read.
>
>http://www.w3.org/Protocols/rfc2616/rfc2616.html
>
>Manfred
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>  
>

From grahamd at dscpl.com.au  Fri Aug  6 22:30:23 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Aug  6 07:30:27 2004
Subject: [mod_python] Status of Mac OS X / Apache 1.3 / mod_python 2.7.10.
In-Reply-To: <1091677032.58339@dscpl.com.au>
References: <1091677032.58339@dscpl.com.au>
Message-ID: <01CB5B58-E79C-11D8-B37D-000393DCF16E@dscpl.com.au>


On 05/08/2004, at 1:37 PM, Graham Dumpleton wrote:

> On Aug 04 15:26, Justin Ryan <jryan@qutang.net> wrote:
>>
>> Subject: Re: [mod_python] Status of Mac OS X / Apache 1.3 /  
>> mod_python 2.7.10.
>>
>> Be careful when playing with the file/directory/link/whateva that is
>> /System/Library/Frameworks/Python.Framework.  I ran into some  
>> wierdness
>> trying to change this into a symlink and move it around (i.e. change  
>> it
>> back and forth from pointing to Apple's python and my own).
>>
>> Also, take care when using the 'python' command after installing your
>> own framework build.  It's kind of a pain to get a framework build to
>> stick python, pythonw, etc.. in /usr/bin - all of my stuff was in
>> /usr/local/bin, even though I passed --prefix=/usr to the configure
>> script.
>
> I would agree and why I didn't want to go down the path of having to  
> replace
> the standard version of Python on MacOSX with a newer version to get  
> mod_python
> to work. Similarly, I didn't want to be replacing their version of  
> Apache.
>
> Anyway, listed below is the changes I had to make to get it to build  
> and work
> on MacOSX (10.3.3) with the standard Python (2.3) and Apache (1.3)  
> that come
> with the operating system.
>
> First off, after running configure, change "src/Makefile" and replace:
>
>    
> /System/Library/Frameworks/Python.framework/Versions/2.3/lib/ 
> python2.3/config/libpython2.3.a
>
> with:
>
>   -framework Python
>
> in LIBS variable.
>
> Second, in the same makefile, change CFLAGS and add in:
>
>   -DEAPI
>
> as a compiler option.
>
> This will allow mod_python to build, but the result will crash.

Just for the record, forgot that to build in thread support to  
mod_python correctly,
need to modify configure before running it and change:

   if test "$PyTHREADS" = "1"; then

to:

   if test "$PyTHREADS" = "True"; then

This is because Python 2.3 generates "True" and not "1".

--
Graham Dumpleton (grahamd@dscpl.com.au)

From dpopowich at comcast.net  Fri Aug  6 13:28:51 2004
From: dpopowich at comcast.net (Daniel Popowich)
Date: Fri Aug  6 12:29:38 2004
Subject: [mod_python] get_cookies in servlet
In-Reply-To: <52DC70C1C1575C418CB033523A29CF14104994@exchange2000.manord.com>
References: <52DC70C1C1575C418CB033523A29CF14104994@exchange2000.manord.com>
Message-ID: <16659.45507.64826.135890@h00a0cc25a952.ne.client2.attbi.com>


Manera, Villiam writes:
> I added this code in prep():
>  
> def prep(self):
>     .....
>   cookies = self.get_cookies()
>   COOKIE_NAME = 'backgroundcolor'
>   if cookies.has_key(COOKIE_NAME):
>                  self.body_attrs['BGCOLOR']=cookies[COOKIE_NAME].value
>  
> in order to achieve what I wont I had to modify the servlet.py get_cookies:
>     def get_cookies(self, klass=Cookie.Cookie, **kw):
>         ...       
>      return Cookie.get_cookies(self.req, klass)
>      #return Cookie.get_cookies(self.req, klass, kw) <--- with kw :
>  
>    File "C:\PROGRA~1\Python23\lib\site-packages\mod_python\servlet.py", line
> 484, in get_cookies
>     return Cookie.get_cookies(self.req, klass, kw)
> 
> TypeError: get_cookies() takes at most 2 arguments (3 given)
>  

You found bug #2.  Going for the trifecta?  I have fixed this (as well
as the assertion bugs) and have placed a new version, 1.1.5, at:

    http://home.comcast.net/~d.popowich/mpservlets/

As for the feature request for js_links.  I like the idea, but I'm not
adding new functionality right now.  I'll add this to the list for the
next minor release.

Thanks!!

Daniel

From eric at bright-interactive.com  Fri Aug  6 23:05:44 2004
From: eric at bright-interactive.com (Eric Clack)
Date: Fri Aug  6 17:04:40 2004
Subject: [mod_python] Setting parameter types with Publisher
Message-ID: <61A97480-E7EC-11D8-A783-0003931D0ECA@bright-interactive.com>

Hi All,
Been playing around with mod_python for a few weeks now and am very 
impressed :-)

Recently I've found in my apps that I seem to be doing a lot of type 
checking and catching of empty strings -- because all parameters are 
passed as string and this causes problems with database criteria for 
example.

So I thought I'd hack publisher.py to make things a little easier. I 
include my changes below for discussion/criticism. Since I'm new to 
Python and mod_python any comments gratefully received :-)

-----------8<-----------------------------------------------------
First, add these lines to any actions scripts and customise as you wish 
(just like you would add __auth__ variables)...

# Identify which parameters to actions are longs and should
# be converted as such...

# Use zero if not long...
__long_or_zero__ = [ 'projectid', 'staffid' ]

# Use None if not long...
__long_or_None__ = [ 'jobid' ]


-----------8<-----------------------------------------------------
Secondly, add the following lines to publisher.py...

In the function handler, line 175, insert these lines:

         # Perform any type conversions
         args = process_types(req, module, args)

Just before the line:

         result = apply(object, (), args)

Then add these functions to the end of the file:

def process_types(req, object, args):
	"""Perform any type conversions"""
	
	if hasattr(object, "__long_or_zero__"):
		for p in object.__long_or_zero__:
		if args.has_key(p):
			args[p] = longOrZero(args[p])

	if hasattr(object, "__long_or_None__"):
		for p in object.__long_or_None__:
			if args.has_key(p):
				args[p] = longOrNone(args[p])
			
	return args
			
			
def longOrNone(p):
	"""Convert string parameter to long or if blank None"""
	try: return long(p)
	except ValueError: return None
	except TypeError: return None
		
	
def longOrZero(p):
	"""Convert string parameter to long or if blank zero"""
	try: return long(p)
	except ValueError: return 0
	except TypeError: return 0
	


Eric Clack
eric@bright-interactive.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: text/enriched
Size: 2138 bytes
Desc: not available
Url : http://modpython.org/pipermail/mod_python/attachments/20040806/de5eeddf/attachment.bin
From jgentil at sebistar.net  Sat Aug  7 08:37:00 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Sat Aug  7 08:37:04 2004
Subject: [mod_python] Frames using psp
In-Reply-To: <4113400F.7090303@stochastique.net>
References: <4111EE38.9060009@yahoo.no>
	<4111F33A.5040608@stochastique.net>	<4112AC2D.6000600@yahoo.no>
	<4113400F.7090303@stochastique.net>
Message-ID: <4114CCEC.2060306@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Adrien Plisson wrote:


>> I 've just tried out your suggestion, but a new Frame pops up. It is
>> not using the same bottom frame as I'd like to...


Here is a suggestion:  Don't use frames.

:)

They have been removed from the HTML standard now.  They're horrible.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkEUzOwACgkQOrVFmaIbww50IQCgnFaNJK6f1tU/v5ojwrEubkAN
bbUAoL2QtGpobe3njQgTuyp+S91Ertaz
=eMvC
-----END PGP SIGNATURE-----
From robert at worksofmagic.com  Sat Aug  7 22:53:56 2004
From: robert at worksofmagic.com (Robert Geller)
Date: Sat Aug  7 21:53:58 2004
Subject: [mod_python] Problems compiling mod_python
Message-ID: <001701c47cea$90f23380$1e02a8c0@leet>

Hello, I am running Fedora Core 2, Apache 2.0.51, Python 2.3.4, and I'm
trying to compile and install mod_python 3.1.3.
 
Note these are not RPMs and were compiled from source, so it's not a
question of having the sources.
 
When I try to make install mod python, I get the following errors at the
end:
 

Performing DSO installation.
 
/usr/bin/install -c -d /usr/local/apache/modules
/usr/bin/install -c src/mod_python.so /usr/local/apache/modules
/usr/bin/install: cannot stat `src/mod_python.so': No such file or
directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/home/robert/mod_python-3.1.3'
make: *** [install] Error 2

 
I'm not sure if this is fairly common, or what I should do. Someone
help! 
 
I've tried following the directions on
http://www.modpython.org/pipermail/mod_python/2003-January/013320.html
to no avail... 
 
What do you recommend I do? I don't know why it would fail while
compiling the .so...
 
Thanks.
 
P.S. -- I was root the entire time; I think you don't have to be / are
not supposed to be until you do make install... could this be why?
 
 

Robert Geller

robert@worksofmagic.com

 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040807/a41ef027/attachment.html
From jgentil at sebistar.net  Sun Aug  8 03:30:42 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Sun Aug  8 03:30:47 2004
Subject: [mod_python] Sessions and Persistant Databases.
Message-ID: <4115D6A2.3040703@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Is there a way to list all active sessions?

And better yet, once you have that list of active sessions, would it be
  safe to load one, and manipulate it and then save it, with the
assumption that it is NOT the active user's session?

My goal is that I wish to store a user's privilege levels in session to
reduce DB connections to a SQL database.  But if an administrator user
alters their priv level, I wish it to reflect in the session.  This
possible at all, or should I rely on loading this information from the
database each time?

I've looked it over, and I am just not entirely sure what I want to do
is possible.  I thought about creating a function in the Session module
that opens the DB and returns a list of keys, and then closes it... but
I wasn't sure if I actually create a session object if it would write
out cookies and such.  Since BaseSession requires a request object, I
get the feeling that what I want to accomplish will be no easy task,
probably needing to write a new BaseSession that allows for modification
without any client changes/request object.  *sigh*

Thanks!
Jon-Pierre
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkEV1qIACgkQOrVFmaIbww4CfACguM+UAHASk8dRIsbC4IVltE34
dKAAnRFBVPmC/VCXoF9St3etxmWyDydI
=2nAg
-----END PGP SIGNATURE-----
From vomjom at vomjom.org  Sun Aug  8 20:14:58 2004
From: vomjom at vomjom.org (Jonathan Hseu)
Date: Sun Aug  8 20:10:29 2004
Subject: [mod_python] Apache restart and Internal Server Error
Message-ID: <20040809001458.GA15114@vomjom.org>

Whenever I restart apache (using /etc/init.d/apache2 restart on debian,
which is equivalent to 'apachectl restart' or sending a SIGHUP to
apache2), and then try to access a mod_python page, I get an Internal
Server Error.  Does anyone else get this?  Someone encountered this same
bug back in January, but it doesn't seem to have been fixed yet...

This is particularly an issue because logrotate on debian calls
/etc/init.d/apache2 restart... so, before, whenever it ran, it would
cause the web page to break.

Now, I have made it first call /etc/init.d/apache2 stop, wait 10
seconds, then start it again, which fixes the problem...

But, this is still an important bug...

This bug appears even with the "Hello World" example.

Jonathan Hseu
From arnaudsj at mac.com  Mon Aug  9 00:30:16 2004
From: arnaudsj at mac.com (=?ISO-8859-1?Q?S=E9bastien_Arnaud?=)
Date: Mon Aug  9 00:30:21 2004
Subject: [mod_python] HTTP-Keep alive bug?
In-Reply-To: <20040806071819.GA20246@vomjom.org>
References: <5E669572-E75C-11D8-B8DB-003065966802@mac.com>
	<20040806071819.GA20246@vomjom.org>
Message-ID: <D01B6030-E9BC-11D8-A8AA-003065966802@mac.com>

Thanks Jonathan for your response.

I have done a little bit more investigation and I think that I managed 
a work around:

First, I was wrong when I said mod_python was forcing the HTTP Header 
"Connection: Close", it is in fact responding to a client request http 
keep-alive, but it is missing an important part: the HTTP header 
"Content-Length: xxx"! Since it is the only way browsers can keep 
connections alive (to know how much bytes they need to expect back from 
the server), without it, most browsers will NOT keep the connection 
alive (maybe your version of Firefox is sensitive to this missing 
header and tries to wait for more content to come back from the server)

For the record I got mistaken in my early tests because I used Lynx to 
get the HTTP headers back, and found out that Lynx did not send a valid 
HTTP 1.1 request with keep-alive (duh!), therefore it was ok to receive 
a "Connection: Close" back then.

Anyway, I think it would be nice to have an explanation why mod_python 
is not setting by default the Content-Length HTTP header when it is 
already setting the "Connection: Keep-alive" HTTP header in response to 
a keep-alive request from the client.

If you set it by hand in your python code like this though:
	ResultHTML = "Your output HTML to the client"
	req.headers_out['Content-Length']=str(len(ResultHTML))
	req.write(ResultHTML)

It works, and you can then start to enjoy the performance boost of 
"keep-alive" connections.

Cheers,

S?bastien


On Aug 6, 2004, at 2:18 AM, Jonathan Hseu wrote:

> On Thu, Aug 05, 2004 at 10:54:51PM -0500, S?bastien Arnaud wrote:
>> Hi,
>>
>> I wonder if anybody else had been getting the same problem that I
>> noticed with http keep alive request being not answered properly by
>> mod_python. If you take the very simple mptest example, and use ab to
>> benchmark/stress this trivial example, you may notice that even though
>> you are requesting to use http-keep alive (-k option in ab), the
>> resulting page (http://yourserver/test/mptest.py) is forcing the
>> connection to close (inspect the HTTP headers and see Connection:
>> Close).
>>
>
> Well, I don't know if this is related, but I do experience an issue 
> with
> keep-alive and mod_python (although, I just assumed it was firefox's
> problem, even though I don't get that bug with anything but firefox).
> Basically, on some keep-alive requests, firefox gives me the HTTP
> headers and other stuff and renders that as text instead of the actual
> page.  Most likely, this is related to your keep-alive bug, since this
> only happens _after_ the first request in a keep-alive request.
>
> Jonathan Hseu
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 155 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040808/b2018e69/PGP.bin
From ppercot at free.fr  Mon Aug  9 10:18:53 2004
From: ppercot at free.fr (Patrick Percot)
Date: Mon Aug  9 03:19:40 2004
Subject: [mod_python] Apache restart and Internal Server Error
In-Reply-To: <20040809001458.GA15114@vomjom.org>
References: <20040809001458.GA15114@vomjom.org>
Message-ID: <20040809.091853.74750498.ppercot@free.fr>

On Sun, 8 Aug 2004 19:14:58 -0500, vomjom@vomjom.org (Jonathan Hseu) wrote

> Whenever I restart apache (using /etc/init.d/apache2 restart on debian,
> which is equivalent to 'apachectl restart' or sending a SIGHUP to
> apache2), and then try to access a mod_python page, I get an Internal
> Server Error.  Does anyone else get this?  Someone encountered this same
> bug back in January, but it doesn't seem to have been fixed yet...
> 

No.   But I don't  use the  Debian packages.   I recompiled  both Apache
(2.0.49), Python (2.3.3) and mod_python (3.1.3). 

I didn't notice any problems when  I used Apache 1.3 Debian package with
mod_python. 

Did you search in Debian mailing list archives for this problem ?

[..Zapp? 19 lignes et 586 caract?res..]

?+
PP
-- 
Groupe Morbihannais d'Utilisateurs de Logiciels Libres http://www.tuxbihan.org
Identifiant Jabber: pp@amessage.de
GPG fingerprint = 1A4F E154 3D2C A20E E4CA  A543 7951 C5C2 E44A A0B5

Patrick Percot.

From waterthrill at yahoo.no  Mon Aug  9 11:03:08 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Mon Aug  9 03:59:09 2004
Subject: [mod_python] GET works, but POST doesn't in mod_python
Message-ID: <41172FBC.3050500@yahoo.no>

Hi.

I am experiencing the same problem as found in : 
http://mail.python.org/pipermail/python-list/2003-December/200961.html
I have successfully accomplished how to send forms from a top frame to a 
bottom frame.

So thanks for helping me out here.

Remember that I am using psp, instead of the publisher.

Output listings:

I will give output from bot_frame.psp, using both POST and GET in 
top_frame.psp:

user=mod_python
database=psp

When  method = \"GET\" in s
bot_frame will produce following output:
 
req.method is a GET[Field('user', 'mod_python'), Field('database', 'psp')]
length of incoming message is: 0

Which is correct, but when method=\"POST\" in s, bot_frame will produce 
following output:
req.method is a POST[]
length of incoming message is: 28

Why doesn't POST works? It seems that the POST message is stored, since 
the length of string is 28....
How can I retrieve it?

I'd like to use GET instead of POST, since GET has a size limit.


Cheers,

Ole J.









Listing of files:


frame_setup.psp:

def frame_setup():
   s = """<frameset rows=\"50%,50%\">
   <frame src=\"top_frame.psp\" name=\"top_frame\">
   <frame src=\"bot_frame.psp\" name=\"bot_frame\">
   </frameset>"""
   req.write(s)



%------------- top_frame.psp -----------%
<%
import DB_SB
def top_frame():
    form_to_bot()

def form_to_bot():
    s = """<form name=\"input\" method=\"post\" action=\"bot_frame.psp\" 
target=\"bot_frame\">
    Username:
    <input type=\"text\" name=\"user\"><br>
    Database:
    <input type=\"text\" name=\"database\">
    <input type=\"submit\" value=\"Submit\">
    </form>"""
    req.write(s)

%>
<html>

<%  top_frame()

%>

</html>

% ------------- end of top_frame.psp -------------------------%


% ----------- bot_frame.psp -----------------------%

<%

def bot_frame(name='default'):
    import types,util
    s = req.read()
    fs = util.FieldStorage(req)
    fslist = fs.list
    req.write("req.method is a %s" % req.method)   
    req.write("%s %s" % (fslist,"<br>"))
    req.write("length of incoming message is: %s<br>" % len(s))


%>
<html>

<%  bot_frame()

%>

</html>

% ---------- end of bot_frame.psp -------------------%


From waterthrill at yahoo.no  Mon Aug  9 11:10:40 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Mon Aug  9 04:06:43 2004
Subject: [mod_python] Re: GET works, but POST doesn't in mod_python
In-Reply-To: <41172FBC.3050500@yahoo.no>
References: <41172FBC.3050500@yahoo.no>
Message-ID: <41173180.6030403@yahoo.no>

Hi.

Read comments:



Ole Jacob Hagen wrote:

>
> user=mod_python
> database=psp
>
> When  method = \"GET\" in s
> bot_frame will produce following output:
>
> req.method is a GET[Field('user', 'mod_python'), Field('database', 
> 'psp')]
> length of incoming message is: 0
>
> Which is correct, but when method=\"POST\" in s, bot_frame will 
> produce following output:
> req.method is a POST[]
> length of incoming message is: 28
>
>
I can retrieve the message using req.read(), which will produce the 
following output:
output: user=mod_python&database=psp

I imagined that req.read() could read both GET and POST, but I believe 
this is not happening.
If I use a POST, then I need to parse the form data, and chech for POST 
method, and the same thing if req.method=="GET"

Why is it like this?

Cheers,

Ole J.



From grisha at modpython.org  Mon Aug  9 11:12:50 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug  9 10:12:55 2004
Subject: [mod_python] HTTP-Keep alive bug?
In-Reply-To: <D01B6030-E9BC-11D8-A8AA-003065966802@mac.com>
References: <5E669572-E75C-11D8-B8DB-003065966802@mac.com>
	<20040806071819.GA20246@vomjom.org>
	<D01B6030-E9BC-11D8-A8AA-003065966802@mac.com>
Message-ID: <20040809095014.R38983@onyx.ispol.com>



On Sun, 8 Aug 2004, [ISO-8859-1] S?bastien Arnaud wrote:

> First, I was wrong when I said mod_python was forcing the HTTP Header 
> "Connection: Close", it is in fact responding to a client request http 
> keep-alive, but it is missing an important part: the HTTP header 
> "Content-Length: xxx"!

If this is HTTP 1.1, then absense of content-length indicates that the 
browser wants chunked-encoding, which means that the output is a number 
indicating size, followed by a chunk of data. With HTTP 1.1 content-length 
is obsolete. There is a pretty good description of it here:

http://www.apacheweek.com/features/http11

> Since it is the only way browsers can keep connections alive (to know 
> how much bytes they need to expect back from the server),

...not with HTTP 1.1

> without it, most browsers will NOT keep the connection alive (maybe your 
> version of Firefox is sensitive to this missing header and tries to wait 
> for more content to come back from the server)

No, this doesn't make a lot of sense. :-) The browser isn't keeping it 
alive because it is seeing a Connection: close, most likely.

> For the record I got mistaken in my early tests because I used Lynx to get 
> the HTTP headers back, and found out that Lynx did not send a valid HTTP 1.1 
> request with keep-alive (duh!), therefore it was ok to receive a "Connection: 
> Close" back then.
>
> Anyway, I think it would be nice to have an explanation why mod_python is not 
> setting by default the Content-Length HTTP header when it is already setting 
> the "Connection: Keep-alive" HTTP header in response to a keep-alive request 
> from the client.

Mod_python does not set the connection header anywhere in the code, but 
other code in Apache probably does. In my experience it is very smart 
about it, so there is more than likely a good reason for it. Something is 
telling Apache to send a "close"... It could the configuration, some 
module in Apache, and it could be something that the browser has caused 
(without seeing the actual headers its hard to tell).

Grisha
From jgentil at sebistar.net  Mon Aug  9 12:53:04 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Mon Aug  9 12:53:09 2004
Subject: [mod_python] GET works, but POST doesn't in mod_python
In-Reply-To: <41172FBC.3050500@yahoo.no>
References: <41172FBC.3050500@yahoo.no>
Message-ID: <4117ABF0.7080305@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Ole Jacob Hagen wrote:
> Hi.
>
> I am experiencing the same problem as found in :
> http://mail.python.org/pipermail/python-list/2003-December/200961.html
> I have successfully accomplished how to send forms from a top frame to a
> bottom frame.
>
> So thanks for helping me out here.
>
> Remember that I am using psp, instead of the publisher.
>
> Output listings:
>
> I will give output from bot_frame.psp, using both POST and GET in
> top_frame.psp:
>
> user=mod_python
> database=psp
>
> When  method = \"GET\" in s
> bot_frame will produce following output:
>
> req.method is a GET[Field('user', 'mod_python'), Field('database', 'psp')]
> length of incoming message is: 0
>
> Which is correct, but when method=\"POST\" in s, bot_frame will produce
> following output:
> req.method is a POST[]
> length of incoming message is: 28
>
> Why doesn't POST works? It seems that the POST message is stored, since
> the length of string is 28....
> How can I retrieve it?

req.read will read POST variables, but not GET varibles.  to get GET
variables, you need to parse the original URL..

Its better just to use the FieldStorage class.  :D
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkEXq/AACgkQOrVFmaIbww4q7wCcCwByzQyI5bBgPYn1NX6/drS4
Fs4AoItP5sr8Q1DILHtg9yZr7a6+2sZx
=UC6z
-----END PGP SIGNATURE-----
From arnaudsj at mac.com  Mon Aug  9 21:38:41 2004
From: arnaudsj at mac.com (=?ISO-8859-1?Q?S=E9bastien_Arnaud?=)
Date: Mon Aug  9 21:38:47 2004
Subject: [mod_python] HTTP-Keep alive bug?
In-Reply-To: <20040809095014.R38983@onyx.ispol.com>
References: <5E669572-E75C-11D8-B8DB-003065966802@mac.com>
	<20040806071819.GA20246@vomjom.org>
	<D01B6030-E9BC-11D8-A8AA-003065966802@mac.com>
	<20040809095014.R38983@onyx.ispol.com>
Message-ID: <02A674A5-EA6E-11D8-B74C-003065966802@mac.com>

Grisha,

Thank you for your enlightenment in those dark areas of my assumptions 
(oh man, let's say it, I was wrong on the whole HTTP 1.1 thing ;)

Here are 2 simple tests that hopefully will speak for themselves better 
than I can explain it. I ran with apache bench (2.40) against one 
simple test page rendered by mod_python.

############# BEGIN: FIRST TEST ##############
ab -v 3 -n 1 -k http://localhost/test/index.py
This is ApacheBench, Version 2.0.40-dev <$Revision: 1.121.2.10 $> 
apache-2.0
Copyright (c) 1996 Adam Twiss, Zeus Technology Ltd, 
http://www.zeustech.net/
Copyright (c) 1998-2002 The Apache Software Foundation, 
http://www.apache.org/

Benchmarking localhost (be patient)...INFO: POST header ==
---
GET /test/index.py HTTP/1.0
User-Agent: ApacheBench/2.0.40-dev
Connection: Keep-Alive
Host: localhost
Accept: */*


---
LOG: header received:
HTTP/1.1 200 OK
Date: Tue, 10 Aug 2004 01:19:55 GMT
Server: Apache
Cache-Control: no-cache="set-cookie"
Set-Cookie: testcookie=testvalue2; expires=Tue, 10-Aug-2004 01:24:56 GMT
Connection: close
Content-Type: text/html

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Test XSLT View</title>
</head>
<body><p>The message is: <span></span></p></body>
</html>

LOG: Response code = 200
..done


Server Software:        Apache
Server Hostname:        localhost
Server Port:            80

Document Path:          /test/index.py
Document Length:        178 bytes

Concurrency Level:      1
Time taken for tests:   0.17957 seconds
Complete requests:      1
Failed requests:        0
Write errors:           0
Keep-Alive requests:    0
Total transferred:      406 bytes
HTML transferred:       178 bytes
Requests per second:    55.69 [#/sec] (mean)
Time per request:       17.957 [ms] (mean)
Time per request:       17.957 [ms] (mean, across all concurrent 
requests)
Transfer rate:          0.00 [Kbytes/sec] received

Connection Times (ms)
               min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       0
Processing:    17   17   0.0     17      17
Waiting:        8    8   0.0      8       8
Total:         17   17   0.0     17      17
################# END FIRST TEST #####################

Note, the "Connection: close" returned by apache even though ab 
requested a "Connection: Keep-Alive"
Now, the same request, but the simple test.py script is now setting 
req.headers_out['Content-Length']

################ BEGIN SECOND TEST ###################
ab -v 3 -n 1 -k http://localhost/test/index.py
This is ApacheBench, Version 2.0.40-dev <$Revision: 1.121.2.10 $> 
apache-2.0
Copyright (c) 1996 Adam Twiss, Zeus Technology Ltd, 
http://www.zeustech.net/
Copyright (c) 1998-2002 The Apache Software Foundation, 
http://www.apache.org/

Benchmarking localhost (be patient)...INFO: POST header ==
---
GET /test/index.py HTTP/1.0
User-Agent: ApacheBench/2.0.40-dev
Connection: Keep-Alive
Host: localhost
Accept: */*


---
LOG: header received:
HTTP/1.1 200 OK
Date: Tue, 10 Aug 2004 01:19:03 GMT
Server: Apache
Cache-Control: no-cache="set-cookie"
Set-Cookie: testcookie=testvalue2; expires=Tue, 10-Aug-2004 01:24:03 GMT
Content-Length: 178
Keep-Alive: timeout=30, max=1000
Connection: Keep-Alive
Content-Type: text/html

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Test XSLT View</title>
</head>
<body><p>The message is: <span></span></p></body>
</html>

LOG: Response code = 200
..done


Server Software:        Apache
Server Hostname:        localhost
Server Port:            80

Document Path:          /test/index.py
Document Length:        178 bytes

Concurrency Level:      1
Time taken for tests:   0.282956 seconds
Complete requests:      1
Failed requests:        0
Write errors:           0
Keep-Alive requests:    1
Total transferred:      466 bytes
HTML transferred:       178 bytes
Requests per second:    3.53 [#/sec] (mean)
Time per request:       282.956 [ms] (mean)
Time per request:       282.956 [ms] (mean, across all concurrent 
requests)
Transfer rate:          0.00 [Kbytes/sec] received

Connection Times (ms)
               min  mean[+/-sd] median   max
Connect:        0    0   0.0      0       0
Processing:   282  282   0.0    282     282
Waiting:      247  247   0.0    247     247
Total:        282  282   0.0    282     282
#################### END SECOND TEST #############################

Note, that suddenly here Apache replies properly to the keep-alive 
request with the response headers:
"Keep-Alive: timeout=30, max=1000" and "Connection: Keep-Alive". All of 
this because we did set the "content-length" header in the python code.

Anybody, who has a more in depth knowledge of Apache, tempted to solve 
this mystery?

Cheers,

S?bastien


On Aug 9, 2004, at 9:12 AM, Gregory (Grisha) Trubetskoy wrote:

>
>
> On Sun, 8 Aug 2004, [ISO-8859-1] S?bastien Arnaud wrote:
>
>> First, I was wrong when I said mod_python was forcing the HTTP Header 
>> "Connection: Close", it is in fact responding to a client request 
>> http keep-alive, but it is missing an important part: the HTTP header 
>> "Content-Length: xxx"!
>
> If this is HTTP 1.1, then absense of content-length indicates that the 
> browser wants chunked-encoding, which means that the output is a 
> number indicating size, followed by a chunk of data. With HTTP 1.1 
> content-length is obsolete. There is a pretty good description of it 
> here:
>
> http://www.apacheweek.com/features/http11
>
>> Since it is the only way browsers can keep connections alive (to know 
>> how much bytes they need to expect back from the server),
>
> ...not with HTTP 1.1
>
>> without it, most browsers will NOT keep the connection alive (maybe 
>> your version of Firefox is sensitive to this missing header and tries 
>> to wait for more content to come back from the server)
>
> No, this doesn't make a lot of sense. :-) The browser isn't keeping it 
> alive because it is seeing a Connection: close, most likely.
>
>> For the record I got mistaken in my early tests because I used Lynx 
>> to get the HTTP headers back, and found out that Lynx did not send a 
>> valid HTTP 1.1 request with keep-alive (duh!), therefore it was ok to 
>> receive a "Connection: Close" back then.
>>
>> Anyway, I think it would be nice to have an explanation why 
>> mod_python is not setting by default the Content-Length HTTP header 
>> when it is already setting the "Connection: Keep-alive" HTTP header 
>> in response to a keep-alive request from the client.
>
> Mod_python does not set the connection header anywhere in the code, 
> but other code in Apache probably does. In my experience it is very 
> smart about it, so there is more than likely a good reason for it. 
> Something is telling Apache to send a "close"... It could the 
> configuration, some module in Apache, and it could be something that 
> the browser has caused (without seeing the actual headers its hard to 
> tell).
>
> Grisha
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PGP.sig
Type: application/pgp-signature
Size: 155 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040809/2ec59bcf/PGP.bin
From suhaimi at niser.org.my  Tue Aug 10 13:49:19 2004
From: suhaimi at niser.org.my (Suhaimi Jamalludin)
Date: Tue Aug 10 00:47:12 2004
Subject: [mod_python] mptest.py testing failed
Message-ID: <411853CF.801@niser.org.my>

Hi All,

Really need your advice. I'm running FreeBSD5.2.1, apache 1.3.31, 
mod_python-2.7.10.
I got  this error in my httpd-error.log. FYI....apache is up an runing.

    make_obcallback(): could not import mod_python.apache.
    make_obcallback(): could not call init.
    [Tue Aug 10 11:57:32 2004] [error] [client 10.1.4.118] 
python_handler: make_obcallback returned no obCallBack!

Can somebody help me.

regards,
suhaimi

My step-by-step for mod_python on FreeBSD5.2.1
----------------------------------
1) Installed python
    # cd /usr/ports/lang/python
    # make -DWITHOUT_THREADS install clean

2) Installed mod_python
    # cd /usr/ports/www/mod_python
    # make -DWANT_EAPI install clean

3) Modify apache configuration file
    #vi /usr/local/etc/apache/http.conf
    add below line at the end of the http.conf
    ----snip-----
    <Directory /usr/local/www/cgi-bin/modpython>
      AddHandler python-program .py
      PythonHandler mptest
      PythonDebug On
    </Directory>
    ----snap-----

4) Create mptest.py
    # vi /usr/local/www/cgi-bin/modpython/mptest.py
    add below line in mptest.py
    ----snip-----
    from mod_python import apache

    def handler(req):
            req.write("Hello World!")
            return apache.OK
    ----snap-----
   
5) Restart Apache
    # /usr/local/etc/rc.d/apache restart
   
6) Open Mozilla Web Browser type the mod_python test file as below.

    http://10.1.4.8/cgi-bin/modpython/mptest.py

    Browser output:
   
    Internal Server Error
    The server encountered an internal error or misconfiguration and was 
unable to complete your request.
    Please contact the server administrator, root@local.domain and 
inform them of the time the error occurred, and anything you might have 
done that may have caused the error.
    More information about this error may be available in the server 
error log.

7) Check apache log file
    # tail /var/log/httpd-error.log
   
    [Tue Aug 10 11:57:24 2004] [notice] caught SIGTERM, shutting down
    [Tue Aug 10 11:57:28 2004] [notice] Apache configured -- resuming 
normal operations
    [Tue Aug 10 11:57:28 2004] [notice] Accept mutex: flock (Default: flock)
    'import site' failed; use -v for traceback
    make_obcallback(): could not import mod_python.apache.
    make_obcallback(): could not call init.
    [Tue Aug 10 11:57:32 2004] [error] [client 10.1.4.118] 
python_handler: make_obcallback returned no obCallBack!
From waterthrill at yahoo.no  Tue Aug 10 09:11:55 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Tue Aug 10 02:07:52 2004
Subject: [mod_python] GET works, but POST doesn't in mod_python
In-Reply-To: <4117ABF0.7080305@sebistar.net>
References: <41172FBC.3050500@yahoo.no> <4117ABF0.7080305@sebistar.net>
Message-ID: <4118672B.6010600@yahoo.no>

How can I use the FieldStorage-class for POST? It doesn't work as it 
does with GET.

Cheers,

Ole J.

Jon-Pierre Gentil wrote:

> Ole Jacob Hagen wrote:
>
>
> >Why doesn't POST works? It seems that the POST message is stored, since
> >the length of string is 28....
> >How can I retrieve it?
>
>
> req.read will read POST variables, but not GET varibles.  to get GET
> variables, you need to parse the original URL..
>
> Its better just to use the FieldStorage class.  :D



From mlists at rotondo.it  Tue Aug 10 12:38:54 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Tue Aug 10 05:36:08 2004
Subject: [mod_python] How long does a mod_python session last?
Message-ID: <411897AE.7030604@rotondo.it>

Hi everybody,

I am new to the list, so sorry if this question has already been formulated.

I'd like to know how much long a mod_python session lasts and if there 
is a way to change this value.

Thanks in advance,

   Fabio
From pc_ at one.lv  Tue Aug 10 15:47:01 2004
From: pc_ at one.lv (Cu _)
Date: Tue Aug 10 07:47:03 2004
Subject: [mod_python] Stopping Reimports
Message-ID: <529860.1092138421114.JavaMail.root@mail1.one.lv>

mpy
Hello, 

I'd like to know if there is some elegant way to deal with the 
[notice] mod_python: (Re)importing module 'index' with path set to [...]

The mod_python.apache importing mechanism works correctly, the problem is,
it keeps reimporting the same files.

I don't think reimporting is the best solution for modules with same names but in different directories.

It degrades performance with unneeded imports. 

Then,
I try to use mod_python's sideeffect of not discarding variables when importing already 
loaded modules to cache frequently used data (If the module doesn't get reimported all the time, it's variables keep their values between subsequent requests). 
Every reimport causes the cached data to be reloaded.

Also, it pollutes error_log :)

My current "solution" is ugly, that's why I post here, maybe somebody will come up with something 
better.
The idea is - if i have to load a module "my_module", which is at /path/to/my_files,
don't load it as my_module, but as path_to_my_files_my_module
That way, modules with same names will be assigned different names in sys.modules and won't
get reloaded all the time.

It's as using 
from path.to.my.files imort my_module as path_to_my_files_my_module
instead of
from path.to.my.files imort my_module

Modules loaded with import_module are usually used by pointers, not by symbolic names so, as for
me, it's ok to load it with a different name.

my mod_python/apache.py import_module() now looks like this:

def import_module(module_name, autoreload=1, log=0, path=None):
    """
    Get the module to handle the request. If
    autoreload is on, then the module will be reloaded
    if it has changed since the last import.
    """
    
    parts = module_name.split('.')    
    if path:
      path2 = '_'.join(path).replace('/','_').replace('.','_').replace('-','_')[1:] + '_'
      mn = path2 + module_name
    else:
      mn = module_name

    # (Re)import
    import sys
    if sys.modules.has_key(mn):
        module = sys.modules[mn]
    else:
        
        _apache.log_error('Has to load: '+str(mn)+ '('+str(module_name)+')', APLOG_NOERRNO|APLOG_NOTICE)
       
        for i in range(len(parts)):
            mname = ".".join(parts[:i+1])
            f, p, d = imp.find_module(parts[i], path)
            try:
                _apache.log_error('Loading: '+mname, APLOG_NOERRNO|APLOG_NOTICE)
                module = imp.load_module(mname, f, p, d)
        
            finally:
                if f: f.close()
            if hasattr(module, "__path__"):
                path = module.__path__

        # dark magic
        if mn:
          if mn != mname:
            t = sys.modules.keys()
            t.sort()
            _apache.log_error('Current load: '+str(t), APLOG_NOERRNO|APLOG_NOTICE)
            _apache.log_error('Switching: '+mname+' <-> '+mn, APLOG_NOERRNO|APLOG_NOTICE)
            sys.modules[mn] = sys.modules[mname]
            del(sys.modules[mname])
  
            t = sys.modules.keys()
            t.sort()
            _apache.log_error('After switch: '+str(t), APLOG_NOERRNO|APLOG_NOTICE)

    return module

-------------------------------------------------------------------------------
http://www.one.lv - Tavs mobilais e-pasts!

Tagad lasi savu e-pastu ar mobilo telefonu - wap.one.lv!
From nicolas at lehuen.com  Tue Aug 10 16:27:58 2004
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Tue Aug 10 09:28:03 2004
Subject: [mod_python] Stopping Reimports
In-Reply-To: <529860.1092138421114.JavaMail.root@mail1.one.lv>
Message-ID: <200408101328.i7ADRxIF028389@modpython.org>

Hi,

I don't think your solution is so ugly... A few weeks ago I wrote about a
similar problem on this list, though my solution was to alter publisher.py
to change the way it builds module names (publisher.py version 1.36, line 67
in mod_python 3.1.3)... Or, as Daniel Popowich wrote, you could use
mod_servlet (http://home.comcast.net/~d.popowich/mpservlets/) which does
correctly load modules.

Note that you were in fact quite lucky to experience reimports, since some
people (including me, running mp 3.1.3 on Apache2 multithreaded on Windows)
experience a much worse behaviour : no reimport at all, e.g. /foo/index.py
would return the same page as /bar/index.py if /bar/index.py was touched
after /foo/index.py !

Regards,

Nicolas Lehuen

> -----Message d'origine-----
> De : mod_python-bounces@modpython.org 
> [mailto:mod_python-bounces@modpython.org] De la part de Cu _
> Envoy? : mardi 10 ao?t 2004 13:47
> ? : mod_python@modpython.org
> Objet : [mod_python] Stopping Reimports
> 
> mpy
> Hello, 
> 
> I'd like to know if there is some elegant way to deal with 
> the [notice] mod_python: (Re)importing module 'index' with 
> path set to [...]
> 
> The mod_python.apache importing mechanism works correctly, 
> the problem is, it keeps reimporting the same files.
> 
> I don't think reimporting is the best solution for modules 
> with same names but in different directories.
> 
> It degrades performance with unneeded imports. 
> 
> Then,
> I try to use mod_python's sideeffect of not discarding 
> variables when importing already loaded modules to cache 
> frequently used data (If the module doesn't get reimported 
> all the time, it's variables keep their values between 
> subsequent requests). 
> Every reimport causes the cached data to be reloaded.
> 
> Also, it pollutes error_log :)
> 
> My current "solution" is ugly, that's why I post here, maybe 
> somebody will come up with something better.
> The idea is - if i have to load a module "my_module", which 
> is at /path/to/my_files, don't load it as my_module, but as 
> path_to_my_files_my_module That way, modules with same names 
> will be assigned different names in sys.modules and won't get 
> reloaded all the time.
> 
> It's as using
> from path.to.my.files imort my_module as 
> path_to_my_files_my_module instead of from path.to.my.files 
> imort my_module
> 
> Modules loaded with import_module are usually used by 
> pointers, not by symbolic names so, as for me, it's ok to 
> load it with a different name.
> 
> my mod_python/apache.py import_module() now looks like this:
> 
> def import_module(module_name, autoreload=1, log=0, path=None):
>     """
>     Get the module to handle the request. If
>     autoreload is on, then the module will be reloaded
>     if it has changed since the last import.
>     """
>     
>     parts = module_name.split('.')    
>     if path:
>       path2 = 
> '_'.join(path).replace('/','_').replace('.','_').replace('-','
> _')[1:] + '_'
>       mn = path2 + module_name
>     else:
>       mn = module_name
> 
>     # (Re)import
>     import sys
>     if sys.modules.has_key(mn):
>         module = sys.modules[mn]
>     else:
>         
>         _apache.log_error('Has to load: '+str(mn)+ 
> '('+str(module_name)+')', APLOG_NOERRNO|APLOG_NOTICE)
>        
>         for i in range(len(parts)):
>             mname = ".".join(parts[:i+1])
>             f, p, d = imp.find_module(parts[i], path)
>             try:
>                 _apache.log_error('Loading: '+mname, 
> APLOG_NOERRNO|APLOG_NOTICE)
>                 module = imp.load_module(mname, f, p, d)
>         
>             finally:
>                 if f: f.close()
>             if hasattr(module, "__path__"):
>                 path = module.__path__
> 
>         # dark magic
>         if mn:
>           if mn != mname:
>             t = sys.modules.keys()
>             t.sort()
>             _apache.log_error('Current load: '+str(t), 
> APLOG_NOERRNO|APLOG_NOTICE)
>             _apache.log_error('Switching: '+mname+' <-> '+mn, 
> APLOG_NOERRNO|APLOG_NOTICE)
>             sys.modules[mn] = sys.modules[mname]
>             del(sys.modules[mname])
>   
>             t = sys.modules.keys()
>             t.sort()
>             _apache.log_error('After switch: '+str(t), 
> APLOG_NOERRNO|APLOG_NOTICE)
> 
>     return module
> 
> --------------------------------------------------------------
> -----------------
> http://www.one.lv - Tavs mobilais e-pasts!
> 
> Tagad lasi savu e-pastu ar mobilo telefonu - wap.one.lv!
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


From grisha at modpython.org  Tue Aug 10 11:27:17 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Aug 10 10:27:21 2004
Subject: [mod_python] Stopping Reimports
In-Reply-To: <529860.1092138421114.JavaMail.root@mail1.one.lv>
References: <529860.1092138421114.JavaMail.root@mail1.one.lv>
Message-ID: <20040810102617.T70193@onyx.ispol.com>


The solution is to not have PythonDebug enabled - or do you need that for 
some reason?

Grisha

On Tue, 10 Aug 2004, Cu _ wrote:

> mpy
> Hello,
>
> I'd like to know if there is some elegant way to deal with the
> [notice] mod_python: (Re)importing module 'index' with path set to [...]
>
> The mod_python.apache importing mechanism works correctly, the problem is,
> it keeps reimporting the same files.
>
> I don't think reimporting is the best solution for modules with same names but in different directories.
>
> It degrades performance with unneeded imports.
>
> Then,
> I try to use mod_python's sideeffect of not discarding variables when importing already
> loaded modules to cache frequently used data (If the module doesn't get reimported all the time, it's variables keep their values between subsequent requests).
> Every reimport causes the cached data to be reloaded.
>
> Also, it pollutes error_log :)
>
> My current "solution" is ugly, that's why I post here, maybe somebody will come up with something
> better.
> The idea is - if i have to load a module "my_module", which is at /path/to/my_files,
> don't load it as my_module, but as path_to_my_files_my_module
> That way, modules with same names will be assigned different names in sys.modules and won't
> get reloaded all the time.
>
> It's as using
> from path.to.my.files imort my_module as path_to_my_files_my_module
> instead of
> from path.to.my.files imort my_module
>
> Modules loaded with import_module are usually used by pointers, not by symbolic names so, as for
> me, it's ok to load it with a different name.
>
> my mod_python/apache.py import_module() now looks like this:
>
> def import_module(module_name, autoreload=1, log=0, path=None):
>    """
>    Get the module to handle the request. If
>    autoreload is on, then the module will be reloaded
>    if it has changed since the last import.
>    """
>
>    parts = module_name.split('.')
>    if path:
>      path2 = '_'.join(path).replace('/','_').replace('.','_').replace('-','_')[1:] + '_'
>      mn = path2 + module_name
>    else:
>      mn = module_name
>
>    # (Re)import
>    import sys
>    if sys.modules.has_key(mn):
>        module = sys.modules[mn]
>    else:
>
>        _apache.log_error('Has to load: '+str(mn)+ '('+str(module_name)+')', APLOG_NOERRNO|APLOG_NOTICE)
>
>        for i in range(len(parts)):
>            mname = ".".join(parts[:i+1])
>            f, p, d = imp.find_module(parts[i], path)
>            try:
>                _apache.log_error('Loading: '+mname, APLOG_NOERRNO|APLOG_NOTICE)
>                module = imp.load_module(mname, f, p, d)
>
>            finally:
>                if f: f.close()
>            if hasattr(module, "__path__"):
>                path = module.__path__
>
>        # dark magic
>        if mn:
>          if mn != mname:
>            t = sys.modules.keys()
>            t.sort()
>            _apache.log_error('Current load: '+str(t), APLOG_NOERRNO|APLOG_NOTICE)
>            _apache.log_error('Switching: '+mname+' <-> '+mn, APLOG_NOERRNO|APLOG_NOTICE)
>            sys.modules[mn] = sys.modules[mname]
>            del(sys.modules[mname])
>
>            t = sys.modules.keys()
>            t.sort()
>            _apache.log_error('After switch: '+str(t), APLOG_NOERRNO|APLOG_NOTICE)
>
>    return module
>
> -------------------------------------------------------------------------------
> http://www.one.lv - Tavs mobilais e-pasts!
>
> Tagad lasi savu e-pastu ar mobilo telefonu - wap.one.lv!
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From John.Ertl at fnmoc.navy.mil  Tue Aug 10 11:02:48 2004
From: John.Ertl at fnmoc.navy.mil (Ertl, John)
Date: Tue Aug 10 12:55:10 2004
Subject: [mod_python] More Mod_python Doc-style help
Message-ID: <E338ADD616B66043824B9ABF5CA6EF2332C2AD@lanexc107p.fnmoc.navy.mil>

All,

I had to take a break from mod_python, but now I am back at trying to make a
DOC-style web service.  I am using ZSI but that is just because I am using
it for an RPC style web service (without mod_python), but I am open to other
suggestions.

 With the help of a few of you (especially Conrad S., thanks) I was able to
get a hold of an entire SOAP message sent from an RPC client but the parsing
did not go as planned.  I am also not sure how to send back my XML message.
Does anyone have a simple doc-style client and server that I could use as an
example?   Could  the RPC client is causing problems for the doc-style
Server?  

I am ,as you may have guessed, not a web services expert (barely a novice)
so the simpler the better.  I think one that just returns the same XML would
be enough to show me the working. 

Thanks,

John Ertl 


From grahamd at dscpl.com.au  Tue Aug 10 20:28:29 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Aug 10 21:28:31 2004
Subject: [mod_python] Stopping Reimports
In-Reply-To: <200408101328.i7ADRxIF028389@modpython.org>
Message-ID: <1092187706.13369@dscpl.com.au>

What concerns me about mod_python (2.X, not sure about 3.X, haven't looked)
and also mpservlets as well, is that the code to look to see if a module should
be reloaded is of the form:

  if not klass or mtime > cached_mtime:

Ie., reload the file if the file is newer.

To my mind this is possibly wrong as it doesn't cater for the case where you
might replace a file with an older version after you worked out the newer
one didn't work and what you put back has a modification time in the past,
not the future.

For example:

  cp myservlet.py myservlet.py.backup

  # edit myservlet.py
  # exercise myservlet
  # find it loads and runs, but not desired result

  mv myservlet.py.backup myservlet.py

The myservlet.py file now has a mtime older than the modified one you briefly
ran so it will not reload automatically. You are forced to touch the file to update
its mtime.

You can also have problems when files are stored on NFS mounted directories
and the two machines aren't time synced very well and changes are made on the
NFS server.

I would thus have though saying:

  if not klass or mtime != cached_mtime:

would be more appropriate. Ie., if the mtime is different to cached mtime and not
just newer.

Comments?


On Aug 10 15:27, "Nicolas Lehuen" <nicolas@lehuen.com> wrote:
>
> Subject: RE: [mod_python] Stopping Reimports
>
> Hi,
> 
> I don't think your solution is so ugly... A few weeks ago I wrote about a
> similar problem on this list, though my solution was to alter publisher.py
> to change the way it builds module names (publisher.py version 1.36, line 67
> in mod_python 3.1.3)... Or, as Daniel Popowich wrote, you could use
> mod_servlet (http://home.comcast.net/~d.popowich/mpservlets/) which does
> correctly load modules.
> 
> Note that you were in fact quite lucky to experience reimports, since some
> people (including me, running mp 3.1.3 on Apache2 multithreaded on Windows)
> experience a much worse behaviour : no reimport at all, e.g. /foo/index.py
> would return the same page as /bar/index.py if /bar/index.py was touched
> after /foo/index.py !
> 
> Regards,
> 
> Nicolas Lehuen
> 
> > -----Message d'origine-----
> > De : mod_python-bounces@modpython.org 
> > [mailto:mod_python-bounces@modpython.org] De la part de Cu _
> > Envoy : mardi 10 aot 2004 13:47
> >  : mod_python@modpython.org
> > Objet : [mod_python] Stopping Reimports
> > 
> > mpy
> > Hello, 
> > 
> > I'd like to know if there is some elegant way to deal with 
> > the [notice] mod_python: (Re)importing module 'index' with 
> > path set to [...]
> > 
> > The mod_python.apache importing mechanism works correctly, 
> > the problem is, it keeps reimporting the same files.
> > 
> > I don't think reimporting is the best solution for modules 
> > with same names but in different directories.
> > 
> > It degrades performance with unneeded imports. 
> > 
> > Then,
> > I try to use mod_python's sideeffect of not discarding 
> > variables when importing already loaded modules to cache 
> > frequently used data (If the module doesn't get reimported 
> > all the time, it's variables keep their values between 
> > subsequent requests). 
> > Every reimport causes the cached data to be reloaded.
> > 
> > Also, it pollutes error_log :)
> > 
> > My current "solution" is ugly, that's why I post here, maybe 
> > somebody will come up with something better.
> > The idea is - if i have to load a module "my_module", which 
> > is at /path/to/my_files, don't load it as my_module, but as 
> > path_to_my_files_my_module That way, modules with same names 
> > will be assigned different names in sys.modules and won't get 
> > reloaded all the time.
> > 
> > It's as using
> > from path.to.my.files imort my_module as 
> > path_to_my_files_my_module instead of from path.to.my.files 
> > imort my_module
> > 
> > Modules loaded with import_module are usually used by 
> > pointers, not by symbolic names so, as for me, it's ok to 
> > load it with a different name.
> > 
> > my mod_python/apache.py import_module() now looks like this:
> > 
> > def import_module(module_name, autoreload=1, log=0, path=None):
> > .......

--
Graham Dumpleton (grahamd@dscpl.com.au)
From brian.bird at securetrading.com  Wed Aug 11 11:44:39 2004
From: brian.bird at securetrading.com (Brian Bird)
Date: Wed Aug 11 05:44:42 2004
Subject: [mod_python] Session.py and "secret" parameter. Is it secure?
Message-ID: <00a601c47f87$d2422800$190b030a@Menai.local>

I'm implementing a session-based login system using mod_python. I decided to
use SignedCookie because the cookie will contain the login name of the
authenticated user and I therefore need to ensure the cookie has not been
tampered with on the client (If there's a better way to do this kind of
thing could someone point me in the right direction?).

If I create a session using the following command: 
s=Session.DbmSession(self.req, secret="mysecret") 

then the session will be created using SignedCookie. If on a subsequent
request I perform the same command I get back the same session. Everything
is fine so far.

However, if I change the value of "mysecret" I thought I would get an error
(since this is equivalent to someone tampering with the signed cookie isn't
it?). The command works though. 

I see from looking at Session.py that a SignedCookie is created (line 111 in
Session.py), but it's type is not checked (the documentation says you should
check the type to ensure it is SignedCookie not Cookie, otherwise the
signature verification has failed). The variable "cookies" normally contains
a SignedCookie object, but when I change "mysecret" it contains a Cookie
object.

Does this mean that the cookie signature is not being verified correctly if
using Session.py or am I missing something? 

Why does SignedCookie return an instance of Cookie if the signature
verification fails rather than raising an Exception?

Thanks, 
Brian 



From waterthrill at yahoo.no  Wed Aug 11 14:31:37 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Wed Aug 11 07:27:29 2004
Subject: [mod_python] global data in psp_/python.
Message-ID: <411A0399.5050104@yahoo.no>

Hi.

I am having a intricate problem....
I am using psp, and my configuration is right...

I am using two frames, an upper frame and one lower frame.
I will describe a simple example:

-----------------------------------------------------------------------------
quasi-code:

upper_frame:
1. form, input="textfield" name=data, should be a number.
2. input="submit"


lower_frame:
1. initialize NUMBER=0 if NUMBER is not initialised
2. req.write("%s = %s + %s" %(NUMBER+upper_frame.data, NUMBER, 
upper_frame.data))
3. set NUMBER = NUMBER+upper_frame.data to be used next time

example of usage:
1. number in textfield in  upper_frame = 10, and click submit
2. lower_frame will receive and add NUMBER and upper_frame.data (which 
is received from POST). The number 10 is the answer.
3. New value of NUMBER is stored.
4. number in textfield in  upper_frame = 15, and click submit
5. lower_frame will receive and add NUMBER and upper_frame.data (which 
is received from POST).
6. NUMBER = 10 fram the last addition, and NUMBER+upper_frame.data = 25
7. set NUMBER = NUMBER+upper_frame.data to be used next time.

----------------------------------------------------------------

My question is how can I implement the lower_frame?
I mean; How can I handle the NUMBER-variable?
Is it possible, at all?


Cheers,

Ole J.



From dpopowich at comcast.net  Wed Aug 11 12:42:56 2004
From: dpopowich at comcast.net (Daniel Popowich)
Date: Wed Aug 11 11:43:35 2004
Subject: [mod_python] Stopping Reimports
In-Reply-To: <1092187706.13369@dscpl.com.au>
References: <200408101328.i7ADRxIF028389@modpython.org>
	<1092187706.13369@dscpl.com.au>
Message-ID: <16666.16000.287285.688104@fenway.local.>


> I would thus have though saying:
> 
>   if not klass or mtime != cached_mtime:
> 
> would be more appropriate. Ie., if the mtime is different to cached
> mtime and not just newer.

Hmmmm.  Thought provoking.  Of course, what's really behind any logic
like this is "has the code changed since last it was cached?"  The
modification time is the canonical way to check because looking up
inode attributes is much faster than any other method and is "good
enough" (yes, the mod time could change without any of the content
actually changing, like via touch, but we're willing to accept that
because any other method of checking would be just as expensive, if
not more so, than exec'ing the source).

While I don't have a problem with changing this in mpservlets I have
this nagging feeling there's a good reason for keeping looking for
future modification times as opposed to any modification time.
However, non leap to mind.  Can anyone think of any reason not to go
for this change?

Daniel Popowich
-----------------------------------------------
http://home.comcast.net/~d.popowich/mpservlets/

From hoxide_dirac at yahoo.com.cn  Thu Aug 12 01:22:01 2004
From: hoxide_dirac at yahoo.com.cn (hoxide)
Date: Wed Aug 11 12:34:13 2004
Subject: [mod_python] How could i use FieldStorage class,
	is there any example?
Message-ID: <200408111634.i7BGYBIF022363@modpython.org>

I'm trying to access the form data with FieldStorage class, but after I submited the form,
it didn't get any data.

in the html:
<form  enctype="multipart/form-data" name="form1" id="form1" method="POST" action="/bin/admin/addimg">
    <input type="text" name="tb"  id= "tb"/>
    <textarea name="textarea">jjkjkjijkj</textarea>
    <input type="file" name="file" />
    <input type="submit" name="submit" value="submit" />
</form>

in the python source:

def addimg(req):
    field = util.FieldStorage(req,1,1)
    req.write(dir(field).__str__())
    req.write(repr(field.list))
    for f in field.list:
        req.write(str(f))
    return

the apache config:
<VirtualHost *:8088>
    ServerAdmin webmaster@yey_python.com
    DocumentRoot "h:/webroot/yey_python"
    ServerName www.yey_python.edu
    ErrorLog logs/dummy-host.example.com-error_log
    CustomLog logs/dummy-host.example.com-access_log common
    AddDefaultCharset gb2312
</VirtualHost>
<Directory "H:/webroot/yey_python/bin">
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonAutoReload On
    PythonDebug On
    PythonPath "sys.path+['H:/webroot/yey_python/bin']"

    AllowOverride None
    Order allow,deny
    Allow from all
    DefaultType text/html
</Directory>


PS:I'm chinese, and sory for you with my poor English.

hoxide
hoxide_dirac@yahoo.com.cn
2004-08-12

From hoxide_dirac at yahoo.com.cn  Thu Aug 12 02:13:46 2004
From: hoxide_dirac at yahoo.com.cn (hoxide)
Date: Wed Aug 11 13:26:14 2004
Subject: [mod_python] How could i use FieldStorage class,
	is there any example?
Message-ID: <200408111726.i7BHQCIF014898@modpython.org>

hoxide,

	The problem was sloved.  It needn't use FieldStorage.  Publisher Handler was parsed form data before calling the method, so FieldStorage would never got the data.


======= 2004-08-12 00:22:01 =======

>I'm trying to access the form data with FieldStorage class, but after I submited the form,
>it didn't get any data.
>
>in the html:
><form  enctype="multipart/form-data" name="form1" id="form1" method="POST" action="/bin/admin/addimg">
>    <input type="text" name="tb"  id= "tb"/>
>    <textarea name="textarea">jjkjkjijkj</textarea>
>    <input type="file" name="file" />
>    <input type="submit" name="submit" value="submit" />
></form>
>
>in the python source:
>
>def addimg(req):
>    field = util.FieldStorage(req,1,1)
>    req.write(dir(field).__str__())
>    req.write(repr(field.list))
>    for f in field.list:
>        req.write(str(f))
>    return
>
>the apache config:
><VirtualHost *:8088>
>    ServerAdmin webmaster@yey_python.com
>    DocumentRoot "h:/webroot/yey_python"
>    ServerName www.yey_python.edu
>    ErrorLog logs/dummy-host.example.com-error_log
>    CustomLog logs/dummy-host.example.com-access_log common
>    AddDefaultCharset gb2312
></VirtualHost>
><Directory "H:/webroot/yey_python/bin">
>    SetHandler mod_python
>    PythonHandler mod_python.publisher
>    PythonAutoReload On
>    PythonDebug On
>    PythonPath "sys.path+['H:/webroot/yey_python/bin']"
>
>    AllowOverride None
>    Order allow,deny
>    Allow from all
>    DefaultType text/html
></Directory>
>
>
>PS:I'm chinese, and sory for you with my poor English.
>
>hoxide
>hoxide_dirac@yahoo.com.cn
>2004-08-12
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

= = = = = = = = = = = = = = = = = = = =
			



 
				 
hoxide
hoxide_dirac@yahoo.com.cn
2004-08-12


From waterthrill at yahoo.no  Wed Aug 11 21:15:23 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Wed Aug 11 14:54:18 2004
Subject: [mod_python] global data in psp_/python.
In-Reply-To: <411A0399.5050104@yahoo.no>
References: <411A0399.5050104@yahoo.no>
Message-ID: <411A623B.5070705@yahoo.no>

Hi.

Is it possible to use Cookies to "simulate" real global data, as you
find in extern C?
I know static global data's is not a good solution to my problem, though....

If I had implemented an application in C++, I would have used singleton
pattern, and so on, but Python is not C++, I'm afraid.

Any suggestions to my problem?

Thanx in advance for helping me out.

Cheers,

Ole J.


Ole Jacob Hagen wrote:

> Hi.
>
> I am having a intricate problem....
> I am using psp, and my configuration is right...
>
> I am using two frames, an upper frame and one lower frame.
> I will describe a simple example:
>
> ----------------------------------------------------------------------------- 
>
> quasi-code:
>
> upper_frame:
> 1. form, input="textfield" name=data, should be a number.
> 2. input="submit"
>
>
> lower_frame:
> 1. initialize NUMBER=0 if NUMBER is not initialised
> 2. req.write("%s = %s + %s" %(NUMBER+upper_frame.data, NUMBER, 
> upper_frame.data))
> 3. set NUMBER = NUMBER+upper_frame.data to be used next time
>
> example of usage:
> 1. number in textfield in  upper_frame = 10, and click submit
> 2. lower_frame will receive and add NUMBER and upper_frame.data (which 
> is received from POST). The number 10 is the answer.
> 3. New value of NUMBER is stored.
> 4. number in textfield in  upper_frame = 15, and click submit
> 5. lower_frame will receive and add NUMBER and upper_frame.data (which 
> is received from POST).
> 6. NUMBER = 10 fram the last addition, and NUMBER+upper_frame.data = 25
> 7. set NUMBER = NUMBER+upper_frame.data to be used next time.
>
> ----------------------------------------------------------------
>
> My question is how can I implement the lower_frame?
> I mean; How can I handle the NUMBER-variable?
> Is it possible, at all?
>
>
> Cheers,
>
> Ole J.
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From waterthrill at yahoo.no  Thu Aug 12 02:11:34 2004
From: waterthrill at yahoo.no (Ole Jacob Hagen)
Date: Wed Aug 11 19:50:31 2004
Subject: [mod_python] maximum size of Cookies and Session
In-Reply-To: <411A623B.5070705@yahoo.no>
References: <411A0399.5050104@yahoo.no> <411A623B.5070705@yahoo.no>
Message-ID: <411AA7A6.7020608@yahoo.no>

Hi,

I've decided to use Session for managing data, which are going to be 
"global" in some extent.
The data that are stored in Session is only strings.

How large can the cookies and Session be in bytes, is it pr. 
cookies/Session or total size?

Cheers,

Ole J.
 
From amix at amix.dk  Thu Aug 12 15:13:01 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Thu Aug 12 08:13:07 2004
Subject: [mod_python] The right way to handle sessions
Message-ID: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>

Hello.
I welcome myself to this list ;-)

I have a question about how to handle sessions correctly.
I am creating a simple login system (just messing around with 
mod_python).
Let's say that we have a page called index.py and we are using the 
publisher handler.

Example one:
def createSession(req):
     new_session = Session.Session(req)
     return new_session.id()

def getSameSession(req):
     same_session = Session.Session(req)
     return same_session.id()

This works ok! They have the same sid. I.e. you first call 
index.py/createSession and then  index.py/getSameSession


Example two:
def createSession(req):
     new_session = Session.Session(req)
     return getSameSession(req)

def getSameSession(req):
     same_session = Session.Session(req)
     return same_session.id()

This does not work - it makes an infinitive loop..!  Now to fix this 
you need to unlock the session in createSession (.. I have no clue why 
you have to do this..?). And then you need to restart apache...  i.e.:
def createSession(req):
     new_session = Session.Session(req)
     new_session.unlock()
     return getSameSession(req)

But this does not work quite well.. If you delete the Session:
def deleteSession(req):
     same_session = Session.Session(req)
     same_session.invalidate()
     return "Deleted"

And then you do this:
def createSession(req):
     new_session = Session.Session(req)
     new_session.save()
     new_session.unlock()

     req.write(new_session.id())
     return getSameSession(req)

def getSameSession(req):
     same_session = Session.Session(req)

     return "\n%s" % same_session.id()

First time the id's aren't same - after that they are the same.


Now, I could solve this by doing internal redirects i.e. instead of 
calling "return getSameSession" I could go util.redirect... But that 
isn't smart...

I could also store some variables in the request object. I.e. 
req.login["Logged_in"] = True. i.e.:
createSession:
- Create session
- Create req.login["Logged_in"]

getSameSession:
- Check if  req.login["Logged_in"] is set.
- If  req.login["Logged_in"] isn't set (we aren't doing an "internal" 
call), then try to load the variables from our session.

But how secure is this? And is there another way to handle this?
I could also store the whole session object in the req  - - but ..  it 
isn't very smart.

And why does it happen (quite often!) that the session handling make 
Apache server spin in an infinitive loop!?

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

From mlists at rotondo.it  Thu Aug 12 15:48:24 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Thu Aug 12 08:45:36 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <411B6718.1040607@rotondo.it>

Amir Salihefendic wrote:
> Hello.
> I welcome myself to this list ;-)
> 
> I have a question about how to handle sessions correctly.
> I am creating a simple login system (just messing around with mod_python).
> Let's say that we have a page called index.py and we are using the 
> publisher handler.

Hi,

try this code: ``req`` is the request object from mod_python.

def get_session ( req ):
	sess = Session.Session  ( req )

	if sess.is_new ():
		sess.save ()
	else:
		sess.load ()

	return sess

Ciao,

   Fabio
From amix at amix.dk  Thu Aug 12 16:17:49 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Thu Aug 12 09:18:00 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <411B6718.1040607@rotondo.it>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
	<411B6718.1040607@rotondo.it>
Message-ID: <0253CEB3-EC62-11D8-A444-000A95B2E4E0@amix.dk>

Hello Fabio

Thanks for your input. But that does not work :-(
Try this:
def createSession(req):
     sess = get_session(req)
     req.write(sess.id())
     return getSameSession(req)

def getSameSession(req):
     sess = get_session(req)
     return "\n%s" % sess.id()

def get_session(req):
	sess = Session.Session(req)
	if sess.is_new():
		sess.save ()
	else:
		sess.load()
	return sess

Try to store this in a file (index.py) and call index.py/createSection
First time you run it the sid's are going to be different...
Second time you run it - - it will make an infinitive loop (or at least 
mess apache up).

The method only works if you call the two functions:
index.py/createSection
and after that you call:
index.py/getSameSection
Then you get the deserved output.

My question is more: How do you work on sessions across functions - - 
by storing data in the request (req) object or what??

Med venlig hilsen / Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

Den 12/8-2004, kl. 14.48, skrev Fabio Rotondo:

> Amir Salihefendic wrote:
>> Hello.
>> I welcome myself to this list ;-)
>> I have a question about how to handle sessions correctly.
>> I am creating a simple login system (just messing around with 
>> mod_python).
>> Let's say that we have a page called index.py and we are using the 
>> publisher handler.
>
> Hi,
>
> try this code: ``req`` is the request object from mod_python.
>
> def get_session ( req ):
> 	sess = Session.Session  ( req )
>
> 	if sess.is_new ():
> 		sess.save ()
> 	else:
> 		sess.load ()
>
> 	return sess
>
> Ciao,
>
>   Fabio
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From gandalf at geochemsource.com  Thu Aug 12 17:45:32 2004
From: gandalf at geochemsource.com (Gandalf)
Date: Thu Aug 12 10:45:34 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <411B828C.6080404@geochemsource.com>



Amir Salihefendic wrote:

>
> This works ok! They have the same sid. I.e. you first call 
> index.py/createSession and then index.py/getSameSession

...

>
> This does not work - it makes an infinitive loop..! Now to fix this 
> you need to unlock the session in createSession (.. I have no clue why 
> you have to do this..?).

Very strange. I use this to create a session:

self.session = session = Session.Session(req)

and this one to save it:

self.session.save()


I never call session.load() but it works fine for me.

Best,

Laci 2.0


From jim-mod-python at jimdabell.com  Thu Aug 12 18:37:17 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Thu Aug 12 12:27:38 2004
Subject: [mod_python] PSP buffer?
Message-ID: <200408121737.17395.jim-mod-python@jimdabell.com>


I'm just getting stuck into mod_python, and I've hit a bit of a snag.  I am 
writing a handler, but would like to use PSP to construct a few pages.  So 
I'm instantiating a PSP object, and using its run() method to execute it.

Unfortunately, that just repeatedly calls req.write(), which doesn't give me 
the opportunity to perform any operations on the result before it is sent to 
the client, or even output additional headers afterwards.  For instance, I 
can't find a way of producing a Content-Length header, or using content 
encoding to gzip the response body.  run() actually calls req.write with 
flush=0, but then explicitly calls flush() afterwards.

For the moment, I'm working around this by passing a proxy object that 
intercepts write() and flush() to the PSP constructor.  This seems like a 
pretty fragile hack to me though, and I was wondering if there was a better 
way of accomplishing what I am after, or plans to make PSP more flexible in 
later releases.

As far as I can tell, my only other options are:

a) Dump PSP
b) Alter psp.py
c) Dump my handler and use the PSP handler.

None of these are particularly attractive options to me.  Does anybody have 
any better suggestions?  Google, the FAQ and the manual didn't turn up 
anything particularly inspiring.

-- 
Jim Dabell

From grisha at modpython.org  Thu Aug 12 14:03:49 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Aug 12 13:04:14 2004
Subject: [mod_python] PSP buffer?
In-Reply-To: <200408121737.17395.jim-mod-python@jimdabell.com>
References: <200408121737.17395.jim-mod-python@jimdabell.com>
Message-ID: <20040812125835.X9676@onyx.ispol.com>


On Thu, 12 Aug 2004, Jim Dabell wrote:
>
> Unfortunately, that just repeatedly calls req.write(), which doesn't give me
> the opportunity to perform any operations on the result before it is sent to
> the client, or even output additional headers afterwards.  For instance, I
> can't find a way of producing a Content-Length header, or using content
> encoding to gzip the response body.

You shouldn't need to set content length because it will be set by Apache 
for you. Apache will decide wither to set it depending on the protocol 
version used and whether the client accepts chunked encoding.

If you want to gzip the response, the proper way to do this in Apache 2.0 
would be by implementing a filter rather than a handler, there is actually 
an example of how to do this in mod_python in the examples directory, 
though you will probably be better off using something like mod_gzip.

Grisha
From sanders at apache.org  Thu Aug 12 11:20:17 2004
From: sanders at apache.org (Scott Sanders)
Date: Thu Aug 12 13:20:16 2004
Subject: [mod_python] PSP buffer?
In-Reply-To: <20040812125835.X9676@onyx.ispol.com>
References: <200408121737.17395.jim-mod-python@jimdabell.com>
	<20040812125835.X9676@onyx.ispol.com>
Message-ID: <E12F83AD-EC83-11D8-9184-000A95D2D288@apache.org>

I have implemented and documented a simple way to do this at:

http://dotnot.org/blog/archives/2004/02/10/provide-gzip-for-my- 
apachephp-based-blog/

Scott

On Aug 12, 2004, at 10:03 AM, Gregory (Grisha) Trubetskoy wrote:

>
> On Thu, 12 Aug 2004, Jim Dabell wrote:
>>
>> Unfortunately, that just repeatedly calls req.write(), which doesn't  
>> give me
>> the opportunity to perform any operations on the result before it is  
>> sent to
>> the client, or even output additional headers afterwards.  For  
>> instance, I
>> can't find a way of producing a Content-Length header, or using  
>> content
>> encoding to gzip the response body.
>
> You shouldn't need to set content length because it will be set by  
> Apache for you. Apache will decide wither to set it depending on the  
> protocol version used and whether the client accepts chunked encoding.
>
> If you want to gzip the response, the proper way to do this in Apache  
> 2.0 would be by implementing a filter rather than a handler, there is  
> actually an example of how to do this in mod_python in the examples  
> directory, though you will probably be better off using something like  
> mod_gzip.
>
> Grisha
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From jim-mod-python at jimdabell.com  Thu Aug 12 20:53:28 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Thu Aug 12 14:43:48 2004
Subject: [mod_python] PSP buffer?
In-Reply-To: <20040812125835.X9676@onyx.ispol.com>
References: <200408121737.17395.jim-mod-python@jimdabell.com>
	<20040812125835.X9676@onyx.ispol.com>
Message-ID: <200408121953.28736.jim-mod-python@jimdabell.com>

On Thursday 12 August 2004 18:03, Gregory (Grisha) Trubetskoy wrote:
> On Thu, 12 Aug 2004, Jim Dabell wrote:
> > Unfortunately, that just repeatedly calls req.write(), which doesn't give
> > me the opportunity to perform any operations on the result before it is
> > sent to the client, or even output additional headers afterwards.  For
> > instance, I can't find a way of producing a Content-Length header, or
> > using content encoding to gzip the response body.
>
> You shouldn't need to set content length because it will be set by Apache
> for you. Apache will decide wither to set it depending on the protocol
> version used and whether the client accepts chunked encoding.

Great!  Is there a description of all the fixups Apache adds anywhere?


> If you want to gzip the response, the proper way to do this in Apache 2.0
> would be by implementing a filter rather than a handler, there is actually
> an example of how to do this in mod_python in the examples directory,
> though you will probably be better off using something like mod_gzip.

Thanks, that's useful to know and I'll probably use that, but Content-Length 
and gzip were just examples.  I was really hoping for a clean way of getting 
the result of a PSP instead of it being automatically sent to the client; I'd 
rather not split my script up if it's not necessary.

I'd use this buffer for such things as:

* Generating an etag header based upon the template result.

* Generating a header that showed how long the template transformation took.

* Running the result through HTML Tidy.

* Converting to XHTML where acceptable.

* Providing a Content-MD5 header.

Sure, all of these things can be hacked around, separated into filters or 
placed into templates, I just don't see the point when an output buffer would 
give a clean way of doing all this in a single handler, and I could leave the 
templates to simply be templates.

-- 
Jim Dabell

From grisha at modpython.org  Thu Aug 12 16:05:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Thu Aug 12 15:05:10 2004
Subject: [mod_python] PSP buffer?
In-Reply-To: <200408121953.28736.jim-mod-python@jimdabell.com>
References: <200408121737.17395.jim-mod-python@jimdabell.com>
	<20040812125835.X9676@onyx.ispol.com>
	<200408121953.28736.jim-mod-python@jimdabell.com>
Message-ID: <20040812150158.C11935@onyx.ispol.com>


On Thu, 12 Aug 2004, Jim Dabell wrote:

> I was really hoping for a clean way of getting the result of a PSP 
> instead of it being automatically sent to the client; I'd rather not 
> split my script up if it's not necessary.
>
> I'd use this buffer for such things as:
>
> * Generating an etag header based upon the template result.
>
> * Generating a header that showed how long the template transformation took.
>
> * Running the result through HTML Tidy.
>
> * Converting to XHTML where acceptable.
>
> * Providing a Content-MD5 header.
>
> Sure, all of these things can be hacked around, separated into filters or
> placed into templates, I just don't see the point when an output buffer would
> give a clean way of doing all this in a single handler, and I could leave the
> templates to simply be templates.

Well - I'm not sure what would be aclean way to make a PSP buffer 
available, short of implementing some sort of a filter hook - but what's 
the point if Apache already has one. But if you get any cool ideas, please 
do share it with the list, this is an interesting point.

Grisha
From courtneyludwin at yahoo.com  Thu Aug 12 13:45:46 2004
From: courtneyludwin at yahoo.com (courtney ludwin)
Date: Thu Aug 12 15:46:04 2004
Subject: [mod_python] Anyone using Cheetah for templating?
Message-ID: <20040812194546.75510.qmail@web14521.mail.yahoo.com>

Hello, 

I wanted to see if anyone was using cheetah
(www.cheetahtemplate.org/) for templating, and if so
what the performance was like. 

The reason I ask is that I have not been able to get
mp+cheetah to perform well together even after
compiling templates.  On my P3-933 w/ 1Gig of ram I
can serve ~10 pages/sec using Cheetah and ~200
pages/sec NOT using Cheetah.  

-- The page I am using for benchmarking manages
sessions and makes a query to MySQL and renders the
results as html.  

I was hoping someone might have some advice...
 
I have been using openload
(http://openload.sourceforge.net/) for benchmarking
and it works pretty well.  

thanks in advance,
Courtney



	
		
__________________________________
Do you Yahoo!?
New and Improved Yahoo! Mail - 100MB free storage!
http://promotions.yahoo.com/new_mail 
From nick at dd.revealed.net  Thu Aug 12 16:22:47 2004
From: nick at dd.revealed.net (Nick)
Date: Thu Aug 12 16:22:58 2004
Subject: [mod_python] Anyone using Cheetah for templating?
In-Reply-To: <20040812194546.75510.qmail@web14521.mail.yahoo.com>
References: <20040812194546.75510.qmail@web14521.mail.yahoo.com>
Message-ID: <411BD197.50609@dd.revealed.net>

courtney ludwin wrote:
> The reason I ask is that I have not been able to get
> mp+cheetah to perform well together even after
> compiling templates.  On my P3-933 w/ 1Gig of ram I
> can serve ~10 pages/sec using Cheetah and ~200
> pages/sec NOT using Cheetah.  

That doesn't sound completely unreasonable for a benchmark figure (i.e. 
constantly hitting the server with simultaneous requests and driving up the 
CPU).  My benchmarks typically don't even do that well, with say 10 clients 
and 0 delay between each request.

Nick
From courtneyludwin at yahoo.com  Thu Aug 12 15:06:38 2004
From: courtneyludwin at yahoo.com (courtney ludwin)
Date: Thu Aug 12 17:06:40 2004
Subject: [mod_python] Anyone using Cheetah for templating?
In-Reply-To: <411BD197.50609@dd.revealed.net>
Message-ID: <20040812210638.46906.qmail@web14524.mail.yahoo.com>

I still think something is not right,
I am able to fill a cheetah template well over 1000
times a second (just wrote a script to test this out),
and I know mod_python is fast so I think that it is
more of a configuration issue... 

Cheetah is fast when filling templates, but slow to
load templates therefore it may be a importing issue,
but I don't see how in my code, I am only importing
the template once:

example handler:
#---------------------------------------------------------
from ads.tmpl.index import index
from common.ui import navigation as nav
from mod_python import apache
                                                      
                         
def handler(req, sesh):
        tmpl = index(searchList=[{
                "sesh": sesh,
                "site_nav":
nav.get_site_nav("adhome"),
                "ad_nav": nav.get_ad_nav("adhome")}])
        return apache.OK, tmpl
#---------------------------------------------------------



--- Nick <nick@dd.revealed.net> wrote:

> courtney ludwin wrote:
> > The reason I ask is that I have not been able to
> get
> > mp+cheetah to perform well together even after
> > compiling templates.  On my P3-933 w/ 1Gig of ram
> I
> > can serve ~10 pages/sec using Cheetah and ~200
> > pages/sec NOT using Cheetah.  
> 
> That doesn't sound completely unreasonable for a
> benchmark figure (i.e. 
> constantly hitting the server with simultaneous
> requests and driving up the 
> CPU).  My benchmarks typically don't even do that
> well, with say 10 clients 
> and 0 delay between each request.
> 
> Nick
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
>
http://mailman.modpython.org/mailman/listinfo/mod_python
> 



		
__________________________________
Do you Yahoo!?
New and Improved Yahoo! Mail - Send 10MB messages!
http://promotions.yahoo.com/new_mail 
From bje at apnic.net  Fri Aug 13 10:17:07 2004
From: bje at apnic.net (Byron Ellacott)
Date: Thu Aug 12 19:16:22 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <411BFA73.3090805@apnic.net>

Amir Salihefendic wrote:
> I welcome myself to this list ;-)

Welcome!

[working example]
> def createSession(req):
> def getSameSession(req):

The important thing to note here is that the code is identical in both 
calls.  That is, if you call Session.Session(req) with no session ID in 
cookies, or the existing session ID has no matching session stored on 
disk, a new session ID is generated.

But, the session is /not/ written to disk.

> def createSession(req):
>     return getSameSession(req)
> def getSameSession(req):
>     return same_session.id()

So when you change to calling getSameSession() from createSession() you 
are in fact creating /two/ sessions.  My guess would be that your 
apparent infinite loop is in fact a deadlock, caused by the fact that 
your second created session will be reusing the session ID created by 
the first one, and then attempting to establish a global lock on that 
session ID.  Bad.

> This does not work - it makes an infinitive loop..!  Now to fix this you 
> need to unlock the session in createSession (.. I have no clue why you 
> have to do this..?). And then you need to restart apache...  i.e.:

This bears up my analysis well.  The locking done by the Session module 
is an Apache-wide lock on the session ID.  So, when createSession() 
first creates a session, it locks that sid.  Then, it calls 
getSameSession() which attempts to lock the same sid.  The lock call 
blocks here, waiting for the first lock to be released, but that release 
will never come.  If you cause the first created session to unlock 
itself, you will not create a deadlock, but you will need to restart 
apache to break an existing deadlock.

> But this does not work quite well.. If you delete the Session:
> And then you do this:
> First time the id's aren't same - after that they are the same.

When a session has been deleted, it is marked as invalid and calling 
.load() on that sid will fail.  .__init__() will create a new sid if 
.load() fails for an existing one, so I suspect you are seeing this 
behaviour.

Overall, it seems you are making the session management process far more 
complicated than it needs to be.  Under what circumstances do you call 
createSession() instead of getSameSession() ?

I am successfully using the Session module to handle an HTML forms based 
login system:

session = Session.Session(req)
if NeedAuth and not session.has_key('username'):
     redirect(AuthPage)
ServePage(req)
session.save()
return apache.OK

This is a simplification, since I use an extensible application object 
that allows you to change how sessions are generated and how users are 
authenticated, but it boils down to the above.  I create a new session 
or get an existing session.  I do not care which.  If the page being 
requested needs auth, but the session doesn't contain a username key, I 
redirect[1] to the login page, which stores the username value into the 
session if the user presents the right credentials.  Otherwise, I serve 
the requested page, then save the session, and Bob's a builder.

Note that I cannot distinguish between an expired session and no session 
at all, but this is a limitation of the Session module.  I can 
distinguish between a new session and an existing session by calling 
session.is_new(), but that distinction turns out not to be very important.

At some point, I will need to extract the sid from the cookie set 
myself, to be able to distinguish between a timed out session, an 
invalidated session, a missing session and a brand new session.  (Or 
else I'll have to patch the Session module, which I'm not real keen to do.)

-- 
bje

[1] The 'redirects' I do are simply changing what view my code believes 
it is processing, so execution continues down the line, and 
session.save() is called in due order.  If you're using an Apache 
internal redirect or a 302/303 redirect, you should ensure new sessions 
are saved as soon as created with "if session.is_new(): session.save()".
From stian at soiland.no  Fri Aug 13 03:28:18 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Thu Aug 12 20:28:22 2004
Subject: [mod_python] Re: Anyone using Cheetah for templating?
In-Reply-To: <20040812210638.46906.qmail@web14524.mail.yahoo.com>
References: <411BD197.50609@dd.revealed.net>
	<20040812210638.46906.qmail@web14524.mail.yahoo.com>
Message-ID: <20040813002818.GE3256@itea.ntnu.no>

On 2004-08-12 23:06:38, courtney ludwin wrote:

> I still think something is not right,
> I am able to fill a cheetah template well over 1000
> times a second (just wrote a script to test this out),
> and I know mod_python is fast so I think that it is
> more of a configuration issue... 
> 
> Cheetah is fast when filling templates, but slow to
> load templates therefore it may be a importing issue,
> but I don't see how in my code, I am only importing
> the template once:

Maybe you've forgot to turn off Auto reload of modules. Check out:

 http://www.modpython.org/live/current/doc-html/dir-other-par.html


(btw, we're using Cheetah too, but we haven't done any deployment or
benchmarking yet, so I can't comment on your numbers. 
(The cheetah syntax sucks, the block overloading is nice.)

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]
                            Og dette er en ekstra linje 

From jgentil at sebistar.net  Fri Aug 13 02:13:32 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Fri Aug 13 02:13:37 2004
Subject: [mod_python] Session.py and "secret" parameter. Is it secure?
In-Reply-To: <00a601c47f87$d2422800$190b030a@Menai.local>
References: <00a601c47f87$d2422800$190b030a@Menai.local>
Message-ID: <411C5C0C.1000908@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Brian Bird wrote:
> I'm implementing a session-based login system using mod_python. I
decided to
> use SignedCookie because the cookie will contain the login name of the
> authenticated user and I therefore need to ensure the cookie has not been
> tampered with on the client (If there's a better way to do this kind of
> thing could someone point me in the right direction?).

I don't know a solution to your problem, but the only thing I use the
cookie for is to hold the session ID.  Everything else is in the
session, including their login username.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkEcXAwACgkQOrVFmaIbww5JewCgmtHIYVPf9FCzj6SxMtRTbPMA
SN4An1OsbYdWx1s8jPndKcijgXJq8t1x
=SELg
-----END PGP SIGNATURE-----
From brian.bird at securetrading.com  Fri Aug 13 10:05:48 2004
From: brian.bird at securetrading.com (Brian Bird)
Date: Fri Aug 13 04:05:54 2004
Subject: [mod_python] PSP buffer?
In-Reply-To: <200408121953.28736.jim-mod-python@jimdabell.com>
Message-ID: <026e01c4810c$57928fb0$190b030a@Menai.local>

> Sure, all of these things can be hacked around, separated into filters or 
> placed into templates, I just don't see the point when an output buffer
would 
> give a clean way of doing all this in a single handler, and I could leave
the 
> templates to simply be templates.

I ended up using Cheetah (http://www.cheetahtemplate.org/) instead of PSP
for the same reason. I'm using my own handlers and a Cheetah template and so
far it feels a lot simpler than using PSP. I'm sure this is partly due to
PSP being very new though.

Brian


From yrbahn at nhncorp.jp  Fri Aug 13 19:38:43 2004
From: yrbahn at nhncorp.jp (=?ks_c_5601-1987?B?ud2/tbfP?=)
Date: Fri Aug 13 05:29:41 2004
Subject: [mod_python] Dispatch() returned nothing???
Message-ID: <088801c48119$530b1fe0$079610ac@nhnbsftp2lxzwu>

i am using mod_python 3.1.3.
Sometimes, "Dispatch() returned nothing" appers in apache error logs.
what is the problem?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040813/7f51eb07/attachment.html
From amix at amix.dk  Fri Aug 13 14:30:23 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Fri Aug 13 07:30:30 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <411BFA73.3090805@apnic.net>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
	<411BFA73.3090805@apnic.net>
Message-ID: <2AB88DEA-ED1C-11D8-A444-000A95B2E4E0@amix.dk>

Thanks a lot for your time spent on the reply, I appreciate it.

"Under what circumstances do you call createSession() instead of 
getSameSession()?"

Let's take another example:
I am making a blog-system where I need to have an admin section. I am 
using the publisher handler.
Simple forms post username and password to admin.py
Admin.py has an index function, which has username and password as 
input.
In the index function I check if the username and password match, if 
they do I create an session and store username and password.
Now, I need to redirect to a new function viewPosts (it's also located 
in the admin module).

In viewPosts I have to check if the right session is set - else 
somebody could do admin.py/viewPosts and get access to the admin 
section.

Of course, I could solve problem in many other ways:
- Send the SID to viewPosts
- Place everything in one function (i.e. place everything in 
admin.py/index)
- "Append" the session to the req object
- Make viewPosts private (i.e. do _viewPosts) and then I can only 
access it by going through admin.py/index
-etc.

Anyway, I am interested in knowing: What is the smartest way to 
"share"/access same session across functions (i.e. when you are 
internal "redirecting")? Example of what I mean by "redirecting" (not 
working...):
def createSession(req):
     new_session = Session.Session(req)
     return getSameSession(req)

def getSameSession(req):
     same_session = Session.Session(req)
     return same_session.id()


My guess is to send the SID (working). This seems to be a very light 
and easy approach:
def createSession(req):
     new_session = Session.Session(req)
     new_session.unlock()

     #Check id
     req.write(new_session.id())

     return getSameSession(req, new_session.id())

def getSameSession(req, SID):
     same_session = Session.Session(req, SID)

     #Check id
     req.write("\n%s\n" % same_session.id())

     return "Done"

(This is a solution I use now.) Of course this is very simplified 
example...

Med venlig hilsen / Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity
Den 13/8-2004, kl. 1.17, skrev Byron Ellacott:

> Amir Salihefendic wrote:
>> I welcome myself to this list ;-)
>
> Welcome!
>
> [working example]
>> def createSession(req):
>> def getSameSession(req):
>
> The important thing to note here is that the code is identical in both 
> calls.  That is, if you call Session.Session(req) with no session ID 
> in cookies, or the existing session ID has no matching session stored 
> on disk, a new session ID is generated.
>
> But, the session is /not/ written to disk.
>
>> def createSession(req):
>>     return getSameSession(req)
>> def getSameSession(req):
>>     return same_session.id()
>
> So when you change to calling getSameSession() from createSession() 
> you are in fact creating /two/ sessions.  My guess would be that your 
> apparent infinite loop is in fact a deadlock, caused by the fact that 
> your second created session will be reusing the session ID created by 
> the first one, and then attempting to establish a global lock on that 
> session ID.  Bad.
>
>> This does not work - it makes an infinitive loop..!  Now to fix this 
>> you need to unlock the session in createSession (.. I have no clue 
>> why you have to do this..?). And then you need to restart apache...  
>> i.e.:
>
> This bears up my analysis well.  The locking done by the Session 
> module is an Apache-wide lock on the session ID.  So, when 
> createSession() first creates a session, it locks that sid.  Then, it 
> calls getSameSession() which attempts to lock the same sid.  The lock 
> call blocks here, waiting for the first lock to be released, but that 
> release will never come.  If you cause the first created session to 
> unlock itself, you will not create a deadlock, but you will need to 
> restart apache to break an existing deadlock.
>
>> But this does not work quite well.. If you delete the Session:
>> And then you do this:
>> First time the id's aren't same - after that they are the same.
>
> When a session has been deleted, it is marked as invalid and calling 
> .load() on that sid will fail.  .__init__() will create a new sid if 
> .load() fails for an existing one, so I suspect you are seeing this 
> behaviour.
>
> Overall, it seems you are making the session management process far 
> more complicated than it needs to be.  Under what circumstances do you 
> call createSession() instead of getSameSession() ?
>
> I am successfully using the Session module to handle an HTML forms 
> based login system:
>
> session = Session.Session(req)
> if NeedAuth and not session.has_key('username'):
>     redirect(AuthPage)
> ServePage(req)
> session.save()
> return apache.OK
>
> This is a simplification, since I use an extensible application object 
> that allows you to change how sessions are generated and how users are 
> authenticated, but it boils down to the above.  I create a new session 
> or get an existing session.  I do not care which.  If the page being 
> requested needs auth, but the session doesn't contain a username key, 
> I redirect[1] to the login page, which stores the username value into 
> the session if the user presents the right credentials.  Otherwise, I 
> serve the requested page, then save the session, and Bob's a builder.
>
> Note that I cannot distinguish between an expired session and no 
> session at all, but this is a limitation of the Session module.  I can 
> distinguish between a new session and an existing session by calling 
> session.is_new(), but that distinction turns out not to be very 
> important.
>
> At some point, I will need to extract the sid from the cookie set 
> myself, to be able to distinguish between a timed out session, an 
> invalidated session, a missing session and a brand new session.  (Or 
> else I'll have to patch the Session module, which I'm not real keen to 
> do.)
>
> -- 
> bje
>
> [1] The 'redirects' I do are simply changing what view my code 
> believes it is processing, so execution continues down the line, and 
> session.save() is called in due order.  If you're using an Apache 
> internal redirect or a 302/303 redirect, you should ensure new 
> sessions are saved as soon as created with "if session.is_new(): 
> session.save()".
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From ccurvey at earthlink.net  Fri Aug 13 10:27:20 2004
From: ccurvey at earthlink.net (Chris Curvey)
Date: Fri Aug 13 09:19:48 2004
Subject: [mod_python] mod_python servlet failing on non-existent code
Message-ID: <411CC1B8.4030409@earthlink.net>

Hi all,

I'm hacking my way through a proof-of-concept with mod_python servlets, 
and I'm coming across something strange.  When I hit my page, I'm 
getting an error message returned in a browser ("unpack tuple of wrong 
size").   The strange part is that the line listed in the browser 
doesn't exist in my code anymore.  (I changed that line as part of the 
debugging process.)

So I figured that maybe I was having a problem with mod_python caching 
classes, and I restarted apache just as "httpd -X".  I hit the page 
again, and the same error message shows up in the browser, but the HTML 
that I want shows up in the window where I started httpd.

Can anyone point me in the right direction?

-Chris

From grisha at modpython.org  Fri Aug 13 11:08:18 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Aug 13 10:08:51 2004
Subject: [mod_python] mod_python servlet failing on non-existent code
In-Reply-To: <411CC1B8.4030409@earthlink.net>
References: <411CC1B8.4030409@earthlink.net>
Message-ID: <20040813100635.D27666@onyx.ispol.com>



On Fri, 13 Aug 2004, Chris Curvey wrote:

> I'm hacking my way through a proof-of-concept with mod_python servlets, and 
> I'm coming across something strange.  When I hit my page, I'm getting an 
> error message returned in a browser ("unpack tuple of wrong size").   The 
> strange part is that the line listed in the browser doesn't exist in my code 
> anymore.  (I changed that line as part of the debugging process.)

This is not unusual - Python caches locations of lines so when a module is 
reloaded oftentimes the traceback will refer to the source code as it was 
in the original file. The only way to get around this is to restart the 
server.

> So I figured that maybe I was having a problem with mod_python caching 
> classes, and I restarted apache just as "httpd -X".  I hit the page again, 
> and the same error message shows up in the browser, but the HTML that I want 
> shows up in the window where I started httpd.

Are you writing your output to stdout (using "print") or stderr for some 
reason?

Grisha
From ccurvey at earthlink.net  Fri Aug 13 11:35:52 2004
From: ccurvey at earthlink.net (Chris Curvey)
Date: Fri Aug 13 10:28:08 2004
Subject: [mod_python] mod_python servlet failing on non-existent code
In-Reply-To: <20040813100635.D27666@onyx.ispol.com>
References: <411CC1B8.4030409@earthlink.net>
	<20040813100635.D27666@onyx.ispol.com>
Message-ID: <411CD1C8.1060201@earthlink.net>

Gregory (Grisha) Trubetskoy wrote:

>
>
> On Fri, 13 Aug 2004, Chris Curvey wrote:
>
>> I'm hacking my way through a proof-of-concept with mod_python 
>> servlets, and I'm coming across something strange.  When I hit my 
>> page, I'm getting an error message returned in a browser ("unpack 
>> tuple of wrong size").   The strange part is that the line listed in 
>> the browser doesn't exist in my code anymore.  (I changed that line 
>> as part of the debugging process.)
>
>
> This is not unusual - Python caches locations of lines so when a 
> module is reloaded oftentimes the traceback will refer to the source 
> code as it was in the original file. The only way to get around this 
> is to restart the server.

That's what's so confusing to me.  I did restart the server, and I'm 
still seeing the old code.  There aren't even any pyc files around for 
me to blame it on.  (Not to mention the fact that the entire page is 
generated properly, at least somewhere.)

>
>> So I figured that maybe I was having a problem with mod_python 
>> caching classes, and I restarted apache just as "httpd -X".  I hit 
>> the page again, and the same error message shows up in the browser, 
>> but the HTML that I want shows up in the window where I started httpd.
>
>
> Are you writing your output to stdout (using "print") or stderr for 
> some reason?

Hmm, I'm using self.writeln() to write out the html, I don't remember 
off the top of my head if that's from mod_python itself or from the 
servlets...

>
> Grisha
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From ccurvey at earthlink.net  Fri Aug 13 12:07:12 2004
From: ccurvey at earthlink.net (Chris Curvey)
Date: Fri Aug 13 10:59:30 2004
Subject: [mod_python] mod_python servlet failing on non-existent code
In-Reply-To: <411CD1C8.1060201@earthlink.net>
References: <411CC1B8.4030409@earthlink.net>	<20040813100635.D27666@onyx.ispol.com>
	<411CD1C8.1060201@earthlink.net>
Message-ID: <411CD920.6050604@earthlink.net>

Hold on, I think I was having a brain cramp.  It looks like my servlet 
is kicking out a 204, so the stuff in the browser isn't even being updated.

Sheesh.  Sorry.

Chris Curvey wrote:

> Gregory (Grisha) Trubetskoy wrote:
>
>>
>>
>> On Fri, 13 Aug 2004, Chris Curvey wrote:
>>
>>> I'm hacking my way through a proof-of-concept with mod_python 
>>> servlets, and I'm coming across something strange.  When I hit my 
>>> page, I'm getting an error message returned in a browser ("unpack 
>>> tuple of wrong size").   The strange part is that the line listed in 
>>> the browser doesn't exist in my code anymore.  (I changed that line 
>>> as part of the debugging process.)
>>
>>
>>
>> This is not unusual - Python caches locations of lines so when a 
>> module is reloaded oftentimes the traceback will refer to the source 
>> code as it was in the original file. The only way to get around this 
>> is to restart the server.
>
>
> That's what's so confusing to me.  I did restart the server, and I'm 
> still seeing the old code.  There aren't even any pyc files around for 
> me to blame it on.  (Not to mention the fact that the entire page is 
> generated properly, at least somewhere.)
>
>>
>>> So I figured that maybe I was having a problem with mod_python 
>>> caching classes, and I restarted apache just as "httpd -X".  I hit 
>>> the page again, and the same error message shows up in the browser, 
>>> but the HTML that I want shows up in the window where I started httpd.
>>
>>
>>
>> Are you writing your output to stdout (using "print") or stderr for 
>> some reason?
>
>
> Hmm, I'm using self.writeln() to write out the html, I don't remember 
> off the top of my head if that's from mod_python itself or from the 
> servlets...
>
>>
>> Grisha
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From amix at amix.dk  Fri Aug 13 18:32:28 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Fri Aug 13 11:32:34 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <2AB88DEA-ED1C-11D8-A444-000A95B2E4E0@amix.dk>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>
	<411BFA73.3090805@apnic.net>
	<2AB88DEA-ED1C-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <FBD9767A-ED3D-11D8-A444-000A95B2E4E0@amix.dk>

> def createSession(req):
>     new_session = Session.Session(req)
>     new_session.unlock()
>
>     #Check id
>     req.write(new_session.id())
>
>     return getSameSession(req, new_session.id())
>
> def getSameSession(req, SID):
>     same_session = Session.Session(req, SID)
>
>     #Check id
>     req.write("\n%s\n" % same_session.id())
>
>     return "Done"

Argh forgot something very important (to save the damn session)!:
def createSession(req):
     new_session = Session.Session(req)
     new_session.save()
     new_session.unlock()

     #Check id
     req.write(new_session.id())

     return getSameSession(req, new_session.id())

def getSameSession(req, SID):
     same_session = Session.Session(req, SID)
     same_session.load()

     #Check id
     req.write("\n%s\n" % same_session.id())

     return "Done"

*Tsk tsk*

Med venlig hilsen / Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity
Den 13/8-2004, kl. 13.30, skrev Amir Salihefendic:

> Thanks a lot for your time spent on the reply, I appreciate it.
>
> "Under what circumstances do you call createSession() instead of 
> getSameSession()?"
>
> Let's take another example:
> I am making a blog-system where I need to have an admin section. I am 
> using the publisher handler.
> Simple forms post username and password to admin.py
> Admin.py has an index function, which has username and password as 
> input.
> In the index function I check if the username and password match, if 
> they do I create an session and store username and password.
> Now, I need to redirect to a new function viewPosts (it's also located 
> in the admin module).
>
> In viewPosts I have to check if the right session is set - else 
> somebody could do admin.py/viewPosts and get access to the admin 
> section.
>
> Of course, I could solve problem in many other ways:
> - Send the SID to viewPosts
> - Place everything in one function (i.e. place everything in 
> admin.py/index)
> - "Append" the session to the req object
> - Make viewPosts private (i.e. do _viewPosts) and then I can only 
> access it by going through admin.py/index
> -etc.
>
> Anyway, I am interested in knowing: What is the smartest way to 
> "share"/access same session across functions (i.e. when you are 
> internal "redirecting")? Example of what I mean by "redirecting" (not 
> working...):
> def createSession(req):
>     new_session = Session.Session(req)
>     return getSameSession(req)
>
> def getSameSession(req):
>     same_session = Session.Session(req)
>     return same_session.id()
>
>
> My guess is to send the SID (working). This seems to be a very light 
> and easy approach:
> def createSession(req):
>     new_session = Session.Session(req)
>     new_session.unlock()
>
>     #Check id
>     req.write(new_session.id())
>
>     return getSameSession(req, new_session.id())
>
> def getSameSession(req, SID):
>     same_session = Session.Session(req, SID)
>
>     #Check id
>     req.write("\n%s\n" % same_session.id())
>
>     return "Done"
>
> (This is a solution I use now.) Of course this is very simplified 
> example...
>
> Med venlig hilsen / Kind regards
> Amir Salihefendic
> -----
> What we do in life echoes in eternity
> Den 13/8-2004, kl. 1.17, skrev Byron Ellacott:
>
>> Amir Salihefendic wrote:
>>> I welcome myself to this list ;-)
>>
>> Welcome!
>>
>> [working example]
>>> def createSession(req):
>>> def getSameSession(req):
>>
>> The important thing to note here is that the code is identical in 
>> both calls.  That is, if you call Session.Session(req) with no 
>> session ID in cookies, or the existing session ID has no matching 
>> session stored on disk, a new session ID is generated.
>>
>> But, the session is /not/ written to disk.
>>
>>> def createSession(req):
>>>     return getSameSession(req)
>>> def getSameSession(req):
>>>     return same_session.id()
>>
>> So when you change to calling getSameSession() from createSession() 
>> you are in fact creating /two/ sessions.  My guess would be that your 
>> apparent infinite loop is in fact a deadlock, caused by the fact that 
>> your second created session will be reusing the session ID created by 
>> the first one, and then attempting to establish a global lock on that 
>> session ID.  Bad.
>>
>>> This does not work - it makes an infinitive loop..!  Now to fix this 
>>> you need to unlock the session in createSession (.. I have no clue 
>>> why you have to do this..?). And then you need to restart apache...  
>>> i.e.:
>>
>> This bears up my analysis well.  The locking done by the Session 
>> module is an Apache-wide lock on the session ID.  So, when 
>> createSession() first creates a session, it locks that sid.  Then, it 
>> calls getSameSession() which attempts to lock the same sid.  The lock 
>> call blocks here, waiting for the first lock to be released, but that 
>> release will never come.  If you cause the first created session to 
>> unlock itself, you will not create a deadlock, but you will need to 
>> restart apache to break an existing deadlock.
>>
>>> But this does not work quite well.. If you delete the Session:
>>> And then you do this:
>>> First time the id's aren't same - after that they are the same.
>>
>> When a session has been deleted, it is marked as invalid and calling 
>> .load() on that sid will fail.  .__init__() will create a new sid if 
>> .load() fails for an existing one, so I suspect you are seeing this 
>> behaviour.
>>
>> Overall, it seems you are making the session management process far 
>> more complicated than it needs to be.  Under what circumstances do 
>> you call createSession() instead of getSameSession() ?
>>
>> I am successfully using the Session module to handle an HTML forms 
>> based login system:
>>
>> session = Session.Session(req)
>> if NeedAuth and not session.has_key('username'):
>>     redirect(AuthPage)
>> ServePage(req)
>> session.save()
>> return apache.OK
>>
>> This is a simplification, since I use an extensible application 
>> object that allows you to change how sessions are generated and how 
>> users are authenticated, but it boils down to the above.  I create a 
>> new session or get an existing session.  I do not care which.  If the 
>> page being requested needs auth, but the session doesn't contain a 
>> username key, I redirect[1] to the login page, which stores the 
>> username value into the session if the user presents the right 
>> credentials.  Otherwise, I serve the requested page, then save the 
>> session, and Bob's a builder.
>>
>> Note that I cannot distinguish between an expired session and no 
>> session at all, but this is a limitation of the Session module.  I 
>> can distinguish between a new session and an existing session by 
>> calling session.is_new(), but that distinction turns out not to be 
>> very important.
>>
>> At some point, I will need to extract the sid from the cookie set 
>> myself, to be able to distinguish between a timed out session, an 
>> invalidated session, a missing session and a brand new session.  (Or 
>> else I'll have to patch the Session module, which I'm not real keen 
>> to do.)
>>
>> -- 
>> bje
>>
>> [1] The 'redirects' I do are simply changing what view my code 
>> believes it is processing, so execution continues down the line, and 
>> session.save() is called in due order.  If you're using an Apache 
>> internal redirect or a 302/303 redirect, you should ensure new 
>> sessions are saved as soon as created with "if session.is_new(): 
>> session.save()".
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From iker at research.att.com  Fri Aug 13 14:59:26 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Fri Aug 13 14:02:01 2004
Subject: [mod_python] Output buffering
Message-ID: <411D017E.2040905@research.att.com>

Does the PSP handler support output buffering?
Something along the lines of ob_start under PHP? If
explicit support is not there, is there some other
way to accomplish the same thing?

Thanks,
Iker

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From milesf at gmail.com  Fri Aug 13 14:24:17 2004
From: milesf at gmail.com (Miles K. Forrest)
Date: Fri Aug 13 16:24:19 2004
Subject: [mod_python] mod_python Live examples
Message-ID: <ca7fdd19040813132417bcc727@mail.gmail.com>

Does anyone have a comprehensive list of websites running mod_python? 
Or even websites using Python?  I'm starting to lose faith that Python
is a better development environment than other LAMP boxes (Perl and
PHP).  I want to believe that Python can be a better development
platform, but I can't find anyone out there who's actually *using*
Python or mod_python for more than just simple dynamic websites.

Maybe if I can see what's out there it'll give me reason to push
through and keep trying.  I'm just about ready to throw in the towel.
-- 
Cheers,

Miles K. Forrest
From nick at dd.revealed.net  Fri Aug 13 16:31:55 2004
From: nick at dd.revealed.net (Nick)
Date: Fri Aug 13 16:32:06 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <411D253B.4030300@dd.revealed.net>

I have used mod_python on large scale internal production systems. 
Unfortunately these are not available to the general public.

Nick

Miles K. Forrest wrote:
> Does anyone have a comprehensive list of websites running mod_python? 
> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.
> 
> Maybe if I can see what's out there it'll give me reason to push
> through and keep trying.  I'm just about ready to throw in the towel.

From indrek at inversion.ee  Sat Aug 14 00:36:58 2004
From: indrek at inversion.ee (Indrek =?ISO-8859-1?Q?J=E4rve?=)
Date: Fri Aug 13 16:33:02 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <1092429418.12289.67.camel@hercules.dustbite.org>

Hi,

Well, one not-exactly "simple dynamic website" done in mod_python is
Conflux (http://www.conflux.ee/, http://demo.conflux.ee/), a groupware
product our company is developing.

Not exactly a list, but something a bit more complicated than a general
website and we're quite happy with how this LAMP (Linux Apache
Mod_python PostgreSQL) works for us.

Best regards,
Indrek

On Fri, 2004-08-13 at 23:24, Miles K. Forrest wrote:
> Does anyone have a comprehensive list of websites running mod_python? 
> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.
> 
> Maybe if I can see what's out there it'll give me reason to push
> through and keep trying.  I'm just about ready to throw in the towel.

From nick at dd.revealed.net  Fri Aug 13 16:39:13 2004
From: nick at dd.revealed.net (Nick)
Date: Fri Aug 13 16:39:22 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <411D253B.4030300@dd.revealed.net>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<411D253B.4030300@dd.revealed.net>
Message-ID: <411D26F1.7090405@dd.revealed.net>

Actually I can tell you that once instance is a client of mine that is a 
leader in the IT industry, I don't know if they want me to say who it is. 
Another is a project I helped develop for the US Air Force.  In both of 
these instances I used PSE (http://nick.borko.org/pse).  The first case uses 
PostgreSQL, the second used Oracle (and linux, apache, and mod_python, natch).

Nick

Nick wrote:

> I have used mod_python on large scale internal production systems. 
> Unfortunately these are not available to the general public.
> 
> Nick
> 
> Miles K. Forrest wrote:
> 
>> Does anyone have a comprehensive list of websites running mod_python? 
>> Or even websites using Python?  I'm starting to lose faith that Python
>> is a better development environment than other LAMP boxes (Perl and
>> PHP).  I want to believe that Python can be a better development
>> platform, but I can't find anyone out there who's actually *using*
>> Python or mod_python for more than just simple dynamic websites.
>>
>> Maybe if I can see what's out there it'll give me reason to push
>> through and keep trying.  I'm just about ready to throw in the towel.
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From azaroth at liverpool.ac.uk  Fri Aug 13 22:34:26 2004
From: azaroth at liverpool.ac.uk (Robert Sanderson)
Date: Fri Aug 13 16:40:33 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <Pine.LNX.4.60.0408132132140.2827@gondolin.hist.liv.ac.uk>

> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.

http://www.cheshire3.org/

Not only do we use mod_python for handling SRW/U requests, we also use it 
to handle Z39.50 requests to our databases.

I assume that meets your definition of more than a simple dynamic website 
:)

Rob


       ,'/:.          Dr Robert Sanderson (azaroth@liverpool.ac.uk)
     ,'-/::::.        http://www.o-r-g.org/~azaroth/
   ,'--/::(@)::.      Special Collections and Archives, extension 3142
,'---/::::::::::.    University of Liverpool
____/:::::::::::::.  L5R Shop: http://www.cardsnotwords.com/
I L L U M I N A T I
From grisha at modpython.org  Fri Aug 13 17:41:53 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Aug 13 16:42:32 2004
Subject: [mod_python] Output buffering
In-Reply-To: <411D017E.2040905@research.att.com>
References: <411D017E.2040905@research.att.com>
Message-ID: <20040813163603.F31783@onyx.ispol.com>


Yes, by default PSP does not flush the output buffer until the very end 
which looks like what PHP ob_start func enables. If you want to force a 
flush from within PSP, you can always call req.flush().

Grisha

On Fri, 13 Aug 2004, Iker Arizmendi wrote:

> Does the PSP handler support output buffering?
> Something along the lines of ob_start under PHP? If
> explicit support is not there, is there some other
> way to accomplish the same thing?
>
> Thanks,
> Iker
>
> -- 
> Iker Arizmendi
> AT&T Labs - Research
> Speech and Image Processing Lab
> e: iker@research.att.com
> w: http://research.att.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From amix at amix.dk  Sat Aug 14 00:36:06 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Fri Aug 13 17:36:12 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>

Hello Miles

I would also really like to see more examples. And get some advice :)!

Anyway, I have also done some work in PHP, ASP and eRuby - - and I must 
say that mod_python is way more powerful - - especially because you 
have such a control over the Apache server. The publisher handler is 
really great - mixing that up with PSP for handling templates - - and 
boom, you got a really neat and powerful web-development tool! But you 
really got to know what you are doing - -because there isn't much of 
help out there...

Anyway, some of you elite mod_python users, couldn't you post some 
advice - tips and tricks?
Here is some aspects I want to know more about:
- How do you build your application (structure)?
- How do you transport data in your application? Of course, you may use 
publisher, you own handlers etc - - But how do you do internal data 
transportation (i.e. for your own function calls, callbacks, classes 
etc.)?
- What about security? Is there some things that one should really be 
careful about? I read that some has done some work for US Air Force - - 
now I suppose security must be high on a project like that one.. How do 
you test security in mod_python? How do you secure your application?
- How do you optimize your application?  What can optimize an 
application (i.e. your experience with optimizing applications)?
- How do you debug?
- How do you handle access to a database? Do you use global connection? 
Could you share how you have builded your database system?
- How do you test your application? How are you sure that the 
application doesn't crash if there more than 50 users? Do you use 
unittesting? If you do, could you share an unittest - or describe how 
you test your application using unittesting?
Well, just write about your own experience ;-)

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

Den 13/8-2004, kl. 22.24, skrev Miles K. Forrest:

> Does anyone have a comprehensive list of websites running mod_python?
> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.
>
> Maybe if I can see what's out there it'll give me reason to push
> through and keep trying.  I'm just about ready to throw in the towel.
> -- 
> Cheers,
>
> Miles K. Forrest
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From kevinsl at gmail.com  Fri Aug 13 17:42:59 2004
From: kevinsl at gmail.com (Kevin Lewandowski)
Date: Fri Aug 13 19:43:04 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <3f732c0b04081316424fdb4e@mail.gmail.com>

www.discogs.com runs on mod_python. I'm not sure if that's the type of
example you're looking for but it's a high traffic dynamic site and
not too simple.

On Fri, 13 Aug 2004 13:24:17 -0700, Miles K. Forrest <milesf@gmail.com> wrote:
> Does anyone have a comprehensive list of websites running mod_python?
> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.
> 
> Maybe if I can see what's out there it'll give me reason to push
> through and keep trying.  I'm just about ready to throw in the towel.
> --
> Cheers,
> 
> Miles K. Forrest
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From neel at mediapulse.com  Fri Aug 13 23:25:30 2004
From: neel at mediapulse.com (Michael Neel)
Date: Fri Aug 13 22:25:37 2004
Subject: [mod_python] mod_python Live examples
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <002201c481a5$f85b3390$0400a8c0@clapton>

Isn't Google doing alot of Python work?  A search on their site seems to
show the open positions at google want python developers:

http://googlesite.google.com/search?output=googleabout&site=googlesite&q=python&submit=Search+our+site

don't think you can get much bigger than google atm =p

Mike

----- Original Message ----- 
From: "Miles K. Forrest" <milesf@gmail.com>
To: <mod_python@modpython.org>
Sent: Friday, August 13, 2004 4:24 PM
Subject: [mod_python] mod_python Live examples


> Does anyone have a comprehensive list of websites running mod_python?
> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.
>
> Maybe if I can see what's out there it'll give me reason to push
> through and keep trying.  I'm just about ready to throw in the towel.
> -- 
> Cheers,
>
> Miles K. Forrest
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From grisha at modpython.org  Fri Aug 13 23:47:34 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Aug 13 22:47:39 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <002201c481a5$f85b3390$0400a8c0@clapton>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<002201c481a5$f85b3390$0400a8c0@clapton>
Message-ID: <20040813224522.O37143@onyx.ispol.com>


I don't know for a fact that Google uses mod_python, but they certainly do 
use lots of Python.

I know one example of a large mod_python site would be the RedHat's 
up2date network servers - they aren't really web sites, more like web 
services, but the volume must be pretty huge.

Grisha

On Fri, 13 Aug 2004, Michael Neel wrote:

> Isn't Google doing alot of Python work?  A search on their site seems to
> show the open positions at google want python developers:
>
> http://googlesite.google.com/search?output=googleabout&site=googlesite&q=python&submit=Search+our+site
>
> don't think you can get much bigger than google atm =p
>
> Mike
>
> ----- Original Message -----
> From: "Miles K. Forrest" <milesf@gmail.com>
> To: <mod_python@modpython.org>
> Sent: Friday, August 13, 2004 4:24 PM
> Subject: [mod_python] mod_python Live examples
>
>
>> Does anyone have a comprehensive list of websites running mod_python?
>> Or even websites using Python?  I'm starting to lose faith that Python
>> is a better development environment than other LAMP boxes (Perl and
>> PHP).  I want to believe that Python can be a better development
>> platform, but I can't find anyone out there who's actually *using*
>> Python or mod_python for more than just simple dynamic websites.
>>
>> Maybe if I can see what's out there it'll give me reason to push
>> through and keep trying.  I'm just about ready to throw in the towel.
>> --
>> Cheers,
>>
>> Miles K. Forrest
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From modpython at holovaty.com  Sat Aug 14 01:58:07 2004
From: modpython at holovaty.com (Adrian Holovaty)
Date: Sat Aug 14 02:00:44 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <200408140058.07538.modpython@holovaty.com>

Miles K. Forrest wrote:
> Does anyone have a comprehensive list of websites running mod_python?
> Or even websites using Python?  I'm starting to lose faith that Python
> is a better development environment than other LAMP boxes (Perl and
> PHP).  I want to believe that Python can be a better development
> platform, but I can't find anyone out there who's actually *using*
> Python or mod_python for more than just simple dynamic websites.

I work for a newspaper Web site in Lawrence, Kansas, and we've been using 
mod_python almost exclusively for the past year or so for our many 
content-management needs. We absolutely love it; it'd take a *lot* for me and 
the other developer, Simon Willison, to change our development platform.

Here are just a few examples of our mod_python-powered sites:

http://www.lawrence.com/
(Has a bit of legacy mod_perl in it for the moment, on the www. subdomain, but 
the rest is mod_python. This is an award-winning local entertainment site. 
Check out the many cross-reference databases, from events to local bands to 
multimedia to drink specials.)

http://blogs.lawrence.com/
(Local-community weblogs, with registration/comment functionality.)

http://www.6newslawrence.com/
(Local TV-station's Web site.)

http://www.6newslawrence.com/weather/
(TV station's weather site, combining locally-produced content and various 
public weather feeds.)

Our sites have a great reputation in the online news industry (despite our 
out-in-the-middle-of-nowhere location), and we're even in the beginning 
stages of packaging our mod_python-based CMS for use by other online media 
companies.

Python and mod_python, for us, have been flexible, quick to develop in, 
powerful, robust and secure. I'd encourage you to explore them deeply and 
fall in love.

Adrian

-- 
Adrian Holovaty
Lead developer, World Online
www.ljworld.com | www.lawrence.com | www.kusports.com
Personal: www.holovaty.com
From amix at amix.dk  Sat Aug 14 10:38:57 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Sat Aug 14 03:39:02 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <200408140058.07538.modpython@holovaty.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<200408140058.07538.modpython@holovaty.com>
Message-ID: <005FA637-EDC5-11D8-A444-000A95B2E4E0@amix.dk>

Hello Adrian

I must say: Impressive stuff!

I really like to see/read that mod_python can be used on some serious 
websites
- - not just for play or prototypes.

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

Den 14/8-2004, kl. 7.58, skrev Adrian Holovaty:
> I work for a newspaper Web site in Lawrence, Kansas, and we've been 
> using
> mod_python almost exclusively for the past year or so for our many
> content-management needs. We absolutely love it; it'd take a *lot* for 
> me and
> the other developer, Simon Willison, to change our development 
> platform.
>
> Here are just a few examples of our mod_python-powered sites:
>
> http://www.lawrence.com/
> (Has a bit of legacy mod_perl in it for the moment, on the www. 
> subdomain, but
> the rest is mod_python. This is an award-winning local entertainment 
> site.
> Check out the many cross-reference databases, from events to local 
> bands to
> multimedia to drink specials.)
>
> http://blogs.lawrence.com/
> (Local-community weblogs, with registration/comment functionality.)
>
> http://www.6newslawrence.com/
> (Local TV-station's Web site.)
>
> http://www.6newslawrence.com/weather/
> (TV station's weather site, combining locally-produced content and 
> various
> public weather feeds.)
>
> Our sites have a great reputation in the online news industry (despite 
> our
> out-in-the-middle-of-nowhere location), and we're even in the beginning
> stages of packaging our mod_python-based CMS for use by other online 
> media
> companies.
>
> Python and mod_python, for us, have been flexible, quick to develop in,
> powerful, robust and secure. I'd encourage you to explore them deeply 
> and
> fall in love.
>
> Adrian
>
> -- 
> Adrian Holovaty
> Lead developer, World Online
> www.ljworld.com | www.lawrence.com | www.kusports.com
> Personal: www.holovaty.com
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From amix at amix.dk  Sat Aug 14 10:53:57 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Sat Aug 14 03:54:03 2004
Subject: [mod_python] Turn "PythonDebug on" on on a live system
Message-ID: <18B5BFC2-EDC7-11D8-A444-000A95B2E4E0@amix.dk>

Here is what could be smart:
To be able to turn "PythonDebug on" on a live system, without losing 
security.
This could be triggered on something like a fixed IP.
IMO this would make debugging of live systems much easier and more 
secure.

This could also be done on production systems (i.e. the feature would 
be smart if you are showing your site to clients, alpha/beta testing 
etc.)

Med venlig hilsen / Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

From amix at amix.dk  Sat Aug 14 13:59:15 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Sat Aug 14 06:59:21 2004
Subject: [mod_python] Making error (debug) output more readable.
Message-ID: <FB7B481C-EDE0-11D8-A444-000A95B2E4E0@amix.dk>

I have made (at least for me) the error output more readable by 
highlighting the important things.

In apche.py function ReportError I have added following code:
                 else:
                     # write to client
                     req.content_type = 'text/html'

                     #Search patterns
                     pattern_file = re.compile('\/([\w]+\.[\D]{1,5})",')
                     pattern_line = re.compile("line ([\d]+)")
                     pattern_in = re.compile(", in ([\w]+)")
                     pattern_type = re.compile("^([A-Za-z]+): (.+)$")

                     s = '\n<h3>Mod_python error: "%s 
%s"</h3>\n<pre>\n\n' % (phase, hname)
                     for e in traceback.format_exception(etype, evalue, 
etb):
                         e = pattern_line.sub(r'<b>line</b> <font 
color="blue">\1</font>', e)
                         e = pattern_file.sub(r'/<font 
color="green">\1</font>,', e)
                         e = pattern_in.sub(r', in <font 
color="darkred">\1</font>', e)
                         e = pattern_type.sub(r'<font 
color="darkblue">\1</font>: <i>\2</i>', e)
                         s += e + '\n'
                     s += "</pre>\n"

To make this work, you of course need to "import re" in the top of 
apache.py.

The output should look something like this:
http://amix.dk/output_colorfull.png

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

From bl at netgroup.dk  Sat Aug 14 15:39:13 2004
From: bl at netgroup.dk (Bo Lorentsen)
Date: Sat Aug 14 08:39:59 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <1092487153.955.341.camel@localhost>

On Fri, 2004-08-13 at 23:36, Amir Salihefendic wrote:

> I would also really like to see more examples. And get some advice :)!
I do understand your problem, as I was in the same situation for about a
half year ago. I tested the old mod_python (2.7) on apache 1.3, and as I
needed sessions, I felt I had to make to much code to make it worth the
while.

But then I tested version 3.x and apache2, and it all changed, it now
has sessions, and other "basic" stuff, and it all work as expected.
mod_python don't work as php, but I found it more easy to structure my
code, when I got use to the "new" way of modelling.

Hmm, I don't know if this is usefull information :-)

> Anyway, I have also done some work in PHP, ASP and eRuby - - and I must 
> say that mod_python is way more powerful - - especially because you 
> have such a control over the Apache server. The publisher handler is 
> really great - mixing that up with PSP for handling templates - - and 
> boom, you got a really neat and powerful web-development tool! But you 
> really got to know what you are doing - -because there isn't much of 
> help out there...
Well, the python language are very common and you can get all the help
you like, and af for mod_python, this mailling list have some quite nice
and helpfull people, and they know stuff, too :-)

> Anyway, some of you elite mod_python users, couldn't you post some 
> advice - tips and tricks?
> Here is some aspects I want to know more about:
Good idea ... I answer a few :-)

> - How do you build your application (structure)?
I use a OO model of "html renders", and database relations to
automaticlly generate HTML form output. This way I can concentrate my
mind on data relations and data flow (I am not a good web designer, so I
make it easy for somebody else to deside how things must look). I even
have build my own database abstraction layer, that I use both in C++ and
Python (its written in C++). 

It is so nice to have only (I used four before) two languages to write
in : Python for WUI and general scripting, and C/C++ for high
performance backend code.
 
> - How do you transport data in your application? Of course, you may use 
> publisher, you own handlers etc - - But how do you do internal data 
> transportation (i.e. for your own function calls, callbacks, classes 
> etc.)?
A homebuild HTML render class library, so you will se absolut NO HTML in
my normal Python code, as it is issolated in a few modules.

> - How do you optimize your application?  What can optimize an 
> application (i.e. your experience with optimizing applications)?
Well, have not done much here, python has an OK speed, and my biggest
problem remains the database and not Python. I use connection pools for
the database but that is about it for now.

> - How do you debug?
Now, this is what really makes Python shine ... I use the python
exception system, and this is really nice. I make sure to raise
exceptions whenever something is wrong and then I catch them in the
finale "render" function. 

Here I can print out stacktraces, or even send them to myself as an
email, and make i nice message to the enduser.

I really like the exception model (also in C++), and the only
alternertive to Python would be Ruby, but Ruby uses "memory sweep GC"
(as in Java and D) and I hate that :-)

> - How do you handle access to a database? Do you use global connection? 
As I wrote, I made me own DB abstraction (addes type checking, 
relations and more), but I also uses psycopg for some reporting. I quess
the connection is like a global connection, and as I use the apache2
process model, this works out just nice. 

And yes ... I use PostgreSQL.

> Could you share how you have builded your database system?
That would be a big issue and not very geneal (except if you make a
payment system :-)), what exactly do you what to know ?

> Well, just write about your own experience ;-)
Well I tried :-)

/BL

From bl at netgroup.dk  Sat Aug 14 15:45:11 2004
From: bl at netgroup.dk (Bo Lorentsen)
Date: Sat Aug 14 08:45:56 2004
Subject: [mod_python] Making error (debug) output more readable.
In-Reply-To: <FB7B481C-EDE0-11D8-A444-000A95B2E4E0@amix.dk>
References: <FB7B481C-EDE0-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <1092487511.945.343.camel@localhost>

On Sat, 2004-08-14 at 12:59, Amir Salihefendic wrote:

> I have made (at least for me) the error output more readable by 
> highlighting the important things.
Now this is nice ... hope you dont mind me stealing it :-)

/BL

From neel at mediapulse.com  Sat Aug 14 12:22:34 2004
From: neel at mediapulse.com (Michael Neel)
Date: Sat Aug 14 11:22:39 2004
Subject: [mod_python] Turn "PythonDebug on" on on a live system
References: <18B5BFC2-EDC7-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <001201c48212$86126070$0400a8c0@clapton>

This is something you can do with Apache; just configure a vhost to point to
the same files and change the auth to whatever you want it to be and in this
host set the debug option.

Mike

----- Original Message ----- 
From: "Amir Salihefendic" <amix@amix.dk>
To: "mod_python user mailing list" <mod_python@modpython.org>
Sent: Saturday, August 14, 2004 3:53 AM
Subject: [mod_python] Turn "PythonDebug on" on on a live system


> Here is what could be smart:
> To be able to turn "PythonDebug on" on a live system, without losing
> security.
> This could be triggered on something like a fixed IP.
> IMO this would make debugging of live systems much easier and more
> secure.
>
> This could also be done on production systems (i.e. the feature would
> be smart if you are showing your site to clients, alpha/beta testing
> etc.)
>
> Med venlig hilsen / Kind regards
> Amir Salihefendic
> -----
> What we do in life echoes in eternity
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From neel at mediapulse.com  Sat Aug 14 12:34:48 2004
From: neel at mediapulse.com (Michael Neel)
Date: Sat Aug 14 11:34:53 2004
Subject: [mod_python] mod_python Live examples
References: <ca7fdd19040813132417bcc727@mail.gmail.com><C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<1092487153.955.341.camel@localhost>
Message-ID: <001f01c48214$3bc8aae0$0400a8c0@clapton>

> > I would also really like to see more examples. And get some advice :)!
> I do understand your problem, as I was in the same situation for about a
> half year ago. I tested the old mod_python (2.7) on apache 1.3, and as I
> needed sessions, I felt I had to make to much code to make it worth the
> while.
>
> But then I tested version 3.x and apache2, and it all changed, it now
> has sessions, and other "basic" stuff, and it all work as expected.
> mod_python don't work as php, but I found it more easy to structure my
> code, when I got use to the "new" way of modelling.

I think that's a bit unfair, mod_python's 'basic' is exposing the apache api
in python, and allowing python code to be understood by apache.  The other
things mod_python can do are really extras and bonuses, and if you come from
having worked with the apache api before, mod_python has been pretty
complete for a while now.

Also, you've never been "locked into" the options that come with mod_python.
There are some other frameworks that work under mod_python listed in the
links section; http://www.modpython.org/links.html and I myself use
Albatross; http://www.object-craft.com.au/projects/albatross/  There are
alot more than these out there as well that use mod_python for it's access
to the apache api and then supply their own framework.  And it never hurts
to know more than one, as not every framework is best for every app;
sometimes you really need Zope and other times Publisher will be get the job
quite nicely =)

Mike

From nick at dd.revealed.net  Sat Aug 14 14:30:34 2004
From: nick at dd.revealed.net (Nick)
Date: Sat Aug 14 14:30:35 2004
Subject: [mod_python] Making error (debug) output more readable.
In-Reply-To: <FB7B481C-EDE0-11D8-A444-000A95B2E4E0@amix.dk>
References: <FB7B481C-EDE0-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <1092508233.20151.1.camel@nick>

On Sat, 2004-08-14 at 05:59, Amir Salihefendic wrote:
> I have made (at least for me) the error output more readable by 
> highlighting the important things.

A nice idea for an option, but not very helpful if you test with lynx
-dump

Nick

From amix at amix.dk  Sat Aug 14 23:39:53 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Sat Aug 14 16:39:58 2004
Subject: [mod_python] Making error (debug) output more readable.
In-Reply-To: <1092508233.20151.1.camel@nick>
References: <FB7B481C-EDE0-11D8-A444-000A95B2E4E0@amix.dk>
	<1092508233.20151.1.camel@nick>
Message-ID: <186885DE-EE32-11D8-A444-000A95B2E4E0@amix.dk>

> A nice idea for an option, but not very helpful if you test with lynx

Well, didn't know that anyone tested with lynx :-D
Maybe I should look on extending PythonDebug directive.

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

Den 14/8-2004, kl. 20.30, skrev Nick:

> On Sat, 2004-08-14 at 05:59, Amir Salihefendic wrote:
>> I have made (at least for me) the error output more readable by
>> highlighting the important things.
>
> A nice idea for an option, but not very helpful if you test with lynx
> -dump
>
> Nick
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From amix at amix.dk  Sat Aug 14 23:49:52 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Sat Aug 14 16:49:56 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <1092487153.955.341.camel@localhost>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<1092487153.955.341.camel@localhost>
Message-ID: <7D989686-EE33-11D8-A444-000A95B2E4E0@amix.dk>

Hello Bo and thanks for your answer.
It looks to me as most mod_python developers use their own home-made 
systems :-) Well, it's cool and mod_python is just perfect for that 
purpose.

> That would be a big issue and not very geneal (except if you make a
> payment system :-)), what exactly do you what to know ?
I would like to know about some experience you guys had -
I.e. I have tried this, it didn't work out, therefore I did it this way 
- - and now it works fine. But I know, it must be hard to write about.
I just think I am going to get my own experience :-)

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

From iker at research.att.com  Sat Aug 14 18:27:15 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Sat Aug 14 17:29:52 2004
Subject: [mod_python] Output buffering
In-Reply-To: <20040813163603.F31783@onyx.ispol.com>
References: <411D017E.2040905@research.att.com>
	<20040813163603.F31783@onyx.ispol.com>
Message-ID: <411E83B3.90601@research.att.com>

Thanks Greg. Is there a method that clears the
current output buffer as well?



Gregory (Grisha) Trubetskoy wrote:
> 
> Yes, by default PSP does not flush the output buffer until the very end 
> which looks like what PHP ob_start func enables. If you want to force a 
> flush from within PSP, you can always call req.flush().
> 
> Grisha
> 
> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
> 
>> Does the PSP handler support output buffering?
>> Something along the lines of ob_start under PHP? If
>> explicit support is not there, is there some other
>> way to accomplish the same thing?
>>
>> Thanks,
>> Iker
>>

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From nick at dd.revealed.net  Sun Aug 15 00:02:24 2004
From: nick at dd.revealed.net (Nick)
Date: Sun Aug 15 00:02:26 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <7D989686-EE33-11D8-A444-000A95B2E4E0@amix.dk>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<1092487153.955.341.camel@localhost>
	<7D989686-EE33-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <1092542543.2236.5.camel@nick>

On Sat, 2004-08-14 at 15:49, Amir Salihefendic wrote:
> Hello Bo and thanks for your answer.
> It looks to me as most mod_python developers use their own home-made 
> systems :-) Well, it's cool and mod_python is just perfect for that 
> purpose.

If you're coming from a background like php or jsp, I would say check
out http://nick.borko.org/pse -- it's a handler built on top of
mod_python like psp and servlets, but it's more like php and jsp in that
you primarily work in html to make the pages rather than build html
generators (although you can do that).  It's an easier way to get
started using straight python code in your html rather than using
specialized templating languages, like cherrypy, spyce, etc.  You can
use as little or as much python as you need to make your application,
either embedded in the html or in a separate module that gets executed
with the page.

Nick

From bl at netgroup.dk  Sun Aug 15 09:38:12 2004
From: bl at netgroup.dk (Bo Lorentsen)
Date: Sun Aug 15 02:38:59 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <001f01c48214$3bc8aae0$0400a8c0@clapton>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<1092487153.955.341.camel@localhost>
	<001f01c48214$3bc8aae0$0400a8c0@clapton>
Message-ID: <1092551892.945.358.camel@localhost>

On Sat, 2004-08-14 at 17:34, Michael Neel wrote:

> I think that's a bit unfair, mod_python's 'basic' is exposing the apache api
> in python, and allowing python code to be understood by apache.  The other
> things mod_python can do are really extras and bonuses, and if you come from
> having worked with the apache api before, mod_python has been pretty
> complete for a while now.
I agree, but I just found that something was missing to get the job
done. I could (and did) try to make some of these things myself, but it
really made me feel (subjective feeling) that mod_python was not ready.

But I was wrong, and that was the point. Mod_python is just something
else, and it works very nice.

> Also, you've never been "locked into" the options that come with mod_python.
Agree, it just took me som time to find out.

/BL

From grahamd at dscpl.com.au  Sun Aug 15 19:22:31 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sun Aug 15 04:22:39 2004
Subject: [mod_python] Imports, Caching, Handlers and Page Templates.
Message-ID: <40D7AF10-EE94-11D8-937D-000393DCF16E@dscpl.com.au>

I'll admit that I have only been looking at mod_python for about a 
month and have only
been on the mailing list for a couple of weeks. Also, I have 
exclusively been playing
with the older 2.7 version of mod_python, as I don't have access to a 
machine which
runs Apache 2.0. All the same, I thought it might be a good time to say 
a few things
about what I have been up to since I have just made available a new 
beta version of a
package I make available and this new version now incorporates some 
specific support
for mod_python.

Okay, see it as a bit of advertising for this package if you want, but 
the mod_python
handler I have come up with can be separated from the package and used 
by itself if
desired. From what I have seen, this mod_python handler provides 
something a bit
different to what is out there, but then I could be wrong, as I haven't 
been looking
too long and I haven't looked at mod_python 3.1 in any real detail yet. 
Thus I may have
missed the obvious and simply reinvented the wheel. Please educate me 
if necessary. :-)

First off, the package is called OSE and it is available from:

   http://ose.sourceforge.net

The version just made available is OSE 8.0b4.

I will not go into detail about what OSE is all about as it would take 
too long. It is
enough to say that it provides a way of implementing applications 
distributed across
multiple processes or multiple machines. This is done using a 
publish/subscribe and
request/reply messaging system. Although the core is written in C++, 
there are some
Python wrappers provided. As far as mod_python is concerned, the main 
thing I now
provide which would be of interest to people here is a specialised 
mod_python content
handler.

Now unless I have missed something, there are two ways to setup 
mod_python to be used.
You can use "AddHandler" to indicate that a specific handler be used 
for all requests
where a specific extension is used, or you can use SetHandler to have 
all requests be
processed by a specific content handler. The two cases are represented 
by mod_python.psp
in the first instance and mod_python.publisher in the latter.

The mod_python handler I have developed uses SetHandler like 
mod_python.publisher, but
whereas mod_python.publisher then does some interpretation of the 
request and translates
it into a totally different calling convention, ie., Python method 
invocation, what I
have created effectively maps requests back onto different basic 
content handlers by
looking at the resource being requested.

In other words, if you had copied the "mptest.py" example file into the 
directory and
made a request against "mptest.html", it would be processed by the 
"handler()" method
contained in "mptest.py". At the same time and in the same directory, 
if there were
also a handler defined in "index.py" and a request was made for 
"index.html" then
the "handler()" method in "index.py" would be used to process the 
request.

Thus, without imposing a particular mechanism for how the resultant 
HTML is generated,
such as with mod_python.psp, you can have multiple basic content 
handlers within the one
directory where which is used is by default determined by stripping off 
the ".html"
extension and replacing it with ".py" to arrive at which handler to 
execute. If it is
determined that for a particular request of a ".html" file there is no 
corresponding ".py"
file, the handler declines to handle the request and thus Apache 
processes it as per
normal. Similarly, if the request was for any resource at all it didn't 
know what to
do with, it would again pass it back to Apache.

Now I would have thought this would have been quite basic functionality 
and why I feel
I must have missed something and that this actually is possible without 
a specialised
content handler. So what have I overlooked?

Anyway, to extend on that, as well as dealing with requests for files 
with a ".html"
extension, it is possible to define that a content handler can produce 
other types of
files as well as, or instead of ".html" files. Thus, you might have in 
a directory a file
called "data.csv". If you were to request this file, the initial 
handler, not knowing
what to do with it, will decline to service the request and instead 
Apache will return
it instead.

What can now be done though, is to add a "data.py" containing a handler 
method. This
isn't going to be used to generate the CSV data, but by defining that 
this handler be
called for ".txt" and ".html" requests, ie., requests against 
"data.txt" and "data.html",
it can be used to translate the data in the CSV file into different 
forms, such as
tab separated and HTML table formatted data.

In summary, if a directory were to contain the files as described 
above, plus an
ordinary HTML file, as listed below:

   mptest.py
   index.py
   data.csv
   data.py
   basic.html

The result thus of requests would be:

   basic.html - declined by initial handler and content returned by 
Apache
   data.csv - declined by initial handler and content returned by Apache
   missing.html - declined by initial handler and Apache returns "Not 
Found"
   index.html - initial handler would execute handler in index.py to 
generate content
   mptest.html - initial handler would execute handler in mptest.py to 
generate content
   data.txt - initial handler would execute handler in data.py to 
generate content
   data.html - initial handler would execute handler in data.py to 
generate content

One final case, if the extension which a ".py" file is indicated as 
being able to process
is set to be empty, then that name can be used like a directory with 
additional path
info being passed in to the handler. Ie., if the code file is called 
"proxy.py", using
the URL "proxy/a/b/c" would result in the handler in "proxy.py" being 
executed and
with the path info set to "/a/b/c".

That is the first significant bit of functionality provided. The next 
relates to the
fact that to do this effectively, you need to have a caching system for 
Python code
which is loaded, to avoid reimporting on every request. Caching is done 
by mod_python
itself as well as in systems like mpservlets.

The specialised content handler being supplied actually makes use of a 
module caching
system which OSE has had in it for some time, although it has been 
upgraded a bit
recently and split into a separate file so it can be split out of OSE 
if required.

Unlike mod_python and mpservlets the caching system will reload Python 
code if any
change occurs in the modification time. These other systems only do so 
if the modification
time is newer than before, which is no good if an older version of a 
file is put
back in place of the newer one. Only reloading a file if the 
modification is newer
can also sometimes be problematic when files are shared across the 
network using
something like NFS and machine clocks aren't properly synchronised.

More importantly than that, the module cache system can be used 
explicitly within a
loaded module to load additional modules as children and the cache will 
track the
relationships between the modules and will reload a parent if any of 
the children is
changed. This avoids the problem whereby if you use "import" explicitly 
to load a
common bit of code and you change the common code, you are in most 
cases forced to
restart Apache to throw out the old code remembered by Python so as to 
be able to
pick up the new code.

This mechanism of tracking relationships between loaded modules was 
originally developed
for a servlet based system. Specifically, you might have a base class 
servlet which defines
a lot of site structure and a derived class which defines specific page 
content. As
well as the derived servlet being loaded through the module cache, the 
derived servlet
could load the base class servlet via the cache. Now if the base class 
servlet was
modified, even though the derived class servlet hadn't, if a request 
came in which
meant the derived class servlet were to be executed, the system would 
detect the change
in the base class and automatically reload the derived class which 
would in turn reload
the base class thus picking up the changes in the site structure.

Although originally used on a servlet based system independent of 
mod_python and Apache,
it is still applicable here. The cache also does a few other things to 
avoid unnecessary
reimporting as well as cope with removal of files, but enough said on 
that one.

Next thing which might be of interest is that a wrapper for 
HTMLTemplate is provided
along with a template object caching system for its templates. 
HTMLTemplate is a bit
different to most systems in that there is a quite clear separation 
between HTML and
code used to populate the HTML with data. That is, there is no Python 
code embedded
within the HTML, nor is there necessarily any HTML embedded in the 
Python code. In some
respects it is DOM like, but not really, as to make things more 
efficient it only
indexes and allows you to manipulate nodes marked up in a certain way. 
Since this is
a very poor description of HTMLTemplate, you should simply go to its 
web site for a
description.

As to the wrappers for HTMLTemplate and the template caching system, 
what you can end
up with is:

   index.html
   index.py

That is, the HTML is all in "index.html", with necessary node markup 
defined in elements
as necessary. When a request comes in for "index.html", the handler in 
"index.py" is
executed. This loads the HTML for "index.html" via the template cache 
and is given a
copy to work on. It uses the HTMLTemplate API to fill in the data and 
writes back the
rendered result for Apache to to return to the client.

Okay, done for now. If you are interested, get down OSE 8.0b4 and 
specifically look at:

   examples/apache
   examples/apache/_mputils
   netsvc/cache/__init__.py
   netsvc/apache/__init__.py

The example has the start of some documentation on how it hangs 
together, but running
out of time before I go on holidays, so wanted to get something out now.

Knowing that most probably will not care much about the larger 
functionality of OSE,
the "examples/apache/README" file describes how to copy the module 
cache and mod_python
handler out of OSE proper into the example so you can run it as is, 
without installing
OSE.

If you have comments or questions, then post them here on the 
mod_python mailing list
and I'll do my best to address them. If there is enough interest I can 
go on to describe
how I see all this fitting into the larger scheme of things with 
respect to the messaging
system provided with OSE and how one might go about implementing 
sessions and database
interfaces.

Enjoy.

--
Graham Dumpleton (grahamd@dscpl.com.au)

From iker at research.att.com  Mon Aug 16 14:08:40 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Mon Aug 16 13:11:24 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <411E83B3.90601@research.att.com>
References: <411D017E.2040905@research.att.com>	<20040813163603.F31783@onyx.ispol.com>
	<411E83B3.90601@research.att.com>
Message-ID: <4120EA18.1020706@research.att.com>

One problem I've encountered with using set_error_page()
for error handling is that often the faulty page has already
generated some output when the error is encountered. This
results in garbled pages with bits from both the error-raising
page and the error-catching page.

Is there some way to get around this?

Regards,
Iker


Iker Arizmendi wrote:
> Thanks Greg. Is there a method that clears the
> current output buffer as well?
> 
> Gregory (Grisha) Trubetskoy wrote:
> 
>>
>> Yes, by default PSP does not flush the output buffer until the very 
>> end which looks like what PHP ob_start func enables. If you want to 
>> force a flush from within PSP, you can always call req.flush().
>>
>> Grisha
>>
>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>
>>> Does the PSP handler support output buffering?
>>> Something along the lines of ob_start under PHP? If
>>> explicit support is not there, is there some other
>>> way to accomplish the same thing?
>>>
>>> Thanks,
>>> Iker
>>>
> 

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From rfelder at globaltecsolutions.com  Mon Aug 16 15:11:32 2004
From: rfelder at globaltecsolutions.com (Ryan Felder)
Date: Mon Aug 16 15:11:36 2004
Subject: [mod_python] Mod_python, Windows,
	and Cookies : cannot import name Cookie
Message-ID: <BFELILJNDOILCFMKOHDBGEAECIAA.rfelder@globaltecsolutions.com>

I am trying to bring a small web application I developed on
a solaris machine over to a mod_python 3.0.4 equipped apache
2.0 windows server 2003 machine. The code runs fine on Solaris,
however, when I try to run it on the Windows machine, I receive
an error. Trying from an interpreter, I get this error, which is
the same as the error in apache's error log.

IDLE 1.0.2      
>>> from mod_python import Cookie

Traceback (most recent call last):
  File "<pyshell#0>", line 1, in -toplevel-
    from mod_python import Cookie
ImportError: cannot import name Cookie

Is the implimentation of cookies different on win32? 
Is it supported? I get similar errors with Session.
I can successfully import mod_python itself. The machine
is very clean, having been setup to run another mod_python
application, which does execute with no suprises.

- Ryan Felder
 
From rfelder at globaltecsolutions.com  Mon Aug 16 15:21:42 2004
From: rfelder at globaltecsolutions.com (Ryan Felder)
Date: Mon Aug 16 15:21:46 2004
Subject: [mod_python] Mod_Python,
	Win32 and Cookies : cannot import name Cookie
Message-ID: <BFELILJNDOILCFMKOHDBMEAECIAA.rfelder@globaltecsolutions.com>

I forgot to mention that my code is written only in mod_python,
and not using any PSP.

>I am trying to bring a small web application I developed on
>a solaris machine over to a mod_python 3.0.4 equipped apache
>2.0 windows server 2003 machine. The code runs fine on Solaris,
>however, when I try to run it on the Windows machine, I receive
>an error. Trying from an interpreter, I get this error, which is
>the same as the error in apache's error log.
>
>IDLE 1.0.2
>>>> from mod_python import Cookie
>
>Traceback (most recent call last):
>  File "<pyshell#0>", line 1, in -toplevel-
>    from mod_python import Cookie
>ImportError: cannot import name Cookie
>
>Is the implimentation of cookies different on win32?
>Is it supported? I get similar errors with Session.
>I can successfully import mod_python itself. The machine
>is very clean, having been setup to run another mod_python
>application, which does execute with no suprises.
>
>- Ryan Felder

Wizetrade?, 4X Made Easy?, Options Made Easy?, Wizefinder?, OptionHunter?,
Wizefeed?, Optionsfeed? and 4Xfeed? are trademarks and subsidiaries of
GlobalTec Solutions, LLP?.  Wizetrade?, 4X Made Easy?, Options Made Easy?,
Wizefinder? and OptionsHunter?, and any related products, are analytical
tools only and are not intended to replace individual research or licensed
investment advice. Unique experiences and past performances do not guarantee
future results!  Testimonials are non-representative of all clients; certain
accounts may have worse performance than that indicated. Trading stocks,
options and spot currencies involves substantial risk; and there is always
the potential for loss. Your trading results may vary. No representation is
being made that any software or training will guarantee profits or not
result in losses from trading. Neither the software programs, any
explanation or demonstration of their operation, nor any training held in
conjunction therewith, including, without limitation, through online chat,
in connection with our radio programs, during our in-person seminars or
otherwise, should be construed as providing a trade recommendation or the
giving of investment advice.  The purchase, sale or advice regarding a
security can only be performed by a licensed Broker/Dealer and/or Registered
Investment Advisor. Neither GlobalTec Solutions, LLP? nor its officers,
employees, owners, agents, principals or affiliates is a registered
Broker/Dealer or Investment Advisor in any State or Federally. All
purchasers of software or other products owned by GlobalTec Solutions, LLP?
are encouraged to consult with a licensed representative of their choice
regarding any particular investment or investment strategy. Prices and
offers are subject to change without notice. All shipping & handling charges
are non-refundable. Texas residents add 8.25% sales tax. International
customers are responsible for all tariffs, duties and fees.



From grisha at modpython.org  Mon Aug 16 17:32:00 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 16 16:32:05 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <4120EA18.1020706@research.att.com>
References: <411D017E.2040905@research.att.com>
	<20040813163603.F31783@onyx.ispol.com>
	<411E83B3.90601@research.att.com> <4120EA18.1020706@research.att.com>
Message-ID: <20040816163044.B90060@onyx.ispol.com>


Hmm... The buffer that buffers output is controlled by Apache, and AFAIK 
once something's been written to it, you cannot get it back.

Grisha

On Mon, 16 Aug 2004, Iker Arizmendi wrote:

> One problem I've encountered with using set_error_page()
> for error handling is that often the faulty page has already
> generated some output when the error is encountered. This
> results in garbled pages with bits from both the error-raising
> page and the error-catching page.
>
> Is there some way to get around this?
>
> Regards,
> Iker
>
>
> Iker Arizmendi wrote:
>> Thanks Greg. Is there a method that clears the
>> current output buffer as well?
>> 
>> Gregory (Grisha) Trubetskoy wrote:
>> 
>>> 
>>> Yes, by default PSP does not flush the output buffer until the very end 
>>> which looks like what PHP ob_start func enables. If you want to force a 
>>> flush from within PSP, you can always call req.flush().
>>> 
>>> Grisha
>>> 
>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>> 
>>>> Does the PSP handler support output buffering?
>>>> Something along the lines of ob_start under PHP? If
>>>> explicit support is not there, is there some other
>>>> way to accomplish the same thing?
>>>> 
>>>> Thanks,
>>>> Iker
>>>> 
>> 
>
> -- 
> Iker Arizmendi
> AT&T Labs - Research
> Speech and Image Processing Lab
> e: iker@research.att.com
> w: http://research.att.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From quarl at nospam.quarl.org  Mon Aug 16 14:36:57 2004
From: quarl at nospam.quarl.org (Karl Chen)
Date: Mon Aug 16 16:41:03 2004
Subject: [mod_python] mod_python 2.7.10 hangs apache sometimes
Message-ID: <quack.20040816T1336.j5vffikefq@hkn.eecs.berkeley.edu>


After installing mod_python, apache has started hanging sometimes
(likely during high loads).  Any help?

Mod_python 2.7.10 was compiled from source as DSO; Apache 1.3.26
is from Debian woody; Python 2.3 was compiled from source.


-- 
Karl 2004-08-16 13:33

From davidf at sjsoft.com  Mon Aug 16 23:42:40 2004
From: davidf at sjsoft.com (David Fraser)
Date: Mon Aug 16 16:42:45 2004
Subject: [mod_python] Mod_python, Windows,	and Cookies : cannot import
	name Cookie
In-Reply-To: <BFELILJNDOILCFMKOHDBGEAECIAA.rfelder@globaltecsolutions.com>
References: <BFELILJNDOILCFMKOHDBGEAECIAA.rfelder@globaltecsolutions.com>
Message-ID: <41211C40.6020002@sjsoft.com>

Ryan Felder wrote:

>I am trying to bring a small web application I developed on
>a solaris machine over to a mod_python 3.0.4 equipped apache
>2.0 windows server 2003 machine. The code runs fine on Solaris,
>however, when I try to run it on the Windows machine, I receive
>an error. Trying from an interpreter, I get this error, which is
>the same as the error in apache's error log.
>
>IDLE 1.0.2      
>  
>
>>>>from mod_python import Cookie
>>>>        
>>>>
>
>Traceback (most recent call last):
>  File "<pyshell#0>", line 1, in -toplevel-
>    from mod_python import Cookie
>ImportError: cannot import name Cookie
>
>Is the implimentation of cookies different on win32? 
>Is it supported? I get similar errors with Session.
>I can successfully import mod_python itself. The machine
>is very clean, having been setup to run another mod_python
>application, which does execute with no suprises.
>  
>
Surely you want a later mod_python version?
mod_python.Cookie is only available from 3.1.x I think, as as Session
Maybe you are using a more up-to-date version on Solaris

Regards
David
From iker at research.att.com  Mon Aug 16 18:23:50 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Mon Aug 16 17:26:31 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <20040816163044.B90060@onyx.ispol.com>
References: <411D017E.2040905@research.att.com>	<20040813163603.F31783@onyx.ispol.com>	<411E83B3.90601@research.att.com>
	<4120EA18.1020706@research.att.com>
	<20040816163044.B90060@onyx.ispol.com>
Message-ID: <412125E6.9070000@research.att.com>

I don't need to get it back, I just need to clear it so
I can send just the error page without any dangling output
from the faulty page. I guess one solution is to write the
output to a buffer in Python code and only call req.write
once all processing is complete. But this would eliminate
the need for PSP (unless PSP offers a way to direct it's
output to my own buffer).

Iker


Gregory (Grisha) Trubetskoy wrote:
> 
> Hmm... The buffer that buffers output is controlled by Apache, and AFAIK 
> once something's been written to it, you cannot get it back.
> 
> Grisha
> 
> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
> 
>> One problem I've encountered with using set_error_page()
>> for error handling is that often the faulty page has already
>> generated some output when the error is encountered. This
>> results in garbled pages with bits from both the error-raising
>> page and the error-catching page.
>>
>> Is there some way to get around this?
>>
>> Regards,
>> Iker
>>
>>
>> Iker Arizmendi wrote:
>>
>>> Thanks Greg. Is there a method that clears the
>>> current output buffer as well?
>>>
>>> Gregory (Grisha) Trubetskoy wrote:
>>>
>>>>
>>>> Yes, by default PSP does not flush the output buffer until the very 
>>>> end which looks like what PHP ob_start func enables. If you want to 
>>>> force a flush from within PSP, you can always call req.flush().
>>>>
>>>> Grisha
>>>>
>>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>>>
>>>>> Does the PSP handler support output buffering?
>>>>> Something along the lines of ob_start under PHP? If
>>>>> explicit support is not there, is there some other
>>>>> way to accomplish the same thing?
>>>>>
>>>>> Thanks,
>>>>> Iker
>>>>>
>>>
>>

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From rfelder at globaltecsolutions.com  Mon Aug 16 17:37:55 2004
From: rfelder at globaltecsolutions.com (Ryan Felder)
Date: Mon Aug 16 17:37:59 2004
Subject: [mod_python] Mod_python, Windows,
	and Cookies : cannot import name Cookie
Message-ID: <BFELILJNDOILCFMKOHDBKEAGCIAA.rfelder@globaltecsolutions.com>

Thanks, That has almost certainly got it. I don't even know where
I got that older version from anymore. I seem to have had a zombie
process for python, and began having issues after trying to install
the latest mod_python. I'll ask if I have any other unsurmaountable
issues. Thanks again!

- Ryan

>Ryan Felder wrote:
>
>>I am trying to bring a small web application I developed on
>>a solaris machine over to a mod_python 3.0.4 equipped apache
>>2.0 windows server 2003 machine. The code runs fine on Solaris,
>>however, when I try to run it on the Windows machine, I receive
>>an error. Trying from an interpreter, I get this error, which is
>>the same as the error in apache's error log.
>>
>>IDLE 1.0.2
>>
>>
>>>>>from mod_python import Cookie
>>>>>
>>>>>
>>
>>Traceback (most recent call last):
>>  File "<pyshell#0>", line 1, in -toplevel-
>>    from mod_python import Cookie
>>ImportError: cannot import name Cookie
>>
>>Is the implimentation of cookies different on win32?
>>Is it supported? I get similar errors with Session.
>>I can successfully import mod_python itself. The machine
>>is very clean, having been setup to run another mod_python
>>application, which does execute with no suprises.
>>
>>
>Surely you want a later mod_python version?
>mod_python.Cookie is only available from 3.1.x I think, as as Session
>Maybe you are using a more up-to-date version on Solaris
>
>Regards
>David

Wizetrade?, 4X Made Easy?, Options Made Easy?, Wizefinder?, OptionHunter?,
Wizefeed?, Optionsfeed? and 4Xfeed? are trademarks and subsidiaries of
GlobalTec Solutions, LLP?.  Wizetrade?, 4X Made Easy?, Options Made Easy?,
Wizefinder? and OptionsHunter?, and any related products, are analytical
tools only and are not intended to replace individual research or licensed
investment advice. Unique experiences and past performances do not guarantee
future results!  Testimonials are non-representative of all clients; certain
accounts may have worse performance than that indicated. Trading stocks,
options and spot currencies involves substantial risk; and there is always
the potential for loss. Your trading results may vary. No representation is
being made that any software or training will guarantee profits or not
result in losses from trading. Neither the software programs, any
explanation or demonstration of their operation, nor any training held in
conjunction therewith, including, without limitation, through online chat,
in connection with our radio programs, during our in-person seminars or
otherwise, should be construed as providing a trade recommendation or the
giving of investment advice.  The purchase, sale or advice regarding a
security can only be performed by a licensed Broker/Dealer and/or Registered
Investment Advisor. Neither GlobalTec Solutions, LLP? nor its officers,
employees, owners, agents, principals or affiliates is a registered
Broker/Dealer or Investment Advisor in any State or Federally. All
purchasers of software or other products owned by GlobalTec Solutions, LLP?
are encouraged to consult with a licensed representative of their choice
regarding any particular investment or investment strategy. Prices and
offers are subject to change without notice. All shipping & handling charges
are non-refundable. Texas residents add 8.25% sales tax. International
customers are responsible for all tariffs, duties and fees.



From milesf at gmail.com  Mon Aug 16 17:51:09 2004
From: milesf at gmail.com (Miles K. Forrest)
Date: Mon Aug 16 19:51:12 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <ca7fdd190408161651417fc9b6@mail.gmail.com>

> I would also really like to see more examples. And get some advice :)!

Glad I'm not alone :)  Thanks everyone for your feedback and links to
working mod_python sites.  I'm beginning to see that mod_python's
ability to open up the insides of apache is something really powerful.
 I also get the sense that it's not meant for "newbies" like me who
are used to building webpages with Windows tools like Dreamweaver and
putting in the dynamic plumming with PHP.

But I _want_ to learn.  And I'd like to seperate the HTML and Python
code so I can still rely on HTML designers who, unlike myself, know
how to build nice looking pages.  And I'd like to use Python.  But I
can't seem to get a platform working.

I figure I need to use templating to seperate the HTML and Python
code.  I've read Grisha's article at onlamp.com:

http://www.onlamp.com/pub/a/python/2004/02/26/python_server_pages.html

I suppose having lots of choices when it comes to templating if you
know what you're doing, but for someone like me the choice is
difficult: which _should_ I choose?  Being told "it depends on what
you're doing" doesn't help because I'm not sure what I'm going to do,
I'm still learning.  I'm leaning towards PSP because it's built-in to
mod_python, so it seems to me it will become a standard way of
templating because it's already there.

Can any gurus out there help guide this neophyte? (wincing a bit as I
click send in fear of a "RTFM" retaliation - I've read so much my
eyeballs are beginning to glaze over)

Miles
From ccurvey at earthlink.net  Mon Aug 16 21:21:59 2004
From: ccurvey at earthlink.net (Chris Curvey)
Date: Mon Aug 16 20:13:15 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <41214FA7.60209@earthlink.net>

I've recently been working on integrating owlfish's implementation of 
TAL (Template Attribute Language) with mod_python servlets.   I like 
that model, because it lets me separate all the HTML from the Python 
code (so that I can't get sloppy and mix Python with my HTML).  I can 
then implement controller classes by subclassing mod_python servlets, 
and keep those separate from my entity classes (which are straight python).

I have a feeling that this solution may be slow-performing, but that 
doesn't matter for what I'm doing now.  The only other problem is that 
you are replacing all of the servlet's handling of HTML, and there are 
some patterns that you have to follow to keep the whole thing working.

If there's any interest, I can post an annotated example.

-Chris

Miles K. Forrest wrote:

>>I would also really like to see more examples. And get some advice :)!
>>    
>>
>
>Glad I'm not alone :)  Thanks everyone for your feedback and links to
>working mod_python sites.  I'm beginning to see that mod_python's
>ability to open up the insides of apache is something really powerful.
> I also get the sense that it's not meant for "newbies" like me who
>are used to building webpages with Windows tools like Dreamweaver and
>putting in the dynamic plumming with PHP.
>
>But I _want_ to learn.  And I'd like to seperate the HTML and Python
>code so I can still rely on HTML designers who, unlike myself, know
>how to build nice looking pages.  And I'd like to use Python.  But I
>can't seem to get a platform working.
>
>I figure I need to use templating to seperate the HTML and Python
>code.  I've read Grisha's article at onlamp.com:
>
>http://www.onlamp.com/pub/a/python/2004/02/26/python_server_pages.html
>
>I suppose having lots of choices when it comes to templating if you
>know what you're doing, but for someone like me the choice is
>difficult: which _should_ I choose?  Being told "it depends on what
>you're doing" doesn't help because I'm not sure what I'm going to do,
>I'm still learning.  I'm leaning towards PSP because it's built-in to
>mod_python, so it seems to me it will become a standard way of
>templating because it's already there.
>
>Can any gurus out there help guide this neophyte? (wincing a bit as I
>click send in fear of a "RTFM" retaliation - I've read so much my
>eyeballs are beginning to glaze over)
>
>Miles
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>  
>


From kevinsl at gmail.com  Mon Aug 16 18:21:35 2004
From: kevinsl at gmail.com (Kevin Lewandowski)
Date: Mon Aug 16 20:21:40 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <3f732c0b0408161721117bf746@mail.gmail.com>

> But I _want_ to learn.  And I'd like to seperate the HTML and Python
> code so I can still rely on HTML designers who, unlike myself, know

Discogs.com uses Clearsilver (www.clearsilver.net) as a templating
system so the html and python code are separated. It was awkward at
first but is especially useful because html changes can't break the
python code and python changes can't break the display. There are
numerous other advantages of going this route which are listed on
their website and I can attest to.


> difficult: which _should_ I choose?  Being told "it depends on what
> you're doing" doesn't help because I'm not sure what I'm going to do,

If you don't know what you're going to do then try everything. When
you decide what to do you'll have some ideas of what tool will be
best.
From neel at mediapulse.com  Mon Aug 16 21:24:03 2004
From: neel at mediapulse.com (Michael Neel)
Date: Mon Aug 16 20:24:10 2004
Subject: [mod_python] mod_python Live examples
References: <ca7fdd19040813132417bcc727@mail.gmail.com><C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <001c01c483f0$7ffd8f90$0400a8c0@clapton>

> Glad I'm not alone :)  Thanks everyone for your feedback and links to
> working mod_python sites.  I'm beginning to see that mod_python's
> ability to open up the insides of apache is something really powerful.
>  I also get the sense that it's not meant for "newbies" like me who
> are used to building webpages with Windows tools like Dreamweaver and
> putting in the dynamic plumming with PHP.

While it doesn't talk about python directly, reading Apache Modules in C and
Perl from O'Rielly contains a solid break down of the apache api mod_python
opens up.  I'm not sure if there is a version for 2.0 Apache out, but if you
learn 1.3 it's not hard to read some online stuff to make the jump.


> But I _want_ to learn.  And I'd like to seperate the HTML and Python
> code so I can still rely on HTML designers who, unlike myself, know
> how to build nice looking pages.  And I'd like to use Python.  But I
> can't seem to get a platform working.
>

I'd recommend draco or albatross, and work though their tutorials.

> I suppose having lots of choices when it comes to templating if you
> know what you're doing, but for someone like me the choice is
> difficult: which _should_ I choose?  Being told "it depends on what
> you're doing" doesn't help because I'm not sure what I'm going to do,
> I'm still learning.  I'm leaning towards PSP because it's built-in to
> mod_python, so it seems to me it will become a standard way of
> templating because it's already there.
>

PSP is "built in" but atm it's the new kid on the block.  IIRC sessions and
PSP appeared in 3.1.x  I've never cared for PHP/ASP/JSP so I admit I'm
probably not going to use PSP, but it has picked up a considerable amount of
interest judging from the list.  This means it's still in a molding stage,
so if you do decide to go with PSP don't be afraid to look at the souce and
send in a patch.  This may sound like a hugh undertaking, but if you dive
into it you'll see it's really not as hairy a beast as you thought.

Mike

From eric at ericwalstad.com  Mon Aug 16 18:29:29 2004
From: eric at ericwalstad.com (Eric Walstad)
Date: Mon Aug 16 20:29:38 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <200408161729.29284.eric@ericwalstad.com>

Hey Miles,

On Monday 16 August 2004 04:51 pm, Miles K. Forrest wrote:
[snip]
> But I _want_ to learn.  And I'd like to seperate the HTML and
> Python code so I can still rely on HTML designers who, unlike
> myself, know how to build nice looking pages.  And I'd like to use
> Python.  But I can't seem to get a platform working.
Sorry if you mentioned this in other posts, but do you have mod_python 
working using the tutorial and examples yet?  If not, I'd get those 
nailed down before you start experimenting with templating.  
Templating will be one more layer of stuff to have to debug and could 
result in more hair-pulling-late-night-frustrations.


> I suppose having lots of choices when it comes to templating if you
> know what you're doing, but for someone like me the choice is
> difficult: which _should_ I choose?  Being told "it depends on what
> you're doing" doesn't help because I'm not sure what I'm going to
> do, I'm still learning.  I'm leaning towards PSP because it's
> built-in to mod_python, so it seems to me it will become a standard
> way of templating because it's already there.
>
> Can any gurus out there help guide this neophyte? (wincing a bit as
> I click send in fear of a "RTFM" retaliation - I've read so much my
> eyeballs are beginning to glaze over)
Here's *this* neophyte's templating system of choice:
SimpleTAL
<http://www.owlfish.com/software/simpleTAL/>
"""
SimpleTAL is a stand alone Python implementation of the TAL, TALES and 
METAL specifications used in Zope to power HTML and XML templates. 
SimpleTAL is an independent implementation of TAL; there are no 
dependencies on Zope nor is any of the Zope work re-used.
"""

I like SimpleTAL because I already have experience with Zope's 
TAL/METAL templating system so there was no syntax for me to learn.  
Also, TAL plays VERY nicely with Dreamweaver, etc, as the syntax is 
XML.  Also, there's lots of documentation and examples for using 
Zope's Page Templates available out there.  (consider the terms ZPT, 
Zope Page Templates, TAL/METAL and SimpleTAL basically synonymous)

Here's a quote from Zope's TAL documentation that might give you an 
idea of how they work:
<http://www.zope.org/Documentation/Books/ZopeBook/2_6Edition/ZPT.stx>
"""
 How Page Templates Work

Page Templates use the Template Attribute Language (TAL). TAL consists 
of special tag attributes. For example, a dynamic page title might 
look like this:

<title tal:content="here/title">Page Title</title>

The tal:content attribute is a TAL statement. Since it has an XML 
namespace (the tal: part) most editing tools will not complain that 
they don't understand it, and will not remove it. It will not change 
the structure or appearance of the template when loaded into a 
WYSIWYG editor or a web browser. The name content indicates that it 
will set the text contained by the title tag, and the value 
"here/title" is an expression providing the text to insert into the 
tag. 
"""

In other words, the "Page Title" part above is replaced with the value 
of the variable named "title".

Of course, there are tags for looping, conditionals, etc.

I hope that helps.

Eric.
From gnb at itga.com.au  Tue Aug 17 11:41:42 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Mon Aug 16 20:41:49 2004
Subject: [mod_python] mod_python Live examples 
In-Reply-To: Your message of Mon, 16 Aug 2004 16:51:09 -0700.
Message-ID: <200408170041.KAA18250@lightning.itga.com.au>


milesf@gmail.com said:
> Can any gurus out there help guide this neophyte? (wincing a bit as I
> click send in fear of a "RTFM" retaliation - I've read so much my
> eyeballs are beginning to glaze over)

Well, a useful bit of TFF (as opposed to TFM) is here:

	http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.010.htp

... additions/updates here would be welcome!


From nick at dd.revealed.net  Mon Aug 16 20:53:57 2004
From: nick at dd.revealed.net (Nick)
Date: Mon Aug 16 20:54:04 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <1092704037.13647.3.camel@nick>

On Mon, 2004-08-16 at 18:51, Miles K. Forrest wrote:
> But I _want_ to learn.  And I'd like to seperate the HTML and Python
> code so I can still rely on HTML designers who, unlike myself, know
> how to build nice looking pages.  And I'd like to use Python.  But I
> can't seem to get a platform working.

Hate to sound like a broken record, but that's exactly what I built PSE
for:

http://nick.borko.org/pse

If you have an interest and have any problems setting this up, let me
know and I'll help you out.

Nick

From dg at sponsera.com  Mon Aug 16 22:57:23 2004
From: dg at sponsera.com (David Geller)
Date: Mon Aug 16 21:57:28 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <41216603.7070707@sponsera.com>

To me, templates and frameworks are two different animals! And you 
should be able to use one without the other!

For what it's worth, here has been my experience:


I. Templates
--------------

1. I used (and still do, in one application) simpleTAL from owlfish, 
which implements zope's ZPT. It works fine, and I had no problems with it.

At first, I thought I liked the ZPT way of doing things: it is a 
flexible templating language which uses "pure" HTML. This would be good 
for things like WYSIWYG html editors, and the like.

However, after using it for awhile, I found several limitations:

a. ZPT can *only* be used for html (or xml): NOT for javascript, style 
sheets or, more generally, anything else.

b. while you can do it, the idea of "building up" a complex page 
comprised of smaller snippets isn't really what ZPT was designed for. It 
  seems like it is designed to build an entire page at once. For some 
things this is fine; for others, not quite.


2. I discovered Cheetah, and must say, it has met all of my needs. For 
now, at least, it is my python templating engine of choice.

a. Extremely flexible - can be used for *any* text templating, not just 
pure html/xml code

b. Although I haven't benchmarked it, I would suspect it would be quite 
"fast" - i.e., run at basically python speeds if you pre-compile the 
templates. I haven't yet had the need to do this - and it seems to work 
fast enough for my purposes using the cheetah templates directly.

c. Cheetah's facilities are way beyond what I have used - basically, I 
do the bulk of processing in python, and pass very simple variables to 
the template. In some cases, the template needs to do a little 
processing  (for complex formatting like alternating styles for lines in 
a table and the like), but for the most part I use it just to substitute 
variables. The obvious rule: process the actual data in python; display 
logic, etc. in cheetah, so there is almost a total separation.

d. While the cheetah language is not strictly python, it meshes with 
python in a very natural way. This theoretically makes the designing of 
templates easy for non-programmer types. Just keep the logic in the 
templates SIMPLE.

3. There are ****many**** other templating engines out there. I just 
came across a new one (on me) yesterday: "empy" which is something like 
a python version of m4 (I think it is slow, though, and not meant for 
dynamic situations)


II. Frameworks
--------------

I have checked out several python frameworks. So far, to be honest, I 
have not found the "one for me". There are some that are obviously very 
good, but for one reason or another, have problems for my way of doing 
things. So, I have basically written my own (at least for the time 
being), which is very very simple, but gets the job done. And it's easy 
to debug!

What I have found for many things out there - they are too complex for 
their own good! It believe in KISS, and in modularity to the extreme - a 
framework should not require you to do "everything" their way.

The frameworks I have checked out:

1. slither - I really liked this, but doesn't have a "critical mass", 
and the developers of it don't seem to want to create an environment so 
it can be supported. Too bad, because with a few changes, I meets my 
criteria of: simple + powerful.

2. webware - quite good, and quite extensive. Maybe a little complex for 
my tastes. What I really don't like about it is the need for a separate 
process - we at the mod_python group believe in apache, so why not have 
webare run via a mod_python handler directly under apache control, with 
apache threading, etc? To me, this would make it a far more desirable 
and reliable system.

3. mod_python servelets - looked at this, and it might be worthwhile, 
but haven't tried it yet

4. cheerypy - cool, but an entire "religion", requiring a special 
compilation phase, etc.

5. albatross - might be ok, but it seems to require the use of its own 
templating language.

6. quixote - I didn't like the "inside-out" approach of embedding html 
in python.

7. twisted - isn't a framework! But really cool toolkit if you want to 
do sophisticated web-enabled applications.

CONCLUSIONS:

1. Python is wonderful! BUT

2. The world of Python for the Web needs alot of work. Other than Zope, 
there doesn't seem to be a consensus for what the best way of doing 
things is! Now, that is a good thing (if "choice" = "good"), but it is 
also daunting to the newbie, and makes it hard for someone who knows a 
little more to convince a newbie that Python is the way to go for the 
web (which it IS, in my opinion, for many situations).

3. I think the python community needs a ..."plan" of some sort, to try 
to come up with recommendations, tools, basic elements, etc., so new 
folks might have a much better idea of at least how to get started 
building web apps in python with a minimum of grief....

My 2 cents...

Cheers,
David

From gnb at itga.com.au  Tue Aug 17 13:24:08 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Mon Aug 16 22:24:12 2004
Subject: [mod_python] mod_python Live examples 
In-Reply-To: Your message of Mon, 16 Aug 2004 21:57:23 -0400.
Message-ID: <200408170224.MAA27230@lightning.itga.com.au>


I've updated the templating/framework FAQ (several times - my apologies to
anyone watching it with RSS!) and added links to several new options that have 
been raised in this thread.

I also added a link to David Geller's excellent summary email.  Thanks David!


From amix at amix.dk  Tue Aug 17 08:24:02 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Tue Aug 17 01:24:13 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <A6965E50-F00D-11D8-A444-000A95B2E4E0@amix.dk>

Hello Miles

I have tried several external systems (PSE, Albatross and Quixote) to 
use with mod_python. And I really didn't like them - - Resaon: I really 
don't like to learn an extra language just do template some HTML 
templateing.

I come up with, that the most simplest and powerful way to do 
templateing is:
- Using publisher as your handler
- Using PSP as your template system

Now, this can be because I do both the code and design myself. And 
because I use XHTML+CSS combo (i.e. most of my HTML is just div 
layers). But if I didn't do both things myself, I really doubt any 
designer will want to learn an extra language to design websites. Other 
than that, if you cooperate on websitets then consider SimpleTal - it 
looks very design-friendly.

Anyway, if I was you, I would start off with publisher and PSP. They 
are very good at separating code from HTML - and you still use Python 
as your main language.

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

Den 17/8-2004, kl. 1.51, skrev Miles K. Forrest:

>> I would also really like to see more examples. And get some advice :)!
>
> Glad I'm not alone :)  Thanks everyone for your feedback and links to
> working mod_python sites.  I'm beginning to see that mod_python's
> ability to open up the insides of apache is something really powerful.
>  I also get the sense that it's not meant for "newbies" like me who
> are used to building webpages with Windows tools like Dreamweaver and
> putting in the dynamic plumming with PHP.
>
> But I _want_ to learn.  And I'd like to seperate the HTML and Python
> code so I can still rely on HTML designers who, unlike myself, know
> how to build nice looking pages.  And I'd like to use Python.  But I
> can't seem to get a platform working.
>
> I figure I need to use templating to seperate the HTML and Python
> code.  I've read Grisha's article at onlamp.com:
>
> http://www.onlamp.com/pub/a/python/2004/02/26/python_server_pages.html
>
> I suppose having lots of choices when it comes to templating if you
> know what you're doing, but for someone like me the choice is
> difficult: which _should_ I choose?  Being told "it depends on what
> you're doing" doesn't help because I'm not sure what I'm going to do,
> I'm still learning.  I'm leaning towards PSP because it's built-in to
> mod_python, so it seems to me it will become a standard way of
> templating because it's already there.
>
> Can any gurus out there help guide this neophyte? (wincing a bit as I
> click send in fear of a "RTFM" retaliation - I've read so much my
> eyeballs are beginning to glaze over)
>
> Miles
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From nferrier at tapsellferrier.co.uk  Tue Aug 17 10:36:25 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Tue Aug 17 05:36:26 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd190408161651417fc9b6@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
Message-ID: <873c2mkt2k.fsf@tapsellferrier.co.uk>

Miles said:

> But I _want_ to learn.  And I'd like to seperate the HTML and Python
> code so I can still rely on HTML designers who, unlike myself, know
> how to build nice looking pages.  And I'd like to use Python.  But I
> can't seem to get a platform working.
> 
> I figure I need to use templating to seperate the HTML and Python
> code.  I've read Grisha's article at onlamp.com:
> 
> http://www.onlamp.com/pub/a/python/2004/02/26/python_server_pages.html
> 
> I suppose having lots of choices when it comes to templating if you
> know what you're doing, but for someone like me the choice is
> difficult: which _should_ I choose?  Being told "it depends on what
> you're doing" doesn't help because I'm not sure what I'm going to do,
> I'm still learning.  I'm leaning towards PSP because it's built-in to
> mod_python, so it seems to me it will become a standard way of
> templating because it's already there.
> 
> Can any gurus out there help guide this neophyte? (wincing a bit as I
> click send in fear of a "RTFM" retaliation - I've read so much my
> eyeballs are beginning to glaze over)

I think one of the best ways to do templating is with XSLT. I find
that designers who understand XML can be quickly taught XSLT. It's
pretty natural and it's also quite common and not tied to one specific
language or operating system.

python and mod_python work well with XSLT.

If you're interested there are a couple of articles about it on my
website:

http://www.tapsellferrier.co.uk/nics-articles/python-servlets.html
http://www.tapsellferrier.co.uk/nics-articles/python-pipe-helper.html

I hope to be writing more and maybe putting up some on www.onlamp.com



Nic
From fabbe at paniq.net  Tue Aug 17 17:54:24 2004
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Tue Aug 17 09:54:50 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <41216603.7070707@sponsera.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
	<41216603.7070707@sponsera.com>
Message-ID: <1092750865.2907.34.camel@kernel>

On Mon, 2004-08-16 at 21:57 -0400, David Geller wrote:
> 2. The world of Python for the Web needs alot of work. Other than Zope, 
> there doesn't seem to be a consensus for what the best way of doing 
> things is! Now, that is a good thing (if "choice" = "good"), but it is 
> also daunting to the newbie, and makes it hard for someone who knows a 
> little more to convince a newbie that Python is the way to go for the 
> web (which it IS, in my opinion, for many situations).
> 
> 3. I think the python community needs a ..."plan" of some sort, to try 
> to come up with recommendations, tools, basic elements, etc., so new 
> folks might have a much better idea of at least how to get started 
> building web apps in python with a minimum of grief....

You may want to check out the Python Web SIG
(http://www.python.org/sigs/web-sig/) although it's perhaps approaching
the issue from a slightly different angle.

What I think would be most useful would be a series of documents
describing different solution patterns in general, and practical
examples to go along. The problem is, people coming from the "HTML
embedded web application" world (PHP, ASP) see things very differently
than people coming from the "two-tier business-logic-HTML-
renderer" (mod_perl?) world, and then there is still the "constantly
running business-logic-in-a-servlet" world (Java Servlets).

As I'm sure quite a few people have experienced, it can be almost
impossible to get your head around a different way of looking at things,
unless someone shows you the underlying patterns and lets you compare
them side-by-side. I'd say it's even harder than learning from scratch,
because you have to un-learn what you knew from before.

I've seen some great documentation contributions announced or referenced
on this list, but most of these documents exist in isolation and suffer
from the same problem as described above, but of a milder sort. I'd like
to collect some of these patterns, so if you have experience with any
web development software, then I'd be glad to hear from you. Just
explain what it does, and what your mental picture of it looks like. If
you'd be given only a few paragraphs to outline the most important
things about it, how would you express yourself?

Cheers,
-- 
Fabian Fagerholm <fabbe@paniq.net>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040817/b09e1a77/attachment.bin
From grisha at modpython.org  Tue Aug 17 11:04:56 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Aug 17 10:05:05 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <412125E6.9070000@research.att.com>
References: <411D017E.2040905@research.att.com>
	<20040813163603.F31783@onyx.ispol.com>
	<411E83B3.90601@research.att.com> <4120EA18.1020706@research.att.com>
	<20040816163044.B90060@onyx.ispol.com>
	<412125E6.9070000@research.att.com>
Message-ID: <20040817095844.X5478@onyx.ispol.com>


By "getting back" I meant having any access to it. Once it's written out, 
the data becomes owned by the next module/filter in the filter chain. The 
only way to do this would be for mod_python to do its own buffering, 
which it does not.

Grisha

On Mon, 16 Aug 2004, Iker Arizmendi wrote:

> I don't need to get it back, I just need to clear it so
> I can send just the error page without any dangling output
> from the faulty page. I guess one solution is to write the
> output to a buffer in Python code and only call req.write
> once all processing is complete. But this would eliminate
> the need for PSP (unless PSP offers a way to direct it's
> output to my own buffer).
>
> Iker
>
>
> Gregory (Grisha) Trubetskoy wrote:
>> 
>> Hmm... The buffer that buffers output is controlled by Apache, and AFAIK 
>> once something's been written to it, you cannot get it back.
>> 
>> Grisha
>> 
>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>> 
>>> One problem I've encountered with using set_error_page()
>>> for error handling is that often the faulty page has already
>>> generated some output when the error is encountered. This
>>> results in garbled pages with bits from both the error-raising
>>> page and the error-catching page.
>>> 
>>> Is there some way to get around this?
>>> 
>>> Regards,
>>> Iker
>>> 
>>> 
>>> Iker Arizmendi wrote:
>>> 
>>>> Thanks Greg. Is there a method that clears the
>>>> current output buffer as well?
>>>> 
>>>> Gregory (Grisha) Trubetskoy wrote:
>>>> 
>>>>> 
>>>>> Yes, by default PSP does not flush the output buffer until the very 
>>>>> end which looks like what PHP ob_start func enables. If you want to 
>>>>> force a flush from within PSP, you can always call req.flush().
>>>>> 
>>>>> Grisha
>>>>> 
>>>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>>>> 
>>>>>> Does the PSP handler support output buffering?
>>>>>> Something along the lines of ob_start under PHP? If
>>>>>> explicit support is not there, is there some other
>>>>>> way to accomplish the same thing?
>>>>>> 
>>>>>> Thanks,
>>>>>> Iker
>>>>>> 
>>>> 
>>> 
>
> -- 
> Iker Arizmendi
> AT&T Labs - Research
> Speech and Image Processing Lab
> e: iker@research.att.com
> w: http://research.att.com
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From nick at dd.revealed.net  Tue Aug 17 10:08:49 2004
From: nick at dd.revealed.net (Nick)
Date: Tue Aug 17 10:08:59 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <20040817095844.X5478@onyx.ispol.com>
References: <411D017E.2040905@research.att.com>	<20040813163603.F31783@onyx.ispol.com>	<411E83B3.90601@research.att.com>
	<4120EA18.1020706@research.att.com>	<20040816163044.B90060@onyx.ispol.com>	<412125E6.9070000@research.att.com>
	<20040817095844.X5478@onyx.ispol.com>
Message-ID: <41221171.2090005@dd.revealed.net>

It is simple enough to do your own buffering with a CStringIO, which is 
relatively fast and file-like, and then sending the resulting buffer at the 
end of your handler to req.write.

Nick

Gregory (Grisha) Trubetskoy wrote:

> 
> By "getting back" I meant having any access to it. Once it's written 
> out, the data becomes owned by the next module/filter in the filter 
> chain. The only way to do this would be for mod_python to do its own 
> buffering, which it does not.
> 
> Grisha
> 
> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
> 
>> I don't need to get it back, I just need to clear it so
>> I can send just the error page without any dangling output
>> from the faulty page. I guess one solution is to write the
>> output to a buffer in Python code and only call req.write
>> once all processing is complete. But this would eliminate
>> the need for PSP (unless PSP offers a way to direct it's
>> output to my own buffer).
>>
>> Iker
>>
>>
>> Gregory (Grisha) Trubetskoy wrote:
>>
>>>
>>> Hmm... The buffer that buffers output is controlled by Apache, and 
>>> AFAIK once something's been written to it, you cannot get it back.
>>>
>>> Grisha
>>>
>>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>>>
>>>> One problem I've encountered with using set_error_page()
>>>> for error handling is that often the faulty page has already
>>>> generated some output when the error is encountered. This
>>>> results in garbled pages with bits from both the error-raising
>>>> page and the error-catching page.
>>>>
>>>> Is there some way to get around this?
>>>>
>>>> Regards,
>>>> Iker
>>>>
>>>>
>>>> Iker Arizmendi wrote:
>>>>
>>>>> Thanks Greg. Is there a method that clears the
>>>>> current output buffer as well?
>>>>>
>>>>> Gregory (Grisha) Trubetskoy wrote:
>>>>>
>>>>>>
>>>>>> Yes, by default PSP does not flush the output buffer until the 
>>>>>> very end which looks like what PHP ob_start func enables. If you 
>>>>>> want to force a flush from within PSP, you can always call 
>>>>>> req.flush().
>>>>>>
>>>>>> Grisha
>>>>>>
>>>>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>>>>>
>>>>>>> Does the PSP handler support output buffering?
>>>>>>> Something along the lines of ob_start under PHP? If
>>>>>>> explicit support is not there, is there some other
>>>>>>> way to accomplish the same thing?
>>>>>>>
>>>>>>> Thanks,
>>>>>>> Iker
>>>>>>>
>>>>>
>>>>
>>
>> -- 
>> Iker Arizmendi
>> AT&T Labs - Research
>> Speech and Image Processing Lab
>> e: iker@research.att.com
>> w: http://research.att.com
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Tue Aug 17 12:11:17 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Aug 17 11:11:21 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <41221171.2090005@dd.revealed.net>
References: <411D017E.2040905@research.att.com>
	<20040813163603.F31783@onyx.ispol.com>
	<411E83B3.90601@research.att.com> <4120EA18.1020706@research.att.com>
	<20040816163044.B90060@onyx.ispol.com>
	<412125E6.9070000@research.att.com>
	<20040817095844.X5478@onyx.ispol.com>
	<41221171.2090005@dd.revealed.net>
Message-ID: <20040817110956.B6732@onyx.ispol.com>


Yes, but Iker's problem is that it's not that simple to use with PSP, 
which uses req.write()...

On Tue, 17 Aug 2004, Nick wrote:

> It is simple enough to do your own buffering with a CStringIO, which is 
> relatively fast and file-like, and then sending the resulting buffer at the 
> end of your handler to req.write.
>
> Nick
>
> Gregory (Grisha) Trubetskoy wrote:
>
>> 
>> By "getting back" I meant having any access to it. Once it's written out, 
>> the data becomes owned by the next module/filter in the filter chain. The 
>> only way to do this would be for mod_python to do its own buffering, which 
>> it does not.
>> 
>> Grisha
>> 
>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>> 
>>> I don't need to get it back, I just need to clear it so
>>> I can send just the error page without any dangling output
>>> from the faulty page. I guess one solution is to write the
>>> output to a buffer in Python code and only call req.write
>>> once all processing is complete. But this would eliminate
>>> the need for PSP (unless PSP offers a way to direct it's
>>> output to my own buffer).
>>> 
>>> Iker
>>> 
>>> 
>>> Gregory (Grisha) Trubetskoy wrote:
>>> 
>>>> 
>>>> Hmm... The buffer that buffers output is controlled by Apache, and 
>>>> AFAIK once something's been written to it, you cannot get it back.
>>>> 
>>>> Grisha
>>>> 
>>>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>>>> 
>>>>> One problem I've encountered with using set_error_page()
>>>>> for error handling is that often the faulty page has already
>>>>> generated some output when the error is encountered. This
>>>>> results in garbled pages with bits from both the error-raising
>>>>> page and the error-catching page.
>>>>> 
>>>>> Is there some way to get around this?
>>>>> 
>>>>> Regards,
>>>>> Iker
>>>>> 
>>>>> 
>>>>> Iker Arizmendi wrote:
>>>>> 
>>>>>> Thanks Greg. Is there a method that clears the
>>>>>> current output buffer as well?
>>>>>> 
>>>>>> Gregory (Grisha) Trubetskoy wrote:
>>>>>> 
>>>>>>> 
>>>>>>> Yes, by default PSP does not flush the output buffer until the 
>>>>>>> very end which looks like what PHP ob_start func enables. If you 
>>>>>>> want to force a flush from within PSP, you can always call 
>>>>>>> req.flush().
>>>>>>> 
>>>>>>> Grisha
>>>>>>> 
>>>>>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>>>>>> 
>>>>>>>> Does the PSP handler support output buffering?
>>>>>>>> Something along the lines of ob_start under PHP? If
>>>>>>>> explicit support is not there, is there some other
>>>>>>>> way to accomplish the same thing?
>>>>>>>> 
>>>>>>>> Thanks,
>>>>>>>> Iker
>>>>>>>> 
>>>>>> 
>>>>> 
>>> 
>>> -- 
>>> Iker Arizmendi
>>> AT&T Labs - Research
>>> Speech and Image Processing Lab
>>> e: iker@research.att.com
>>> w: http://research.att.com
>>> 
>>> 
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>> 
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From gabriel.cooper at mediapulse.com  Tue Aug 17 12:14:27 2004
From: gabriel.cooper at mediapulse.com (Gabriel Cooper)
Date: Tue Aug 17 11:14:31 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <ca7fdd19040813132417bcc727@mail.gmail.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
Message-ID: <412220D3.9080302@mediapulse.com>



Miles K. Forrest wrote:

>Does anyone have a comprehensive list of websites running mod_python? 
>
Not comprehensive, to be sure, but this should do:

http://www.pythonology.com/spotting
From nick at dd.revealed.net  Tue Aug 17 11:14:39 2004
From: nick at dd.revealed.net (Nick)
Date: Tue Aug 17 11:15:08 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <20040817110956.B6732@onyx.ispol.com>
References: <411D017E.2040905@research.att.com>	<20040813163603.F31783@onyx.ispol.com>	<411E83B3.90601@research.att.com>
	<4120EA18.1020706@research.att.com>	<20040816163044.B90060@onyx.ispol.com>	<412125E6.9070000@research.att.com>	<20040817095844.X5478@onyx.ispol.com>	<41221171.2090005@dd.revealed.net>
	<20040817110956.B6732@onyx.ispol.com>
Message-ID: <412220DF.1080907@dd.revealed.net>

I don't know how mutable req is, but couldn't you replace write with a 
StringIO write function early in the execution?

Nick

Gregory (Grisha) Trubetskoy wrote:

> 
> Yes, but Iker's problem is that it's not that simple to use with PSP, 
> which uses req.write()...
> 
> On Tue, 17 Aug 2004, Nick wrote:
> 
>> It is simple enough to do your own buffering with a CStringIO, which 
>> is relatively fast and file-like, and then sending the resulting 
>> buffer at the end of your handler to req.write.
>>
>> Nick
>>
>> Gregory (Grisha) Trubetskoy wrote:
>>
>>>
>>> By "getting back" I meant having any access to it. Once it's written 
>>> out, the data becomes owned by the next module/filter in the filter 
>>> chain. The only way to do this would be for mod_python to do its own 
>>> buffering, which it does not.
>>>
>>> Grisha
>>>
>>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>>>
>>>> I don't need to get it back, I just need to clear it so
>>>> I can send just the error page without any dangling output
>>>> from the faulty page. I guess one solution is to write the
>>>> output to a buffer in Python code and only call req.write
>>>> once all processing is complete. But this would eliminate
>>>> the need for PSP (unless PSP offers a way to direct it's
>>>> output to my own buffer).
>>>>
>>>> Iker
>>>>
>>>>
>>>> Gregory (Grisha) Trubetskoy wrote:
>>>>
>>>>>
>>>>> Hmm... The buffer that buffers output is controlled by Apache, and 
>>>>> AFAIK once something's been written to it, you cannot get it back.
>>>>>
>>>>> Grisha
>>>>>
>>>>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>>>>>
>>>>>> One problem I've encountered with using set_error_page()
>>>>>> for error handling is that often the faulty page has already
>>>>>> generated some output when the error is encountered. This
>>>>>> results in garbled pages with bits from both the error-raising
>>>>>> page and the error-catching page.
>>>>>>
>>>>>> Is there some way to get around this?
>>>>>>
>>>>>> Regards,
>>>>>> Iker
>>>>>>
>>>>>>
>>>>>> Iker Arizmendi wrote:
>>>>>>
>>>>>>> Thanks Greg. Is there a method that clears the
>>>>>>> current output buffer as well?
>>>>>>>
>>>>>>> Gregory (Grisha) Trubetskoy wrote:
>>>>>>>
>>>>>>>>
>>>>>>>> Yes, by default PSP does not flush the output buffer until the 
>>>>>>>> very end which looks like what PHP ob_start func enables. If you 
>>>>>>>> want to force a flush from within PSP, you can always call 
>>>>>>>> req.flush().
>>>>>>>>
>>>>>>>> Grisha
>>>>>>>>
>>>>>>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>>>>>>>
>>>>>>>>> Does the PSP handler support output buffering?
>>>>>>>>> Something along the lines of ob_start under PHP? If
>>>>>>>>> explicit support is not there, is there some other
>>>>>>>>> way to accomplish the same thing?
>>>>>>>>>
>>>>>>>>> Thanks,
>>>>>>>>> Iker
>>>>>>>>>
>>>>>>>
>>>>>>
>>>>
>>>> -- 
>>>> Iker Arizmendi
>>>> AT&T Labs - Research
>>>> Speech and Image Processing Lab
>>>> e: iker@research.att.com
>>>> w: http://research.att.com
>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Tue Aug 17 12:16:56 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Aug 17 11:16:59 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <1092750865.2907.34.camel@kernel>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
	<41216603.7070707@sponsera.com> <1092750865.2907.34.camel@kernel>
Message-ID: <20040817111225.A6732@onyx.ispol.com>


On Tue, 17 Aug 2004, Fabian Fagerholm wrote:

> What I think would be most useful would be a series of documents
> describing different solution patterns in general, and practical
> examples to go along. The problem is, people coming from the "HTML
> embedded web application" world (PHP, ASP) see things very differently
> than people coming from the "two-tier business-logic-HTML-
> renderer" (mod_perl?) world, and then there is still the "constantly
> running business-logic-in-a-servlet" world (Java Servlets).

I'd like to add that we don't have to play into any of these camps, 
because there may well exist a better web development paradigm than any of 
the above, one that somehow takes advantage of Python's unique abilities 
that differentiate it from other languages. I don't believe it has been 
discovered quite yet, but I think that that should be the thinking - 
something that works well in Python, NOT something that is "like" JSP, or 
Servlets, etc.

Grisha

From gabriel.cooper at mediapulse.com  Tue Aug 17 12:31:29 2004
From: gabriel.cooper at mediapulse.com (Gabriel Cooper)
Date: Tue Aug 17 11:31:31 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <412220D3.9080302@mediapulse.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<412220D3.9080302@mediapulse.com>
Message-ID: <412224D1.1080803@mediapulse.com>



Gabriel Cooper wrote:

>
>
> Miles K. Forrest wrote:
>
>> Does anyone have a comprehensive list of websites running mod_python?
>
> Not comprehensive, to be sure, but this should do:
>
> http://www.pythonology.com/spotting

My bad, that list isn't mod_python exclusive, but python in general.
From nick at dd.revealed.net  Tue Aug 17 11:37:31 2004
From: nick at dd.revealed.net (Nick)
Date: Tue Aug 17 11:37:41 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <20040817111225.A6732@onyx.ispol.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<41216603.7070707@sponsera.com>
	<1092750865.2907.34.camel@kernel>
	<20040817111225.A6732@onyx.ispol.com>
Message-ID: <4122263B.5010109@dd.revealed.net>

Gregory (Grisha) Trubetskoy wrote:
> I'd like to add that we don't have to play into any of these camps, 
> because there may well exist a better web development paradigm than any 
> of the above, one that somehow takes advantage of Python's unique 
> abilities that differentiate it from other languages. I don't believe it 
> has been discovered quite yet, but I think that that should be the 
> thinking - something that works well in Python, NOT something that is 
> "like" JSP, or Servlets, etc.

Rah, rah!  That's why I really like Python so much.  It's so powerful and 
versatile, and it stimulates that little center of my brain that enjoys 
programming.  I love seeing all the new and inventive ways people are using 
Python to accomplish tasks.  The language itself seems to encourage thinking 
outside the box.

Nick
From nick at dd.revealed.net  Tue Aug 17 11:39:20 2004
From: nick at dd.revealed.net (Nick)
Date: Tue Aug 17 11:39:34 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <412224D1.1080803@mediapulse.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<412220D3.9080302@mediapulse.com>
	<412224D1.1080803@mediapulse.com>
Message-ID: <412226A8.4080609@dd.revealed.net>

This is true; when I wrote the Rackspace article we weren't using mod_python 
at the time, but it is a great resource to show that REAL companies use 
Python seriously.

Nick

Gabriel Cooper wrote:
>> Not comprehensive, to be sure, but this should do:
>>
>> http://www.pythonology.com/spotting
> 
> My bad, that list isn't mod_python exclusive, but python in general.

From iker at research.att.com  Tue Aug 17 13:21:50 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Tue Aug 17 12:24:33 2004
Subject: [mod_python] set_error_page and output buffering
In-Reply-To: <20040817110956.B6732@onyx.ispol.com>
References: <411D017E.2040905@research.att.com>	<20040813163603.F31783@onyx.ispol.com>	<411E83B3.90601@research.att.com>
	<4120EA18.1020706@research.att.com>	<20040816163044.B90060@onyx.ispol.com>	<412125E6.9070000@research.att.com>	<20040817095844.X5478@onyx.ispol.com>	<41221171.2090005@dd.revealed.net>
	<20040817110956.B6732@onyx.ispol.com>
Message-ID: <4122309E.4010607@research.att.com>

Right, I don't think this can be solved on the
page writer's end without losing PSP's inline
support (eg, "<%=val%>").



Gregory (Grisha) Trubetskoy wrote:
> 
> Yes, but Iker's problem is that it's not that simple to use with PSP, 
> which uses req.write()...
> 
> On Tue, 17 Aug 2004, Nick wrote:
> 
>> It is simple enough to do your own buffering with a CStringIO, which 
>> is relatively fast and file-like, and then sending the resulting 
>> buffer at the end of your handler to req.write.
>>
>> Nick
>>
>> Gregory (Grisha) Trubetskoy wrote:
>>
>>>
>>> By "getting back" I meant having any access to it. Once it's written 
>>> out, the data becomes owned by the next module/filter in the filter 
>>> chain. The only way to do this would be for mod_python to do its own 
>>> buffering, which it does not.
>>>
>>> Grisha
>>>
>>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>>>
>>>> I don't need to get it back, I just need to clear it so
>>>> I can send just the error page without any dangling output
>>>> from the faulty page. I guess one solution is to write the
>>>> output to a buffer in Python code and only call req.write
>>>> once all processing is complete. But this would eliminate
>>>> the need for PSP (unless PSP offers a way to direct it's
>>>> output to my own buffer).
>>>>
>>>> Iker
>>>>
>>>>
>>>> Gregory (Grisha) Trubetskoy wrote:
>>>>
>>>>>
>>>>> Hmm... The buffer that buffers output is controlled by Apache, and 
>>>>> AFAIK once something's been written to it, you cannot get it back.
>>>>>
>>>>> Grisha
>>>>>
>>>>> On Mon, 16 Aug 2004, Iker Arizmendi wrote:
>>>>>
>>>>>> One problem I've encountered with using set_error_page()
>>>>>> for error handling is that often the faulty page has already
>>>>>> generated some output when the error is encountered. This
>>>>>> results in garbled pages with bits from both the error-raising
>>>>>> page and the error-catching page.
>>>>>>
>>>>>> Is there some way to get around this?
>>>>>>
>>>>>> Regards,
>>>>>> Iker
>>>>>>
>>>>>>
>>>>>> Iker Arizmendi wrote:
>>>>>>
>>>>>>> Thanks Greg. Is there a method that clears the
>>>>>>> current output buffer as well?
>>>>>>>
>>>>>>> Gregory (Grisha) Trubetskoy wrote:
>>>>>>>
>>>>>>>>
>>>>>>>> Yes, by default PSP does not flush the output buffer until the 
>>>>>>>> very end which looks like what PHP ob_start func enables. If you 
>>>>>>>> want to force a flush from within PSP, you can always call 
>>>>>>>> req.flush().
>>>>>>>>
>>>>>>>> Grisha
>>>>>>>>
>>>>>>>> On Fri, 13 Aug 2004, Iker Arizmendi wrote:
>>>>>>>>
>>>>>>>>> Does the PSP handler support output buffering?
>>>>>>>>> Something along the lines of ob_start under PHP? If
>>>>>>>>> explicit support is not there, is there some other
>>>>>>>>> way to accomplish the same thing?
>>>>>>>>>
>>>>>>>>> Thanks,
>>>>>>>>> Iker
>>>>>>>>>
>>>>>>>
>>>>>>
>>>>
>>>> -- 
>>>> Iker Arizmendi
>>>> AT&T Labs - Research
>>>> Speech and Image Processing Lab
>>>> e: iker@research.att.com
>>>> w: http://research.att.com
>>>>
>>>>
>>>> _______________________________________________
>>>> Mod_python mailing list
>>>> Mod_python@modpython.org
>>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com
p: 973-360-8516

From amix at amix.dk  Tue Aug 17 19:29:17 2004
From: amix at amix.dk (Amir Salihefendic)
Date: Tue Aug 17 12:29:24 2004
Subject: [mod_python] Introducing AnalyzeThat!
Message-ID: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>

I was pretty tired of the way that you test out stuff in mod_python. 
I.e. you use req.write(variable), req.write(dir(object)) etc.

Therefor I sat down - and thought of a good way to analyze stuff.
I thought, let's make it this way:
- Throw anything in - abracadabra - you get some informative output - 
that also is readable.
And some hours later I have class AnalyzeThat :-)

Throw anything in AnalyzeThat and it generates some informative and 
readable output.
Following types are supported (i.e. there are written explicit handlers 
for them):
Int, Str, Tuple, List, Dict, Module and Function. I had also support 
for boolean (but it does not work in Python 2.2, so I removed it 
again).
Other types are also supported - they just don't have their own 
handlers.

For a better overview check out:
http://amix.dk/at/index.py

If anybody has any additions I would be very glad to implement them - - 
in the final version of the class.

Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity

From mlists at rotondo.it  Tue Aug 17 20:11:26 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Tue Aug 17 13:08:30 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <41223C3E.4060201@rotondo.it>

Amir Salihefendic wrote:

Amir,

> http://amix.dk/at/index.py
> 
> If anybody has any additions I would be very glad to implement them - - 
> in the final version of the class.

it looks very interesting :-)
Now, if only the last table would use CSS and not just a border="1", it 
would look much greater.

Can I help you with coding?

Ciao,
   Fabio
From neel at mediapulse.com  Tue Aug 17 14:13:19 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Aug 17 13:11:09 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <1092762799.16727.47.camel@mike.mediapulse.com>

Do you have the source up somewhere for download (i didn't see a link on
the page)?

Mike

On Tue, 2004-08-17 at 12:29, Amir Salihefendic wrote:

> I was pretty tired of the way that you test out stuff in mod_python. 
> I.e. you use req.write(variable), req.write(dir(object)) etc.
> 
> Therefor I sat down - and thought of a good way to analyze stuff.
> I thought, let's make it this way:
> - Throw anything in - abracadabra - you get some informative output - 
> that also is readable.
> And some hours later I have class AnalyzeThat :-)
> 
> Throw anything in AnalyzeThat and it generates some informative and 
> readable output.
> Following types are supported (i.e. there are written explicit handlers 
> for them):
> Int, Str, Tuple, List, Dict, Module and Function. I had also support 
> for boolean (but it does not work in Python 2.2, so I removed it 
> again).
> Other types are also supported - they just don't have their own 
> handlers.
> 
> For a better overview check out:
> http://amix.dk/at/index.py
> 
> If anybody has any additions I would be very glad to implement them - - 
> in the final version of the class.
> 
> Kind regards
> Amir Salihefendic
> -----
> What we do in life echoes in eternity
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

__________________________________ 

michael.neel@mediapulse.com
vice president of information systems
865.675.4455 x30
800.380.4514

www.mediapulse.com
__________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040817/31a78ee6/attachment.html
From nick at dd.revealed.net  Tue Aug 17 13:17:39 2004
From: nick at dd.revealed.net (Nick)
Date: Tue Aug 17 13:17:50 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <41223DB3.4070605@dd.revealed.net>

Very nifty and pretty.  For the pathetically lazy (like myself) I often call 
pydoc.html.document(object) or pydoc.text.document(object) when debugging. 
Not as complete and pretty as what Amir has written, though, and it doesn't 
introspect objects.  And the html links won't work of course, but the text 
version can be handy in logs.

Nick

Amir Salihefendic wrote:

> I was pretty tired of the way that you test out stuff in mod_python. 
> I.e. you use req.write(variable), req.write(dir(object)) etc.
> 
> Therefor I sat down - and thought of a good way to analyze stuff.
> I thought, let's make it this way:
> - Throw anything in - abracadabra - you get some informative output - 
> that also is readable.
> And some hours later I have class AnalyzeThat :-)
> 
> Throw anything in AnalyzeThat and it generates some informative and 
> readable output.
> Following types are supported (i.e. there are written explicit handlers 
> for them):
> Int, Str, Tuple, List, Dict, Module and Function. I had also support for 
> boolean (but it does not work in Python 2.2, so I removed it again).
> Other types are also supported - they just don't have their own handlers.
> 
> For a better overview check out:
> http://amix.dk/at/index.py
> 
> If anybody has any additions I would be very glad to implement them - - 
> in the final version of the class.
> 
> Kind regards
> Amir Salihefendic
> -----
> What we do in life echoes in eternity
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From amix at amix.dk  Tue Aug 17 20:41:54 2004
From: amix at amix.dk (4mix)
Date: Tue Aug 17 13:42:01 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <41223C3E.4060201@rotondo.it>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
	<41223C3E.4060201@rotondo.it>
Message-ID: <BADD5907-F074-11D8-A444-000A95B2E4E0@amix.dk>

Hello again

http://amix.dk/at/at.zip
Here is the source if anybody wants to contribute - or use it (this is 
only a test version thought),
I have also added index.py - a publisher-handler primitive "unit-test".

Base class is AnalyzeThat.
Template class (where all the HTML stuff is created) is in class called 
AnalyzeThatTemplate
Handler class (which also has little HTML) is called 
AnalyzeThatHandlers.

The flow is:
AnalyzeThat.__init__;
Sets self.object
Sets self.type (type of the object)
Checks what type it is.
self.content is set depending on what type it is. Some types have their 
own handlers.

_renderLayer (located in AnalyzeThatTemplate) is called - it's main 
function is to get information form self.content and to write that info 
in HTML.

Be-aware: No documentation and shit loads of list comprehension's :-D
But I think it's easy to understand if you start off from class 
AnalyzeThat

4mix (http://amix.dk)
------------------------------------------------
What we do in life echoes in eternity

From fabbe at paniq.net  Tue Aug 17 23:07:03 2004
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Tue Aug 17 15:07:20 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <20040817111225.A6732@onyx.ispol.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
	<41216603.7070707@sponsera.com>
	<1092750865.2907.34.camel@kernel> <20040817111225.A6732@onyx.ispol.com>
Message-ID: <1092769623.2224.5.camel@kernel>

On Tue, 2004-08-17 at 11:16 -0400, Gregory (Grisha) Trubetskoy wrote:
> I'd like to add that we don't have to play into any of these camps, 
> because there may well exist a better web development paradigm than any of 
> the above, one that somehow takes advantage of Python's unique abilities 
> that differentiate it from other languages. I don't believe it has been 
> discovered quite yet, but I think that that should be the thinking - 
> something that works well in Python, NOT something that is "like" JSP, or 
> Servlets, etc.

I agree completely.

One way of finding that paradigm might be to look at what's available
right now, and try to solve some shortcomings in those solutions. I find
that looking at several solutions creates an idea in my mind that really
boils down to a generalization that will cover all the other ideas --
but which is more than the sum of the original parts.

But then there are always those who like to follow a ready-made
paradigm. They shouldn't be forgotten, because some of them will
eventually start thinking about yet "better ways", and become innovators
themselves.

So, I'd like again to ask for people's mental images of the tools you
use -- or the tools you'd like to use, which don't exist just yet.

Cheers,
-- 
Fabian Fagerholm <fabbe@paniq.net>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040817/7b32c977/attachment.bin
From milesf at gmail.com  Tue Aug 17 13:34:14 2004
From: milesf at gmail.com (Miles K. Forrest)
Date: Tue Aug 17 15:34:21 2004
Subject: [mod_python] Can't get mod_python's PSP 'Hello World' to work
Message-ID: <ca7fdd1904081712343c3aa8b7@mail.gmail.com>

I've been having difficulty configuring my Debian server to use PSP as
a templating system. Since I lack the verbage and expertise to explain
what I have/haven't done, I've made a webpage with snapshots outlining
the problem:

http://linuxhouse.org/tshooting/001.htm

Any ideas?
-- 
Cheers,

Miles K. Forrest
From amix at amix.dk  Tue Aug 17 22:42:47 2004
From: amix at amix.dk (4mix)
Date: Tue Aug 17 15:42:55 2004
Subject: [mod_python] Can't get mod_python's PSP 'Hello World' to work
In-Reply-To: <ca7fdd1904081712343c3aa8b7@mail.gmail.com>
References: <ca7fdd1904081712343c3aa8b7@mail.gmail.com>
Message-ID: <9DAB2062-F085-11D8-A444-000A95B2E4E0@amix.dk>

Hello

To solve your first problem, try out:
Add this in the top of hello function:
req.content_type = "text/html"

To sovle the second, try out going to:
pubpsp/hello?name=joe

Kind regards,
4mix (http://amix.dk)
------------------------------------------------
What we do in life echoes in eternity

Den 17/8-2004, kl. 21.34, skrev Miles K. Forrest:

> I've been having difficulty configuring my Debian server to use PSP as
> a templating system. Since I lack the verbage and expertise to explain
> what I have/haven't done, I've made a webpage with snapshots outlining
> the problem:
>
> http://linuxhouse.org/tshooting/001.htm
>
> Any ideas?
> -- 
> Cheers,
>
> Miles K. Forrest
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From yrbahn at nhncorp.jp  Wed Aug 18 12:00:22 2004
From: yrbahn at nhncorp.jp (=?ks_c_5601-1987?B?ud2/tbfP?=)
Date: Tue Aug 17 22:00:40 2004
Subject: [mod_python] python_handler: Dispatch() returned nothing.,
Message-ID: <000f01c484c7$1ed10670$020ba8c0@yrbahn>

i am using mod_python 3.1.13 and apache2.0.50.
sometimes, in logs, "python_handler: Dispatch() returned nothing.,"
appears. what is this? why do this message appears?
can you tell me this reason?

From robert at worksofmagic.com  Wed Aug 18 00:37:51 2004
From: robert at worksofmagic.com (Robert Geller)
Date: Tue Aug 17 23:37:50 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <412226A8.4080609@dd.revealed.net>
Message-ID: <004101c484d4$bde6f6e0$1e02a8c0@leet>

Sorry to get off-topic, but do you work for Rackspace Nick?

How do you guys (or Rackspace) use Python in your everyday operations?



Robert Geller
robert@worksofmagic.com



-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] On Behalf Of Nick
Sent: Tuesday, August 17, 2004 11:39 AM
To: mod_python user mailing list
Subject: Re: [mod_python] mod_python Live examples


This is true; when I wrote the Rackspace article we weren't using
mod_python 
at the time, but it is a great resource to show that REAL companies use 
Python seriously.

Nick

Gabriel Cooper wrote:
>> Not comprehensive, to be sure, but this should do:
>>
>> http://www.pythonology.com/spotting
> 
> My bad, that list isn't mod_python exclusive, but python in general.

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


From mlists at rotondo.it  Wed Aug 18 12:23:26 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Wed Aug 18 05:20:32 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <BADD5907-F074-11D8-A444-000A95B2E4E0@amix.dk>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>	<41223C3E.4060201@rotondo.it>
	<BADD5907-F074-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <4123200E.1000407@rotondo.it>

4mix wrote:
> Hello again
> 
> http://amix.dk/at/at.zip
> Here is the source if anybody wants to contribute - or use it (this is 
> only a test version thought),
> I have also added index.py - a publisher-handler primitive "unit-test".

Hi,

	I have played with your class.. Now it returns a string with all the 
information layer inside, without writing directly to req.
I have also added a new ``analyze()`` method to AnalyzeThat class that 
requires the object to be analized and returns a string (that can be 
printed everywhere).

You have done a pretty good work! (Even if pylint rates your code 
-3.50/10 :-))

Ciao,

   Fabio



-------------- next part --------------
A non-text attachment was scrubbed...
Name: at.zip
Type: application/zip
Size: 2285 bytes
Desc: not available
Url : http://modpython.org/pipermail/mod_python/attachments/20040818/a149336b/at.zip
From davidf at sjsoft.com  Wed Aug 18 12:51:22 2004
From: davidf at sjsoft.com (David Fraser)
Date: Wed Aug 18 05:51:27 2004
Subject: [mod_python] Debugging methods
In-Reply-To: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <4123269A.1050206@sjsoft.com>

Amir Salihefendic wrote:

> I was pretty tired of the way that you test out stuff in mod_python. 
> I.e. you use req.write(variable), req.write(dir(object)) etc.

Yes it can be tiring, looks interesting.
Thought I would throw in some methods I use for debugging:

Use the command line:
Run Apache server from command line with -DONE_PROCESS and just print to 
stdout - appears on screen.
This can be easier than adding stuff into the page using req.write, 
particularly if you don't have the request object at the right point in 
the program.

Reloader system:
I have a python script that lets me run Apache from the command line and 
restart it manually. It's a bit brutal (it kills the process and 
launches another one) but it makes for quick debugging. I find this 
means I can keep the given web page open, change the code quickly, 
restart Apache without having to worry about modules being reloaded etc. 
It's actually much quicker debugging web apps like this than standard 
apps, as you can keep all the state in the web browser and restart the 
server seamlessly underneath.
Of course, you don't want to do this on your production servers :-)

Logging input and output:
For debugging hard-to-understand problems on our client sites, I wrote a 
system that lets you configure client requests and response pages to be 
logged to a file. This has been invaluable when we can't get into the 
client machines and can't understand why it is doing something - they 
simple turn on recording and email us the resulting file.

David
From kamil at nvstudio.pl  Wed Aug 18 14:53:42 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Wed Aug 18 06:36:24 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <20040818135342.1246c29c.kamil@nvstudio.pl>

On Tue, 17 Aug 2004 18:29:17 +0200
Amir Salihefendic <amix@amix.dk> wrote:

> I was pretty tired of the way that you test out stuff in mod_python. 
> I.e. you use req.write(variable), req.write(dir(object)) etc.

Isn't it better to write some logging class with log levels similar
to those of syslog for example? You write your debug output to that
file and read it immediately in the other console window..
For example:

	logger = Log("/tmp/debug.log")
	logger.logWARN("some special condition")
	logger.logDEBUG("result: " + `some_variable`)
	
and so on. 

Then you read the file using 'tail -f' for example, which immediately
shows you new lines from /tmp/debug.log file. I've found this method
extremely comfortable to use.

You can write some disable/enable mechanism, so that you can later
do logger.setDebug(FALSE) to disable logging, which can affect
performance on production servers where there are a lot of processed
requests..

I think this is one of the best methods to debug web applications,
because it does not affect web page (like debugging using req.write()
which prints those values on the page)

Best regards,

/Kamil
From neel at mediapulse.com  Wed Aug 18 10:24:08 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Wed Aug 18 09:21:51 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <20040818135342.1246c29c.kamil@nvstudio.pl>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
	<20040818135342.1246c29c.kamil@nvstudio.pl>
Message-ID: <1092835448.14059.2.camel@mike.mediapulse.com>

On Wed, 2004-08-18 at 07:53, Kamil Niechajewicz wrote:

> On Tue, 17 Aug 2004 18:29:17 +0200
> Amir Salihefendic <amix@amix.dk> wrote:
> 
> > I was pretty tired of the way that you test out stuff in mod_python. 
> > I.e. you use req.write(variable), req.write(dir(object)) etc.
> 
> Isn't it better to write some logging class with log levels similar
> to those of syslog for example? You write your debug output to that
> file and read it immediately in the other console window..
> For example:
> 


As of python 2.3 there is a logging module that acts like this, and also
mod_python exposes the apache logging hooks if you wanted to put your
information into the apache error/debug logs and configure what goes
where from within apache.  I know the apache methods do and I believe
the logging module both handle several threads / processes writing to
the log file.

Mike
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040818/3f4cddc2/attachment.html
From nick at dd.revealed.net  Wed Aug 18 09:51:13 2004
From: nick at dd.revealed.net (Nick)
Date: Wed Aug 18 09:51:25 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <004101c484d4$bde6f6e0$1e02a8c0@leet>
References: <004101c484d4$bde6f6e0$1e02a8c0@leet>
Message-ID: <41235ED1.6020609@dd.revealed.net>

I no longer work at Rackspace, but I still work for Rackspace in the 
capacity of an independent contractor.  When I did work there, we started 
converting our internal behemoth PHP system to something a little more 
structured, testable and debuggable, i.e. Python.  You can read all about 
that in the link on the pythonology page, which is also in the O'Rielly 
"Python Success Stories" booklet (that was a freebee sent to bookstores I 
think, don't know if you can actually get copies).

Anyway, they still use it, in the capacity as a CGI that we original wrote a 
couple years back.  They have been helpful in shaping and testing PSE, which 
I wrote independently after I left Rackspace to use mod_python from the 
beginning.

I don't know what their plans are for the future of Python at Rackspace, if 
any -- I'm just a contractor.  I just want to caveat that in case they say 
tomorrow that Python sucks and PHP rules!

Nick

Robert Geller wrote:

> Sorry to get off-topic, but do you work for Rackspace Nick?
> 
> How do you guys (or Rackspace) use Python in your everyday operations?
> 
> Robert Geller
> robert@worksofmagic.com
> 
> 
> This is true; when I wrote the Rackspace article we weren't using
> mod_python 
> at the time, but it is a great resource to show that REAL companies use 
> Python seriously.
> 
> Nick
> 
> Gabriel Cooper wrote:
> 
>>>Not comprehensive, to be sure, but this should do:
>>>
>>>http://www.pythonology.com/spotting
>>
>>My bad, that list isn't mod_python exclusive, but python in general.

From milesf at gmail.com  Wed Aug 18 09:28:28 2004
From: milesf at gmail.com (Miles K. Forrest)
Date: Wed Aug 18 11:28:37 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <41235ED1.6020609@dd.revealed.net>
References: <004101c484d4$bde6f6e0$1e02a8c0@leet>
	<41235ED1.6020609@dd.revealed.net>
Message-ID: <ca7fdd19040818082819a90242@mail.gmail.com>

On Wed, 18 Aug 2004 08:51:13 -0500, Nick <nick@dd.revealed.net> wrote:
> I no longer work at Rackspace, but I still work for Rackspace in the
> capacity of an independent contractor.  When I did work there, we started
> converting our internal behemoth PHP system to something a little more
> structured, testable and debuggable, i.e. Python.  You can read all about
> that in the link on the pythonology page, which is also in the O'Rielly
> "Python Success Stories" booklet (that was a freebee sent to bookstores I
> think, don't know if you can actually get copies).

You can still get a pdf copy of that document here:

http://python.oreilly.com/news/python_success_stories.pdf
From donnie at darthik.com  Wed Aug 18 13:39:50 2004
From: donnie at darthik.com (donnie)
Date: Wed Aug 18 12:40:01 2004
Subject: [mod_python] Help with apache.import_module
Message-ID: <1092847190.5283.7.camel@sleek>

I am having problems importing a module when using mod_python.
Here is the error I receive...

--------begin-----------
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299, in HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 98, in handler
    path=[path])

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
    module = imp.load_module(mname, f, p, d)

  File "/var/www/python/blah.py", line 2, in ?
    mymodule = apache.import_module('mymodule', log=1)

  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 454, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named mymodule
----------end---------

This is the file I am executing.
filename: blah.py
--------begin-----------
from mod_python import apache
mymodule = apache.import_module('mymodule', log=1)

def main(req):
  num = 100
  blah = mymodule.mytest(num)
  req.write("this is a test, blah = %s" % blah)
  return
---------end----------

Here is the file that contains the module that I am trying to import.
filename: mymodule.py
--------begin----------
def mytest(num):
  blah = num
  return blah
--------end------------

I am not sure what I am doing wrong....
The files are located in /var/www/python/
and blah.py is loaded like this: http://localhost/python/blah.py

Any help would be greatly appreciated.
I am very new to python and modpython, but I am hooked!

Thank you.

--
Donnie

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040818/5e53ea1a/attachment.bin
From amix at amix.dk  Wed Aug 18 18:15:12 2004
From: amix at amix.dk (4mix)
Date: Wed Aug 18 13:15:14 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <20040818135342.1246c29c.kamil@nvstudio.pl>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>
	<20040818135342.1246c29c.kamil@nvstudio.pl>
Message-ID: <28C299DE-6AE3-11D8-A445-000A95B2E4E0@amix.dk>

Hello

To test out my applications I use unit-testing. In my opinion, that's 
the best way to test out a system.
With unit-tests you don't need to look through logs to find out an 
error - - it simply tells you where the problem is.

I simply use this class to get some information about objects.

4mix (http://amix.dk)
------------------------------------------------
What we do in life echoes in eternity

Den 18/8-2004, kl. 13.53, skrev Kamil Niechajewicz:

> On Tue, 17 Aug 2004 18:29:17 +0200
> Amir Salihefendic <amix@amix.dk> wrote:
>
>> I was pretty tired of the way that you test out stuff in mod_python.
>> I.e. you use req.write(variable), req.write(dir(object)) etc.
>
> Isn't it better to write some logging class with log levels similar
> to those of syslog for example? You write your debug output to that
> file and read it immediately in the other console window..
> For example:
>
> 	logger = Log("/tmp/debug.log")
> 	logger.logWARN("some special condition")
> 	logger.logDEBUG("result: " + `some_variable`)
> 	
> and so on.
>
> Then you read the file using 'tail -f' for example, which immediately
> shows you new lines from /tmp/debug.log file. I've found this method
> extremely comfortable to use.
>
> You can write some disable/enable mechanism, so that you can later
> do logger.setDebug(FALSE) to disable logging, which can affect
> performance on production servers where there are a lot of processed
> requests..
>
> I think this is one of the best methods to debug web applications,
> because it does not affect web page (like debugging using req.write()
> which prints those values on the page)
>
> Best regards,
>
> /Kamil
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From amix at amix.dk  Wed Aug 18 18:17:40 2004
From: amix at amix.dk (4mix)
Date: Wed Aug 18 13:17:42 2004
Subject: [mod_python] Introducing AnalyzeThat!
In-Reply-To: <4123200E.1000407@rotondo.it>
References: <95CE07E2-F06A-11D8-A444-000A95B2E4E0@amix.dk>	<41223C3E.4060201@rotondo.it>
	<BADD5907-F074-11D8-A444-000A95B2E4E0@amix.dk>
	<4123200E.1000407@rotondo.it>
Message-ID: <82E8D3DE-6AE3-11D8-A445-000A95B2E4E0@amix.dk>

> You have done a pretty good work! (Even if pylint rates your code 
> -3.50/10 :-))
I just started coding in python, and I haven't really looked on what 
the coding standards are.
I just code what seems to be the best way to solve a problem ;-) But of 
course I will read some stuff on how to improve my Py-Code.

4mix (http://amix.dk)
------------------------------------------------
What we do in life echoes in eternity

Den 18/8-2004, kl. 11.23, skrev Fabio Rotondo:

> 4mix wrote:
>> Hello again
>> http://amix.dk/at/at.zip
>> Here is the source if anybody wants to contribute - or use it (this 
>> is only a test version thought),
>> I have also added index.py - a publisher-handler primitive 
>> "unit-test".
>
> Hi,
>
> 	I have played with your class.. Now it returns a string with all the 
> information layer inside, without writing directly to req.
> I have also added a new ``analyze()`` method to AnalyzeThat class that 
> requires the object to be analized and returns a string (that can be 
> printed everywhere).
>
> You have done a pretty good work! (Even if pylint rates your code 
> -3.50/10 :-))
>
> Ciao,
>
>   Fabio
>
>
>
> <at.zip>_______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From donnie at darthik.com  Wed Aug 18 14:32:18 2004
From: donnie at darthik.com (donnie)
Date: Wed Aug 18 13:32:29 2004
Subject: [mod_python] Help with apache.import_module
In-Reply-To: <1092847190.5283.7.camel@sleek>
References: <1092847190.5283.7.camel@sleek>
Message-ID: <1092850338.5283.14.camel@sleek>

On Wed, 2004-08-18 at 12:39, donnie wrote:
> I am having problems importing a module when using mod_python.
> Here is the error I receive...
> 
> --------begin-----------
> Mod_python error: "PythonHandler mod_python.publisher"
> 
> Traceback (most recent call last):
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299, in HandlerDispatch
>     result = object(req)
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 98, in handler
>     path=[path])
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
>     module = imp.load_module(mname, f, p, d)
> 
>   File "/var/www/python/blah.py", line 2, in ?
>     mymodule = apache.import_module('mymodule', log=1)
> 
>   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 454, in import_module
>     f, p, d = imp.find_module(parts[i], path)
> 
> ImportError: No module named mymodule
> ----------end---------
> 
> This is the file I am executing.
> filename: blah.py
> --------begin-----------
> from mod_python import apache
> mymodule = apache.import_module('mymodule', log=1)
> 
> def main(req):
>   num = 100
>   blah = mymodule.mytest(num)
>   req.write("this is a test, blah = %s" % blah)
>   return
> ---------end----------
> 
> Here is the file that contains the module that I am trying to import.
> filename: mymodule.py
> --------begin----------
> def mytest(num):
>   blah = num
>   return blah
> --------end------------
> 
> I am not sure what I am doing wrong....
> The files are located in /var/www/python/
> and blah.py is loaded like this: http://localhost/python/blah.py
> 
> Any help would be greatly appreciated.
> I am very new to python and modpython, but I am hooked!
> 
> Thank you.
> 
> --
> Donnie
> 

Well, after testing and testing and trying again and again, I got it to
work!  haha... simple errors always get ya. ;-)

First problem, I wasn't calling the function in my url.
http://localhost/python/blah.py/main
That got the file to load, but mozilla was asking me to save the file
b.c it didn't know how to handle the file.

Second problem, I forgot to add:
req.content_type = "text/html"
req.send_http_header()

Well, hope that helps anyone else in the future.
Thanks.

--
Donnie



-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040818/61a569f7/attachment.bin
From donnie at darthik.com  Wed Aug 18 15:01:20 2004
From: donnie at darthik.com (donnie)
Date: Wed Aug 18 14:01:32 2004
Subject: Weirdness. Re: [mod_python] Help with apache.import_module
In-Reply-To: <1092850338.5283.14.camel@sleek>
References: <1092847190.5283.7.camel@sleek> <1092850338.5283.14.camel@sleek>
Message-ID: <1092852080.5283.27.camel@sleek>

Well, I thought I had it completely working...
I have found that I can only get the module that I am trying to import
to be found if I load that module through the url:
http://localhost/python/mymodule.py/mytest
before trying to access the module in the url:
http://localhost/python/blah.py/main

I guess apache can find the module once it has been loaded into memory,
but is not finding the module if it has not been loaded first?
This boggles my mind....?
Thanks.

--
Donnie

On Wed, 2004-08-18 at 13:32, donnie wrote:
> On Wed, 2004-08-18 at 12:39, donnie wrote:
> > I am having problems importing a module when using mod_python.
> > Here is the error I receive...
> > 
> > --------begin-----------
> > Mod_python error: "PythonHandler mod_python.publisher"
> > 
> > Traceback (most recent call last):
> > 
> >   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299, in HandlerDispatch
> >     result = object(req)
> > 
> >   File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 98, in handler
> >     path=[path])
> > 
> >   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
> >     module = imp.load_module(mname, f, p, d)
> > 
> >   File "/var/www/python/blah.py", line 2, in ?
> >     mymodule = apache.import_module('mymodule', log=1)
> > 
> >   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 454, in import_module
> >     f, p, d = imp.find_module(parts[i], path)
> > 
> > ImportError: No module named mymodule
> > ----------end---------
> > 
> > This is the file I am executing.
> > filename: blah.py
> > --------begin-----------
> > from mod_python import apache
> > mymodule = apache.import_module('mymodule', log=1)
> > 
> > def main(req):
> >   num = 100
> >   blah = mymodule.mytest(num)
> >   req.write("this is a test, blah = %s" % blah)
> >   return
> > ---------end----------
> > 
> > Here is the file that contains the module that I am trying to import.
> > filename: mymodule.py
> > --------begin----------
> > def mytest(num):
> >   blah = num
> >   return blah
> > --------end------------
> > 
> > I am not sure what I am doing wrong....
> > The files are located in /var/www/python/
> > and blah.py is loaded like this: http://localhost/python/blah.py
> > 
> > Any help would be greatly appreciated.
> > I am very new to python and modpython, but I am hooked!
> > 
> > Thank you.
> > 
> > --
> > Donnie
> > 
> 
> Well, after testing and testing and trying again and again, I got it to
> work!  haha... simple errors always get ya. ;-)
> 
> First problem, I wasn't calling the function in my url.
> http://localhost/python/blah.py/main
> That got the file to load, but mozilla was asking me to save the file
> b.c it didn't know how to handle the file.
> 
> Second problem, I forgot to add:
> req.content_type = "text/html"
> req.send_http_header()
> 
> Well, hope that helps anyone else in the future.
> Thanks.
> 
> --
> Donnie
> 
> 
> 
> 
> ______________________________________________________________________
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040818/d0126531/attachment.bin
From donnie at darthik.com  Wed Aug 18 15:32:05 2004
From: donnie at darthik.com (donnie)
Date: Wed Aug 18 14:32:16 2004
Subject: Weirdness. Re: [mod_python] Help with apache.import_module
In-Reply-To: <1092852080.5283.27.camel@sleek>
References: <1092847190.5283.7.camel@sleek> <1092850338.5283.14.camel@sleek>
	<1092852080.5283.27.camel@sleek>
Message-ID: <1092853924.5283.31.camel@sleek>

Alright, more information, haha.

After some investigation, I discovered that if I placed the
module(mymodule.py) in the /var/www then it would load fine, without
having to be loaded in the URL first.

Eventually, I checked out my apache2 configuration, and changed the
Directory to /var/www/python as you can see below, this has solved all
of my problems.  :-)

<Directory /var/www/python>
  AddHandler mod_python .py
  PythonHandler mod_python.publisher
  PythonDebug On
</Directory>

Thanks.

--
Donnie

On Wed, 2004-08-18 at 14:01, donnie wrote:
> Well, I thought I had it completely working...
> I have found that I can only get the module that I am trying to import
> to be found if I load that module through the url:
> http://localhost/python/mymodule.py/mytest
> before trying to access the module in the url:
> http://localhost/python/blah.py/main
> 
> I guess apache can find the module once it has been loaded into memory,
> but is not finding the module if it has not been loaded first?
> This boggles my mind....?
> Thanks.
> 
> --
> Donnie
> 
> On Wed, 2004-08-18 at 13:32, donnie wrote:
> > On Wed, 2004-08-18 at 12:39, donnie wrote:
> > > I am having problems importing a module when using mod_python.
> > > Here is the error I receive...
> > > 
> > > --------begin-----------
> > > Mod_python error: "PythonHandler mod_python.publisher"
> > > 
> > > Traceback (most recent call last):
> > > 
> > >   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 299, in HandlerDispatch
> > >     result = object(req)
> > > 
> > >   File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 98, in handler
> > >     path=[path])
> > > 
> > >   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 457, in import_module
> > >     module = imp.load_module(mname, f, p, d)
> > > 
> > >   File "/var/www/python/blah.py", line 2, in ?
> > >     mymodule = apache.import_module('mymodule', log=1)
> > > 
> > >   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 454, in import_module
> > >     f, p, d = imp.find_module(parts[i], path)
> > > 
> > > ImportError: No module named mymodule
> > > ----------end---------
> > > 
> > > This is the file I am executing.
> > > filename: blah.py
> > > --------begin-----------
> > > from mod_python import apache
> > > mymodule = apache.import_module('mymodule', log=1)
> > > 
> > > def main(req):
> > >   num = 100
> > >   blah = mymodule.mytest(num)
> > >   req.write("this is a test, blah = %s" % blah)
> > >   return
> > > ---------end----------
> > > 
> > > Here is the file that contains the module that I am trying to import.
> > > filename: mymodule.py
> > > --------begin----------
> > > def mytest(num):
> > >   blah = num
> > >   return blah
> > > --------end------------
> > > 
> > > I am not sure what I am doing wrong....
> > > The files are located in /var/www/python/
> > > and blah.py is loaded like this: http://localhost/python/blah.py
> > > 
> > > Any help would be greatly appreciated.
> > > I am very new to python and modpython, but I am hooked!
> > > 
> > > Thank you.
> > > 
> > > --
> > > Donnie
> > > 
> > 
> > Well, after testing and testing and trying again and again, I got it to
> > work!  haha... simple errors always get ya. ;-)
> > 
> > First problem, I wasn't calling the function in my url.
> > http://localhost/python/blah.py/main
> > That got the file to load, but mozilla was asking me to save the file
> > b.c it didn't know how to handle the file.
> > 
> > Second problem, I forgot to add:
> > req.content_type = "text/html"
> > req.send_http_header()
> > 
> > Well, hope that helps anyone else in the future.
> > Thanks.
> > 
> > --
> > Donnie
> > 
> > 
> > 
> > 
> > ______________________________________________________________________
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> ______________________________________________________________________
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040818/c2aa1223/attachment.bin
From mdragon at rackspace.com  Wed Aug 18 17:48:54 2004
From: mdragon at rackspace.com (Monsyne Dragon)
Date: Wed Aug 18 17:51:09 2004
Subject: [mod_python] Bizzare mod_python behavior (2 HTTP Responses for 1
	Request?!)
Message-ID: <200408181648.54779.mdragon@rackspace.com>


I have a mod_python app I am working on, and I am getting a bizzare reaction
from it. When I  do a request (get or post) apache returns TWO http
responses!! one is the correct response, the second looks like an
apache-generated html page that says the url is not found.
the http response code of both is 200 Ok.

The oddest thing is that this code works fine on another server!
Here is a an example request and response(s): (note this is running under
SSL.  )

++++++++++Begin+++++++++++++++++++++++++++++++++++++++++++++++++
GET /xmlrpc/Ticket HTTP/1.0
Host: core.some.com

HTTP/1.1 200 OK
Date: Mon, 16 Aug 2004 22:38:35 GMT
Server: Apache/1.3.27 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.2
mod_ssl/2.8.5 OpenSSL/0.9.6b PHP/4.2.2 mod_fastcgi/2.4.2
Connection: close
Content-Type: text/html

<html><head><title>Documentation</title></head><body><h1>Topics</h1><ul><li><
a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=createGenieTicket">createGenieTicket</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=createSubTicket">createSubTicket</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=createTicket">createTicket</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=getQueues">getQueues</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=getTicketCategories">getTicketCategories</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=getTicketSeverities">getTicketSeverities</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=getTicketSources">getTicketSources</a></li><li><a
 href="https://core.some.com:443/xmlrpc/Ticket?topic=getTicketSubcategories">
getTicketSubcategories</a></li></ul></body></html>HTTP/1.1 200 OK
Date: Mon, 16 Aug 2004 22:38:35 GMT
Server: Apache/1.3.27 (Unix)  (Red-Hat/Linux) mod_python/2.7.8 Python/2.2.2
mod_ssl/2.8.5 OpenSSL/0.9.6b PHP/4.2.2 mod_fastcgi/2.4.2
Connection: close
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<HTML><HEAD>
<TITLE>200 OK</TITLE>
</HEAD><BODY>
<H1>OK</H1>
The requested URL /xmlrpc/Ticket was not found on this server.<P>
<HR>
<ADDRESS>Apache/1.3.27 Server at core.some.com Port 443</ADDRESS>
</BODY></HTML>
+++++++++End+++++++++++++++++++++++++++++++++++++++++++++++++++++++++

The other server (which works fine)  is thus:

Server: Apache/1.3.29 (Debian GNU/Linux) mod_python/2.7.10 Python/2.2.3+
mod_gzip/1.3.26.1a PHP/4.3.4 mod_fastcgi/2.4.0 mod_ssl/2.8.16 OpenSSL/0.9.7c
DAV/1.0.3

(note the diff. mod_python versions)
Curiously, it also seemed to work on yet another server, which had
mod_python/2.7.6 on it!

Does this sound like a 2.7.8 bug anyone recalls? Like one that was fixed by
2.7.10?
Or could a botched config in the httpd.conf do this somehow? If so what
 should I be looking for? I can't just compare the http.conf's on the two
 machines, alas, as they are too  different, and I don't know where to begin.

Note that regular html pages, and another mod_python app running on the same
servers (different handler & interpreter) do NOT exhibit this issue.

(yes, I would prefer to have my servers have the same config, but these are
production company servers, thus I have to take what we've got. :P )

--
	-M. Dragon

-------------------------------------------------------

-- 
--
	-M. Dragon
From bje at apnic.net  Thu Aug 19 10:03:11 2004
From: bje at apnic.net (Byron Ellacott)
Date: Wed Aug 18 19:02:19 2004
Subject: [mod_python] The right way to handle sessions
In-Reply-To: <FBD9767A-ED3D-11D8-A444-000A95B2E4E0@amix.dk>
References: <F48E9BA3-EC58-11D8-A444-000A95B2E4E0@amix.dk>	<411BFA73.3090805@apnic.net>	<2AB88DEA-ED1C-11D8-A444-000A95B2E4E0@amix.dk>
	<FBD9767A-ED3D-11D8-A444-000A95B2E4E0@amix.dk>
Message-ID: <4123E02F.4060401@apnic.net>

Amir Salihefendic wrote:
>> def createSession(req):
>> def getSameSession(req, SID):
> Argh forgot something very important (to save the damn session)!:
>> Anyway, I am interested in knowing: What is the smartest way to 
>> "share"/access same session across functions (i.e. when you are 
>> internal "redirecting")? Example of what I mean by "redirecting" (not 
>> working...):

In case saving the session in createSession() didn't solve your problem, 
I'd suggest collapsing the two functions into one, since you don't seem 
to really need to distinguish between creating a session and fetching an 
existing one, as demonstrated by your getSameSession() function not 
checking if the session it fetches is newly created:

def getSession(req):
     sess = Session.Session(req)
     if sess.is_new(): sess.save()
     return sess

Of course, you now have the problem that the session might have already 
been created during the processing of this request.  I'm not very 
familiar with the publisher approach, but I'm assuming it calls a method 
based on the requested URL, essentially doing a dispatch for you.  This 
is awkward when you want to have functions done outside of the 
dispatched routine, but you can alter getSession() to help out:

def getSession(req):
     if not hasattr(req, 'session'):
         req.session = Session.Session(req)
         if req.session.is_new(): req.session.save()
     return req.session

You can assign to attributes of a request object, and those attributes 
will last for the lifetime of the request (but not cross-interpreter, so 
be careful about request phases and which configuration directives apply 
when, if you do multi-phase handlers!).  So, you can cache the previous 
getSession() request in the req object itself.

Of course, if your problem is solved, there's not a great deal of point 
in doing this anyway, and storing attributes in the request object is 
probably about as unclean as calling session.unlock() to allow you to 
fetch a session twice.

-- 
bje
From bje at apnic.net  Thu Aug 19 10:18:02 2004
From: bje at apnic.net (Byron Ellacott)
Date: Wed Aug 18 19:17:08 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <873c2mkt2k.fsf@tapsellferrier.co.uk>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>
	<873c2mkt2k.fsf@tapsellferrier.co.uk>
Message-ID: <4123E3AA.1050906@apnic.net>

Nic Ferrier wrote:
> I think one of the best ways to do templating is with XSLT. I find
> that designers who understand XML can be quickly taught XSLT. It's
> pretty natural and it's also quite common and not tied to one specific
> language or operating system.

That's what I do.  GET operations fetch a view, which consists of any 
number of Python modules each returning an XML fragment (or throwing a 
redirection exception).  Those fragments are combined into a document, 
which is passed to the defined translator for the view.  Currently, the 
only translator type I have is XSLT.

POST operations call a single module to handle the operation requested, 
which returns an XML fragment and a view to display.  The engine then 
redirects (currently by calling, soon by 303ing) to the view, including 
the POSTed XML result in the output.

But I work on it in fits and starts, with little free time these days. 
There are a number of problems to solve:

  * XHTML is pretty useless as an output language, since IE does not 
support it - but you can output HTML with XSLT;
  * All the XML processing is slower than most other templating methods, 
and so caching at various levels is important; and
  * Since I'm processing an entire XML document through a translation, I 
cannot send a partial response to a client, and this vastly changes the 
user's impression of responsiveness.

The last one is the most significant.  If the browser cannot render a 
partial page, the user will feel that the application is slower to 
respond, sometimes significantly so, even if it's actually faster to 
load the complete page.  This is a major stumbling block to using XSLT 
for whole-page translations.

-- 
bje
From vinjvinj at yahoo.com  Wed Aug 18 17:53:57 2004
From: vinjvinj at yahoo.com (Vinj Vinj)
Date: Wed Aug 18 19:54:04 2004
Subject: [mod_python] mpservlet and formkit
Message-ID: <20040818235357.19752.qmail@web41308.mail.yahoo.com>

I was thinking of using mpservlet/modpython/simpletal
and formkit for form generation. 

Has anyone used this combination. How difficult would
it be to get mpservlet to work with formkit. Or in
other words how different is the mpservlet api then
the webware servlet api. 


From nferrier at tapsellferrier.co.uk  Thu Aug 19 01:45:10 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Wed Aug 18 20:45:12 2004
Subject: [mod_python] mod_python Live examples
In-Reply-To: <4123E3AA.1050906@apnic.net>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
	<873c2mkt2k.fsf@tapsellferrier.co.uk> <4123E3AA.1050906@apnic.net>
Message-ID: <87acwsot6y.fsf@tapsellferrier.co.uk>

Byron Ellacott <bje@apnic.net> writes:

> That's what I do.  GET operations fetch a view, which consists of any 
> number of Python modules each returning an XML fragment (or throwing a 
> redirection exception).  Those fragments are combined into a document, 
> which is passed to the defined translator for the view.  Currently, the 
> only translator type I have is XSLT.
> 
> POST operations call a single module to handle the operation requested, 
> which returns an XML fragment and a view to display.  The engine then 
> redirects (currently by calling, soon by 303ing) to the view, including 
> the POSTed XML result in the output.
> 
> But I work on it in fits and starts, with little free time these days. 
> There are a number of problems to solve:
> 
>   * XHTML is pretty useless as an output language, since IE does not 
> support it - but you can output HTML with XSLT;
>   * All the XML processing is slower than most other templating methods, 
> and so caching at various levels is important; and
>   * Since I'm processing an entire XML document through a translation, I 
> cannot send a partial response to a client, and this vastly changes the 
> user's impression of responsiveness.
> 

Your architecture sounds more complicated than the one I use. I have
business methods that deliver XML. The XML gets transformed into HTML
(or not) by particular mod_python handlers. It's a very code based
approach. 

In my architecture, there is no aggregation of XML from collections of
business methods (though there could be if it was pragmatic). There is
no special 'view' definition. There is no need for a pluggable
translation layer. The mod_python parts of the architecture are *very*
disposable.


And note that XSLT doesn't have to be slow; there's quite a lot of
research going into improving speed. The pipelining approach has
already been taken:

  http://xml.apache.org/xalan-j/xsltc_usage.html

but in general it's far easier to build DOMs. DOM building is
expensive in terms of memory: but at least that it a known. Just add
more memory  /8->

In a RESTfull application you could also just add another server.


> The last one is the most significant.  If the browser cannot render a 
> partial page, the user will feel that the application is slower to 
> respond, sometimes significantly so, even if it's actually faster to 
> load the complete page.  This is a major stumbling block to using XSLT 
> for whole-page translations.

Hmmm... but unless you translate the whole page you don't know that
there won't be an error that you should signal with 500 (or
whatever). 

This is true for all templating applications, those that return data
before translation completion are inherently weak.


Python doesn't have 'standard' XSLT support yet... but when it does it
will be possible to pass DOMs around instead of XML character
streams. That will speed things up considerably.


And even though there is no 'standard' XSLT support I still think
mod_python is a *very* good tool for RESTfull applications like this.


Nic
From robert at worksofmagic.com  Wed Aug 18 22:11:47 2004
From: robert at worksofmagic.com (Robert Geller)
Date: Wed Aug 18 21:11:53 2004
Subject: [mod_python] mod python compilation / installation problems
Message-ID: <000101c48589$80a383b0$1e02a8c0@leet>

hello all, I am trying to compile and install mod-python 3.1.3 and
Apache 2.0.50, with Fedora Core 2.
 
I am very frustrated by now, as I have been trying this for a long time
and to no avail.
 
Upon doing make (after ./configure
--with-apxs=/usr/local/apache2/bin/apxs) I get some warnings about
C_POSIX_SOURCE or whatever. Is this significant?
 
My real problem is upon doing make install.
 

/usr/bin/install -c -d /usr/local/apache2/modules
/usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
/usr/bin/install: cannot stat `src/mod_python.so': No such file or
directory
make[1]: *** [install_dso] Error 1
make[1]: Leaving directory `/home/robert/mod_python-3.1.3'
make: *** [install] Error 2


Any ideas? I heard it may be something with libtool?

Robert Geller

robert@worksofmagic.com

 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040818/f80354f7/attachment.html
From greg at owlinteractive.org  Wed Aug 18 21:52:51 2004
From: greg at owlinteractive.org (Greg Jones)
Date: Wed Aug 18 21:53:03 2004
Subject: [mod_python] mod python compilation / installation problems
In-Reply-To: <000101c48589$80a383b0$1e02a8c0@leet>
References: <000101c48589$80a383b0$1e02a8c0@leet>
Message-ID: <1092880370.6139.41.camel@nuit.owlinteractive.org>

On Wed, 2004-08-18 at 20:11, Robert Geller wrote:
> hello all, I am trying to compile and install mod-python 3.1.3 and
> Apache 2.0.50, with Fedora Core 2.
>  
> I am very frustrated by now, as I have been trying this for a long
> time and to no avail.
>  
> Upon doing make (after ./configure
> --with-apxs=/usr/local/apache2/bin/apxs) I get some warnings about
> C_POSIX_SOURCE or whatever. Is this significant?
>  
> My real problem is upon doing make install.
>  
> /usr/bin/install -c -d /usr/local/apache2/modules
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/home/robert/mod_python-3.1.3'
> make: *** [install] Error 2
> 
> 
> Any ideas? I heard it may be something with libtool?


Hey Robert. I am not sure if you need to compile it, but if you don't it
is available in the apt repository. It should also be on one of the CDs
in rpm. Not sure which one. Good luck!

Greg

From robert at worksofmagic.com  Wed Aug 18 23:17:37 2004
From: robert at worksofmagic.com (Robert Geller)
Date: Wed Aug 18 22:17:46 2004
Subject: [mod_python] mod python compilation / installation problems
In-Reply-To: <1092880370.6139.41.camel@nuit.owlinteractive.org>
Message-ID: <000e01c48592$b42fafc0$1e02a8c0@leet>

Thanks for the suggestion, however the RPM is already installed from a
previous Fedora default Apache installation, but I'd like to use my own
Apache installation, compiled and installed to my needs/specifications.

Any ideas on how to actually fix the errors?

Thanks! :)

Robert Geller
robert@worksofmagic.com



-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] On Behalf Of Greg Jones
Sent: Wednesday, August 18, 2004 9:53 PM
To: mod_python user mailing list
Subject: Re: [mod_python] mod python compilation / installation problems


On Wed, 2004-08-18 at 20:11, Robert Geller wrote:
> hello all, I am trying to compile and install mod-python 3.1.3 and 
> Apache 2.0.50, with Fedora Core 2.
>  
> I am very frustrated by now, as I have been trying this for a long 
> time and to no avail.
>  
> Upon doing make (after ./configure
> --with-apxs=/usr/local/apache2/bin/apxs) I get some warnings about 
> C_POSIX_SOURCE or whatever. Is this significant?
>  
> My real problem is upon doing make install.
>  
> /usr/bin/install -c -d /usr/local/apache2/modules /usr/bin/install -c 
> src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or 
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/home/robert/mod_python-3.1.3'
> make: *** [install] Error 2
> 
> 
> Any ideas? I heard it may be something with libtool?


Hey Robert. I am not sure if you need to compile it, but if you don't it
is available in the apt repository. It should also be on one of the CDs
in rpm. Not sure which one. Good luck!

Greg

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


From bje at apnic.net  Thu Aug 19 13:31:54 2004
From: bje at apnic.net (Byron Ellacott)
Date: Wed Aug 18 22:31:01 2004
Subject: [mod_python] XSLT versus 'traditional' templating (was: mod_python
	Live examples)
In-Reply-To: <87acwsot6y.fsf@tapsellferrier.co.uk>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>
	<4123E3AA.1050906@apnic.net> <87acwsot6y.fsf@tapsellferrier.co.uk>
Message-ID: <4124111A.40105@apnic.net>

Nic Ferrier wrote:
> Your architecture sounds more complicated than the one I use. I have
> business methods that deliver XML. The XML gets transformed into HTML
> (or not) by particular mod_python handlers. It's a very code based
> approach. 

(And yet, still under 300 lines of Python!)

There are two reasons I chose the approach I have.  First, I am still 
dealing with the top layer of the application: views and actions.  The 
business methods may or may not be implemented using XML, but when a 
page is being viewed, the data retrieved for that page will be expressed 
as XML.  Thus, I insert the view level objects that know how to get 
business results expressed in XML.  I have multiple modules allowed per 
page to allow reuse: a menu module or a reminders module will commonly 
be reused, and I'd rather just say "This view will use the reminders 
module" and let the XSLT worry about how and where to put the output of 
that module in the final display.

> In my architecture, there is no aggregation of XML from collections of
> business methods (though there could be if it was pragmatic). There is
> no special 'view' definition. There is no need for a pluggable
> translation layer. The mod_python parts of the architecture are *very*
> disposable.

The pluggable translation layer would allow for me to replace XSLT with 
a system that parsed the XML as template variables for processing in 
some other template system.  Which I will probably never use.

As I'm still dealing entirely at the top, /mod_/python could perhaps be 
replaced with a CGI python, but the point is to map between a user's URI 
request and business code that's got no reason to know or care how it's 
being accessed.

> And note that XSLT doesn't have to be slow; there's quite a lot of
> research going into improving speed. The pipelining approach has
> already been taken:
>   http://xml.apache.org/xalan-j/xsltc_usage.html

Sorry, but I'm not sure what you mean by pipelining.  Since an XSLT 
document can, at any point, examine any part of the source document, you 
/must/ have the entire source document available to perform a transform. 
  Consider how you would implement <xsl:value-of 
select="//foo/bar[@baz='quux']"> without a full document, for instance. 
  In essense, XSLT is a document transformation tool, whereas 
traditional HTML templating mechanisms, including PSP, are stream 
templating tools.

On the other hand, it's perfectly valid to compile the XSLT document to 
some other, more convenient form, thus saving on the parsing, and it's 
also valid to cache DOM trees instead of XML strings.  But these don't 
change the basic fact that an XSLT transformation is still more complex 
than your ordinary run-of-the-mill template translations.

> In a RESTfull application you could also just add another server.

And I am talking not about scalability performance, but about 
per-request response time.  If the system starts too slow to use for one 
user making one request at a time, scaling well will simply mean it can 
be too slow for lots of users at once.

> Hmmm... but unless you translate the whole page you don't know that
> there won't be an error that you should signal with 500 (or
> whatever). 
> This is true for all templating applications, those that return data
> before translation completion are inherently weak.

Yes, this is true.  You can work optimistically, though, and say that in 
a well tested production system, pages will not have parsing/templating 
errors.  Or, you can say that they will only very rarely have them, and 
in your approach prefer the case where those such errors do not occur. 
In streaming templates, you can simply put data out to the client 
browser as fast as you get it, and if a parsing error occurs, you will 
fail ungracefully - but hey, it's an ungraceful and (hopefully) unlikely 
error.  When you're transforming a document, you cannot perform the 
transform until you have an entire document available to transform, and 
thus you cannot send data to the client until near the end of your 
processing.

Same overall response time, but a far slower perception.

> Python doesn't have 'standard' XSLT support yet... but when it does it
> will be possible to pass DOMs around instead of XML character
> streams. That will speed things up considerably.

Sure, or you just say that you expect DOMs to be of the type you can 
handle.  You're defining an API, you can also define the types of the 
arguments and return values.

> And even though there is no 'standard' XSLT support I still think
> mod_python is a *very* good tool for RESTfull applications like this.

Yes, I'm not denying that.  My main claim here is that XSLT approaches, 
and any approach that outputs (correct) XHTML, will always /feel/ slower 
to the user than streaming template approaches, because in the first 
case the entire document must be available to transform against, and in 
the second case the entire document must be parsed before rendering begins.

These aren't reasons to avoid the technologies, they are tradeoffs. 
Your application will almost certainly feel slower, but it's likely to 
have much better decoupling and maintainability, if you use XSLT to 
transform XML data to markup.

-- 
bje
From grahamd at dscpl.com.au  Thu Aug 19 02:09:22 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Thu Aug 19 03:09:25 2004
Subject: [mod_python] Imports, Caching, Handlers and Page Templates.
In-Reply-To: <40D7AF10-EE94-11D8-937D-000393DCF16E@dscpl.com.au>
Message-ID: <1092899359.3190@dscpl.com.au>

On Aug 15 18:22, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
>
> Subject: [mod_python] Imports, Caching, Handlers and Page Templates.
>
> First off, the package is called OSE and it is available from:
> 
>    http://ose.sourceforge.net
> 
> The version just made available is OSE 8.0b4.

FWIW, I have now made available the mod_python bits and pieces which were
added to the above package and which I described in previous email, available
as a separate standalone package.

For want of a better name, the package has been called "Vampire" and the
package along with online working demonstrations can be found at:

  http://www.dscpl.com.au/projects/vampire

This has all been a bit of a rush job to get this together as about to go on long
overdue holidays. I'll still be reading email occassionally and would be interested
in any feedback and comments. When I get back I'll start on improving the pages
and adding more examples.

Hopefully this site may also be of interest in the separate discussion about live
examples since it deliberately allows you to see the Python code which backs
up the examples. It also uses a mechanism which clearly separates Python code
from the HTML code which some had expressed interest in being able to do.

--
Graham Dumpleton (grahamd@dscpl.com.au)
From nferrier at tapsellferrier.co.uk  Thu Aug 19 10:29:01 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Thu Aug 19 05:29:03 2004
Subject: [mod_python] XSLT versus 'traditional' templating (was:
	mod_python  Live examples)
In-Reply-To: <4124111A.40105@apnic.net>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>
	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>
	<ca7fdd190408161651417fc9b6@mail.gmail.com>
	<873c2mkt2k.fsf@tapsellferrier.co.uk> <4123E3AA.1050906@apnic.net>
	<87acwsot6y.fsf@tapsellferrier.co.uk> <4124111A.40105@apnic.net>
Message-ID: <877jrvpjly.fsf@tapsellferrier.co.uk>

Byron Ellacott <bje@apnic.net> writes:

> > And note that XSLT doesn't have to be slow; there's quite a lot of
> > research going into improving speed. The pipelining approach has
> > already been taken:
> >   http://xml.apache.org/xalan-j/xsltc_usage.html
> 
> Sorry, but I'm not sure what you mean by pipelining.  Since an XSLT 
> document can, at any point, examine any part of the source document, you 
> /must/ have the entire source document available to perform a transform. 
>   Consider how you would implement <xsl:value-of 
> select="//foo/bar[@baz='quux']"> without a full document, for instance. 
>   In essense, XSLT is a document transformation tool, whereas 
> traditional HTML templating mechanisms, including PSP, are stream 
> templating tools.
> 
> On the other hand, it's perfectly valid to compile the XSLT document to 
> some other, more convenient form, thus saving on the parsing, and it's 
> also valid to cache DOM trees instead of XML strings.  But these don't 
> change the basic fact that an XSLT transformation is still more complex 
> than your ordinary run-of-the-mill template translations.

Yes, that's right. That's what xsltc does. The templates are compiled
into code that operates on a stream. It's clever and fast, but it's
also complicated.


> > In a RESTfull application you could also just add another server.

> And I am talking not about scalability performance, but about
> per-request response time.  If the system starts too slow to use for
> one user making one request at a time, scaling well will simply mean
> it can be too slow for lots of users at once.

What I was trying to say was that the biggest factor in XSLT
computation is memory size. If you can fit all the requests' DOM's
into memory then you will reduce the speed problem. I've recently been
working on a Java webapp with a similar architecture to the one you've
outlined, it is awfully slow when it isn't run on very large memory
servers but on big memory machines it's very quick.

But you're right. Stream based templating is always going to be
quicker.


> > Python doesn't have 'standard' XSLT support yet... but when it
> > does it will be possible to pass DOMs around instead of XML
> > character streams. That will speed things up considerably.

> Sure, or you just say that you expect DOMs to be of the type you can
> handle.  You're defining an API, you can also define the types of
> the arguments and return values.

That's true. But I was getting at the performance issue. Currently
it's likely that passing your 'DOM' to an XSLT engine will require
serializtion of your DOM and then the XSLT engine to parse the
serialized form. 

When there is standard Python XSLT support we will presumably be able
to pass a DOM directly to an XSLT engine which will operate on it
directly. This is how one achieves reasonable XSLT performance with
Java for example.


> These aren't reasons to avoid the technologies, they are tradeoffs.
> Your application will almost certainly feel slower, but it's likely
> to have much better decoupling and maintainability, if you use XSLT
> to transform XML data to markup.

I do agree with you. But I think your assesment of XSLT as slow is
(only) slightly misleading. Partly it's slow in Python because of a
lack of standard support (although this can be fixed by using things
like libxml2 for your xml and xslt).


Nic
From davidf at sjsoft.com  Thu Aug 19 13:25:58 2004
From: davidf at sjsoft.com (David Fraser)
Date: Thu Aug 19 06:26:03 2004
Subject: [mod_python] mod python compilation / installation problems
In-Reply-To: <000101c48589$80a383b0$1e02a8c0@leet>
References: <000101c48589$80a383b0$1e02a8c0@leet>
Message-ID: <41248036.2020502@sjsoft.com>

Robert Geller wrote:

> hello all, I am trying to compile and install mod-python 3.1.3 and 
> Apache 2.0.50, with Fedora Core 2.
>  
> I am very frustrated by now, as I have been trying this for a long 
> time and to no avail.
>  
> Upon doing make (after ./configure 
> --with-apxs=/usr/local/apache2/bin/apxs) I get some warnings about 
> C_POSIX_SOURCE or whatever. Is this significant?

Can you post the actual output? it may give clues...

> <> My real problem is upon doing make install.
>  
> /usr/bin/install -c -d /usr/local/apache2/modules
> /usr/bin/install -c src/mod_python.so /usr/local/apache2/modules
> /usr/bin/install: cannot stat `src/mod_python.so': No such file or 
> directory
> make[1]: *** [install_dso] Error 1
> make[1]: Leaving directory `/home/robert/mod_python-3.1.3'
> make: *** [install] Error 2
>
> Any ideas? I heard it may be something with libtool?
>

From sanders at apache.org  Thu Aug 19 08:39:53 2004
From: sanders at apache.org (Scott Sanders)
Date: Thu Aug 19 10:40:04 2004
Subject: [mod_python] XSLT versus 'traditional' templating (was:
	mod_python Live examples)
In-Reply-To: <4124111A.40105@apnic.net>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>
	<4123E3AA.1050906@apnic.net> <87acwsot6y.fsf@tapsellferrier.co.uk>
	<4124111A.40105@apnic.net>
Message-ID: <A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>


On Aug 18, 2004, at 7:31 PM, Byron Ellacott wrote:
> My main claim here is that XSLT approaches, and any approach that 
> outputs (correct) XHTML, will always /feel/ slower to the user than 
> streaming template approaches, because in the first case the entire 
> document must be available to transform against, and in the second 
> case the entire document must be parsed before rendering begins.
>

This is not entirely true.  In the java world, I took a Java-based 
application framework that used DOM and XSLT to do rendering (about 1 
page per sec) to a pipelined SAX approach using custom SAX filters 
instead of DOM, but still using XSLT as the final render, and the 
application increased performance 100 fold!  We could do render in 40ms 
or less (usually 20).  And we also used a streaming approach.  Using 
XSLT in a SAX filter stream allowed use to stream the response, which 
did increase the perceived performance.  Using XSLT does not mean that 
you cannot stream, because you can.

I was using Saxon in that application, BTW, so I know several 
processors out there can stream.

Scott


From sascha at saschas-netz.de  Thu Aug 19 22:39:50 2004
From: sascha at saschas-netz.de (Sascha)
Date: Thu Aug 19 15:51:08 2004
Subject: [mod_python] Problems loading .psp's
Message-ID: <cg2vqc$sks$1@sea.gmane.org>

Hi,

I'm new to PSP but did a lot of PHP and a little less of JSP.

So after 1 day of desaster and RTFM I now can use .psp and publisher on 
my public_html (yust not in one and the same folder :-))

My problem is, that when I load my hello.psp file, my HELLO WORLD 
apears, but my konqueror keeps laoding and stops at 58%, then I get a 
timeout-message.

Can someone imagine what this might be???


Greetings, Sascha

From svenne at krap.dk  Thu Aug 19 23:03:16 2004
From: svenne at krap.dk (Svenne Krap)
Date: Thu Aug 19 15:58:31 2004
Subject: [mod_python] Lifespan of objects
Message-ID: <41250784.8020002@krap.dk>

Hi.

Firstly, I'm running modpython 3.1.3 on apache2 (2.0.50).

I have been fooling around with ModPython a little, but I am having 
trouble to figure out lifetime of objects.

Let's consider this

==== test.py starts ====
from mod_python import apache
import MYSQLdb
_db = None

def getdb():
    global _db
    if _db is None:
       _db = MYSQLdb.connect(....)

def handler(req):
    cnx = getdb()
    cur = cnx.cursor()
    ...
    return apache.OK

==== test.py ends====

As far as I can figure out from the docs, the following should be true:

1) _db is initialized exactly once for every apache process and lives as 
long as the process
2) cnx is copied from _db at every request, but freed after handler returns
3) cur is created at every request, but freed at handler return

When I run a slightly more complex script (with the same idea though), I 
keep getting "too many connections" back from mysql at some point.
There is only one python file served and no custom modules are loaded, 
so it should not be because I got too many interprenters started up.
This is after 100 connections are made, but since I am the only one 
(guaranteed) to access the script, 100 simultanious connections is utopia.

I use an extensive amount of subdomains, but everything is run through 
one wild-carded vhost.

I usually have around 20 apache2 processes hanging around, but nothing 
else is using mysql.

Can anyone please point out, where my problem is? And perhaps provide a 
pointer to a good way to pool ressources, the tutorial in the docs seems 
a little meager.

Svenne
From nferrier at tapsellferrier.co.uk  Thu Aug 19 21:46:13 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Thu Aug 19 16:46:14 2004
Subject: [mod_python] Lifespan of objects
In-Reply-To: <41250784.8020002@krap.dk>
References: <41250784.8020002@krap.dk>
Message-ID: <87vffeoob5.fsf@tapsellferrier.co.uk>

Svenne Krap <svenne@krap.dk> writes:

> Hi.
> 
> Firstly, I'm running modpython 3.1.3 on apache2 (2.0.50).
> 
> I have been fooling around with ModPython a little, but I am having 
> trouble to figure out lifetime of objects.
> 
> Let's consider this
> 
> ==== test.py starts ====
> from mod_python import apache
> import MYSQLdb
> _db = None
> 
> def getdb():
>     global _db
>     if _db is None:
>        _db = MYSQLdb.connect(....)
> 
> def handler(req):
>     cnx = getdb()
>     cur = cnx.cursor()
>     ...
>     return apache.OK
> 
> ==== test.py ends====
> 
> As far as I can figure out from the docs, the following should be true:
> 
> 1) _db is initialized exactly once for every apache process and lives as 
> long as the process
> 2) cnx is copied from _db at every request, but freed after handler returns
> 3) cur is created at every request, but freed at handler return
> 
> When I run a slightly more complex script (with the same idea though), I 
> keep getting "too many connections" back from mysql at some point.
> There is only one python file served and no custom modules are loaded, 
> so it should not be because I got too many interprenters started up.
> This is after 100 connections are made, but since I am the only one 
> (guaranteed) to access the script, 100 simultanious connections is utopia.
> 
> I use an extensive amount of subdomains, but everything is run through 
> one wild-carded vhost.
> 
> I usually have around 20 apache2 processes hanging around, but nothing 
> else is using mysql.
> 
> Can anyone please point out, where my problem is? And perhaps provide a 
> pointer to a good way to pool ressources, the tutorial in the docs seems 
> a little meager.

Are you just hitting some MySQL cursor limit? You are using a single
connection in parallel, not a good idea.

I'd say you need to use a connection pool and get and return a
connection from the pool with every request.


Nic
From svenne at krap.dk  Fri Aug 20 00:16:16 2004
From: svenne at krap.dk (Svenne Krap)
Date: Thu Aug 19 17:11:08 2004
Subject: [mod_python] Lifespan of objects
In-Reply-To: <87vffeoob5.fsf@tapsellferrier.co.uk>
References: <41250784.8020002@krap.dk> <87vffeoob5.fsf@tapsellferrier.co.uk>
Message-ID: <412518A0.1040300@krap.dk>

Nic Ferrier wrote:

>Are you just hitting some MySQL cursor limit? You are using a single
>connection in parallel, not a good idea.
>
>I'd say you need to use a connection pool and get and return a
>connection from the pool with every request.
>
>
>Nic
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>  
>
I don't realize how I am using a single connection in parallel.

While running apache, it forks new processes if there are simultanious 
connections. Each of these should open exactly one connection and use that.

I thought, that my example was a simple connection pool (I never need 
more than one cursor open per process anyhow), if I am in error, please 
provide pointers to a good connection pool (I haven't been able to 
locate any through google. Just a mailing-list suggestion that resembles 
my solution).

It seems however, when I modify the .py-file the amount of connections 
grow. Is my program "losing" connections when the module is reloaded ?

Thanks in advance.

Svenne
From nferrier at tapsellferrier.co.uk  Thu Aug 19 22:46:21 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Thu Aug 19 17:46:23 2004
Subject: [mod_python] Lifespan of objects
In-Reply-To: <412518A0.1040300@krap.dk>
References: <41250784.8020002@krap.dk> <87vffeoob5.fsf@tapsellferrier.co.uk>
	<412518A0.1040300@krap.dk>
Message-ID: <87smaiol5y.fsf@tapsellferrier.co.uk>

Svenne Krap <svenne@krap.dk> writes:

> I don't realize how I am using a single connection in parallel.
> 
> While running apache, it forks new processes if there are simultanious 
> connections. Each of these should open exactly one connection and
> use that.

Sorry, I missed what mpm you were using. 


> I thought, that my example was a simple connection pool (I never need 
> more than one cursor open per process anyhow), if I am in error, please 
> provide pointers to a good connection pool (I haven't been able to 
> locate any through google. Just a mailing-list suggestion that resembles 
> my solution).
> 
> It seems however, when I modify the .py-file the amount of connections 
> grow. Is my program "losing" connections when the module is reloaded
> ?

If you modify the .py I'm sure you'll lose them. The old instances
will go out of scope and not be closed.

When I started playing with DB API stuff I thought that destruction
would close the connection, but it didn't seem to. I had to
specifically close them.


Nic
From Antonio at Memora.com  Thu Aug 19 18:59:47 2004
From: Antonio at Memora.com (Antonio Rodriguez)
Date: Thu Aug 19 18:00:29 2004
Subject: [mod_python] Lifespan of objects
In-Reply-To: <87smaiol5y.fsf@tapsellferrier.co.uk>
References: <41250784.8020002@krap.dk> <87vffeoob5.fsf@tapsellferrier.co.uk>
	<412518A0.1040300@krap.dk> <87smaiol5y.fsf@tapsellferrier.co.uk>
Message-ID: <1606C1F9-F22B-11D8-9860-000A95AC6C3C@Memora.com>

> When I started playing with DB API stuff I thought that destruction
> would close the connection, but it didn't seem to. I had to
> specifically close them.

How do you specifically close them especially when mod_python is 
performing the module reload automatically? Is there some sort of 
unload hook?

I can think that an alternative is to put all of the db connection code 
in a dbmodule.py and then import from there for the script your working 
on. Since this dbmodule.py will not change as you work on your code, 
its global dict (and therefore your connection object) should stay in 
scope the whole time (unless you change dbmodule.py).

Does this make sense?

AR

On Aug 19, 2004, at 5:47 PM, Nic Ferrier wrote:

> Svenne Krap <svenne@krap.dk> writes:
>
>> I don't realize how I am using a single connection in parallel.
>>
>> While running apache, it forks new processes if there are simultanious
>> connections. Each of these should open exactly one connection and
>> use that.
>
> Sorry, I missed what mpm you were using.
>
>
>> I thought, that my example was a simple connection pool (I never need
>> more than one cursor open per process anyhow), if I am in error, 
>> please
>> provide pointers to a good connection pool (I haven't been able to
>> locate any through google. Just a mailing-list suggestion that 
>> resembles
>> my solution).
>>
>> It seems however, when I modify the .py-file the amount of connections
>> grow. Is my program "losing" connections when the module is reloaded
>> ?
>
> If you modify the .py I'm sure you'll lose them. The old instances
> will go out of scope and not be closed.
>
> When I started playing with DB API stuff I thought that destruction
> would close the connection, but it didn't seem to. I had to
> specifically close them.
>
>
> Nic
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From iker at research.att.com  Thu Aug 19 19:44:10 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Thu Aug 19 18:46:59 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <87vffeoob5.fsf@tapsellferrier.co.uk>
References: <41250784.8020002@krap.dk> <87vffeoob5.fsf@tapsellferrier.co.uk>
Message-ID: <41252D3A.9070005@research.att.com>

Hello all,

I have a PSP page, say test.psp, that does an import
of a module called mymod.py. In this module I have
something like the following

     from mod_python import apache

     def test():
         req.write("this is a test")

My test.psp page imports this module and tries
to invoke the test() method, but I get the
following error:

     NameError: global name 'req' is not defined

I've tried various combinations of import statements
in mymod.py with no luck. How can I make the req
object available to the module? I've verified that
the its available to test.psp, but when the PSP page
calls the module - boom.

Here's my Apache config as well:

    Listen 80
    NameVirtualHost *:80
    <VirtualHost *:80>
       <Directory "/home/iker/www/">
          AddHandler mod_python .psp
          PythonHandler mod_python.psp
          PythonDebug On
          PythonPath "['/path/to/mymodule/'] + sys.path"
          Options FollowSymLinks +Indexes
          AllowOverride All
          Order allow,deny
          Allow from all
       </Directory>
       ServerName rose
       ServerAlias localhost
       DocumentRoot /home/iker/www/
       LogLevel debug
    </VirtualHost>


Thanks,
Iker



-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com

From robert at worksofmagic.com  Thu Aug 19 20:38:50 2004
From: robert at worksofmagic.com (Robert Geller)
Date: Thu Aug 19 19:39:01 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <41252D3A.9070005@research.att.com>
Message-ID: <002401c48645$b19c6a60$1e02a8c0@leet>

As for NameError: global name 'req' is not defined,

You must put req as an argument to the function test, i.e.

def test(req):
	req.write("this is a test")

Robert Geller
robert@worksofmagic.com



-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] On Behalf Of Iker Arizmendi
Sent: Thursday, August 19, 2004 6:44 PM
To: mod_python user mailing list
Subject: [mod_python] from mod_python import apache


Hello all,

I have a PSP page, say test.psp, that does an import
of a module called mymod.py. In this module I have
something like the following

     from mod_python import apache

     def test():
         req.write("this is a test")

My test.psp page imports this module and tries
to invoke the test() method, but I get the
following error:

     NameError: global name 'req' is not defined

I've tried various combinations of import statements
in mymod.py with no luck. How can I make the req
object available to the module? I've verified that
the its available to test.psp, but when the PSP page
calls the module - boom.

Here's my Apache config as well:

    Listen 80
    NameVirtualHost *:80
    <VirtualHost *:80>
       <Directory "/home/iker/www/">
          AddHandler mod_python .psp
          PythonHandler mod_python.psp
          PythonDebug On
          PythonPath "['/path/to/mymodule/'] + sys.path"
          Options FollowSymLinks +Indexes
          AllowOverride All
          Order allow,deny
          Allow from all
       </Directory>
       ServerName rose
       ServerAlias localhost
       DocumentRoot /home/iker/www/
       LogLevel debug
    </VirtualHost>


Thanks,
Iker



-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


From bje at apnic.net  Fri Aug 20 11:18:19 2004
From: bje at apnic.net (Byron Ellacott)
Date: Thu Aug 19 20:17:25 2004
Subject: [mod_python] XSLT versus 'traditional' templating
In-Reply-To: <A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>	<4123E3AA.1050906@apnic.net>
	<87acwsot6y.fsf@tapsellferrier.co.uk>	<4124111A.40105@apnic.net>
	<A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>
Message-ID: <4125434B.1020904@apnic.net>

(combined responses, this thread is probably getting too offtopic...)

Scott Sanders wrote:
Nic Ferrier wrote:
[I believe you both told me it's possible to stream data through an XSLT 
processor; please correct me if this is not what you meant!]

My basic problem here is that there are trivial XSLT fragments that may 
not be determinable until the entire source document has been read. 
Consider <xsl:if test="/foo/bar">There is a bar element</xsl:if>.  In 
this example, a source document may have no bar elements at all, or it 
may have a bar element as the very last element before closing the root 
foo element.  An XSLT processor cannot distinguish these cases until the 
root element has been closed.

If the bar element appeared earlier in the document, a sufficiently 
clever XSLT processor could continue processing as soon as that element 
was encountered, but this falls down when you consider:

<xsl:for-each select="/foo/bar">Another bar found</xsl:for-each>

In this case, processing must be halted until the root element has been 
closed, since another bar element may be encountered at any time.  Once 
again, a clever processor could continue processing, storing tree 
fragments for later use, but it could not output any further elements 
until it was satisfied that the xsl:for-each had completed.

So, I can see how a sufficiently clever XSLT processor could stream 
output where possible, but this requires the stylesheet author to 
carefully avoid any construct that would cause output to block.  Most 
notably, any XPath expression used to control transformation that cannot 
be sufficiently evaluated until the document is fully parsed must be 
avoided, and for any non-trivial use of XSLT, this is, to say the least, 
a hard task.

If I'm missing something here, please fill me in, because I am in the 
process of recommending an XML/XSLT approach to web development here at 
work, and I'd love to strike out the cost to perceived response times 
associated with a document transformation.

-- 
bje
From iker at research.att.com  Thu Aug 19 21:23:13 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Thu Aug 19 20:26:02 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <002401c48645$b19c6a60$1e02a8c0@leet>
References: <002401c48645$b19c6a60$1e02a8c0@leet>
Message-ID: <41254471.7030206@research.att.com>

What I meant is that I'd like to have the req
object globally available within the module
as it is within PSP pages.

Any way to do that?



Robert Geller wrote:
> As for NameError: global name 'req' is not defined,
> 
> You must put req as an argument to the function test, i.e.
> 
> def test(req):
> 	req.write("this is a test")
> 
> Robert Geller
> robert@worksofmagic.com
> 
> 
> 
> -----Original Message-----
> From: mod_python-bounces@modpython.org
> [mailto:mod_python-bounces@modpython.org] On Behalf Of Iker Arizmendi
> Sent: Thursday, August 19, 2004 6:44 PM
> To: mod_python user mailing list
> Subject: [mod_python] from mod_python import apache
> 
> 
> Hello all,
> 
> I have a PSP page, say test.psp, that does an import
> of a module called mymod.py. In this module I have
> something like the following
> 
>      from mod_python import apache
> 
>      def test():
>          req.write("this is a test")
> 
> My test.psp page imports this module and tries
> to invoke the test() method, but I get the
> following error:
> 
>      NameError: global name 'req' is not defined
> 
> I've tried various combinations of import statements
> in mymod.py with no luck. How can I make the req
> object available to the module? I've verified that
> the its available to test.psp, but when the PSP page
> calls the module - boom.
> 
> Here's my Apache config as well:
> 
>     Listen 80
>     NameVirtualHost *:80
>     <VirtualHost *:80>
>        <Directory "/home/iker/www/">
>           AddHandler mod_python .psp
>           PythonHandler mod_python.psp
>           PythonDebug On
>           PythonPath "['/path/to/mymodule/'] + sys.path"
>           Options FollowSymLinks +Indexes
>           AllowOverride All
>           Order allow,deny
>           Allow from all
>        </Directory>
>        ServerName rose
>        ServerAlias localhost
>        DocumentRoot /home/iker/www/
>        LogLevel debug
>     </VirtualHost>
> 
> 
> Thanks,
> Iker
> 
> 
> 

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From nferrier at tapsellferrier.co.uk  Fri Aug 20 01:53:37 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Thu Aug 19 20:53:39 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <41254471.7030206@research.att.com>
References: <002401c48645$b19c6a60$1e02a8c0@leet>
	<41254471.7030206@research.att.com>
Message-ID: <87ekm2ocn5.fsf@tapsellferrier.co.uk>

Iker Arizmendi <iker@research.att.com> writes:

> What I meant is that I'd like to have the req
> object globally available within the module
> as it is within PSP pages.
> 
> Any way to do that?

How about:


req_object = None

def handler(req):
        global req_object
        req_object = req
        make_some_call()
        return None

def make_some_call():
        global req_object
        req_object.content_type = "text/plain"
        return None



-- 
Nic Ferrier
http://www.tapsellferrier.co.uk
From iker at research.att.com  Thu Aug 19 23:11:58 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Thu Aug 19 22:14:47 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <87ekm2ocn5.fsf@tapsellferrier.co.uk>
References: <002401c48645$b19c6a60$1e02a8c0@leet>	<41254471.7030206@research.att.com>
	<87ekm2ocn5.fsf@tapsellferrier.co.uk>
Message-ID: <41255DEE.9070409@research.att.com>

Declaring variables as global within a function
definition seems to be a syntax error. But even if
I moved the declarations to module scope the global
variable in the importing module is still not visible
in the module that is imported (which seems reasonable,
otherwise modules would risk polluting the namespace
of modules they imported).


Nic Ferrier wrote:

> How about:
> 
> 
> req_object = None
> 
> def handler(req):
>         global req_object
>         req_object = req
>         make_some_call()
>         return None
> 
> def make_some_call():
>         global req_object
>         req_object.content_type = "text/plain"
>         return None
> 
> 
> 

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From sector119 at mail.ru  Fri Aug 20 13:01:50 2004
From: sector119 at mail.ru (sector119@mail.ru)
Date: Fri Aug 20 05:55:31 2004
Subject: [mod_python] Publisher. How to make FieldStorage use
	keep_blank_values=0
Message-ID: <20040820090150.GA30242@city.gov.te.ua>

How to make FieldStorage use keep_blank_values=0 with out editing of
source code when I use Publisher handler!?

-- 
WBR, sector119
From nferrier at tapsellferrier.co.uk  Fri Aug 20 11:05:07 2004
From: nferrier at tapsellferrier.co.uk (Nic Ferrier)
Date: Fri Aug 20 06:05:09 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <41255DEE.9070409@research.att.com>
References: <002401c48645$b19c6a60$1e02a8c0@leet>
	<41254471.7030206@research.att.com>
	<87ekm2ocn5.fsf@tapsellferrier.co.uk>
	<41255DEE.9070409@research.att.com>
Message-ID: <87wtzum8rk.fsf@tapsellferrier.co.uk>

Iker Arizmendi <iker@research.att.com> writes:

> Declaring variables as global within a function
> definition seems to be a syntax error. 

http://docs.python.org/ref/global.html


> But even if I moved the declarations to module scope the global
> variable in the importing module is still not visible in the module
> that is imported (which seems reasonable, otherwise modules would
> risk polluting the namespace of modules they imported).

You're right. The module that is imported would have to import your
main module right back.

What you seem to want is dynamic scope ? la lisp.

I don't know if it's possible to do dynamic scope in python.


Nic

From iker at research.att.com  Fri Aug 20 08:57:22 2004
From: iker at research.att.com (Iker Arizmendi)
Date: Fri Aug 20 08:00:11 2004
Subject: [mod_python] from mod_python import apache
In-Reply-To: <87wtzum8rk.fsf@tapsellferrier.co.uk>
References: <002401c48645$b19c6a60$1e02a8c0@leet>	<41254471.7030206@research.att.com>	<87ekm2ocn5.fsf@tapsellferrier.co.uk>	<41255DEE.9070409@research.att.com>
	<87wtzum8rk.fsf@tapsellferrier.co.uk>
Message-ID: <4125E722.1070303@research.att.com>

I also think I have misunderstood how mod_python
does its thing. At first I thought that the req
object was global object and a member of mod_python
that gets appropriately populated before my PSP
code executed. This led me to believe that I could
import it and use it in an arbitrary module provided
I was running within Apache (sort of like the COM's
context object).

Regards,
Iker


Nic Ferrier wrote:
> Iker Arizmendi <iker@research.att.com> writes:
> 
> 
>>Declaring variables as global within a function
>>definition seems to be a syntax error. 
> 
> 
> http://docs.python.org/ref/global.html
> 
> 
> 
>>But even if I moved the declarations to module scope the global
>>variable in the importing module is still not visible in the module
>>that is imported (which seems reasonable, otherwise modules would
>>risk polluting the namespace of modules they imported).
> 
> 
> You're right. The module that is imported would have to import your
> main module right back.
> 
> What you seem to want is dynamic scope ? la lisp.
> 
> I don't know if it's possible to do dynamic scope in python.
> 
> 
> Nic
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

-- 
Iker Arizmendi
AT&T Labs - Research
Speech and Image Processing Lab
e: iker@research.att.com
w: http://research.att.com


From nick at dd.revealed.net  Fri Aug 20 10:12:42 2004
From: nick at dd.revealed.net (Nick)
Date: Fri Aug 20 10:12:51 2004
Subject: [mod_python] Lifespan of objects
In-Reply-To: <1606C1F9-F22B-11D8-9860-000A95AC6C3C@Memora.com>
References: <41250784.8020002@krap.dk>
	<87vffeoob5.fsf@tapsellferrier.co.uk>	<412518A0.1040300@krap.dk>
	<87smaiol5y.fsf@tapsellferrier.co.uk>
	<1606C1F9-F22B-11D8-9860-000A95AC6C3C@Memora.com>
Message-ID: <412606DA.4000608@dd.revealed.net>

Try calling gc.collect() occasionally, assuming the connections can be 
collected.  Don't know if the db module keeps an internal list of 
connections or not.  If it does, then forcing garbage collection may not 
help.  The 3rd module that has a connection pool may be your only hope in 
that case.

Nick

Antonio Rodriguez wrote:

>> When I started playing with DB API stuff I thought that destruction
>> would close the connection, but it didn't seem to. I had to
>> specifically close them.
> 
> 
> How do you specifically close them especially when mod_python is 
> performing the module reload automatically? Is there some sort of unload 
> hook?
> 
> I can think that an alternative is to put all of the db connection code 
> in a dbmodule.py and then import from there for the script your working 
> on. Since this dbmodule.py will not change as you work on your code, its 
> global dict (and therefore your connection object) should stay in scope 
> the whole time (unless you change dbmodule.py).
> 
> Does this make sense?
> 
> AR
> 
> On Aug 19, 2004, at 5:47 PM, Nic Ferrier wrote:
> 
>> Svenne Krap <svenne@krap.dk> writes:
>>
>>> I don't realize how I am using a single connection in parallel.
>>>
>>> While running apache, it forks new processes if there are simultanious
>>> connections. Each of these should open exactly one connection and
>>> use that.
>>
>>
>> Sorry, I missed what mpm you were using.
>>
>>
>>> I thought, that my example was a simple connection pool (I never need
>>> more than one cursor open per process anyhow), if I am in error, please
>>> provide pointers to a good connection pool (I haven't been able to
>>> locate any through google. Just a mailing-list suggestion that resembles
>>> my solution).
>>>
>>> It seems however, when I modify the .py-file the amount of connections
>>> grow. Is my program "losing" connections when the module is reloaded
>>> ?
>>
>>
>> If you modify the .py I'm sure you'll lose them. The old instances
>> will go out of scope and not be closed.
>>
>> When I started playing with DB API stuff I thought that destruction
>> would close the connection, but it didn't seem to. I had to
>> specifically close them.
>>
>>
>> Nic
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From nick at dd.revealed.net  Fri Aug 20 10:30:53 2004
From: nick at dd.revealed.net (Nick)
Date: Fri Aug 20 10:31:35 2004
Subject: [mod_python] AuthName
Message-ID: <41260B1D.1090901@dd.revealed.net>

Is there a way to get the AuthName from the apache config in mod_python?

Thanks,
Nick
From sanders at apache.org  Fri Aug 20 11:29:08 2004
From: sanders at apache.org (Scott Sanders)
Date: Fri Aug 20 13:29:22 2004
Subject: [mod_python] XSLT versus 'traditional' templating
In-Reply-To: <4125434B.1020904@apnic.net>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>	<4123E3AA.1050906@apnic.net>
	<87acwsot6y.fsf@tapsellferrier.co.uk>	<4124111A.40105@apnic.net>
	<A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>
	<4125434B.1020904@apnic.net>
Message-ID: <717509D0-F2CE-11D8-BCA7-000A95D2D288@apache.org>


On Aug 19, 2004, at 5:18 PM, Byron Ellacott wrote:

> My basic problem here is that there are trivial XSLT fragments that 
> may not be determinable until the entire source document has been 
> read. Consider <xsl:if test="/foo/bar">There is a bar 
> element</xsl:if>.  In this example, a source document may have no bar 
> elements at all, or it may have a bar element as the very last element 
> before closing the root foo element.  An XSLT processor cannot 
> distinguish these cases until the root element has been closed.

On the flip side, it can continue as soon as it sees a bar element. :)

>
> If the bar element appeared earlier in the document, a sufficiently 
> clever XSLT processor could continue processing as soon as that 
> element was encountered, but this falls down when you consider:
>
> <xsl:for-each select="/foo/bar">Another bar found</xsl:for-each>
>
> In this case, processing must be halted until the root element has 
> been closed, since another bar element may be encountered at any time. 
>  Once again, a clever processor could continue processing, storing 
> tree fragments for later use, but it could not output any further 
> elements until it was satisfied that the xsl:for-each had completed.

True

>
> So, I can see how a sufficiently clever XSLT processor could stream 
> output where possible, but this requires the stylesheet author to 
> carefully avoid any construct that would cause output to block.

This is true.  Usually though (and this was the case in my app), you 
spit out a bunch of header html without complex expression evaluation), 
so the user starts to see the top of your page.  That's all it takes to 
convice them that the app is fast, and if anything is slow, it's their 
browser.

In places where we were doing complex evaluations, we either moved 
around the xml input to accomodate, or move complexity into a hand 
coded SAX filter above the XSLT processor.

A good XSLT processor will stream whenever it can.  It is up to the 
architect/designer/programmer to allow it to.

> Most notably, any XPath expression used to control transformation that 
> cannot be sufficiently evaluated until the document is fully parsed 
> must be avoided, and for any non-trivial use of XSLT, this is, to say 
> the least, a hard task.

And it can usually be avoided very easily.

>
> If I'm missing something here, please fill me in, because I am in the 
> process of recommending an XML/XSLT approach to web development here 
> at work, and I'd love to strike out the cost to perceived response 
> times associated with a document transformation.

Make sure that XML is going to pay off first, and then XSLT can follow. 
  Don't let the cart lead the horse :)

Scott

From list at joreybump.com  Fri Aug 20 15:43:35 2004
From: list at joreybump.com (Jorey Bump)
Date: Fri Aug 20 14:43:37 2004
Subject: [mod_python] XSLT versus 'traditional' templating
In-Reply-To: <717509D0-F2CE-11D8-BCA7-000A95D2D288@apache.org>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>	<4123E3AA.1050906@apnic.net>	<87acwsot6y.fsf@tapsellferrier.co.uk>	<4124111A.40105@apnic.net>	<A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>	<4125434B.1020904@apnic.net>
	<717509D0-F2CE-11D8-BCA7-000A95D2D288@apache.org>
Message-ID: <41264657.9050406@joreybump.com>

Scott Sanders wrote:

> This is true.  Usually though (and this was the case in my app), you 
> spit out a bunch of header html without complex expression evaluation), 
> so the user starts to see the top of your page.  That's all it takes to 
> convice them that the app is fast, and if anything is slow, it's their 
> browser.

You're deluding yourself. Users measure speed as the time between the 
request and the moment the desired data hits their eyes. They visit 
other sites; they know when your app is slow. ;)
From sanders at apache.org  Fri Aug 20 13:29:52 2004
From: sanders at apache.org (Scott Sanders)
Date: Fri Aug 20 15:30:07 2004
Subject: [mod_python] XSLT versus 'traditional' templating
In-Reply-To: <41264657.9050406@joreybump.com>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>	<4123E3AA.1050906@apnic.net>	<87acwsot6y.fsf@tapsellferrier.co.uk>	<4124111A.40105@apnic.net>	<A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>	<4125434B.1020904@apnic.net>
	<717509D0-F2CE-11D8-BCA7-000A95D2D288@apache.org>
	<41264657.9050406@joreybump.com>
Message-ID: <4ED7674F-F2DF-11D8-BCA7-000A95D2D288@apache.org>

I am not deluding myself.  If you have two pages that take 50ms to 
render, but one is streamed, every user on this planet (including 
yourself) will think the streamed page is faster.  It is a psycological 
fact of life.  That is part of the reason there is a computer field 
called HCI.

We had a customer that was pissed off about how slow our server app 
was.  All we did is turn off buffering of output (we were doing it to 
catch errors before the user saw the page), and the customer said 
'That's great! Why weren't you doing that before'.  Render time AND 
response time were the same, the only difference was TTFB (time to 
first byte).

Scott

On Aug 20, 2004, at 11:43 AM, Jorey Bump wrote:

> Scott Sanders wrote:
>
>> This is true.  Usually though (and this was the case in my app), you 
>> spit out a bunch of header html without complex expression 
>> evaluation), so the user starts to see the top of your page.  That's 
>> all it takes to convice them that the app is fast, and if anything is 
>> slow, it's their browser.
>
> You're deluding yourself. Users measure speed as the time between the 
> request and the moment the desired data hits their eyes. They visit 
> other sites; they know when your app is slow. ;)
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From list at joreybump.com  Fri Aug 20 17:34:21 2004
From: list at joreybump.com (Jorey Bump)
Date: Fri Aug 20 16:34:24 2004
Subject: [mod_python] XSLT versus 'traditional' templating
In-Reply-To: <4ED7674F-F2DF-11D8-BCA7-000A95D2D288@apache.org>
References: <ca7fdd19040813132417bcc727@mail.gmail.com>	<C88BF6F6-ED70-11D8-A444-000A95B2E4E0@amix.dk>	<ca7fdd190408161651417fc9b6@mail.gmail.com>	<873c2mkt2k.fsf@tapsellferrier.co.uk>	<4123E3AA.1050906@apnic.net>	<87acwsot6y.fsf@tapsellferrier.co.uk>	<4124111A.40105@apnic.net>	<A1C56902-F1ED-11D8-BCA7-000A95D2D288@apache.org>	<4125434B.1020904@apnic.net>	<717509D0-F2CE-11D8-BCA7-000A95D2D288@apache.org>	<41264657.9050406@joreybump.com>
	<4ED7674F-F2DF-11D8-BCA7-000A95D2D288@apache.org>
Message-ID: <4126604D.1090909@joreybump.com>

Scott Sanders wrote:

> I am not deluding myself.  If you have two pages that take 50ms to 
> render, but one is streamed, every user on this planet (including 
> yourself) will think the streamed page is faster.  It is a psycological 
> fact of life.  That is part of the reason there is a computer field 
> called HCI.
> 
> We had a customer that was pissed off about how slow our server app 
> was.  All we did is turn off buffering of output (we were doing it to 
> catch errors before the user saw the page), and the customer said 
> 'That's great! Why weren't you doing that before'.  Render time AND 
> response time were the same, the only difference was TTFB (time to first 
> byte).

I'm not questioning the practice; indicators are a good thing. But in 
spite of the initial rendering, spinning hourglasses and whatnot, users 
are fully aware of how long it takes to get the information they want.

When it comes to users, "slow" is a vague term; "broken" is not. By 
providing indicators, the user gets a buffer in which they don't need to 
worry that the app is broken (yet). This may be the relief you offered 
to your customer by decreasing the TTFB.
From dwmp at opti.cgi.net  Sun Aug 22 04:14:33 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Sun Aug 22 04:15:49 2004
Subject: [mod_python] Cookies & Redirects
Message-ID: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>


I have a script that needs to receive a request, set a cookie, and then 
redirect to another location.  I'm using PSP on mod_python 3.1.3.  I'm not 
getting the Set-Cookie header in the request response.  Here's the code I'm 
using

<%
cookie = "..." # set the cookie to something
req.headers_out.add('Set-Cookie', cookie)
req.headers_out["Location"] = "http://..."
raise apache.SERVER_RETURN, apache.HTTP_SEE_OTHER
%>

I can pull that request up in telnet and the Set-Cookie header is not 
there.  But if I comment out the last line (raise apache.SERVER_RETURN, 
apache.HTTP_SEE_OTHER) then the Set-Cookie header appears in the 
headers.  Also, if I change the line to "raise apache.SERVER_RETURN, 
apache.OK" then the Set-Cookie header appears in the response headers as 
well.  I've also tried returning apache.HTTP_MOVED_TEMPORARILY but no luck 
there either.  Why is it that mod_python seems to honor the Set-Cookie 
header for the OK status code, but not the others?

Thanks!

-Dan



From ossix at ossix.net  Sun Aug 22 21:47:26 2004
From: ossix at ossix.net (steven a)
Date: Sun Aug 22 08:46:31 2004
Subject: [mod_python] Why do I get a 405 ERROR on HEAD REQUEST? 
Message-ID: <4129065E.4080902@ossix.net>

Why do I get a 405 ERROR on HEAD REQUEST?

Here is an example request when using mod_python.publisher:

 bash-2.05b$ telnet my.host.org 80
 Trying 55.55.55.55...
 Connected to my.host.org.
 Escape character is '^]'.
 HEAD /python/viva.py/list HTTP/1.1
 Host: my.host.org

 HTTP/1.1 405 Method Not Allowed
 Date: Sun, 22 Aug 2004 20:08:02 GMT
 Server: Apache/2.0.50 (Gentoo/Linux) mod_python/3.1.3 Python/2.3.3 mod_ssl/2.0.50 OpenSSL/0.9.7d
 Allow: GET,HEAD,POST,TRACE
 Content-Type: text/html; charset=iso-8859-1

 Connection closed by foreign host.


Thanks,
s
From ossix at ossix.net  Mon Aug 23 05:37:34 2004
From: ossix at ossix.net (steven a)
Date: Sun Aug 22 16:36:38 2004
Subject: [mod_python] Why do I get a 405 ERROR on HEAD REQUEST?
In-Reply-To: <4129065E.4080902@ossix.net>
References: <4129065E.4080902@ossix.net>
Message-ID: <4129748E.8090908@ossix.net>

hmm,

it seems that adding "HEAD" to this code in modpython/publisher.py fixes 
the issue:

(around line 41)

def handler(req):
    req.allow_methods(["GET", "POST"])
    if req.method not in ["GET", "POST"]:


is there a more elegant way to fix this?  why does the publisher handler 
set the allowable methods?  shouldn't i have control over that?   do i 
and just not know it?  or do i just have to create my  own publisher?

thanks,s

steven a wrote:

> Why do I get a 405 ERROR on HEAD REQUEST?
>
> Here is an example request when using mod_python.publisher:
>
> bash-2.05b$ telnet my.host.org 80
> Trying 55.55.55.55...
> Connected to my.host.org.
> Escape character is '^]'.
> HEAD /python/viva.py/list HTTP/1.1
> Host: my.host.org
>
> HTTP/1.1 405 Method Not Allowed
> Date: Sun, 22 Aug 2004 20:08:02 GMT
> Server: Apache/2.0.50 (Gentoo/Linux) mod_python/3.1.3 Python/2.3.3 
> mod_ssl/2.0.50 OpenSSL/0.9.7d
> Allow: GET,HEAD,POST,TRACE
> Content-Type: text/html; charset=iso-8859-1
>
> Connection closed by foreign host.
>
>
> Thanks,
> s
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From jombo at 2wire.ch  Mon Aug 23 00:16:25 2004
From: jombo at 2wire.ch (Jean Martin)
Date: Sun Aug 22 17:18:39 2004
Subject: [mod_python] Why do I get a 405 ERROR on HEAD REQUEST?
In-Reply-To: <4129748E.8090908@ossix.net>
Message-ID: <GGECKGHNGKLNPCFLGMBDKEOFCDAA.jombo@2wire.ch>

Hi,

I don't use the publisher, but i take a look and find something interesting
:

As you find if that's not a "GET" or a "POST" an http error is returned to
the client :

publisher.py :

47    req.allow_methods(["GET", "POST"])
48    if req.method not in ["GET", "POST"]:
49        raise apache.SERVER_RETURN, apache.HTTP_METHOD_NOT_ALLOWED

But somewhere the method "HEAD" is correctly handled :

155        if req.method != "HEAD":
156            req.write(result)
157        else:
158            req.write("")
159        return apache.OK

Since the result is everything that's should be send after the header, this
work.
It's look like the previous code [47-49] was added after but, i don't know
why.

Somebody have an idea ?

Well, you should either write your own handler, or keep the modified
publisher if it fit your needs.

Jim

-----Original Message-----
From: mod_python-bounces@modpython.org
On Behalf Of steven a
Sent: lundi, 23. ao?t 2004 06:38

hmm,

it seems that adding "HEAD" to this code in modpython/publisher.py fixes
the issue:

(around line 41)

def handler(req):
    req.allow_methods(["GET", "POST"])
    if req.method not in ["GET", "POST"]:


is there a more elegant way to fix this?  why does the publisher handler
set the allowable methods?  shouldn't i have control over that?   do i
and just not know it?  or do i just have to create my  own publisher?

thanks,s

steven a wrote:

> Why do I get a 405 ERROR on HEAD REQUEST?
>
> Here is an example request when using mod_python.publisher:
>
> bash-2.05b$ telnet my.host.org 80
> Trying 55.55.55.55...
> Connected to my.host.org.
> Escape character is '^]'.
> HEAD /python/viva.py/list HTTP/1.1
> Host: my.host.org
>
> HTTP/1.1 405 Method Not Allowed
> Date: Sun, 22 Aug 2004 20:08:02 GMT
> Server: Apache/2.0.50 (Gentoo/Linux) mod_python/3.1.3 Python/2.3.3
> mod_ssl/2.0.50 OpenSSL/0.9.7d
> Allow: GET,HEAD,POST,TRACE
> Content-Type: text/html; charset=iso-8859-1
>
> Connection closed by foreign host.
>
>
> Thanks,
> s



From maxp at orcon.net.nz  Mon Aug 23 15:06:40 2004
From: maxp at orcon.net.nz (Malcolm Lockyer)
Date: Sun Aug 22 22:06:43 2004
Subject: [mod_python] Silly session help
Message-ID: <41295130.10508@orcon.net.nz>

Hi All,

This is my first post, and I'd just like to say mod_python is awsome :). 
I'm happy to be getting away from the page-by-page style of PHP, and the 
horrible verbosity of java. Anyways - my session questions probably come 
from the fact I'm a relitive python and mod_python noobie. After much 
googling and looking through the mod_python documentation I still can't 
quite figure out how to use sessions.

When I try this example as noted in the mod_python documentation in 
section 4.8.1, it seems that the session keeps getting created :

from mod_python import apache, util, Session

def handler(req) :
    sess = Session.Session(req)
    if sess.is_new() :
        req.write("Hello this is a new session!")
    return apache.OK

Everytime I reload the page I get the "Hello this is a new session!" 
message. I tried checking what the timeout is with the .timeout() 
function, which returns 1800 (which seems to be a reasonable default). 
Anybody know what I'm missing?

At this point even a RTFM in the right direction would be extremely 
helpful...


More info:
Apache/2.0.50 (Gentoo/Linux) mod_python/3.1.3 Python/2.3.3 
mod_ssl/2.0.50 OpenSSL/0.9.7d DAV/2 PHP/5.0.0 Server at localhost Port 80
.htaccess:
SetHandler mod_python
PythonHandler Test
PythonDebug On


Help!


M
From bje at apnic.net  Mon Aug 23 13:21:44 2004
From: bje at apnic.net (Byron Ellacott)
Date: Sun Aug 22 22:20:46 2004
Subject: [mod_python] Silly session help
In-Reply-To: <41295130.10508@orcon.net.nz>
References: <41295130.10508@orcon.net.nz>
Message-ID: <412954B8.6080000@apnic.net>

Malcolm Lockyer wrote:
> def handler(req) :
>    sess = Session.Session(req)
>    if sess.is_new() :
>        req.write("Hello this is a new session!")
          sess.save()
>    return apache.OK
> Anybody know what I'm missing?

Probably the line I sneakily added in there. :)

-- 
bje
From maxp at orcon.net.nz  Mon Aug 23 16:40:48 2004
From: maxp at orcon.net.nz (Malcolm Lockyer)
Date: Sun Aug 22 23:40:50 2004
Subject: [mod_python] PythonAutoReload?
Message-ID: <41296740.3070000@orcon.net.nz>

Hi All (again),

Thanks for the quick replies to my previous dumb question!


In my mod_python application I intend to load several modules from a 
package. It seems that at the moment when I import the module it stays 
in memory, even when I change and save it.

Example -
from mod_python import apache
from application import Authentication

def handler :
    req.content_type = "text/html"
    if Authentication.check() == 1 :
       req.write("You are authenticated")
    else :
       req.write("You aren't authenticated!")
    return apache.OK

(Authentication.py inside application folder)
def check() :
    return 1

That is all fine and dandy, but when I change it to return 0 - the 
output doesn't change. I just assume that on first import it compiles 
the bytecode and keeps it. When I re-start apache it changes, but 
doesn't change again. This is annoying during development (since its 
changing all the time).

I noticed the PythonAutoReload directive, even though it defaults to on, 
I added it to my .htaccess with no change. Also there isn't just a .pyc 
in the application folder I can delete.


Any ideas would be appreciated....
(sorry if this is *really* dumb!)


M
From bje at apnic.net  Mon Aug 23 14:48:31 2004
From: bje at apnic.net (Byron Ellacott)
Date: Sun Aug 22 23:47:32 2004
Subject: [mod_python] PythonAutoReload?
In-Reply-To: <41296740.3070000@orcon.net.nz>
References: <41296740.3070000@orcon.net.nz>
Message-ID: <4129690F.2000007@apnic.net>

Malcolm Lockyer wrote:
> from mod_python import apache
> from application import Authentication
> I noticed the PythonAutoReload directive, even though it defaults to on, 
> I added it to my .htaccess with no change. Also there isn't just a .pyc 
> in the application folder I can delete.

I'm not sure if this is really what goes on, but I believe the 
PythonAutoReload directive tells mod_python that when it needs a module 
to handle a request, it should automatically reload any changed modules.

This doesn't tell Python itself that all imports should reload changed 
modules.

There are two solutions here.  The first is to configure your Apache 
process to be more conducive to debugging: MaxRequestsPerChild of 1, or 
start it in single process mode, or something similar.  The second is to 
use:

from application import Authentication
if DEBUG_ON: reload(Authentication)

I'd probably go with the first solution, if practical.

-- 
bje
From jim-mod-python at jimdabell.com  Mon Aug 23 06:03:42 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Sun Aug 22 23:58:35 2004
Subject: [mod_python] Cookies & Redirects
In-Reply-To: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
References: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
Message-ID: <200408230503.42639.jim-mod-python@jimdabell.com>

On Sunday 22 August 2004 09:14, Daniel West wrote:
> I have a script that needs to receive a request, set a cookie, and then
> redirect to another location.  I'm using PSP on mod_python 3.1.3.  I'm not
> getting the Set-Cookie header in the request response.
[snip]
> Why is it that mod_python seems to honor the Set-Cookie header for the OK
> status code, but not the others?

Your mistake is in assuming that adding something to req.headers_out will 
result in headers being sent out ;).

For some reason, mod_python has separated the concept of response headers out 
into two separate types - headers that are sent out in normal conditions, and 
headers that are sent out in error conditions.  I would guess that raising 
any type of exception will cause mod_python to ignore normal headers (but 
still pull out Location in the case of HTTP_SEE_OTHER).

In other words, the working version of the code you posted is:

<%
cookie = "..." # set the cookie to something
req.err_headers_out.add('Set-Cookie', cookie) # note use of err_headers_out
req.headers_out["Location"] = "http://..."
raise apache.SERVER_RETURN, apache.HTTP_SEE_OTHER
%>

I personally think it's pretty silly to have two separate sets of headers, I'm 
guessing this is an internal Apache issue that is being exposed 
unnecessarily.  Especially in this case, it is nonsensical to consider a 
simple redirect to be an error condition that should ignore normal headers.

Also note that using psp.redirect() instead of raising an exception provides 
the behaviour you want.  Another alternative is to set req.status to what you 
want and raise apache.OK.  Also, it appears whoever wrote util.redirect() is 
aware of the problem, as it manually sets req.status and then raises 
apache.OK, rather than simply raising an exception with the correct value.

Under what circumstances is having separate sets of headers useful?  Does 
anybody actually need this?  It seems to me that it would be far more 
intuitive to have headers_out sent for every type of response.  At the very 
least, 3xx status codes should not be treated as an error condition (that's 
what 4xx and 5xx are for).

-- 
Jim Dabell

From bje at apnic.net  Mon Aug 23 15:08:41 2004
From: bje at apnic.net (Byron Ellacott)
Date: Mon Aug 23 00:07:42 2004
Subject: [mod_python] Cookies & Redirects
In-Reply-To: <200408230503.42639.jim-mod-python@jimdabell.com>
References: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
	<200408230503.42639.jim-mod-python@jimdabell.com>
Message-ID: <41296DC9.3070205@apnic.net>

Jim Dabell wrote:
> Under what circumstances is having separate sets of headers useful?  Does 

def handle_response():
     set_content_type()
     set_cache_controls()
     set_content_length()
     do_fallible_operation()
     return apache.OK

... and if do_fallible_operation() happens to raise an exception, 
assuming it's handled correctly and an appropriate error message is 
generated for the user and a 5xx return code is raised, then the content 
type, length and cache controls that have been set are no longer 
appropriate.

Essentially, having a separate set of headers for error output allows 
you to handle an error when it occurs, and not worry about it otherwise, 
by giving you a clean slate to work with when generating an error response.

Whether that's worth while or not is another question, but those are 
probably the circumstances under which it's useful to ahve separate headers.

-- 
bje
From maxp at orcon.net.nz  Mon Aug 23 17:53:51 2004
From: maxp at orcon.net.nz (Malcolm Lockyer)
Date: Mon Aug 23 00:53:57 2004
Subject: [mod_python] PythonAutoReload?
In-Reply-To: <4129690F.2000007@apnic.net>
References: <41296740.3070000@orcon.net.nz> <4129690F.2000007@apnic.net>
Message-ID: <4129785F.8040301@orcon.net.nz>

Thanks for the reply.


Gah this is frustrating.. so far I've tried ->

* Reloading the module on each page of the handler
* Changing the MaxRequestsPerChild to 1
* Changing the StartServers, MinSpareServers and MaxSpareServers to 1

With no change. Each approach seemed to slightly modify the behavior, 
with the reloading and with all the server directives set to 1 - it 
started alternating between the two outcomes (obviously apache has a 
sense of humor :P). I currently can't figure out weither the actual 
updating is triggered by the number of refreshes, or the time - since I 
havn't had any reproducable results with either. Seems to range between 
40 seconds and 1min 30, and 60 and 170 refreshes. Its like its picking a 
random number of time and requests and actually reloading the module 
when either of them is reached (even though I know its not, thats what 
it looks like). Also after re-reading the documentation again it says: 
"""By default, mod_python checks the time-stamp of the file and reloads 
the module if the module's file modification date is later than the last 
import or reload. This way changed modules get automatically reimported, 
eliminating the need to restart the server for every change."""

So I've checked the time on my linux box, and ntp is still functioning 
properly. The time differnce between my two machines is <1 second as far 
as I can tell. Also the file modify time (with ls) is clearly earlier 
than the current "date" - and it still doesn't reload.

Its just mocking me now :S...

Anyhow - enough time wasted, guess I'll be restarting apache alot. 
Thanks for your help though.

:'(

M


Byron Ellacott wrote:

> Malcolm Lockyer wrote:
>
>> from mod_python import apache
>> from application import Authentication
>> I noticed the PythonAutoReload directive, even though it defaults to 
>> on, I added it to my .htaccess with no change. Also there isn't just 
>> a .pyc in the application folder I can delete.
>
>
> I'm not sure if this is really what goes on, but I believe the 
> PythonAutoReload directive tells mod_python that when it needs a 
> module to handle a request, it should automatically reload any changed 
> modules.
>
> This doesn't tell Python itself that all imports should reload changed 
> modules.
>
> There are two solutions here.  The first is to configure your Apache 
> process to be more conducive to debugging: MaxRequestsPerChild of 1, 
> or start it in single process mode, or something similar.  The second 
> is to use:
>
> from application import Authentication
> if DEBUG_ON: reload(Authentication)
>
> I'd probably go with the first solution, if practical.
>

From jim-mod-python at jimdabell.com  Mon Aug 23 07:06:03 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Mon Aug 23 01:00:45 2004
Subject: [mod_python] Cookies & Redirects
In-Reply-To: <41296DC9.3070205@apnic.net>
References: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
	<200408230503.42639.jim-mod-python@jimdabell.com>
	<41296DC9.3070205@apnic.net>
Message-ID: <200408230606.03827.jim-mod-python@jimdabell.com>

On Monday 23 August 2004 05:08, Byron Ellacott wrote:
> Jim Dabell wrote:
> > Under what circumstances is having separate sets of headers useful?  Does
>
> def handle_response():
>      set_content_type()
>      set_cache_controls()
>      set_content_length()
>      do_fallible_operation()
>      return apache.OK
>
> ... and if do_fallible_operation() happens to raise an exception,
> assuming it's handled correctly and an appropriate error message is
> generated for the user and a 5xx return code is raised, then the content
> type, length and cache controls that have been set are no longer
> appropriate.

I see what you mean, but surely it's a bad idea to assume success and output 
headers before you try do_fallible_operation()?  Wouldn't it be far better to 
attempt do_fallible_operation() before outputting headers that depend upon 
success?

On the flip side, there are all sorts of situations where it's a pain in the 
neck - caching 410 responses, setting the correct media type/character 
encoding, debugging information, etc.  It's not a good idea to assume headers 
wouldn't apply to error conditions.

It just seems to me that it's an optimisation that only works for poorly 
structured handlers and can get in the way of other people.  If somebody 
outputs headers and then realises the headers are wrong later in the program, 
well then they should either use a better design or take the headers back out 
again before raising an exception.

Is there a list somewhere of which items in headers_out get used in error 
conditions?  The Location header is, but what about others?  A quick skim of 
the source didn't reveal much, but I don't really know my way around it that 
well yet.

-- 
Jim Dabell

From mlists at rotondo.it  Mon Aug 23 10:09:09 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Mon Aug 23 03:06:08 2004
Subject: [mod_python] PythonAutoReload?
In-Reply-To: <4129785F.8040301@orcon.net.nz>
References: <41296740.3070000@orcon.net.nz> <4129690F.2000007@apnic.net>
	<4129785F.8040301@orcon.net.nz>
Message-ID: <41299815.3050405@rotondo.it>

Malcolm Lockyer wrote:

> Gah this is frustrating.. so far I've tried ->
> 
> * Reloading the module on each page of the handler
> * Changing the MaxRequestsPerChild to 1
> * Changing the StartServers, MinSpareServers and MaxSpareServers to 1
> 
> With no change. Each approach seemed to slightly modify the behavior, 

Hi Malcolm,

I have the same problem, but I have resolved it in a faster (and much 
more dirty) way: I simply restart Apache every time I have made a change 
in my code that mod_python would not be able to see.

As far as I can tell, there are two kind of files those you'll be pretty 
sure mod_python will reload and those you wont.
For example, in my app, I have some code that goes inside 
/usr/lib/python/site-packages/(mydir)
These files are *not* reloaded by mod_python and when I change them I 
have to restart apache in order to see the changes.

The "plugin" directory, on the other hand, that is not contained inside 
"site-packages" is reloaded every time I hit the "reload" button on my 
browser.

Now, I don't know the logic behind PSP pages or related to your code, 
but you should make some tests and find out when an Apache restart is 
needed.

BTW: keep in mind that (with the standard Apache config) there could be 
more than one single thread that keeps running your app. This means that 
  one thread could have a version of your code more recent/older than 
the other.

You have to restart Apache only while you are developing. I know this 
can be annoying, but it is the only *safe* way I found out to be sure 
that what you write is what you get :-)
Furthermore, once your app is deployed it is handy to have mod_python to 
keep your mods around: your app will run faster.

Hope this helps.

Ciao,

    Fabio

From dwmp at opti.cgi.net  Mon Aug 23 04:19:39 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Mon Aug 23 04:18:37 2004
Subject: [mod_python] Cookies & Redirects
In-Reply-To: <200408230503.42639.jim-mod-python@jimdabell.com>
References: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
	<5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040823031832.0194c620@mail.pyxos.com>


Thanks for the very informative post Jim!  I was totally unaware of 
err_headers_out and your other suggestions were very helpful as 
well!  Thank you!

-Dan



At 05:03 AM 8/23/2004 +0100, you wrote:
>On Sunday 22 August 2004 09:14, Daniel West wrote:
> > I have a script that needs to receive a request, set a cookie, and then
> > redirect to another location.  I'm using PSP on mod_python 3.1.3.  I'm not
> > getting the Set-Cookie header in the request response.
>[snip]
> > Why is it that mod_python seems to honor the Set-Cookie header for the OK
> > status code, but not the others?
>
>Your mistake is in assuming that adding something to req.headers_out will
>result in headers being sent out ;).
>
>For some reason, mod_python has separated the concept of response headers out
>into two separate types - headers that are sent out in normal conditions, and
>headers that are sent out in error conditions.  I would guess that raising
>any type of exception will cause mod_python to ignore normal headers (but
>still pull out Location in the case of HTTP_SEE_OTHER).
>
>In other words, the working version of the code you posted is:
>
><%
>cookie = "..." # set the cookie to something
>req.err_headers_out.add('Set-Cookie', cookie) # note use of err_headers_out
>req.headers_out["Location"] = "http://..."
>raise apache.SERVER_RETURN, apache.HTTP_SEE_OTHER
>%>
>
>I personally think it's pretty silly to have two separate sets of headers, 
>I'm
>guessing this is an internal Apache issue that is being exposed
>unnecessarily.  Especially in this case, it is nonsensical to consider a
>simple redirect to be an error condition that should ignore normal headers.
>
>Also note that using psp.redirect() instead of raising an exception provides
>the behaviour you want.  Another alternative is to set req.status to what you
>want and raise apache.OK.  Also, it appears whoever wrote util.redirect() is
>aware of the problem, as it manually sets req.status and then raises
>apache.OK, rather than simply raising an exception with the correct value.
>
>Under what circumstances is having separate sets of headers useful?  Does
>anybody actually need this?  It seems to me that it would be far more
>intuitive to have headers_out sent for every type of response.  At the very
>least, 3xx status codes should not be treated as an error condition (that's
>what 4xx and 5xx are for).
>
>--
>Jim Dabell
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From AJDENSTONE at BKB.com.br  Mon Aug 23 13:30:27 2004
From: AJDENSTONE at BKB.com.br (AJDENSTONE@BKB.com.br)
Date: Mon Aug 23 11:32:16 2004
Subject: RES: [mod_python] The right way to handle sessions
Message-ID: <DBBA2C22AB83D711BBBC0008C75DC9541131201B@BRSAOMXMP02.sp.bra.bkb.com>

Hi Amir.

	You can add your code snippet in the mod_python wiki cookbook
(http://modpython.coedit.net/CookBook). 

	Regards,

Alexandre Denstone
BankBoston - Retail Internet Systems
* ajdenstone@bkb.com.br


-----Mensagem original-----
De: Amir Salihefendic [mailto:amix@amix.dk] 
Enviada em: sexta-feira, 13 de agosto de 2004 12:32
Para: mod_python user mailing list
Assunto: Re: [mod_python] The right way to handle sessions


> def createSession(req):
>     new_session = Session.Session(req)
>     new_session.unlock()
>
>     #Check id
>     req.write(new_session.id())
>
>     return getSameSession(req, new_session.id())
>
> def getSameSession(req, SID):
>     same_session = Session.Session(req, SID)
>
>     #Check id
>     req.write("\n%s\n" % same_session.id())
>
>     return "Done"

Argh forgot something very important (to save the damn session)!: def
createSession(req):
     new_session = Session.Session(req)
     new_session.save()
     new_session.unlock()

     #Check id
     req.write(new_session.id())

     return getSameSession(req, new_session.id())

def getSameSession(req, SID):
     same_session = Session.Session(req, SID)
     same_session.load()

     #Check id
     req.write("\n%s\n" % same_session.id())

     return "Done"

*Tsk tsk*

Med venlig hilsen / Kind regards
Amir Salihefendic
-----
What we do in life echoes in eternity
Den 13/8-2004, kl. 13.30, skrev Amir Salihefendic:

> Thanks a lot for your time spent on the reply, I appreciate it.
>
> "Under what circumstances do you call createSession() instead of
> getSameSession()?"
>
> Let's take another example:
> I am making a blog-system where I need to have an admin section. I am
> using the publisher handler.
> Simple forms post username and password to admin.py
> Admin.py has an index function, which has username and password as 
> input.
> In the index function I check if the username and password match, if 
> they do I create an session and store username and password.
> Now, I need to redirect to a new function viewPosts (it's also located 
> in the admin module).
>
> In viewPosts I have to check if the right session is set - else
> somebody could do admin.py/viewPosts and get access to the admin 
> section.
>
> Of course, I could solve problem in many other ways:
> - Send the SID to viewPosts
> - Place everything in one function (i.e. place everything in
> admin.py/index)
> - "Append" the session to the req object
> - Make viewPosts private (i.e. do _viewPosts) and then I can only 
> access it by going through admin.py/index
> -etc.
>
> Anyway, I am interested in knowing: What is the smartest way to
> "share"/access same session across functions (i.e. when you are 
> internal "redirecting")? Example of what I mean by "redirecting" (not 
> working...):
> def createSession(req):
>     new_session = Session.Session(req)
>     return getSameSession(req)
>
> def getSameSession(req):
>     same_session = Session.Session(req)
>     return same_session.id()
>
>
> My guess is to send the SID (working). This seems to be a very light
> and easy approach:
> def createSession(req):
>     new_session = Session.Session(req)
>     new_session.unlock()
>
>     #Check id
>     req.write(new_session.id())
>
>     return getSameSession(req, new_session.id())
>
> def getSameSession(req, SID):
>     same_session = Session.Session(req, SID)
>
>     #Check id
>     req.write("\n%s\n" % same_session.id())
>
>     return "Done"
>
> (This is a solution I use now.) Of course this is very simplified
> example...
>
> Med venlig hilsen / Kind regards
> Amir Salihefendic
> -----
> What we do in life echoes in eternity
> Den 13/8-2004, kl. 1.17, skrev Byron Ellacott:
>
>> Amir Salihefendic wrote:
>>> I welcome myself to this list ;-)
>>
>> Welcome!
>>
>> [working example]
>>> def createSession(req):
>>> def getSameSession(req):
>>
>> The important thing to note here is that the code is identical in
>> both calls.  That is, if you call Session.Session(req) with no 
>> session ID in cookies, or the existing session ID has no matching 
>> session stored on disk, a new session ID is generated.
>>
>> But, the session is /not/ written to disk.
>>
>>> def createSession(req):
>>>     return getSameSession(req)
>>> def getSameSession(req):
>>>     return same_session.id()
>>
>> So when you change to calling getSameSession() from createSession()
>> you are in fact creating /two/ sessions.  My guess would be that your 
>> apparent infinite loop is in fact a deadlock, caused by the fact that 
>> your second created session will be reusing the session ID created by 
>> the first one, and then attempting to establish a global lock on that 
>> session ID.  Bad.
>>
>>> This does not work - it makes an infinitive loop..!  Now to fix this
>>> you need to unlock the session in createSession (.. I have no clue 
>>> why you have to do this..?). And then you need to restart apache...  
>>> i.e.:
>>
>> This bears up my analysis well.  The locking done by the Session
>> module is an Apache-wide lock on the session ID.  So, when 
>> createSession() first creates a session, it locks that sid.  Then, it 
>> calls getSameSession() which attempts to lock the same sid.  The lock 
>> call blocks here, waiting for the first lock to be released, but that 
>> release will never come.  If you cause the first created session to 
>> unlock itself, you will not create a deadlock, but you will need to 
>> restart apache to break an existing deadlock.
>>
>>> But this does not work quite well.. If you delete the Session: And 
>>> then you do this: First time the id's aren't same - after that they 
>>> are the same.
>>
>> When a session has been deleted, it is marked as invalid and calling
>> .load() on that sid will fail.  .__init__() will create a new sid if 
>> .load() fails for an existing one, so I suspect you are seeing this 
>> behaviour.
>>
>> Overall, it seems you are making the session management process far
>> more complicated than it needs to be.  Under what circumstances do 
>> you call createSession() instead of getSameSession() ?
>>
>> I am successfully using the Session module to handle an HTML forms
>> based login system:
>>
>> session = Session.Session(req)
>> if NeedAuth and not session.has_key('username'):
>>     redirect(AuthPage)
>> ServePage(req)
>> session.save()
>> return apache.OK
>>
>> This is a simplification, since I use an extensible application
>> object that allows you to change how sessions are generated and how 
>> users are authenticated, but it boils down to the above.  I create a 
>> new session or get an existing session.  I do not care which.  If the 
>> page being requested needs auth, but the session doesn't contain a 
>> username key, I redirect[1] to the login page, which stores the 
>> username value into the session if the user presents the right 
>> credentials.  Otherwise, I serve the requested page, then save the 
>> session, and Bob's a builder.
>>
>> Note that I cannot distinguish between an expired session and no
>> session at all, but this is a limitation of the Session module.  I 
>> can distinguish between a new session and an existing session by 
>> calling session.is_new(), but that distinction turns out not to be 
>> very important.
>>
>> At some point, I will need to extract the sid from the cookie set
>> myself, to be able to distinguish between a timed out session, an 
>> invalidated session, a missing session and a brand new session.  (Or 
>> else I'll have to patch the Session module, which I'm not real keen 
>> to do.)
>>
>> --
>> bje
>>
>> [1] The 'redirects' I do are simply changing what view my code
>> believes it is processing, so execution continues down the line, and 
>> session.save() is called in due order.  If you're using an Apache 
>> internal redirect or a 302/303 redirect, you should ensure new 
>> sessions are saved as soon as created with "if session.is_new(): 
>> session.save()".
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org 
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


Esta mensagem, incluindo seus anexos, pode conter informacao confidencial
e/ou privilegiada. Se voce recebeu este e-mail por engano, nao utilize,
copie ou divulgue as informacoes nele contidas. E, por favor, avise
imediatamente o remetente, respondendo ao e-mail, e em seguida apague-o.
Este e-mail possui conteudo informativo e nao transacional. Caso necessite
de atendimento imediato, recomendamos utilizar um dos canais disponiveis:
Internet Banking <http://www.bankboston.com.br>  , BankBoston por telefone
<http://www.bankboston.com.br/bpt>  ou agencia/representante de atendimento
de sua conveniencia. Agradecemos sua colaboracao.
This message, including its attachments, may contain confidential and/or
privileged information. If you received this email by mistake, do not use,
copy or disseminate any information herein contained. Please notify us
immediately by replying to the sender and then delete it. This email is for
information purposes only, not for transactions. In case you need immediate
assistance, please use one of the following channels: Internet Banking
<http://www.bankboston.com.br>  ,  BankBoston by phone
<http://www.bankboston.com.br/bpt>  or branch/relationship manager at your
convenience. Thank you for your cooperation.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040823/46671728/attachment-0001.html
From grisha at modpython.org  Mon Aug 23 13:53:28 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 23 12:53:32 2004
Subject: [mod_python] Cookies & Redirects
In-Reply-To: <200408230503.42639.jim-mod-python@jimdabell.com>
References: <5.2.1.1.2.20040822030418.02a98ec0@mail.pyxos.com>
	<200408230503.42639.jim-mod-python@jimdabell.com>
Message-ID: <20040823124844.N34583@onyx.ispol.com>



On Mon, 23 Aug 2004, Jim Dabell wrote:

> For some reason, mod_python has separated the concept of response headers out
> into two separate types - headers that are sent out in normal conditions, and
> headers that are sent out in error conditions.

This isn't really a mod_python thing, it's how Apache does it - mod_python 
just exposes what's there to Python.

There is a pretty good explanation of how it works here:

http://ken.coar.org/burrow/index?entry=511&comments=true

Grisha
From grisha at modpython.org  Mon Aug 23 13:59:36 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 23 12:59:43 2004
Subject: [mod_python] PythonAutoReload?
In-Reply-To: <41299815.3050405@rotondo.it>
References: <41296740.3070000@orcon.net.nz> <4129690F.2000007@apnic.net>
	<4129785F.8040301@orcon.net.nz> <41299815.3050405@rotondo.it>
Message-ID: <20040823125432.I34583@onyx.ispol.com>



On Mon, 23 Aug 2004, Fabio Rotondo wrote:

>
> As far as I can tell, there are two kind of files those you'll be pretty sure 
> mod_python will reload and those you wont.
> For example, in my app, I have some code that goes inside 
> /usr/lib/python/site-packages/(mydir)
> These files are *not* reloaded by mod_python and when I change them I have to 
> restart apache in order to see the changes.

unless you import them using apache.import_module() :-)

> You have to restart Apache only while you are developing. I know this 
> can be annoying, but it is the only *safe* way I found out to be sure 
> that what you write is what you get :-)

Exactly. The Python docs for the reload() function are pretty clear that 
there are caveats, such as that the module's dictionary of global 
variables persists throughout reloads.

Grisha
From peter at newton.cx  Mon Aug 23 17:14:37 2004
From: peter at newton.cx (Peter Williams)
Date: Mon Aug 23 16:14:40 2004
Subject: [mod_python] Next release of mod_python
Message-ID: <1093292076.2114.39.camel@beta.newton.cx>

Hello,

Can anyone tell me when the next release of the 3.1 series of mod_python
is planned? I'm having problems where my apache server sucks up all
available RAM, and I suspect mod_python is the culprit. On the other
hand, there hasn't been a release for a while, so I was wondering if
maybe this problem has been fixed since 3.1.3 came out.

Peter

-- 
Peter Williams                          peter@newton.cx

"[Ninjas] are cool; and by cool, I mean totally sweet."
                              -- REAL Ultimate Power

From grisha at modpython.org  Mon Aug 23 17:47:30 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 23 16:47:35 2004
Subject: [mod_python] Next release of mod_python
In-Reply-To: <1093292076.2114.39.camel@beta.newton.cx>
References: <1093292076.2114.39.camel@beta.newton.cx>
Message-ID: <20040823164542.T36938@onyx.ispol.com>


Things have been kinda slow in mod_python development land, so I don't 
think there will be another release for at least a month (if not two).

However, are you sure that the memory leak isn't caused by your Python 
code somehow?

Grisha

On Mon, 23 Aug 2004, Peter Williams wrote:

> Hello,
>
> Can anyone tell me when the next release of the 3.1 series of mod_python
> is planned? I'm having problems where my apache server sucks up all
> available RAM, and I suspect mod_python is the culprit. On the other
> hand, there hasn't been a release for a while, so I was wondering if
> maybe this problem has been fixed since 3.1.3 came out.
>
> Peter
>
> --
> Peter Williams                          peter@newton.cx
>
> "[Ninjas] are cool; and by cool, I mean totally sweet."
>                              -- REAL Ultimate Power
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From peter at newton.cx  Mon Aug 23 18:03:01 2004
From: peter at newton.cx (Peter Williams)
Date: Mon Aug 23 17:03:04 2004
Subject: [mod_python] Next release of mod_python
In-Reply-To: <20040823164542.T36938@onyx.ispol.com>
References: <1093292076.2114.39.camel@beta.newton.cx>
	<20040823164542.T36938@onyx.ispol.com>
Message-ID: <1093294981.2114.45.camel@beta.newton.cx>

On Mon, 2004-08-23 at 16:47, Gregory (Grisha) Trubetskoy wrote:
> Things have been kinda slow in mod_python development land, so I don't 
> think there will be another release for at least a month (if not two).

Ok, thanks.

> 
> However, are you sure that the memory leak isn't caused by your Python 
> code somehow?

No. But the problem isn't just a memory leak: the apache process will
somehow get wedged and eat up memory as fast as it can. The code is
pretty straightforward so I don't think it should cause any behavior
like that. Of course I'm also looking into the code, but I'm not very
good at debugging Python programs and I'm getting frustrated with my
server locking up.

Thanks for your help,

Peter

-- 
Peter Williams                          peter@newton.cx

"[Ninjas] are cool; and by cool, I mean totally sweet."
                              -- REAL Ultimate Power

From rdavisunr at yahoo.com  Mon Aug 23 16:20:27 2004
From: rdavisunr at yahoo.com (Robert Thomas Davis)
Date: Mon Aug 23 18:20:29 2004
Subject: [mod_python] set_error_page
Message-ID: <20040823222027.93976.qmail@web81204.mail.yahoo.com>

Hello All

I have been searching through the mailing list
archives and reading through documentation +
onlamp.com article trying to find an example of how to
use the set_error_page() method.  If anyone could
paste up some example code I would really appreciate
it.  Thanks

Rob
From toby at rcsreg.com  Mon Aug 23 10:01:47 2004
From: toby at rcsreg.com (Tobiah)
Date: Mon Aug 23 18:56:59 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
Message-ID: <412A14EB.2080600@rcsreg.com>

(sent from wrong email first time)

Using mod_python to load an index.py file, all works as
expected.  If however, I make changes to modules that
are imported by that script,  I get odd behaviour where
old versions of the modules seem to load.

 From the FAQ, I see the suggestion:

  DEBUG = 1

  import mymodulea
  import mymoduleb

  if DEBUG:
         mymodulea = reload(mymodulea)
         mymoduleb = reload(mymoduleb)


That is O.K., but still, unwieldy.  Also,
if my imported modules import other modules,
wouldn't they have to have their own DEBUG
flag, or would the top reload() then propagate
out?

Is this DEBUG flag method widely used?  It
would seem that something a bit more elegant
would have been created by now.

Thanks,

Toby


From toby at rcsreg.com  Mon Aug 23 10:34:09 2004
From: toby at rcsreg.com (Tobiah)
Date: Mon Aug 23 19:29:22 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412A14EB.2080600@rcsreg.com>
References: <412A14EB.2080600@rcsreg.com>
Message-ID: <412A1C81.5070805@rcsreg.com>


>  DEBUG = 1
> 
>  import mymodulea
>  import mymoduleb
> 
>  if DEBUG:
>         mymodulea = reload(mymodulea)
>         mymoduleb = reload(mymoduleb)
> 
> 
> That is O.K., but still, unwieldy. 

What's more it does not always work.  The docs on
the reload() function reveal that many of the changes
that I make to a module will not have any effect.

If I change the name of a class for instance, the
old one still exists until the apache server is restarted.

So, is there any way at all that I can avoid caching python
objects entirely while developing?

Thanks

Tobiah
From grisha at modpython.org  Mon Aug 23 20:54:08 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 23 19:54:12 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412A1C81.5070805@rcsreg.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
Message-ID: <20040823195052.E38604@onyx.ispol.com>


On Mon, 23 Aug 2004, Tobiah wrote:

>
>>  DEBUG = 1
>> 
>>  import mymodulea
>>  import mymoduleb
>> 
>>  if DEBUG:
>>         mymodulea = reload(mymodulea)
>>         mymoduleb = reload(mymoduleb)
>> 
>> 
>> That is O.K., but still, unwieldy.

This method is pretty old, now a simpler way to do it is:

mymodulea = apache.import_module("mymodulea")
mymoduleb = apache.import_module("mymoduleb")

This will obey the PythonAutoReload setting. Note that it still uses 
reload() under the hood.

> What's more it does not always work.  The docs on
> the reload() function reveal that many of the changes
> that I make to a module will not have any effect.
>
> If I change the name of a class for instance, the
> old one still exists until the apache server is restarted.
>
> So, is there any way at all that I can avoid caching python
> objects entirely while developing?

No, not without altering how Python works, which is way outside the scope 
of mod_python.

Grisha
From nicolas at lehuen.com  Tue Aug 24 12:36:20 2004
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Tue Aug 24 05:36:26 2004
Subject: [mod_python] Next release of mod_python
In-Reply-To: <20040823164542.T36938@onyx.ispol.com>
Message-ID: <200408240936.i7O9aLIF006835@modpython.org>

Hi,

I also have a memory leak on my Apache process and it seems to come from
either mod_python or my Python code. I use the publisher handler with a very
straightforward Python module, which does not use sessions or any persistent
data. I solved the problem the dirty way (i.e. apache -k restart at 3 AM
every day), but it's, well, dirty :).

Maybe it is not a true memory leak, but a consequence of the Python memory
management scheme ? I noticed on long-running scripts that Python can
allocate a pretty big amount of memory before noticing it is not used (maybe
during a garbage collection) and releasing it. The trouble is that on my 1
Gb server, Apache + mod_python actually went up to 600 Mb of memory without
giving any hint that it would release anything. I had to restart Apache
before the end of the experiment, so that my other services would not
trash...

Regards,

Nicolas

> -----Message d'origine-----
> De : mod_python-bounces@modpython.org 
> [mailto:mod_python-bounces@modpython.org] De la part de 
> Gregory (Grisha) Trubetskoy
> Envoy? : lundi 23 ao?t 2004 22:48
> ? : mod_python user mailing list
> Objet : Re: [mod_python] Next release of mod_python
> 
> 
> Things have been kinda slow in mod_python development land, 
> so I don't think there will be another release for at least a 
> month (if not two).
> 
> However, are you sure that the memory leak isn't caused by 
> your Python code somehow?
> 
> Grisha
> 
> On Mon, 23 Aug 2004, Peter Williams wrote:
> 
> > Hello,
> >
> > Can anyone tell me when the next release of the 3.1 series of 
> > mod_python is planned? I'm having problems where my apache server 
> > sucks up all available RAM, and I suspect mod_python is the 
> culprit. 
> > On the other hand, there hasn't been a release for a while, 
> so I was 
> > wondering if maybe this problem has been fixed since 3.1.3 came out.
> >
> > Peter
> >
> > --
> > Peter Williams                          peter@newton.cx
> >
> > "[Ninjas] are cool; and by cool, I mean totally sweet."
> >                              -- REAL Ultimate Power
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


From tme-h81 at myamail.com  Tue Aug 24 13:33:23 2004
From: tme-h81 at myamail.com (FC)
Date: Tue Aug 24 06:33:27 2004
Subject: [mod_python] mod_python error.
Message-ID: <068B9008-F5B9-11D8-822D-000A9575BCC8@myamail.com>


Hi,

I am new on this mailing list and a new mod_python user.
While I was playing with mod_python I have noticed lines like this 
following one in my apache error_log file. I have one of this error for 
every request. Also, I am running FreeBSD 4.10, Python 2.3.4 and 
apache/2.0.50

[Tue Aug 24 11:05:20 2004] [notice] child pid 21274 exit signal Abort 
trap (6)

Can someone tell me what's wrong and how ca I fix it.

I am sorry to bother everyone if this issue has been already discussed 
on this list.

Since I am learning mod_python, I am also interested by pointers on 
docs or code samples.

Cheers
Fred

From jim-mod-python at jimdabell.com  Tue Aug 24 16:08:20 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Tue Aug 24 10:02:57 2004
Subject: [mod_python] set_error_page
In-Reply-To: <20040823222027.93976.qmail@web81204.mail.yahoo.com>
References: <20040823222027.93976.qmail@web81204.mail.yahoo.com>
Message-ID: <200408241508.20184.jim-mod-python@jimdabell.com>


> I have been searching through the mailing list
> archives and reading through documentation +
> onlamp.com article trying to find an example of how to
> use the set_error_page() method.  If anyone could
> paste up some example code I would really appreciate
> it.  Thanks

Sure, suppose you have index.psp.  Put this at the top of it:

<% psp.set_error_page('error.psp') %>

And create a file called error.psp in the same directory.  This will be just 
like a normal PSP file, except it will have an additional variable passed to 
it called 'exception'.  For example, you could use something like this:

<%
import smtplib, traceback

(exceptionType, exceptionValue, tb) = exception

message = """Subject: Error

An error has occurred with the website.
The exception type is %s
The exception value is %s
A traceback follows:
%s""" % (exceptionType, exceptionValue, traceback.format_tb(tb))

mailServer = smtplib.SMTP('mail.example.com')
mailServer.sendmail('errors@example.com', 'webmaster@example.com', message)
mailServer.quit()

%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" 
"http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head>
  <title>Error</title>
 </head>
 <body>
  <h1>Error</h1>
  <p>
   An error has occurred and the administrators have been notified.
  </p>
 </body>
</html>

I'm sure you can make the page much more friendlier, but this is just an 
example :).

-- 
Jim Dabell

From gdamjan at mail.net.mk  Tue Aug 24 18:27:45 2004
From: gdamjan at mail.net.mk (Damjan)
Date: Tue Aug 24 11:27:49 2004
Subject: [mod_python] Problems loading .psp's
In-Reply-To: <cg2vqc$sks$1@sea.gmane.org>
References: <cg2vqc$sks$1@sea.gmane.org>
Message-ID: <20040824152745.GA13374@legolas.on.net.mk>

> So after 1 day of desaster and RTFM I now can use .psp and publisher on 
> my public_html (yust not in one and the same folder :-))

You can run them in the same folder.
http://modpython.org/FAQ/faqw.py?req=show&file=faq01.002.htp
 
> My problem is, that when I load my hello.psp file, my HELLO WORLD 
> apears, but my konqueror keeps laoding and stops at 58%, then I get a 
> timeout-message.

What happens with firefox? Install LiveHTTP headers for firefox and see
what happens.

-- 
damjan | ??????
This is my jabber ID --> damjan@bagra.net.mk <-- not my mail address!!!
From toby at rcsreg.com  Tue Aug 24 05:39:24 2004
From: toby at rcsreg.com (Tobiah)
Date: Tue Aug 24 14:34:30 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <20040823195052.E38604@onyx.ispol.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com>
Message-ID: <412B28EC.2060300@rcsreg.com>


>> So, is there any way at all that I can avoid caching python
>> objects entirely while developing?
> 
> 
> No, not without altering how Python works, which is way outside the 
> scope of mod_python.

Ok, but I'm developing an entire application framework using
the publisher handler.  I have things importing other things
all over the place as I create my library modules.  In this
position, am I relegated to repeatedly restarting apache as
I solidify my classes?  I this what other people do?  Why is
there so little discussion about this on the web?  Am I missing
something?  Is my methodology flawed?

Also, would Quixote suffer the same problem?

I'm starting to rewrite a large online registration system
with reports and other tools.  Is there a better choice then
the mod_python Publisher handler?

Thanks,

Toby
From jafo at tummy.com  Tue Aug 24 14:42:30 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Tue Aug 24 15:42:38 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412B28EC.2060300@rcsreg.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com>
	<412B28EC.2060300@rcsreg.com>
Message-ID: <20040824194230.GA6263@tummy.com>

On Tue, Aug 24, 2004 at 04:39:24AM -0700, Tobiah wrote:
>the publisher handler.  I have things importing other things
>all over the place as I create my library modules.  In this

I've continued to run into problems with complex code importing other
code, even with running Python 2.3.4 and mod_python 3.1.3.  I finally
abandoned the "dynamic" imports I was doing and instead have switched to
a new mechanism where all the imports are done up front before calling
the rendering engine.

>I solidify my classes?  I this what other people do?  Why is

Yes, I will usually restart Apache when I'm poking at the code.

You could also tweek the Apache config so that Apache doesn't run as a
long-running process, instead make the children restart after handling a
single request.  Don't recall the exact config option off the top of my
head, but I know it's there.

Sean
-- 
 A computer lets you make more mistakes faster than any invention in human
 history -- with the possible exceptions of handguns and tequila.
                 -- Mitch Ratcliffe
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
From toby at rcsreg.com  Tue Aug 24 06:52:18 2004
From: toby at rcsreg.com (Tobiah)
Date: Tue Aug 24 15:47:24 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <20040823195052.E38604@onyx.ispol.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com>
Message-ID: <412B3A02.4020601@rcsreg.com>


> 
> This method is pretty old, now a simpler way to do it is:
> 
> mymodulea = apache.import_module("mymodulea")
> mymoduleb = apache.import_module("mymoduleb")
>

Using this method, is there an equivalent to:

	from mymodule import *

thanks.
From grisha at modpython.org  Tue Aug 24 17:07:19 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Aug 24 16:07:56 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412B3A02.4020601@rcsreg.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com> <412B3A02.4020601@rcsreg.com>
Message-ID: <20040824160527.Q57212@onyx.ispol.com>


On Tue, 24 Aug 2004, Tobiah wrote:

>
>> 
>> This method is pretty old, now a simpler way to do it is:
>> 
>> mymodulea = apache.import_module("mymodulea")
>> mymoduleb = apache.import_module("mymoduleb")
>> 
>
> Using this method, is there an equivalent to:
>
> 	from mymodule import *

None that I can think of. I personally try to avoid * imports because they 
make the code difficult to read and debug.

Grisha
From mike_mp at zzzcomputing.com  Tue Aug 24 17:10:34 2004
From: mike_mp at zzzcomputing.com (mike bayer)
Date: Tue Aug 24 16:10:37 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412B28EC.2060300@rcsreg.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com> <412B28EC.2060300@rcsreg.com>
Message-ID: <59035.66.192.34.8.1093378234.squirrel@66.192.34.8>

>
> Ok, but I'm developing an entire application framework using
> the publisher handler.  I have things importing other things
> all over the place as I create my library modules.  In this
> position, am I relegated to repeatedly restarting apache as
> I solidify my classes?  I this what other people do?  Why is
> there so little discussion about this on the web?  Am I missing
> something?  Is my methodology flawed?

i do a lot of mod_perl development where you totally have to restart the
server when new code is put up.  Java servlets have similar issues for
library modules outside of the servlets themselves.  an apache restart is
just a HUP signal to the main process that is not generally noticeable by
end-users (since we do it all the time here with mod_perl).  I wouldnt say
its so unreasonable to have to restart an application when its internal
code is changed....since a mod_python application IS running in the same
application space as apache.

if you are developing in an environment where you have limited access to
the apache server, I'd look into doing something I am doing on a
mod_python project to account for a server that runs apache 1.3....I use
mod_proxy in the primary instance of Apache 1.3 to proxy mod_python
requests to an separate instance of Apache 2.0 that is listening on
localhost port 8100, and that is the application space where mod_python is
running.  you can restart it and reconfigure it freely without ever
touching the main apache server.  This model is analgous to doing java
servlets with an engine like tomcat, which runs as a separate service.


From mike_mp at zzzcomputing.com  Tue Aug 24 17:23:07 2004
From: mike_mp at zzzcomputing.com (mike bayer)
Date: Tue Aug 24 16:23:09 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <20040824194230.GA6263@tummy.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com> <412B28EC.2060300@rcsreg.com>
	<20040824194230.GA6263@tummy.com>
Message-ID: <3818.66.192.34.8.1093378987.squirrel@66.192.34.8>

>
> You could also tweek the Apache config so that Apache doesn't run as a
> long-running process, instead make the children restart after handling a
> single request.  Don't recall the exact config option off the top of my
> head, but I know it's there.

this is MaxRequestsPerChild in apache 1.3 at least....  the problem with
bringing it way down is that when some forks have restarted, others have
not, and you get this maddening difference in application behavior with
each hit to the server.  Restart is best.
From grahamd at dscpl.com.au  Wed Aug 25 13:20:03 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Aug 24 22:20:22 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <20040823195052.E38604@onyx.ispol.com>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com>
Message-ID: <46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>


On 24/08/2004, at 9:54 AM, Gregory (Grisha) Trubetskoy wrote:

>
> On Mon, 23 Aug 2004, Tobiah wrote:
>
>>
>>>  DEBUG = 1
>>>  import mymodulea
>>>  import mymoduleb
>>>  if DEBUG:
>>>         mymodulea = reload(mymodulea)
>>>         mymoduleb = reload(mymoduleb)
>>> That is O.K., but still, unwieldy.
>
> This method is pretty old, now a simpler way to do it is:
>
> mymodulea = apache.import_module("mymodulea")
> mymoduleb = apache.import_module("mymoduleb")

No time right now for an extended description, will send one later, but 
Vampire which I
described recently and which is available at 
"http://www.dscpl.com.au/projects/vampire"
has a module caching system which has explicit module importing similar 
to the
mod_python.apache module, but what it will do is track relationships 
between module
imports and is able to do a reload even when child imports are changed 
and not the
immediate module you are loading.

What this means is if that A imports B which imports C and similarly D 
imports C, if C
is then changed, all the modules which depend on C, ie., A, B and D 
will be automatically
reloaded when requested, rather than them being grabbed from the cache. 
If all your
application modules are in one place and you always use the module 
importer in Vampire
for importing any application module from a page, but also one 
application module from
another, any change to an application module should see anything that 
depends on it
automatically reloaded.

BTW, various problems I have seen with things appearing not to be 
reimported correctly
are actually because of intermediate proxy servers caching stuff. Thus 
need to explicitly
say not to cache stuff in response, although error pages can stuff that 
up also.



--
Graham Dumpleton (grahamd@dscpl.com.au)

From mike_mp at zzzcomputing.com  Wed Aug 25 02:04:35 2004
From: mike_mp at zzzcomputing.com (mike bayer)
Date: Wed Aug 25 01:04:52 2004
Subject: [mod_python] HTML::Mason ported to Python
Message-ID: <58591.69.112.1.169.1093410275.squirrel@69.112.1.169>

hi all -

Ive done just what the subject says, for those of you unfamiliar with
HTML::Mason its a pretty popular templating package for the mod_perl
environment, used by sites like amazon.com and salon.com.  in traditional
"pick a name that has a 'y' in it" fashion I have called it Myghty.

the application supports everything Mason does, including subcomponents,
methods, page inheritance, mod_python/CGI connectors, etc., with the
exception of caching, which is an upcoming feature.  Plus it has some
extra features designed to make life in a python multithreaded environment
easier, if you are running under the worker MPM.   The code is 50% taken
from Mason and 50% custom, although the general architecture is mostly the
same.

Anyway, ive gotten it running standalone, with mod_python 2.7/3.1, with
both the worker and prefork MPMs, and with the CGI handler, and it seems
to work pretty well.  docs need some editing but content-wise are fairly
close to complete.  I am hoping its something people will find useful once
it is road-tested a little more, and also that some folks on here might
want to help me test it out a little as I am sure the outside world will
find tons of little issues I haven't come across yet.

check it out at :   http://myghty.sourceforge.net/

- mike

From bl at netgroup.dk  Wed Aug 25 14:52:18 2004
From: bl at netgroup.dk (Bo Lorentsen)
Date: Wed Aug 25 07:54:19 2004
Subject: [mod_python] Apache2 and SIGHUP ?
Message-ID: <1093434737.8023.30.camel@localhost>

Hi ...

I have been working with mod_python for some time now, and I have found
one strange "error", that I like to know if I am the only one having ?

If I like to restart apache2 because of some module update, or changes
in some binary import modules, or even just the weekly logrotate, I can
do it in two ways.

1. I can send a SIGHUP (/etc/init.d/apache2 restart)
2. I can stop and start apache2

If I do the first, all my future request end up in a coredump and this
continue until I end up using the second method :-)

If I am all alone, can someone please tell me how one behave corectly in
a python module (written i C) when python restarts/reloads ? I can't
find any info. about this in the python doc :-(

I'm looking forward to any help I can get, thanks.

/BL

From jpbarrette at savoirfairelinux.net  Wed Aug 25 10:25:45 2004
From: jpbarrette at savoirfairelinux.net (Jean-Philippe Barrette-LaPierre)
Date: Wed Aug 25 09:26:47 2004
Subject: [mod_python] POST arrays
Message-ID: <200408250925.46756.jpbarrette@savoirfairelinux.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Is it possible that POST arrays aren't supported by mod_python? When I'm 
talking about POST arrays, I'm talking about this:

<form method="POST">
	<input type="text" name="customer[test]"/>
</form>


in php, customer would be an array with a key "test". In mod_python we receive 
a variable named "customer[test]". I would be easy to handle it in the 
publisher. If you're interessed in that functionnality, I can send you some 
code that will handle this behavior.

- -- 
Jean-Philippe Barrette-LaPierre
Maintener of curlpp
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBLJNZ4k/6r/h0g7kRAu4VAKCBilG9db4Pl12A0cbmztVjoYmI7ACgux1b
RmmH+OIEnx5GJI6LMf/mIoA=
=Cnnm
-----END PGP SIGNATURE-----

From sector119 at mail.ru  Wed Aug 25 17:32:52 2004
From: sector119 at mail.ru (sector119@mail.ru)
Date: Wed Aug 25 09:32:57 2004
Subject: [mod_python] select multiple
Message-ID: <20040825133252.GA31672@city.gov.te.ua>

hi

I use publisher handler. When I do:
for k in req.form.keys():
    req.write(repr(k)+" - "+repr(req.form[k])+"\n")

it does not show list of lists at "select multiple"!
just 'manufacturers' - ['13', '18', '14', '17', '13', '14', '17'] not
'manufacturers' - [['13', '18'], ['14', '17', '13'], ['14', '17']]

why?

-- 
WBR, sector119
From jpbarrette at savoirfairelinux.net  Wed Aug 25 10:35:44 2004
From: jpbarrette at savoirfairelinux.net (Jean-Philippe Barrette-LaPierre)
Date: Wed Aug 25 09:36:46 2004
Subject: [mod_python] objects as actions
Message-ID: <200408250935.46490.jpbarrette@savoirfairelinux.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I wanted to use classes intead of function for actions in mod_python. The only
thing it does is to display mymodule.myclass. I checked in the publisher code
and I saw that if it's an object, it does:

result = str(object)

Why couldn't we do this instead:


class MyObject:
	def __init__(self, req):
		self.req = req

	def __str__(self):
		return "some string"


and in the publisher:

objInst = object(req)
result = str(objInst)

(if it's an object)

Maybe I'm using it incorrectly and it works with classes, but I didn't saw any
way to do it
- --
Jean-Philippe Barrette-LaPierre
Maintener of curlpp
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBLJWw4k/6r/h0g7kRAlPzAKDEWiQX5hI84DHo68UtLwMXM6qAGACg41qk
kdFuUQ3pbpM0oSZ4IAU7BQE=
=0ze9
-----END PGP SIGNATURE-----
From jpbarrette at savoirfairelinux.net  Wed Aug 25 10:46:55 2004
From: jpbarrette at savoirfairelinux.net (Jean-Philippe Barrette-LaPierre)
Date: Wed Aug 25 09:47:58 2004
Subject: [mod_python] POST arrays
In-Reply-To: <200408250925.46756.jpbarrette@savoirfairelinux.net>
References: <200408250925.46756.jpbarrette@savoirfairelinux.net>
Message-ID: <200408250946.58251.jpbarrette@savoirfairelinux.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On August 25, 2004 09:25 am, Jean-Philippe Barrette-LaPierre wrote:
> Is it possible that POST arrays aren't supported by mod_python? When I'm
> talking about POST arrays, I'm talking about this:
>
> <form method="POST">
> 	<input type="text" name="customer[test]"/>
> </form>
>
>
> in php, customer would be an array with a key "test". In mod_python we
> receive a variable named "customer[test]". I would be easy to handle it in
> the publisher. If you're interessed in that functionnality, I can send you
> some code that will handle this behavior.

It would be great to receive this customer variable (as a dict) as an argument
to the action.

- --
Jean-Philippe Barrette-LaPierre
Maintener of curlpp
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBLJhP4k/6r/h0g7kRAm/sAJoCyoYJNtmHFjB3LvGuqvpO51xCAgCfXMyI
iPuZNFsAOpgzHb3izlb+6as=
=ttzl
-----END PGP SIGNATURE-----
From aplisson-modpython at stochastique.net  Wed Aug 25 16:51:49 2004
From: aplisson-modpython at stochastique.net (Adrien Plisson)
Date: Wed Aug 25 09:56:54 2004
Subject: [mod_python] select multiple
In-Reply-To: <20040825133252.GA31672@city.gov.te.ua>
References: <20040825133252.GA31672@city.gov.te.ua>
Message-ID: <412C9975.9040109@stochastique.net>

sector119@mail.ru wrote:
> hi

hello !

> I use publisher handler. When I do:
> for k in req.form.keys():
>     req.write(repr(k)+" - "+repr(req.form[k])+"\n")
> 
> it does not show list of lists at "select multiple"!
> just 'manufacturers' - ['13', '18', '14', '17', '13', '14', '17'] not
> 'manufacturers' - [['13', '18'], ['14', '17', '13'], ['14', '17']]
> 
> why?
> 

well, simple answer: because req.form[k] do contain a list and not a list of 
lists...

more elaborated: you can try this in a python interpreter:
 >>> a = [1,2]
 >>> a += [2,3]
 >>> a
[1, 2, 2, 3]
notice that a does just contain a list. the + operator on a list is not a 
simple concatenation !!

but if you type:
 >>> a = [1,2]
 >>> a.append( [2,3] )
 >>> a
[1, 2, [2, 3]]
notice a contains a list of list. the append method of list IS a concatenation.

there may be a bug somewhere in mod_python, or you may have mistyped your 
concatenation...

hope this helps !

-- 
rien
From list at joreybump.com  Wed Aug 25 12:04:59 2004
From: list at joreybump.com (Jorey Bump)
Date: Wed Aug 25 11:06:30 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>
References: <412A14EB.2080600@rcsreg.com>
	<412A1C81.5070805@rcsreg.com>	<20040823195052.E38604@onyx.ispol.com>
	<46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>
Message-ID: <412CAA9B.2070406@joreybump.com>

Graham Dumpleton wrote:

> BTW, various problems I have seen with things appearing not to be 
> reimported correctly
> are actually because of intermediate proxy servers caching stuff. Thus 
> need to explicitly
> say not to cache stuff in response, although error pages can stuff that 
> up also.

Within your application you can do this:

  req.headers_out['Pragma'] = 'no-cache'
  req.headers_out['Cache-Control'] = 'no-cache'
  req.headers_out['Expires'] = '-1'

Or you can simply set the headers in httpd.conf or .htaccess:

  <Directory /var/www/foo/site>
   AddHandler python-program .py
   PythonHandler mod_python.publisher
   PythonDebug On
   # set headers to prevent caching for anything in this directory
   Header set Pragma "no-cache"
   Header set Cache-Control "no-cache"
   Header set Expires "-1"
</Directory>

Note: I use the somewhat outdated versions of apache and mod_python that 
come with Debian Woody, so be sure to check for the correct syntax for 
your versions. You might need to add the correct apache module to get 
the Header directives to work in httpd.conf.

From stephane.bidoul at softwareag.com  Wed Aug 25 20:07:15 2004
From: stephane.bidoul at softwareag.com (=?iso-8859-1?Q?St=E9phane_Bidoul?=)
Date: Wed Aug 25 13:06:03 2004
Subject: [mod_python] Multiple simultaneous requests during server startup
Message-ID: <042301c48ac6$109b2fe0$0100007f@be.sag>

Hi Grisha,

On Windows, when you start (or restart) an Apache instance while
multiple clients are attempting to connect, it seems that
serveral threads import the PythonHandler module simultaneously,
which leads to many kinds of weird behaviours and general
unstability.

You can reproduce with the following PythonHandler:

import time, os, thread
from mod_python import apache

f = open("c:/test.log","a")
print >> f, "start import: pid=",os.getpid(),"tid=",thread.get_ident()
time.sleep(1)
print >> f, "end import: pid=",os.getpid(),"tid=",thread.get_ident()
f.close()

def handler(req):
    req.write("hello")
    return apache.OK

When sending several requests in the same second while the
server starts you obtain the following test.log (several 
thread running the import code simultaneously):

start import: pid= 3668 tid= 808
start import: pid= 3668 tid= 4996
start import: pid= 3668 tid= 1404
start import: pid= 3668 tid= 652
start import: pid= 3668 tid= 1108
start import: pid= 3668 tid= 576
end import: pid= 3668 tid= 808

IMHO, the import of the PythonHandler should be executed
at most once for a given subinterpreter.

Is this a problem you can confirm?
If yes, any idea on how to fix it?

Thanks in advance,

-sbi
From tibor.simko at cern.ch  Wed Aug 25 20:15:06 2004
From: tibor.simko at cern.ch (Tibor Simko)
Date: Wed Aug 25 13:15:10 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com> <412B28EC.2060300@rcsreg.com>
	<20040824194230.GA6263@tummy.com>
	<3818.66.192.34.8.1093378987.squirrel@66.192.34.8>
Message-ID: <f4eu0urw351.fsf@pcdh23.cern.ch>

On Tue, 24 Aug 2004, mike bayer wrote:
> this is MaxRequestsPerChild in apache 1.3 at least.... the problem
> with bringing it way down is that when some forks have restarted,
> others have not [...]

You could limit the number of children too (MaxClients=1), but
restarts usually work faster/safer.
From toby at rcsreg.com  Wed Aug 25 05:35:13 2004
From: toby at rcsreg.com (Tobiah)
Date: Wed Aug 25 15:14:03 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412CAA9B.2070406@joreybump.com>
References: <412A14EB.2080600@rcsreg.com>	<412A1C81.5070805@rcsreg.com>	<20040823195052.E38604@onyx.ispol.com>	<46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>
	<412CAA9B.2070406@joreybump.com>
Message-ID: <412C7971.2060700@rcsreg.com>


> 
> Within your application you can do this:
> 
>  req.headers_out['Pragma'] = 'no-cache'
>  req.headers_out['Cache-Control'] = 'no-cache'
>  req.headers_out['Expires'] = '-1'
> 
> Or you can simply set the headers in httpd.conf or .htaccess:
> 
>  <Directory /var/www/foo/site>
>   AddHandler python-program .py
>   PythonHandler mod_python.publisher
>   PythonDebug On
>   # set headers to prevent caching for anything in this directory
>   Header set Pragma "no-cache"
>   Header set Cache-Control "no-cache"
>   Header set Expires "-1"
> </Directory>
> 

My understanding of the entire request process is limited,
but don't those directives only tell the client (browser)
not to cache content?  My goal is to get mod_python to reload
imported modules when their source file date is newer then
the last import time.

Tobiah
From list at joreybump.com  Wed Aug 25 17:28:24 2004
From: list at joreybump.com (Jorey Bump)
Date: Wed Aug 25 16:28:32 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412C7971.2060700@rcsreg.com>
References: <412A14EB.2080600@rcsreg.com>	<412A1C81.5070805@rcsreg.com>	<20040823195052.E38604@onyx.ispol.com>	<46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>	<412CAA9B.2070406@joreybump.com>
	<412C7971.2060700@rcsreg.com>
Message-ID: <412CF668.9080907@joreybump.com>

Tobiah wrote:

> 
>>
>> Within your application you can do this:
>>
>>  req.headers_out['Pragma'] = 'no-cache'
>>  req.headers_out['Cache-Control'] = 'no-cache'
>>  req.headers_out['Expires'] = '-1'
>>
>> Or you can simply set the headers in httpd.conf or .htaccess:
>>
>>  <Directory /var/www/foo/site>
>>   AddHandler python-program .py
>>   PythonHandler mod_python.publisher
>>   PythonDebug On
>>   # set headers to prevent caching for anything in this directory
>>   Header set Pragma "no-cache"
>>   Header set Cache-Control "no-cache"
>>   Header set Expires "-1"
>> </Directory>
>>
> 
> My understanding of the entire request process is limited,
> but don't those directives only tell the client (browser)
> not to cache content?  My goal is to get mod_python to reload
> imported modules when their source file date is newer then
> the last import time.

Yes, this is only related to Graham's point about cached pages.
From rob at contrastsweb.com  Wed Aug 25 18:59:17 2004
From: rob at contrastsweb.com (Rob Ballou)
Date: Wed Aug 25 18:59:23 2004
Subject: [mod_python] mod_python in a shared environment
Message-ID: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>

Hello,

I'm researching mod_python as a possible development solution for work 
(web design). As I am still learning python and mod_python, I am having 
trouble sizing up how this approach will work in our development 
environment.

Our main server houses a number of clients and all of their projects. 
After reading about the issues of restarting apache and how 
mod_python/apache use system resources, I am starting to doubt if 
mod_python will be a good fit for an environment of this sort. I was 
wondering if people have a similar situation where there are multiple 
applications (20+) running on a single server? Do you use individual 
python interpreters for each? Do you use the same handler for all of 
them? How does this effect server performance (memory and CPU)?

As a semi-related question, is the import caching that is occurring 
caching in memory or in files?

Hope this makes sense! If not, just let me know. If there are resources 
on the web that relate to these issues, just point me in that 
direction. Thanks in advance for any input.

Rob B

From bje at apnic.net  Thu Aug 26 12:00:01 2004
From: bje at apnic.net (Byron Ellacott)
Date: Wed Aug 25 20:58:59 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412CAA9B.2070406@joreybump.com>
References: <412A14EB.2080600@rcsreg.com>	<412A1C81.5070805@rcsreg.com>	<20040823195052.E38604@onyx.ispol.com>	<46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>
	<412CAA9B.2070406@joreybump.com>
Message-ID: <412D3611.1090706@apnic.net>

Jorey Bump wrote:
>  req.headers_out['Pragma'] = 'no-cache'
>  req.headers_out['Cache-Control'] = 'no-cache'
>  req.headers_out['Expires'] = '-1'

There's one caveat to always setting these: Internet Explorer will not 
be able to view any external program data inline over HTTPs with them 
set.  For example, if you generate a PDF or an XLS or similar, and serve 
them with the above headers over an HTTPS connection, if IE is 
instructed to open the file immediately (either via the dialog box that 
opens, or by that dialog's "Always do the same thing" setting) it will 
fail dismally.

To be hopefully clearer: An Internet Explorer quirk/feature/bug will 
prevent the user from viewing files opened with another application when 
sent over HTTPS with caching disabled.

If that's not a situation which applies to you, nevermind. :)

(There's a whole realm of problems with https in apache2; this 
particular one caused a few problems as well, though it's IE specific, 
not apache2 specific.)

-- 
bje
From mlists at rotondo.it  Thu Aug 26 10:48:45 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Thu Aug 26 03:45:35 2004
Subject: [mod_python] mod_python in a shared environment
In-Reply-To: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>
References: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>
Message-ID: <412D95DD.9040409@rotondo.it>

Rob Ballou wrote:

Hi Rob,

> Our main server houses a number of clients and all of their projects. 
> After reading about the issues of restarting apache and how 
> mod_python/apache use system resources, I am starting to doubt if 
> mod_python will be a good fit for an environment of this sort. I was 
> wondering if people have a similar situation where there are multiple 
> applications (20+) running on a single server? Do you use individual 
> python interpreters for each? Do you use the same handler for all of 
> them? How does this effect server performance (memory and CPU)?

the problem of restarting Apache in order to be sure mod_python will get 
the right files is only targeted to development systems and not deployed 
one.

I think nobody would use the "public" machine to do internal developing 
of new / updated apps, so the "Apache restart problem" should not matter 
you.

On performace: it all depends on your apps. For sure, mod_python and 
Python in general are faster and less memory-hungry than other languages 
like Java with servlets, and the mod_python platform is much more stable 
than the early version of Tomcat (I don't know how Tomcat evolved 
because I dropped Java development some years ago).

I think you should give it a try. But not on your production machine ;-)

Ciao,

   Fabio
From jafo at tummy.com  Thu Aug 26 04:22:55 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Thu Aug 26 05:48:36 2004
Subject: [mod_python] Rendering a page as a 404?
Message-ID: <20040826092255.GA29353@tummy.com>

I'm currently trying to set up my own 404 handler in mod_python, but
haven't had any luck tracking down how I can do that.  My first attempt
was:

   req.send_http_header()
   if pagebuffer: req.write(pagebuffer)
   return(404)

(roughly), but what was happening was that my page was being sent, then
the normal Apache 404 handler was occuring.  The first header sent
was including a 200 status as well.

I've pounded through the documentation and source code and just can't
figure out how I can, effectively, get it to use my content, with a 404
header.

Any thoughts?

Thanks,
Sean
-- 
 The social dynamics of the net are a direct consequence of the fact
 that nobody has yet developed a Remote Strangulation Protocol.
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
From jim-mod-python at jimdabell.com  Thu Aug 26 12:33:14 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Thu Aug 26 06:26:44 2004
Subject: [mod_python] Rendering a page as a 404?
In-Reply-To: <20040826092255.GA29353@tummy.com>
References: <20040826092255.GA29353@tummy.com>
Message-ID: <200408261133.14612.jim-mod-python@jimdabell.com>


> (roughly), but what was happening was that my page was being sent, then
> the normal Apache 404 handler was occuring.

mod_python.c has this to say on the matter:

/* When the script sets an error status by using req.status,
 * it can then either provide its own HTML error message or have
 * Apache provide one. To have Apache provide one, you need to send
 * no output and return the error from the handler function. However,
 * if the script is providing HTML, then the return value of the
 * handler should be OK, else the user will get both the script
 * output and the Apache output.
 */

So basically, you need to set req.status = apache.HTTP_NOT_FOUND (which is 
basically a synonym for 404, but perhaps clearer to read), and then return a 
value saying that no error occured, in order to successfully handle an error.  
That's backwards if you ask me, and definitely something that should be make 
clear in the manual.


> The first header sent was including a 200 status as well.

That's a separate problem; the status is sent as the very first line of the 
response, so you need to set req.status before sending any headers, else 
mod_python defaults to 200.

-- 
Jim Dabell

From fabbe at paniq.net  Thu Aug 26 16:51:19 2004
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Thu Aug 26 08:51:37 2004
Subject: [mod_python] mod_python in a shared environment
In-Reply-To: <412D95DD.9040409@rotondo.it>
References: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>
	<412D95DD.9040409@rotondo.it>
Message-ID: <1093524679.5671.34.camel@kernel>

On Thu, 2004-08-26 at 09:48 +0200, Fabio Rotondo wrote:
> Rob Ballou wrote:
> > Our main server houses a number of clients and all of their projects. 
> > After reading about the issues of restarting apache and how 
> > mod_python/apache use system resources, I am starting to doubt if 
> > mod_python will be a good fit for an environment of this sort. I was 
> > wondering if people have a similar situation where there are multiple 
> > applications (20+) running on a single server? Do you use individual 
> > python interpreters for each? Do you use the same handler for all of 
> > them? How does this effect server performance (memory and CPU)?
> 
> the problem of restarting Apache in order to be sure mod_python will get 
> the right files is only targeted to development systems and not deployed 
> one.
> 
> I think nobody would use the "public" machine to do internal developing 
> of new / updated apps, so the "Apache restart problem" should not matter 
> you.

Another concern similar to this is a shared virtual hosting environment
such as many ISPs and hosting companies provide. In these environments,
it is crucial that each customer's code and data is isolated in every
possible way. Regarding mod_python, it would require that a crashing
application halts only that particular application and that a crashing
application does not disrupt service even for itself; running it again
must be possible even if it will just crash again.

Small web sites such as those currently done in PHP are often worked on
while they are "live", and that's where mod_python has one of its
greatest weaknesses. People often start learning in such small
environments, and seeing that mod_python is not stable in such an
environment may result in the conclusion that it is not stable at all.

-- 
Fabian Fagerholm <fabbe@paniq.net>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040826/5cc4f84b/attachment.bin
From mlists at rotondo.it  Thu Aug 26 16:29:43 2004
From: mlists at rotondo.it (Fabio Rotondo)
Date: Thu Aug 26 09:27:24 2004
Subject: [mod_python] mod_python in a shared environment
In-Reply-To: <1093524679.5671.34.camel@kernel>
References: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>	<412D95DD.9040409@rotondo.it>
	<1093524679.5671.34.camel@kernel>
Message-ID: <412DE5C7.2070703@rotondo.it>

Fabian Fagerholm wrote:

Hi,

> Small web sites such as those currently done in PHP are often worked on
> while they are "live", and that's where mod_python has one of its
> greatest weaknesses. People often start learning in such small

sorry but I don't think that in a production environment you can change 
the code while users are browsing your web site. It'd be a complete mess.

The fact that in your development environment you have to restart Apache 
is not so uncommon. JSP and Perl sometimes need the same treatment.

Even more: there are workarounds for python that allows you not to 
restart apache while working. Many examples appeared on this mailing 
list in the last few days.

> environments, and seeing that mod_python is not stable in such an
> environment may result in the conclusion that it is not stable at all.

mod_python is stable. It is rock solid.
Python is a great language and mod_python just exposes Python power to 
web developers.

If you may think mod_python is weak or does not deserve respect or your 
time just switch back to PHP and be prepared to rewrite your code 
everytime they change PHP APIs (which has happened from PHP3 to PHP4 and 
is happening again from PHP4 to PHP5).

Ciao,

	Fabio
From sector119 at mail.ru  Thu Aug 26 17:32:39 2004
From: sector119 at mail.ru (sector119@mail.ru)
Date: Thu Aug 26 09:32:43 2004
Subject: [mod_python] select multiple
Message-ID: <20040826133239.GA7040@city.gov.te.ua>

i have some "<select multiple ...>" with the _same_ name
"manufacturers":
<select multiple size="2" name="manufacturers">
<select multiple size="2" name="manufacturers">
<select multiple size="2" name="manufacturers">

req.form["manufacturers"] has list value like: [1,2,3,4,5,6,7,8,9] not
[[1,2,3],[4,5],[6,7,8,9]] as I expected :) [1,2,3] - values for the
first select, [4,5] - for the second, ...

how can I get [[1,2,3],[4,5],[6,7,8,9]] - list of lists for "<select
multiple ...>" with the _same_ name?

-- 
WBR, sector119
From nick at dd.revealed.net  Thu Aug 26 09:50:47 2004
From: nick at dd.revealed.net (Nick)
Date: Thu Aug 26 09:51:04 2004
Subject: [mod_python] select multiple
In-Reply-To: <20040826133239.GA7040@city.gov.te.ua>
References: <20040826133239.GA7040@city.gov.te.ua>
Message-ID: <412DEAB7.7020201@dd.revealed.net>

If you read the HTTP specification, there is no practical way for mod_python 
to know the difference without any name mangling.  Most mod_python 
frameworks don't parse or modify HTML outside directives like <% %>.

Nick

sector119@mail.ru wrote:

> i have some "<select multiple ...>" with the _same_ name
> "manufacturers":
> <select multiple size="2" name="manufacturers">
> <select multiple size="2" name="manufacturers">
> <select multiple size="2" name="manufacturers">
> 
> req.form["manufacturers"] has list value like: [1,2,3,4,5,6,7,8,9] not
> [[1,2,3],[4,5],[6,7,8,9]] as I expected :) [1,2,3] - values for the
> first select, [4,5] - for the second, ...
> 
> how can I get [[1,2,3],[4,5],[6,7,8,9]] - list of lists for "<select
> multiple ...>" with the _same_ name?
> 

From r.pelizzi at virgilio.it  Thu Aug 26 17:12:37 2004
From: r.pelizzi at virgilio.it (R. Pelizzi)
Date: Thu Aug 26 10:12:56 2004
Subject: [mod_python] how do i share variables accross requests?
Message-ID: <412E0BF5.1040302@virgilio.it>

You probably have encountered this feature in other application 
frameworks... i remember i was using it in ASP, it was called the 
Application Object. You could store variables (ints, strings, objects) 
in it and every request could read and write them thread-safely. A 
simple example using this feature would be a user-online counter.
Every request would check if the session is new. If it is, increment the 
counter and register a cleanup function for the session to decrement it.
Now, how do i implement it in python?
global variables, as far as i've understood, are not global to the 
server, just to the child process spawned by the server, so they cannot 
be used.
Do i really have to pickle what i want to share and write it on disk 
using dbm, mysql or such? Wouldn't this be terribly inefficient, 
pickiling and unpickling every request?
Does anybody have already implemented something similar and can post the 
code?

Thank you
Riccardo
From pynode at centrum.cz  Thu Aug 26 16:23:31 2004
From: pynode at centrum.cz (MJR)
Date: Thu Aug 26 10:23:49 2004
Subject: [mod_python] Servlets, cookies and redirect
Message-ID: <NOEPJMBJNKKPJLAEACANIEIICKAA.pynode@centrum.cz>

with mod_python servlets, I am trying to set cookie and redirect with
following code:

===========================================================
class set(HTMLPage):
    def prep(self):
        HTMLPage.prep(self)
        minute=time()+60
        self.add_cookie('test', 'test_value', expires=minute)
        self.external_redirect(view)
===========================================================

With external_redirect cookie is not set, without redirect it works fine
(cookie set). I've obviously missed something... what is a proper way to do
this?

tx,
mike


From jpbarrette at savoirfairelinux.net  Thu Aug 26 11:33:57 2004
From: jpbarrette at savoirfairelinux.net (Jean-Philippe Barrette-LaPierre)
Date: Thu Aug 26 10:35:41 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <412E0BF5.1040302@virgilio.it>
References: <412E0BF5.1040302@virgilio.it>
Message-ID: <200408261033.59553.jpbarrette@savoirfairelinux.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On August 26, 2004 12:12 pm, R. Pelizzi wrote:
> You probably have encountered this feature in other application
> frameworks... i remember i was using it in ASP, it was called the
> Application Object. You could store variables (ints, strings, objects)
> in it and every request could read and write them thread-safely. A
> simple example using this feature would be a user-online counter.
> Every request would check if the session is new. If it is, increment the
> counter and register a cleanup function for the session to decrement it.
> Now, how do i implement it in python?
> global variables, as far as i've understood, are not global to the
> server, just to the child process spawned by the server, so they cannot
> be used.
> Do i really have to pickle what i want to share and write it on disk
> using dbm, mysql or such? Wouldn't this be terribly inefficient,
> pickiling and unpickling every request?
> Does anybody have already implemented something similar and can post the
> code?

for session management see:
   http://www.modpython.org/live/current/doc-html/pyapi-sess.html 
for "persistance" accross sessions see:
   http://www.modpython.org/live/current/doc-html/pyapi-cookie.html
>
> Thank you
> Riccardo
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

- -- 
Jean-Philippe Barrette-LaPierre
Maintener of curlpp
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBLfTV4k/6r/h0g7kRAoO/AKCsSlIbqtkU3nqL+K1reyC+sgIxZACgjGbv
YW9RJDfSQ9fXFxdsiizhmEE=
=rs67
-----END PGP SIGNATURE-----

From fabbe at paniq.net  Thu Aug 26 19:01:53 2004
From: fabbe at paniq.net (Fabian Fagerholm)
Date: Thu Aug 26 11:02:39 2004
Subject: [mod_python] mod_python in a shared environment
In-Reply-To: <412DE5C7.2070703@rotondo.it>
References: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>
	<412D95DD.9040409@rotondo.it> <1093524679.5671.34.camel@kernel>
	<412DE5C7.2070703@rotondo.it>
Message-ID: <1093532513.5671.63.camel@kernel>

On Thu, 2004-08-26 at 15:29 +0200, Fabio Rotondo wrote:
> sorry but I don't think that in a production environment you can change 
> the code while users are browsing your web site. It'd be a complete mess.

Not neccessarily, but you're misunderstanding; the python code doesn't
have to be the production environment, but the shared web server
provided by your hosting company certainly is. mod_python is part of the
hosting company's responsibility, but if there is a risk of having to
restart the apache server at irregular intervals, affecting all virtual
web sites hosted on it, they're not going to provide that service.
They'll tell you to use <insert currently widespread web scripting
language here> instead.

> Even more: there are workarounds for python that allows you not to 
> restart apache while working. Many examples appeared on this mailing 
> list in the last few days.

Yes, and I've read many, if not all, of them. Nevertheless, they do not
cover all cases. But that was not the point of what I said.

> mod_python is stable. It is rock solid.
> Python is a great language and mod_python just exposes Python power to 
> web developers.
> 
> If you may think mod_python is weak or does not deserve respect or your 
> time just switch back to PHP and be prepared to rewrite your code 
> everytime they change PHP APIs (which has happened from PHP3 to PHP4 and 
> is happening again from PHP4 to PHP5).

Go back and read what I wrote instead of putting words into my mouth,
please.

-- 
Fabian Fagerholm <fabbe@paniq.net>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://modpython.org/pipermail/mod_python/attachments/20040826/03dc7518/attachment.bin
From mike_mp at zzzcomputing.com  Thu Aug 26 12:36:27 2004
From: mike_mp at zzzcomputing.com (mike bayer)
Date: Thu Aug 26 11:43:51 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <412E0BF5.1040302@virgilio.it>
References: <412E0BF5.1040302@virgilio.it>
Message-ID: <16328.66.192.34.8.1093534587.squirrel@66.192.34.8>


just curious....what kind of global variable, shared across all processes,
would you be *writing* to ?   If you are just caching pre-loaded data from
a database or something, you can pre-load whatever is appropriate before
the server starts its child processes, and then have each fork cache
additional data as it needs to in its fork-local copy of the cache.

but also im sure theres a lot of libraries (yah like dbm) you could use as
well for this, probably worth it to try them before deciding that its less
efficient than IIS/ASP ...




> You probably have encountered this feature in other application
> frameworks... i remember i was using it in ASP, it was called the
> Application Object. You could store variables (ints, strings, objects)
> in it and every request could read and write them thread-safely. A
> simple example using this feature would be a user-online counter.
> Every request would check if the session is new. If it is, increment the
> counter and register a cleanup function for the session to decrement it.
> Now, how do i implement it in python?
> global variables, as far as i've understood, are not global to the
> server, just to the child process spawned by the server, so they cannot
> be used.
> Do i really have to pickle what i want to share and write it on disk
> using dbm, mysql or such? Wouldn't this be terribly inefficient,
> pickiling and unpickling every request?
> Does anybody have already implemented something similar and can post the
> code?
>
> Thank you
> Riccardo
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From tme-h81 at myamail.com  Thu Aug 26 18:28:48 2004
From: tme-h81 at myamail.com (FC)
Date: Thu Aug 26 11:48:07 2004
Subject: [mod_python] mod_python in a shared environment
In-Reply-To: <412DE5C7.2070703@rotondo.it>
References: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>	<412D95DD.9040409@rotondo.it>
	<1093524679.5671.34.camel@kernel> <412DE5C7.2070703@rotondo.it>
Message-ID: <A08FFAA8-F774-11D8-9EB5-000A9575BCC8@myamail.com>


On Aug 26, 2004, at 3:29 PM, Fabio Rotondo wrote:

>> environments, and seeing that mod_python is not stable in such an
>> environment may result in the conclusion that it is not stable at all.
>
> mod_python is stable. It is rock solid.
> Python is a great language and mod_python just exposes Python power to 
> web developers.
>
> If you may think mod_python is weak or does not deserve respect or 
> your time just switch back to PHP and be prepared to rewrite your code 
> everytime they change PHP APIs (which has happened from PHP3 to PHP4 
> and is happening again from PHP4 to PHP5).

For myself, I am read to give a try to mod_python. I thing python is a 
better language than PHP. But I have some problems and I have posted a 
question 3/4 days ago wich I did not get any feedback from the list.

Since I'm not giving up so easily, I ask again.

In my httpd-error.log I have these lines on every request. Something 
seems to be dying badly and I don't know why.

[Thu Aug 26 17:25:40 2004] [notice] mod_python: (Re)importing module 
'foo'
Fatal Python error: PyThreadState_Delete: tstate is still current
[Thu Aug 26 17:25:40 2004] [notice] child pid 91596 exit signal Abort 
trap (6)

Thanks,
Fred

From jim-mod-python at jimdabell.com  Thu Aug 26 18:06:51 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Thu Aug 26 12:00:04 2004
Subject: [mod_python] Servlets, cookies and redirect
In-Reply-To: <NOEPJMBJNKKPJLAEACANIEIICKAA.pynode@centrum.cz>
References: <NOEPJMBJNKKPJLAEACANIEIICKAA.pynode@centrum.cz>
Message-ID: <200408261706.51746.jim-mod-python@jimdabell.com>


> With external_redirect cookie is not set, without redirect it works fine
> (cookie set). I've obviously missed something... what is a proper way to do
> this?

I answered this question a few days ago:

<URL:http://modpython.org/pipermail/mod_python/2004-August/016178.html>

In future, searching the archives is usually a lot quicker than posting a 
question and waiting for somebody to answer.

-- 
Jim Dabell

From jafo at tummy.com  Thu Aug 26 11:00:10 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Thu Aug 26 12:00:15 2004
Subject: [mod_python] Rendering a page as a 404?
In-Reply-To: <200408261133.14612.jim-mod-python@jimdabell.com>
References: <20040826092255.GA29353@tummy.com>
	<200408261133.14612.jim-mod-python@jimdabell.com>
Message-ID: <20040826160010.GA10156@tummy.com>

On Thu, Aug 26, 2004 at 11:33:14AM +0100, Jim Dabell wrote:
>mod_python.c has this to say on the matter:

Ah hah, that's what I was missing.  Cool, thanks.

Sean
-- 
 "Your documents always look so good."  "That's because I keep my laser-printer
 set on ``stun''."  -- Sean Reifschneider, 1998
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
From jpbarrette at savoirfairelinux.net  Thu Aug 26 13:00:25 2004
From: jpbarrette at savoirfairelinux.net (Jean-Philippe Barrette-LaPierre)
Date: Thu Aug 26 12:01:31 2004
Subject: [mod_python] mod_python in a shared environment
In-Reply-To: <A08FFAA8-F774-11D8-9EB5-000A9575BCC8@myamail.com>
References: <648A5DDA-F6EA-11D8-BCE3-000A959D9E94@contrastsweb.com>
	<412DE5C7.2070703@rotondo.it>
	<A08FFAA8-F774-11D8-9EB5-000A9575BCC8@myamail.com>
Message-ID: <200408261200.27200.jpbarrette@savoirfairelinux.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

On August 26, 2004 11:28 am, FC wrote:
> On Aug 26, 2004, at 3:29 PM, Fabio Rotondo wrote:
> >> environments, and seeing that mod_python is not stable in such an
> >> environment may result in the conclusion that it is not stable at all.
> >
> > mod_python is stable. It is rock solid.
> > Python is a great language and mod_python just exposes Python power to
> > web developers.
> >
> > If you may think mod_python is weak or does not deserve respect or
> > your time just switch back to PHP and be prepared to rewrite your code
> > everytime they change PHP APIs (which has happened from PHP3 to PHP4
> > and is happening again from PHP4 to PHP5).
>
> For myself, I am read to give a try to mod_python. I thing python is a
> better language than PHP. But I have some problems and I have posted a
> question 3/4 days ago wich I did not get any feedback from the list.
>
> Since I'm not giving up so easily, I ask again.
>
> In my httpd-error.log I have these lines on every request. Something
> seems to be dying badly and I don't know why.
>
> [Thu Aug 26 17:25:40 2004] [notice] mod_python: (Re)importing module
> 'foo'
> Fatal Python error: PyThreadState_Delete: tstate is still current
> [Thu Aug 26 17:25:40 2004] [notice] child pid 91596 exit signal Abort
> trap (6)
>

this might help.

http://www.modpython.org/pipermail/mod_python/2002-November/013171.html

> Thanks,
> Fred
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

- -- 
Jean-Philippe Barrette-LaPierre
Maintener of curlpp
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBLgkZ4k/6r/h0g7kRAkNFAJ9aTLHLZ3d+m+dRAInRRp2p8NnwjACgiQ9l
4UHU9m+F4xfHSaChdqWqTw8=
=uznv
-----END PGP SIGNATURE-----

From pynode at centrum.cz  Thu Aug 26 18:12:27 2004
From: pynode at centrum.cz (MJR)
Date: Thu Aug 26 12:12:37 2004
Subject: [mod_python] Servlets, cookies and redirect
In-Reply-To: <200408261706.51746.jim-mod-python@jimdabell.com>
Message-ID: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>

Jim,

I did read that thread, but I am wondering whether there is a workaround for
this is mod_python servlets.

In other words, is there any other way than access req object and set cookie
through instead of using servlets' add_cookie() method?

tx,
mike




| -----Original Message-----
| From: mod_python-bounces@modpython.org
| [mailto:mod_python-bounces@modpython.org]On Behalf Of Jim Dabell
| Sent: 26 August 2004 17:07
| To: mod_python user mailing list
| Subject: Re: [mod_python] Servlets, cookies and redirect
|
|
|
| > With external_redirect cookie is not set, without redirect it works fine
| > (cookie set). I've obviously missed something... what is a
| proper way to do
| > this?
|
| I answered this question a few days ago:
|
| <URL:http://modpython.org/pipermail/mod_python/2004-August/016178.html>
|
| In future, searching the archives is usually a lot quicker than posting a
| question and waiting for somebody to answer.
|
| --
| Jim Dabell
|
| _______________________________________________
| Mod_python mailing list
| Mod_python@modpython.org
| http://mailman.modpython.org/mailman/listinfo/mod_python
|
|


From pynode at centrum.cz  Thu Aug 26 19:14:38 2004
From: pynode at centrum.cz (MJR)
Date: Sat Aug 28 17:17:46 2004
Subject: [mod_python] Servlets, cookies and redirect
In-Reply-To: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
Message-ID: <NOEPJMBJNKKPJLAEACANOEIKCKAA.pynode@centrum.cz>

what I was looking for was a method in servlet.py, in addition to
add_cookie(), which would be safe to use before redirect, something like:

===========================================================
  def set_cookie(self, cookie, value="", **kw):
     cookie = Cookie.Cookie(cookie, value, **kw)
     self.req.err_headers_out.add("Set-Cookie", str(cookie))
===========================================================

mike


| -----Original Message-----
| From: mod_python-bounces@modpython.org
| [mailto:mod_python-bounces@modpython.org]On Behalf Of MJR
| Sent: 26 August 2004 17:12
| To: mod_python user mailing list
| Subject: RE: [mod_python] Servlets, cookies and redirect
|
|
| Jim,
|
| I did read that thread, but I am wondering whether there is a
| workaround for
| this is mod_python servlets.
|
| In other words, is there any other way than access req object and
| set cookie
| through instead of using servlets' add_cookie() method?
|
| tx,
| mike
|
|
|
|
| | -----Original Message-----
| | From: mod_python-bounces@modpython.org
| | [mailto:mod_python-bounces@modpython.org]On Behalf Of Jim Dabell
| | Sent: 26 August 2004 17:07
| | To: mod_python user mailing list
| | Subject: Re: [mod_python] Servlets, cookies and redirect
| |
| |
| |
| | > With external_redirect cookie is not set, without redirect it
| works fine
| | > (cookie set). I've obviously missed something... what is a
| | proper way to do
| | > this?
| |
| | I answered this question a few days ago:
| |
| | <URL:http://modpython.org/pipermail/mod_python/2004-August/016178.html>
| |
| | In future, searching the archives is usually a lot quicker than
| posting a
| | question and waiting for somebody to answer.
| |
| | --
| | Jim Dabell
| |
| | _______________________________________________
| | Mod_python mailing list
| | Mod_python@modpython.org
| | http://mailman.modpython.org/mailman/listinfo/mod_python
| |
| |
|
|
| _______________________________________________
| Mod_python mailing list
| Mod_python@modpython.org
| http://mailman.modpython.org/mailman/listinfo/mod_python
|
|


From r.pelizzi at virgilio.it  Thu Aug 26 20:59:11 2004
From: r.pelizzi at virgilio.it (R. Pelizzi)
Date: Sat Aug 28 17:17:48 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <200408261033.59553.jpbarrette@savoirfairelinux.net>
References: <412E0BF5.1040302@virgilio.it>
	<200408261033.59553.jpbarrette@savoirfairelinux.net>
Message-ID: <412E410F.5020408@virgilio.it>

Jean-Philippe Barrette-LaPierre wrote:
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> On August 26, 2004 12:12 pm, R. Pelizzi wrote:
   [CUT]
> 
> 
> for session management see:
>    http://www.modpython.org/live/current/doc-html/pyapi-sess.html 
> for "persistance" accross sessions see:
>    http://www.modpython.org/live/current/doc-html/pyapi-cookie.html
> 
>>Thank you
>>Riccardo
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 
> - -- 
> Jean-Philippe Barrette-LaPierre
> Maintener of curlpp
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.4 (GNU/Linux)
> 
> iD8DBQFBLfTV4k/6r/h0g7kRAoO/AKCsSlIbqtkU3nqL+K1reyC+sgIxZACgjGbv
> YW9RJDfSQ9fXFxdsiizhmEE=
> =rs67
> -----END PGP SIGNATURE-----
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

no. You didn't get the point. Suppose you want to print out how many 
users are browsing the site at the moment. You would have to count the 
active sessions. Unfortunately there's no way to do that. A quick 
workaround would be to use a variable global to all the sessions, add 1 
to it for every new session and register a cleanup function for the 
session that substract 1 to the variable. The variable would then count 
the active sessions, which roughly estimates how many users are browsing 
the site. Now, in this simple example i could just pickle the variable 
and store it on disk using dbm, mysql or whatever. But
1. what about unpickable objects? are all objects pickable?
2. is this a bit inefficient? You would have to read, unpickle and 
repickle the variable every time a new session begins or expires, or 
read and unpickle it on every request!
3. I'm lazy... anybody did this before and can post the code? ^_^
From jafo at tummy.com  Thu Aug 26 12:05:53 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Sat Aug 28 17:17:49 2004
Subject: [mod_python] Severe problems with importing still happening.
Message-ID: <20040826170553.GD10606@tummy.com>

I just wanted to follow up to some previous messages and say that the
problem still seems to be there.  In particular, I'm talking about the
problems that I've mentioned in May of this year and June of last year:

   http://www.modpython.org/pipermail/mod_python/2004-May/015678.html
   http://www.modpython.org/pipermail/mod_python/2003-June/013807.html

A few weeks ago I was finally able to get the new toolchain working
(with python 2.3.4 and mod_python 3.1.3), and the problem still is
happening there.

Some of these problems can be worked around by changing the way things
are imported, importing them earlier instead of later.  However, it
seems that the more complicated the code is that you're dealing with,
the more likely you are to run into this problem.

I've just been contacted by another user who is also, apparently,
running into this problem on mod_python 3.1.3 and Python 2.3.4.  As far
as I know, they are not using dynamic imports the way I was.

I have completely re-designed JOTWeb so that all the user code now gets
imported right up front, instead of importing code as my users reference
it.  This seems to have worked around that problem.  Unfortunately, it's
crippled the code structuring that I had before, basically requiring
that everything reside in one module that's imported right up front.

Unfortunately, the only way I know of to reproduce this problem requires
Zope 3's Page Templates and JOTWeb to be installed and configured.

Obviously, it would be nice if this bug could get fixed.  I'd be happy
to work with someone who has a good understanding of the import hooks in
mod_python.  I, unfortunately, don't have the time right now to become
an expert in the mod_python code to the point where I'm likely to be
able to track this down on my own.

Thanks,
Sean
-- 
 If java had real garbage-collection, it would delete most programs
 before it executed them.  -- Sean Reifschneider, 2002
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
From jim-mod-python at jimdabell.com  Thu Aug 26 18:52:37 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Sat Aug 28 17:17:51 2004
Subject: [mod_python] Servlets, cookies and redirect
In-Reply-To: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
References: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
Message-ID: <200408261752.37249.jim-mod-python@jimdabell.com>


> In other words, is there any other way than access req object and set
> cookie through instead of using servlets' add_cookie() method?

According to the servlets documentation, add_cookie() is merely a wrapper for 
Cookie.add_cookie(), which sets the cookie in the normal headers, and upon 
looking at the servlets source, it appears that external_redirect() doesn't 
use the workaround.

You could patch mod_python to fix things so Cookie.add_cookie() sets cookies 
for all types of request.  This may interact badly with (IMHO) buggy software 
that assumes Cookie.add_cookie() is a no-op for "error" pages.

A better idea would be to patch the servlets to make external_redirect() use 
the workaround I mentioned before.  I've attached an (untested) patch if you 
need it.

The best idea, in my opinion, is to fix mod_python to honour the headers 
handlers ask it to send, but that too will be incompatible with some (IMHO) 
buggy software.

-- 
Jim Dabell

-------------- next part --------------
A non-text attachment was scrubbed...
Name: external_redirect-fix.diff
Type: text/x-diff
Size: 608 bytes
Desc: not available
Url : http://modpython.org/pipermail/mod_python/attachments/20040826/febda70a/external_redirect-fix.bin
From jim-mod-python at jimdabell.com  Thu Aug 26 20:44:04 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Sat Aug 28 17:17:52 2004
Subject: [mod_python] Servlets, cookies and redirect
In-Reply-To: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
References: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
Message-ID: <200408261944.05088.jim-mod-python@jimdabell.com>

-
From jim-mod-python at jimdabell.com  Thu Aug 26 21:12:53 2004
From: jim-mod-python at jimdabell.com (Jim Dabell)
Date: Sat Aug 28 17:17:54 2004
Subject: [mod_python] Servlets, cookies and redirect
In-Reply-To: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
References: <NOEPJMBJNKKPJLAEACANGEIKCKAA.pynode@centrum.cz>
Message-ID: <200408262012.54036.jim-mod-python@jimdabell.com>


> In other words, is there any other way than access req object and set
> cookie through instead of using servlets' add_cookie() method?

According to the servlets documentation, add_cookie() is merely a wrapper for 
Cookie.add_cookie(), which sets the cookie in the normal headers, and upon 
looking at the servlets source, it appears that external_redirect() doesn't 
use the workaround.

You could patch mod_python to fix things so Cookie.add_cookie() sets cookies 
for all types of request.  This may interact badly with (IMHO) buggy software 
that assumes Cookie.add_cookie() is a no-op for "error" pages.

A better idea would be to patch the servlets to make external_redirect() use 
the workaround I mentioned before.  I attached a patch for this before, but it 
appears this mailing list doesn't allow attachments, so let me know if you 
need this and I'll send it to you off-list.

The best idea, in my opinion, is to fix mod_python to honour the headers 
handlers ask it to send, but that too will be incompatible with some (IMHO) 
buggy software.

-- 
Jim Dabell
From jombo at 2wire.ch  Thu Aug 26 23:23:21 2004
From: jombo at 2wire.ch (Jean Martin)
Date: Sat Aug 28 17:17:55 2004
Subject: [mod_python] objects as actions
In-Reply-To: <200408250935.46490.jpbarrette@savoirfairelinux.net>
Message-ID: <GGECKGHNGKLNPCFLGMBDOEOPCDAA.jombo@2wire.ch>

Hi,

If i understand good what you are trying to do the code will be :

from mod_python import apache

def handler(req):
	objInst = MyObject(req)
	req.write(str(objInst))
	return apache.OK

class MyObject:
	def __init__(self, req):
		self.req = req

	def __str__(self):
		return "some string"

Jean Martin

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of Jean-Philippe
Barrette-LaPierre
Sent: mercredi, 25. ao?t 2004 15:36
To: mod_python@modpython.org
Subject: [mod_python] objects as actions


-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

I wanted to use classes intead of function for actions in mod_python. The
only
thing it does is to display mymodule.myclass. I checked in the publisher
code
and I saw that if it's an object, it does:

result = str(object)

Why couldn't we do this instead:


class MyObject:
	def __init__(self, req):
		self.req = req

	def __str__(self):
		return "some string"


and in the publisher:

objInst = object(req)
result = str(objInst)

(if it's an object)

Maybe I'm using it incorrectly and it works with classes, but I didn't saw
any
way to do it
- --
Jean-Philippe Barrette-LaPierre
Maintener of curlpp
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFBLJWw4k/6r/h0g7kRAlPzAKDEWiQX5hI84DHo68UtLwMXM6qAGACg41qk
kdFuUQ3pbpM0oSZ4IAU7BQE=
=0ze9
-----END PGP SIGNATURE-----
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


From jombo at 2wire.ch  Thu Aug 26 23:33:24 2004
From: jombo at 2wire.ch (Jean Martin)
Date: Sat Aug 28 17:17:56 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <412E0BF5.1040302@virgilio.it>
Message-ID: <GGECKGHNGKLNPCFLGMBDEEPACDAA.jombo@2wire.ch>

Hi,

Yes, ASP application object is nice, if you would like to cache some data.

I go trought the same problem, and i finally choose the HEAP type table (in
memory) of MySQL to store some strings i need, and do something similar.

This have the advantage to be faster than a disk table, and not dependent of
Apache.

But if mysql is restarted for any reason, you have to recreate table...

I hope this help

Jean Martin
-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org]On Behalf Of R. Pelizzi
Sent: jeudi, 26. aout 2004 18:13
To: mod_python@modpython.org
Subject: [mod_python] how do i share variables accross requests?


You probably have encountered this feature in other application
frameworks... i remember i was using it in ASP, it was called the
Application Object. You could store variables (ints, strings, objects)
in it and every request could read and write them thread-safely. A
simple example using this feature would be a user-online counter.
Every request would check if the session is new. If it is, increment the
counter and register a cleanup function for the session to decrement it.
Now, how do i implement it in python?
global variables, as far as i've understood, are not global to the
server, just to the child process spawned by the server, so they cannot
be used.
Do i really have to pickle what i want to share and write it on disk
using dbm, mysql or such? Wouldn't this be terribly inefficient,
pickiling and unpickling every request?
Does anybody have already implemented something similar and can post the
code?

Thank you
Riccardo
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python


From rdavisunr at yahoo.com  Fri Aug 27 09:55:53 2004
From: rdavisunr at yahoo.com (Robert Thomas Davis)
Date: Sat Aug 28 17:18:15 2004
Subject: [mod_python] Snag Apache Version
Message-ID: <20040827155553.7507.qmail@web81201.mail.yahoo.com>

Anyone know if there is a way to pull out the version
of Apache using the apache module?

Thanks
From r.pelizzi at virgilio.it  Fri Aug 27 21:09:40 2004
From: r.pelizzi at virgilio.it (R. Pelizzi)
Date: Sat Aug 28 17:18:16 2004
Subject: [mod_python] Problems inheriting BaseSession
Message-ID: <412F9504.4030000@virgilio.it>

A few days ago i was trying to implement a "counter" for a site... i had 
to keep track of the number of active sessions and i was asking for a 
way to store variables global to the whole server. There was no way to 
do that, so i tought i could implement a dbm db file and pickle the 
values. I can't see any way to implement an efficient locking mechanism 
(since semaphores cannot be shared between interpreters), what would you 
use? Would using files as semaphores be very inefficient?
Anyway, i thought i would just implement locking later, and i started 
the implementation. I created a class called Application, which is 
perfectly working (tough not thread-safe as i explained before) and can 
be access like a dictionary.
Ok, then i needed a way to register a cleanup function. To use 
Session.cleanup i had to subclass BaseSession. This is where the 
problems come in.

Look at the code:
------------------
from mod_python import Session
import anydbm, UserDict, pickle

class Application:
     """Questa classe permette di condividere tra pi? istanze oggetti 
serializzabili
     """
     def __init__(self):
         self.file = anydbm.open("boh", "c")
         self.load()

     def __len__(self):
         return len(self.dict)

     def __getitem__(self, key):
         return self.dict[key]

     def __setitem__(self, key, value):
         self.dict[key] = value

     def save(self):
         self.file['dict'] = pickle.dumps(self.dict)

     def load(self):
         try:
             self.dict = pickle.loads(self.file['dict'])
         except KeyError:
             #il file ? nuovo
             self.dict = {}

     def __del__(self):
         self.save()

class MySession(Session.BaseSession):
     def __init__(self, req):
         Session.BaseSession.__init__(self, req)
         Session.CLEANUP_CHANCE = 5
         self.dict = Application()
         try:
             self.dict["count"] += 1
         except KeyError:
             self.dict["count"] = 1

     def cleanup():
         self.dict["count"] -= 1

     def countActiveSessions():
         return self.dict["count"]

def index(req):
     sess = MySession(req)
     return "ciao"
--------------------

now, this is the error i get when i run application.py:
-------------------
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

   File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 
299, in HandlerDispatch
     result = object(req)

   File "/usr/lib/python2.3/site-packages/mod_python/publisher.py", line 
136, in handler
     result = util.apply_fs_data(object, req.form, req=req)

   File "/usr/lib/python2.3/site-packages/mod_python/util.py", line 361, 
in apply_fs_data
     return object(**args)

   File "/home/riccardo/web/application.py", line 50, in index

   File "/home/riccardo/web/application.py", line 35, in __init__
     Session.Session.__init__(req)

   File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 
124, in __init__
     if self.load():

   File "/usr/lib/python2.3/site-packages/mod_python/Session.py", line 
185, in load
     dict = self.do_load()

AttributeError: 'MySession' object has no attribute 'do_load'
-------------------------

what is do_load? and how come MySession hasn't got a method called 
do_load if it is a child of BaseSession?

Have i made any mistakes that prevent MySession to be a 100% child of 
BaseSession? This would be a very strange behaviour... Any clues?

thank you
From toby at rcsreg.com  Fri Aug 27 06:18:30 2004
From: toby at rcsreg.com (Tobiah)
Date: Sat Aug 28 17:18:18 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <412E0BF5.1040302@virgilio.it>
References: <412E0BF5.1040302@virgilio.it>
Message-ID: <412F2696.1010106@rcsreg.com>


> Do i really have to pickle what i want to share and write it on disk 
> using dbm, mysql or such? Wouldn't this be terribly inefficient, 
> pickiling and unpickling every request?

This is exactly what I decided to do.  I made a simple mysql database
called 'session' that will handle all of the session data for all of
the web apps for my company.  I tag each session with an 'appname' so
that each report or app can register its own discreet session for
each user.  This is very important if, like around here, a person might
have several apps open at once.  It used to be that one app would
destroy a persons session from another app.

I don't think that efficiency will be a problem.  Every web application
that I have ever written already connects to and queries from a
database on every page hit.  One more little request to retrieve a
small session object shouldn't be of any concern.  PHP uses temp files
to do the same thing.

By writing this myself I think that I will afford myself the greatest
flexibility in the future.

Tobiah
From toby at rcsreg.com  Fri Aug 27 09:39:38 2004
From: toby at rcsreg.com (Tobiah)
Date: Sat Aug 28 17:18:19 2004
Subject: [mod_python] Can't get post vars using Publisher Handler
Message-ID: <412F55BA.2020703@rcsreg.com>

I'm trying to use the FieldStorage class from
the Publisher Handler... is that possible?

I can read GET vars fine, but not POSTs.
I looked at the source for FieldStorage,
and it basically tries to read
req.headers_in['content-length'] bytes using
req.read(), but the read is always empty.

Here is a boiled-down example of what I'm
trying to do:

-----------------------------------------------


from mod_python import util
from mod_python import apache

def index(req):

         req.content_type = "text/html"
         req.send_http_header()

         doc = """
                 <HTML>
                 <HEAD>
                         <TITLE>post example</TITLE>
                 </HEAD>
                 <BODY>
                 <FORM ACTION=index.py METHOD=POST NAME=foo>
                 <INPUT TYPE=text NAME=poster>
                 <INPUT TYPE=submit NAME=submitter VALUE='GO!'>
                 <BR>
         """

         f = util.FieldStorage(req, 1)
         for e in f.list:
                 doc += "Element: %s, Value %s<BR>" % (e.name, e.value)

         doc += """
                 </FORM>
                 </BODY>
                 </HTML>
         """

         return doc

-----------------------------------------------

Thanks for any help.

Tobiah
From jafo at tummy.com  Sat Aug 28 10:23:11 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Sat Aug 28 17:18:31 2004
Subject: Documentation patch for 404 handler (was: Re: [mod_python] Rendering
	a page as a 404?)
In-Reply-To: <200408261133.14612.jim-mod-python@jimdabell.com>
References: <20040826092255.GA29353@tummy.com>
	<200408261133.14612.jim-mod-python@jimdabell.com>
Message-ID: <20040828152311.GA12084@tummy.com>

I'm attaching a patch to the documentation, which should adequately
document this behavior.  This patch is against CVS.

Sean
-- 
 "You took quite a chance..."  "You take a chance getting up in the morning,
 crossing the street, or sticking your face in a fan."  -- Police Squad
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
-------------- next part --------------
--- modpython3.tex.old	2004-08-28 08:46:00.000000000 -0600
+++ modpython3.tex	2004-08-28 09:19:26.000000000 -0600
@@ -433,3 +433,33 @@
 
 \end{itemize}
 
+\section{Your Own 404 Handler\label{tut-404-handler}}
+
+In some cases, you may wish to return a 404 (\constant{HTTP_NOT_FOUND}) or
+other non-200 result from your handler.  There is a trick here.  if you
+return \constant{HTTP_NOT_FOUND} from your handler, Apache will handle
+rendering an error page.  This can be problematic if you wish your handler
+to render it's own error page.
+
+In this case, you need to set \code{req.status = apache.HTTP_NOT_FOUND},
+render your page, and then \code{return(apache.OK)}:
+
+\begin{verbatim}
+   from mod_python import apache
+
+   def handler(req):
+      if req.filename[-17:] == 'apache-error.html':
+         #  make Apache report an error and render the error page
+         return(apache.HTTP_NOT_FOUND)
+      if req.filename[-18:] == 'handler-error.html':
+         #  use our own error page
+         req.status = apache.HTTP_NOT_FOUND
+         pagebuffer = 'Page not here.  Page left, not know where gone.'
+      else:
+         #  use the contents of a file
+         pagebuffer = open(req.filename, 'r').read()
+
+      #  fall through from the latter two above
+      req.write(pagebuffer)
+      return(apache.OK)
+\end{verbatim}
From list at joreybump.com  Sun Aug 29 03:10:26 2004
From: list at joreybump.com (Jorey Bump)
Date: Sun Aug 29 02:10:33 2004
Subject: [mod_python] Can't get post vars using Publisher Handler
In-Reply-To: <412F55BA.2020703@rcsreg.com>
References: <412F55BA.2020703@rcsreg.com>
Message-ID: <41317352.9060409@joreybump.com>

Tobiah wrote:

> I'm trying to use the FieldStorage class from
> the Publisher Handler... is that possible?

It seems like it's not recommended to use it directly, according to the 
documentation.

> I can read GET vars fine, but not POSTs.

Form data is available in req.form when using publisher (no need to 
import anything to access them). For example, using this form:

   <form name="test" action="somefunction" method="POST">
     <input type="hidden" name="foo" value="1">
     <input type="hidden" name="bar" value="milkyway">
     <input type="submit" name="submit" value="Try me!">
   </form>

the variables will be available in the function like this:

   def somefunction(req):
       x = req.form['foo']
       y = req.form['bar']
       result = """<html>
   <head>
   <title>foobar</title>
   </head>
   <body>
   <p>I would like %s %s. </p>
   </body>
   </html>
       """ % (x, y)
       return result

Note that the values of multiple form elements of the same name will be 
returned as a list, so process accordingly.

> Here is a boiled-down example of what I'm
> trying to do:
> 
> -----------------------------------------------
> 
> 
> from mod_python import util
> from mod_python import apache

You shouldn't need to import these with Publisher just to access form data.

> def index(req):
> 
>         req.content_type = "text/html"
>         req.send_http_header()

Not necessary, at least not on my setup.

>         doc = """
>                 <HTML>
>                 <HEAD>
>                         <TITLE>post example</TITLE>
>                 </HEAD>
>                 <BODY>
>                 <FORM ACTION=index.py METHOD=POST NAME=foo>
>                 <INPUT TYPE=text NAME=poster>
>                 <INPUT TYPE=submit NAME=submitter VALUE='GO!'>
>                 <BR>
>         """

That's fine, although I'm not a fan of using index.py for any reason, 
especially if you're just learning mod_python. You might waste time 
dealing with namespace clashes, which wouldn't occur if you gave the 
file a unique name.

>         f = util.FieldStorage(req, 1)
>         for e in f.list:
>                 doc += "Element: %s, Value %s<BR>" % (e.name, e.value)

I'm pretty sure you don't need or want to create an instance of 
FieldStorage in Publisher. You can do something like this instead:

   for key in req.form.keys():
       doc += "Element: %s, Value = %s<BR>" % (key, req.form[key])

>         doc += """
>                 </FORM>
>                 </BODY>
>                 </HTML>
>         """
> 
>         return doc

Try this example, saved as foobar.py (http://localhost/foobar.py/start):

def start(req):
     result = """
<head>
<title>foobar</title>
</head>
<body>
<form name="test" action="somefunction" method="POST">
   <input type="hidden" name="foo" value="1">
   <input type="hidden" name="bar" value="milkyway">
   <input type="submit" name="submit" value="Try me!">
</form>
</body>
</html>
"""
     return result

def somefunction(req):
     x = req.form['foo']
     y = req.form['bar']
     data = "<p>"
     for key in req.form.keys():
        data += """Element: %s, Value = %s<br>
""" % (key, req.form[key])
     data += "</p>"
     result = """<html>
<head>
<title>foobar</title>
</head>
<body>
<p>I would like %s %s. </p>
%s
</body>
</html>
     """ % (x, y, data)
     return result


From grahamd at dscpl.com.au  Sun Aug 29 20:44:11 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sun Aug 29 05:44:24 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <412CF668.9080907@joreybump.com>
References: <412A14EB.2080600@rcsreg.com>	<412A1C81.5070805@rcsreg.com>	<20040823195052.E38604@onyx.ispol.com>	<46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>	<412CAA9B.2070406@joreybump.com>
	<412C7971.2060700@rcsreg.com> <412CF668.9080907@joreybump.com>
Message-ID: <FB40AAA0-F99F-11D8-AEDD-000393DCF16E@dscpl.com.au>


On 26/08/2004, at 6:28 AM, Jorey Bump wrote:

> Tobiah wrote:
>
>>>
>>> Within your application you can do this:
>>>
>>>  req.headers_out['Pragma'] = 'no-cache'
>>>  req.headers_out['Cache-Control'] = 'no-cache'
>>>  req.headers_out['Expires'] = '-1'
>>>
>>> Or you can simply set the headers in httpd.conf or .htaccess:
>>>
>>>  <Directory /var/www/foo/site>
>>>   AddHandler python-program .py
>>>   PythonHandler mod_python.publisher
>>>   PythonDebug On
>>>   # set headers to prevent caching for anything in this directory
>>>   Header set Pragma "no-cache"
>>>   Header set Cache-Control "no-cache"
>>>   Header set Expires "-1"
>>> </Directory>
>>>
>> My understanding of the entire request process is limited,
>> but don't those directives only tell the client (browser)
>> not to cache content?  My goal is to get mod_python to reload
>> imported modules when their source file date is newer then
>> the last import time.
>
> Yes, this is only related to Graham's point about cached pages.

The only problem with relying on setting these in the latter way is 
where
you don't have access to httpd.conf. One can put them in the .htaccess
file, but only if mod_headers is loaded as a module into Apache in the
first place. If it isn't loaded, you are back to the problem of not
being able to modify httpd.conf to even add the loading of mod_headers
in the first place. :-(

Also, I don't want to specify that all resources have cache control
disabled. This is because in Vampire, the mod_python handler I have been
developing, it is possible to mix mod_python handlers and normal files
in the same directory. For normal files, which have static content, I
want normal caching arrangements to apply.

Thus, what I actually would recommend is using:

   <Files *>
   ErrorHeader set Pragma "no-cache"
   ErrorHeader set Cache-Control "no-cache"
   ErrorHeader set Expires "-1"
   </Files>

That is, only explicitly turn off caching for error responses. For 
normal
responses, then have each mod_python handler use:

   req.headers_out['Pragma'] = 'no-cache'
   req.headers_out['Cache-Control'] = 'no-cache'
   req.headers_out['Expires'] = '-1'

This gives you specific control although with some extra coding in every
handler.

The reason for the ErrorHeader statements, as alluded to in my original
email, is to stop proxies caching an error response and not actually
making the request to the web server again. I would have though that an
error response should never be cached, but a proxy that I have to go
through at my work does exactly that. I would have to wait some period
of time for it to throw the cached error page away before I could then
pickup up the response from my now modified and correctly functioning
mod_python handler.


--
Graham Dumpleton (grahamd@dscpl.com.au)

From grahamd at dscpl.com.au  Sun Aug 29 21:42:15 2004
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sun Aug 29 06:42:24 2004
Subject: [mod_python] How can I turn off apparent caching of python code?
In-Reply-To: <46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>
References: <412A14EB.2080600@rcsreg.com> <412A1C81.5070805@rcsreg.com>
	<20040823195052.E38604@onyx.ispol.com>
	<46078FA6-F63D-11D8-83D1-000393DCF16E@dscpl.com.au>
Message-ID: <179E7000-F9A8-11D8-AEDD-000393DCF16E@dscpl.com.au>


On 25/08/2004, at 12:20 PM, Graham Dumpleton wrote:

>
> On 24/08/2004, at 9:54 AM, Gregory (Grisha) Trubetskoy wrote:
>
>>
>> On Mon, 23 Aug 2004, Tobiah wrote:
>>
>>>
>>>>  DEBUG = 1
>>>>  import mymodulea
>>>>  import mymoduleb
>>>>  if DEBUG:
>>>>         mymodulea = reload(mymodulea)
>>>>         mymoduleb = reload(mymoduleb)
>>>> That is O.K., but still, unwieldy.
>>
>> This method is pretty old, now a simpler way to do it is:
>>
>> mymodulea = apache.import_module("mymodulea")
>> mymoduleb = apache.import_module("mymoduleb")
>
> No time right now for an extended description, will send one later, 
> but Vampire which I
> described recently and which is available at 
> "http://www.dscpl.com.au/projects/vampire"
> has a module caching system which has explicit module importing 
> similar to the
> mod_python.apache module, but what it will do is track relationships 
> between module
> imports and is able to do a reload even when child imports are changed 
> and not the
> immediate module you are loading.
>
> What this means is if that A imports B which imports C and similarly D 
> imports C, if C
> is then changed, all the modules which depend on C, ie., A, B and D 
> will be automatically
> reloaded when requested, rather than them being grabbed from the 
> cache. If all your
> application modules are in one place and you always use the module 
> importer in Vampire
> for importing any application module from a page, but also one 
> application module from
> another, any change to an application module should see anything that 
> depends on it
> automatically reloaded.

I said I would follow up later with a better description. Being on 
holidays in a
foreign land this has turned out to the first opportunity to do so.

The module caching mechanism in Vampire is used as:

   import vampire.cache

   cache = vampire.cache.ModuleCache()
   c = cache.importModule("c",".")

The first argument to importModule() is the name of the module to load 
and the second
argument is the specific directory to look in. Specifically, the 
contents of the
sys.path variable is NOT used to find the module, instead you have to 
tell it where
it resides.

The reason for doing this is so you know you pick up the exact module 
you want. The
idea is that all the modules which relate to the application component 
of your web
pages would reside in one place. The name of that root directory would 
be the second
argument you use to importModule(). This avoids any problems where you 
can't be
certain about the order of sys.path when multiple applications are 
running within
the same web server and each different application uses the same module 
name.

Another important feature of the module cache is the encoding of the 
actual path to
the module into the lookup key for the module as it is listed in 
sys.modules. The
module cache in mpservlets does a similar thing, although in Vampire, 
for reasons I
can't quite remember, I encode the name to a greater degree. I vaguely 
remember
having some problems with really long module names in some older 
version of Python.

For example, the module "c" above would appear in sys.modules under the 
key:

   _vampire__2b_yg4_2b_XZhHdEtPHG6AmTz9w_3

The path recorded in the loaded module would be "./c.py" or "./c.pyc" 
as appropriate.

The reason for this is to work around a problem often described on the 
mailing list
whereby using the same name in multiple locations will potentially 
cause reloading
of the handler every time it is accessed from the different locations 
even no changes
have been made.

To explain the tracking of parent/child relationships between modules, 
now consider
the following Python code files.

   # c.py

   print "c"

   # b.py

   import vampire.cache
   print "b 1"
   cache = vampire.cache.ModuleCache()
   c = cache.importModule("c",".")
   print "b 2"

   # a.py

   import vampire.cache
   print "a 1"
   cache = vampire.cache.ModuleCache()
   b = cache.importModule("b",".")
   print "a 2"

   # test.py

   import vampire.cache
   import time

   cache = vampire.cache.ModuleCache()

   for i in range(100):
     print "test",i
     a = cache.importModule("a",".")
     for n in cache.cachedModules():
       c = cache.moduleInfo(n)
       print 
c.name,c.label,c.generation,c.file,c.mtime,c.atime,c.direct,c.indirect
     time.sleep(5)

First thing to be noted is that a normal "import" is not used for any 
module which
would be in your application module directory. Any access to such 
modules is mediated
through the module cache.

Now when the test script is run, it will on the first iteration 
generate the output:

   test 0
   a 1
   c
   b 1
   b 2
   a 2
   c _vampire__2b_yg4_2b_XZhHdEtPHG6AmTz9w_3 1 ./c.py 1093773189 
1093774844.22 2 0
   a _vampire_LqOp5S04uKeR2wBXKPT61w_3 3 ./a.py 1093773270 1093774844.23 
1 0
   b _vampire_XcjTxdeaT7e4Z8DD4M2Axg_3 2 ./b.py 1093773255 1093774844.22 
1 0

The code in each of the modules "a.py", "b.py" and "c.py" has been 
executed upon loading
as demonstrated by print statements outputs.

On the subsequent iteration, the output of the test program is:

   test 1
   c _vampire__2b_yg4_2b_XZhHdEtPHG6AmTz9w_3 1 ./c.py 1093773189 
1093774849.24 2 1
   a _vampire_LqOp5S04uKeR2wBXKPT61w_3 3 ./a.py 1093773270 1093774849.24 
2 0
   b _vampire_XcjTxdeaT7e4Z8DD4M2Axg_3 2 ./b.py 1093773255 1093774849.24 
1 1

That is, no modules were reloaded, instead they were obtained from the 
cache. The output
here is information maintained by the cache about modification and 
access times, number
of access and overall generation snapshot of the cache as a whole at 
the point the
module was loaded.

Note that the test script only attempts to load module "a". If we touch 
the file "a.py",
will now see the iteration of test script following point when file was 
modified showing:

   test 19
   a 1
   a 2
   c _vampire__2b_yg4_2b_XZhHdEtPHG6AmTz9w_3 1 ./c.py 1093773189 
1093774939.5 3 19
   a _vampire_LqOp5S04uKeR2wBXKPT61w_3 4 ./a.py 1093774935 1093774939.5 
1 0
   b _vampire_XcjTxdeaT7e4Z8DD4M2Axg_3 2 ./b.py 1093773255 1093774939.5 
2 18

Because only "a.py" was modified, there is no need to reload "b" and 
"c" from disk and
they instead come from the cache.

If instead we modify "b.py" and then "c.py" we will see the output:

   test 22
   a 1
   b 1
   b 2
   a 2
   c _vampire__2b_yg4_2b_XZhHdEtPHG6AmTz9w_3 1 ./c.py 1093773189 
1093774954.54 5 21
   a _vampire_LqOp5S04uKeR2wBXKPT61w_3 6 ./a.py 1093774935 1093774954.55 
1 0
   b _vampire_XcjTxdeaT7e4Z8DD4M2Axg_3 5 ./b.py 1093774951 1093774954.55 
1 0

   test 25
   a 1
   c
   b 1
   b 2
   a 2
   c _vampire__2b_yg4_2b_XZhHdEtPHG6AmTz9w_3 7 ./c.py 1093774966 
1093774969.64 2 1
   a _vampire_LqOp5S04uKeR2wBXKPT61w_3 9 ./a.py 1093774935 1093774969.65 
1 0
   b _vampire_XcjTxdeaT7e4Z8DD4M2Axg_3 8 ./b.py 1093774951 1093774969.65 
1 0

In these cases, although "a.py" was not modified, but "b.py" and then 
"c.py" were,
the module cache knows that "a.py" depends on "b.py" and that "b.py" 
depends on
"c.py" and thus that it should force a reload of "a.py" anyway in case 
the latter
files have changed in some important way.

As an example, imagine that "c.py" contained configuration information. 
This
module cache will ensure that modules which use that configuration are 
reloaded
to pick up the changed information. This auto reloading would also be 
good where
a servlet style approach was used and each file contained a servlet 
which was
part of a hierarchy. If the lowest base class were changed and it 
contained
important site layout code, those servlets derived from it would be 
automatically
reloaded when next used.

 From what I can see, this module cache will solve the sorts of problems 
people
are talking about with how to force reloading of modules when changed. 
Unless I
am missing something, the other suggestions are okay when there is only 
one level
of module importing, but if there are multiple levels of imports from 
your set
of application modules, they will not detect when the file associated 
with a child
import is changed and thus that an unchanged parent should still be 
reloaded.

I will apologise in advance for not answering any followup questions, 
if any, for a
few days as am about to travel to yet another country for a few days 
and will not be
taking my laptop with me on this part of my trip.

FWIW, Vampire can currently be obtained from:

   http://www.dscpl.com.au/projects/vampire


--
Graham Dumpleton (grahamd@dscpl.com.au)

From bje at apnic.net  Mon Aug 30 10:41:09 2004
From: bje at apnic.net (Byron Ellacott)
Date: Sun Aug 29 19:40:04 2004
Subject: [mod_python] Problems inheriting BaseSession
In-Reply-To: <412F9504.4030000@virgilio.it>
References: <412F9504.4030000@virgilio.it>
Message-ID: <41326995.9030501@apnic.net>

R. Pelizzi wrote:
> A few days ago i was trying to implement a "counter" for a site... i had 
> to keep track of the number of active sessions and i was asking for a 
> way to store variables global to the whole server. There was no way to 
> do that, so i tought i could implement a dbm db file and pickle the 
> values. I can't see any way to implement an efficient locking mechanism 
> (since semaphores cannot be shared between interpreters), what would you 
> use? Would using files as semaphores be very inefficient?
> Anyway, i thought i would just implement locking later, and i started 
> the implementation. I created a class called Application, which is 
> perfectly working (tough not thread-safe as i explained before) and can 
> be access like a dictionary.

I suggest you look at Session.py.  It demonstrates how to use the Apache 
APIs to create global locks and how to set cleanup handlers. 
Interestingly, there is only one reason you couldn't use 
Session.Session() directly: you can't create a session with a 
predetermined session ID.  If you create that out of band, or alter 
Session.py to allow a fixed sid or create a session with a given sid, 
you could just use:

app_obj = Session.Session(req, 'MyGlobalSID')

And there's your dbm or memory backed global session.  Note that if it's 
a memory session you'll lose your data each time the server restarts; if 
that's a problem you should create a DbmSession directly instead.

Updating the Session module to allow a constant sid would perhaps 
involve altering the base __init__() to have a new optional argument of 
"fixed=0."  Then add checks to the bits in __init__ dealing with session 
IDs, to neither check nor create cookies, and not create a new sid if 
the session couldn't be loaded.

-- 
bje
From mmmietti at cs.Helsinki.FI  Mon Aug 30 13:59:02 2004
From: mmmietti at cs.Helsinki.FI (Miikka Miettinen)
Date: Mon Aug 30 05:59:08 2004
Subject: [mod_python] Nested loops in PSP
Message-ID: <Pine.LNX.4.58.0408301252120.15754@sbz-31.cs.Helsinki.FI>

I wonder what makes the comment in the outer loop significant. The first 
piece of code works, but the second doesn't. Is this a bug or have I 
misunderstood the syntax?

---
<%
for i in range(5):
    # begin
%>
<%= i %><br>
<%
    for j in range(5):
%>
<%= i %>, <%= j %><br>
<%
%>
---
<%
for i in range(5):
%>
<%= i %><br>
<%
    for j in range(5):
%>
<%= i %>, <%= j %><br>
<%
%>
---
From rosskarchner at gmail.com  Mon Aug 30 11:11:49 2004
From: rosskarchner at gmail.com (Ross M Karchner)
Date: Mon Aug 30 10:11:55 2004
Subject: [mod_python] HTML::Mason ported to Python
In-Reply-To: <58591.69.112.1.169.1093410275.squirrel@69.112.1.169>
References: <58591.69.112.1.169.1093410275.squirrel@69.112.1.169>
Message-ID: <9cd844804083007114afdd7cf@mail.gmail.com>

Mike--

Is there a way to get the results of an ApacheHandler.handle call as a
string (or to a file buffer, like the out_buffer argument for
Interpreter objects)?

-Ross

On Wed, 25 Aug 2004 01:04:35 -0400 (EDT), mike bayer
<mike_mp@zzzcomputing.com> wrote:
> hi all -
> 
> Ive done just what the subject says, for those of you unfamiliar with
> HTML::Mason its a pretty popular templating package for the mod_perl
> environment, used by sites like amazon.com and salon.com.  in traditional
> "pick a name that has a 'y' in it" fashion I have called it Myghty.
> 
> the application supports everything Mason does, including subcomponents,
> methods, page inheritance, mod_python/CGI connectors, etc., with the
> exception of caching, which is an upcoming feature.  Plus it has some
> extra features designed to make life in a python multithreaded environment
> easier, if you are running under the worker MPM.   The code is 50% taken
> from Mason and 50% custom, although the general architecture is mostly the
> same.
> 
> Anyway, ive gotten it running standalone, with mod_python 2.7/3.1, with
> both the worker and prefork MPMs, and with the CGI handler, and it seems
> to work pretty well.  docs need some editing but content-wise are fairly
> close to complete.  I am hoping its something people will find useful once
> it is road-tested a little more, and also that some folks on here might
> want to help me test it out a little as I am sure the outside world will
> find tons of little issues I haven't come across yet.
> 
> check it out at :   http://myghty.sourceforge.net/
> 
> - mike
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
>
From grisha at modpython.org  Mon Aug 30 11:52:32 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 30 10:52:39 2004
Subject: [mod_python] Severe problems with importing still happening.
In-Reply-To: <20040826170553.GD10606@tummy.com>
References: <20040826170553.GD10606@tummy.com>
Message-ID: <20040830104725.T72729@onyx.ispol.com>


Sean -

I've skimmed over the two messages you referenced, and it wasn't very 
apparent what the problem is mainly due to the complexity of the 
attributes. I think if you want this resolved, you need to work on a clean 
and simple case explaining how to replicate the problem. Assume that we, 
the folks who develop mod_python, are not that smart actually, and we 
don't know what SimpleTAL is and have the attention span of a first grader 
:-)

Grisha

On Thu, 26 Aug 2004, Sean Reifschneider wrote:

> I just wanted to follow up to some previous messages and say that the
> problem still seems to be there.  In particular, I'm talking about the
> problems that I've mentioned in May of this year and June of last year:
>
>   http://www.modpython.org/pipermail/mod_python/2004-May/015678.html
>   http://www.modpython.org/pipermail/mod_python/2003-June/013807.html
>
> A few weeks ago I was finally able to get the new toolchain working
> (with python 2.3.4 and mod_python 3.1.3), and the problem still is
> happening there.
>
> Some of these problems can be worked around by changing the way things
> are imported, importing them earlier instead of later.  However, it
> seems that the more complicated the code is that you're dealing with,
> the more likely you are to run into this problem.
>
> I've just been contacted by another user who is also, apparently,
> running into this problem on mod_python 3.1.3 and Python 2.3.4.  As far
> as I know, they are not using dynamic imports the way I was.
>
> I have completely re-designed JOTWeb so that all the user code now gets
> imported right up front, instead of importing code as my users reference
> it.  This seems to have worked around that problem.  Unfortunately, it's
> crippled the code structuring that I had before, basically requiring
> that everything reside in one module that's imported right up front.
>
> Unfortunately, the only way I know of to reproduce this problem requires
> Zope 3's Page Templates and JOTWeb to be installed and configured.
>
> Obviously, it would be nice if this bug could get fixed.  I'd be happy
> to work with someone who has a good understanding of the import hooks in
> mod_python.  I, unfortunately, don't have the time right now to become
> an expert in the mod_python code to the point where I'm likely to be
> able to track this down on my own.
>
> Thanks,
> Sean
> --
> If java had real garbage-collection, it would delete most programs
> before it executed them.  -- Sean Reifschneider, 2002
> Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
> tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From grisha at modpython.org  Mon Aug 30 11:54:31 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 30 10:54:35 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <412E410F.5020408@virgilio.it>
References: <412E0BF5.1040302@virgilio.it>
	<200408261033.59553.jpbarrette@savoirfairelinux.net>
	<412E410F.5020408@virgilio.it>
Message-ID: <20040830105312.W72729@onyx.ispol.com>



On Thu, 26 Aug 2004, R. Pelizzi wrote:

> no. You didn't get the point. Suppose you want to print out how many users 
> are browsing the site at the moment.

I think this is something that should be done via a back-end database 
rather than the mod_python session storage mechanism.

Grisha
From grisha at modpython.org  Mon Aug 30 11:59:30 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 30 10:59:36 2004
Subject: Documentation patch for 404 handler (was: Re: [mod_python]
	Rendering a page as a 404?)
In-Reply-To: <20040828152311.GA12084@tummy.com>
References: <20040826092255.GA29353@tummy.com>
	<200408261133.14612.jim-mod-python@jimdabell.com>
	<20040828152311.GA12084@tummy.com>
Message-ID: <20040830105911.L72729@onyx.ispol.com>


Thanks! I added this to CVS.

Grisha

On Sat, 28 Aug 2004, Sean Reifschneider wrote:

> I'm attaching a patch to the documentation, which should adequately
> document this behavior.  This patch is against CVS.
>
> Sean
> --
> "You took quite a chance..."  "You take a chance getting up in the morning,
> crossing the street, or sticking your face in a fan."  -- Police Squad
> Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
> tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
>
From grisha at modpython.org  Mon Aug 30 12:05:20 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Aug 30 11:05:33 2004
Subject: [mod_python] Nested loops in PSP
In-Reply-To: <Pine.LNX.4.58.0408301252120.15754@sbz-31.cs.Helsinki.FI>
References: <Pine.LNX.4.58.0408301252120.15754@sbz-31.cs.Helsinki.FI>
Message-ID: <20040830110259.V72729@onyx.ispol.com>


Miikka -

Probably the best way to understand how it works is to look at the Python 
code that the page would produce. Look at the "Debugging" section in this 
article on how to get the Python code:

http://www.onlamp.com/pub/a/python/2004/02/26/python_server_pages.html

Grisha

On Mon, 30 Aug 2004, Miikka Miettinen wrote:

> I wonder what makes the comment in the outer loop significant. The first
> piece of code works, but the second doesn't. Is this a bug or have I
> misunderstood the syntax?
>
> ---
> <%
> for i in range(5):
>    # begin
> %>
> <%= i %><br>
> <%
>    for j in range(5):
> %>
> <%= i %>, <%= j %><br>
> <%
> %>
> ---
> <%
> for i in range(5):
> %>
> <%= i %><br>
> <%
>    for j in range(5):
> %>
> <%= i %>, <%= j %><br>
> <%
> %>
> ---
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From mike_mp at zzzcomputing.com  Mon Aug 30 12:17:56 2004
From: mike_mp at zzzcomputing.com (mike bayer)
Date: Mon Aug 30 11:17:58 2004
Subject: [mod_python] HTML::Mason ported to Python
In-Reply-To: <9cd844804083007114afdd7cf@mail.gmail.com>
References: <58591.69.112.1.169.1093410275.squirrel@69.112.1.169>
	<9cd844804083007114afdd7cf@mail.gmail.com>
Message-ID: <18088.66.192.34.8.1093879076.squirrel@66.192.34.8>

hey there -

Currently, the ApacheRequestImpl object doesnt take an optional out_buffer
argument, which would override the normal usage of the mod_python request
as its out_buffer.  But it should; so I will add this today.  In that
case, you can call it, from within your own mod_python request handler,
as:

  buffer = StringIO.StringIO()
  myghty.ApacheHandler.handle(req, out_buffer = buffer)
  string = buffer.getvalue()

In the meantime, assuming you want your myghty template to have the full
HTTP environment you've configured, here's the hack to get around it:

   # initialize configuration variables
   myghty.ApacheHandler.init_conf(req, require_directories = True)

   # make your own request_impl
   request_impl = myghty.ApacheHandler.ApacheRequestImpl(req,
**myghty.ApacheHandler.confparams)

   buffer = StringIO.StringIO()

   # set its outbuffer
   request_impl.out_buffer = buffer

   myghty.ApacheHandler.handle(req, request_impl = request_impl)

   string = buffer.getvalue()

Or you could also just use Interpreter directly, if the http configuration
is not so important.  You can make the %ARGS hash out of the mod_python
request using myghty.ApacheHandler.make_request_args(req) and send the
resulting dictionary object to the interpreter execute() method as the
"request_args" parameter.

Feel free to use the sourceforge BBS for Myghty questions:

https://sourceforge.net/forum/forum.php?forum_id=398331

- mike



> Mike--
>
> Is there a way to get the results of an ApacheHandler.handle call as a
> string (or to a file buffer, like the out_buffer argument for
> Interpreter objects)?
>
> -Ross
>
> On Wed, 25 Aug 2004 01:04:35 -0400 (EDT), mike bayer
> <mike_mp@zzzcomputing.com> wrote:
>> hi all -
>>
>> Ive done just what the subject says, for those of you unfamiliar with
>> HTML::Mason its a pretty popular templating package for the mod_perl
>> environment, used by sites like amazon.com and salon.com.  in
>> traditional
>> "pick a name that has a 'y' in it" fashion I have called it Myghty.
>>
>> the application supports everything Mason does, including subcomponents,
>> methods, page inheritance, mod_python/CGI connectors, etc., with the
>> exception of caching, which is an upcoming feature.  Plus it has some
>> extra features designed to make life in a python multithreaded
>> environment
>> easier, if you are running under the worker MPM.   The code is 50% taken
>> from Mason and 50% custom, although the general architecture is mostly
>> the
>> same.
>>
>> Anyway, ive gotten it running standalone, with mod_python 2.7/3.1, with
>> both the worker and prefork MPMs, and with the CGI handler, and it seems
>> to work pretty well.  docs need some editing but content-wise are fairly
>> close to complete.  I am hoping its something people will find useful
>> once
>> it is road-tested a little more, and also that some folks on here might
>> want to help me test it out a little as I am sure the outside world will
>> find tons of little issues I haven't come across yet.
>>
>> check it out at :   http://myghty.sourceforge.net/
>>
>> - mike
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From jafo at tummy.com  Mon Aug 30 10:20:57 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Mon Aug 30 11:21:03 2004
Subject: [mod_python] Severe problems with importing still happening.
In-Reply-To: <20040830104725.T72729@onyx.ispol.com>
References: <20040826170553.GD10606@tummy.com>
	<20040830104725.T72729@onyx.ispol.com>
Message-ID: <20040830152057.GA5400@tummy.com>

On Mon, Aug 30, 2004 at 10:52:32AM -0400, Gregory (Grisha) Trubetskoy wrote:
>I've skimmed over the two messages you referenced, and it wasn't very 
>apparent what the problem is mainly due to the complexity of the 
>attributes. I think if you want this resolved, you need to work on a clean 

Unfortunately, I've tried to reproduce it in a simpler system without
calling any other external code, and wasn't able to reproduce it.  I
have been able to reproduce it by using Zope 3's PT library instead of
SimpleTAL.

Sean
-- 
 Any technology distinguishable from magic is insufficiently advanced.
                 -- Gregory Benford
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
From r.pelizzi at virgilio.it  Mon Aug 30 21:13:02 2004
From: r.pelizzi at virgilio.it (R. Pelizzi)
Date: Mon Aug 30 14:18:04 2004
Subject: [mod_python] how do i share variables accross requests?
In-Reply-To: <412F2696.1010106@rcsreg.com>
References: <412E0BF5.1040302@virgilio.it> <412F2696.1010106@rcsreg.com>
Message-ID: <41338A4E.10506@virgilio.it>

Tobiah wrote:
> 
> 
> This is exactly what I decided to do.  I made a simple mysql database
> called 'session' that will handle all of the session data for all of
> the web apps for my company.  I tag each session with an 'appname' so
> that each report or app can register its own discreet session for
> each user.  This is very important if, like around here, a person might
> have several apps open at once.  It used to be that one app would
> destroy a persons session from another app.
> 
> I don't think that efficiency will be a problem.  Every web application
> that I have ever written already connects to and queries from a
> database on every page hit.  One more little request to retrieve a
> small session object shouldn't be of any concern.  PHP uses temp files
> to do the same thing.
> 
> By writing this myself I think that I will afford myself the greatest
> flexibility in the future.
> 


how did you subclass Session to perform the cleanup? I'm having problems 
  with that... Do you have to set CLEANUP_CHANCE to 1 or do you leave it 
to the high default value?

From news at woody.datatailors.com  Mon Aug 30 21:55:11 2004
From: news at woody.datatailors.com (Peter van Kampen)
Date: Mon Aug 30 15:20:29 2004
Subject: [mod_python] AuthHandler and Content-type
Message-ID: <slrncj6u0c.t7u.news@woody.datatailors.com>

Hi,

I have this configured apache like this:

<Directory /var/www/playground/test>
        SetHandler mod_python
	PythonAuthenHandler test
	PythonDebug On
	require valid-user
</Directory>

test.py is simply this:

from mod_python import apache

def authenhandler(req):
    req.user = ""
    return apache.OK
	
Finally there's a file: test.html in the same directory.

The problem is that now the content_type is text/plain. When I turn of
mod_python the content_type is text/html (as I want it to be).

I know I can set req.content_type = "text/html" but I want apache (or
mod_python) to do that for me... (because the files might not be only
.html). 

Can I do that with mod_python? I noticed there is PythonTypeHandler but the
documentation is rather scarce.

TIA,

PterK

-- 
Peter van Kampen
pterk -- at -- datatailors.com

From python at theorb.net  Mon Aug 30 13:49:42 2004
From: python at theorb.net (mod_python user)
Date: Mon Aug 30 15:49:41 2004
Subject: [mod_python] AuthHandler and Content-type
In-Reply-To: <slrncj6u0c.t7u.news@woody.datatailors.com>
References: <slrncj6u0c.t7u.news@woody.datatailors.com>
Message-ID: <413384D6.4020003@theorb.net>

Peter van Kampen wrote:
> Hi,
> 
> I have this configured apache like this:
> 
> <Directory /var/www/playground/test>
>         SetHandler mod_python
> 	PythonAuthenHandler test
> 	PythonDebug On
> 	require valid-user
> </Directory>
> 
> test.py is simply this:
> 
> from mod_python import apache
> 
> def authenhandler(req):
>     req.user = ""
>     return apache.OK
> 	
> Finally there's a file: test.html in the same directory.
> 
> The problem is that now the content_type is text/plain. When I turn of
> mod_python the content_type is text/html (as I want it to be).
> 
> I know I can set req.content_type = "text/html" but I want apache (or
> mod_python) to do that for me... (because the files might not be only
> .html). 

By using the apache Header and RequestHeader directives one can modify 
both the incoming and outgoing headers.  For instance, adding this to 
the <Directory> block above would always force text/html.
	Header set Content-type text/html

You may learn more in the apache manual available here:
	http://httpd.apache.org/docs-2.0/mod/mod_headers.html#header

Hope that is what you need.
Mike Wright

> 
> Can I do that with mod_python? I noticed there is PythonTypeHandler but the
> documentation is rather scarce.
> 
> TIA,
> 
> PterK
> 
From craig.warren at encorp.com  Mon Aug 30 15:33:39 2004
From: craig.warren at encorp.com (Craig Warren)
Date: Mon Aug 30 16:33:41 2004
Subject: [mod_python] Documentation update - Debug option
Message-ID: <1093898018.6587.11.camel@w-warrenc-lnx.encorp.com>

Hi,
I just installed and have been playing around with psp under
mod_python.  To get the debug option (<filename>.psp_) to work, I had to
add an extension to the configuration for the http server.

<Directory "/usr/local/apache2/htdocs/psp">
  AddHandler mod_python .psp 
 ...


Changed to 
 <Directory "/usr/local/apache2/htdocs/psp">
  AddHandler mod_python .psp .psp_
 ....


If I didn't, Apache would not pass along the request to mod_python.psp
handler.  Once I did, everything worked great!  Maybe we can update the
documenation and say something like:
note: to get debug working add ".psp_" as an extension to the
AddHandler.

Or maybe there is a better way, I don't know, this is how I got it
working.


Craig



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://modpython.org/pipermail/mod_python/attachments/20040830/cabb9042/attachment.html
From craig.warren at encorp.com  Mon Aug 30 15:48:26 2004
From: craig.warren at encorp.com (Craig Warren)
Date: Mon Aug 30 16:48:30 2004
Subject: [mod_python] include files
Message-ID: <1093898905.6587.22.camel@w-warrenc-lnx.encorp.com>

I created a file index.psp and included a file called header.psp (<%@
include="header.psp" %>.
Everything works with the include file, but if I modify the header.psp
file, the index.psp file doesn't know that the header.psp file has been
modified.  If I modify the index.psp file, then it picks up the
changes.  Is there a way to get the index.psp file to recongnize that
the include file has changed?

Thanks,
Craig 
From jgentil at sebistar.net  Mon Aug 30 16:58:11 2004
From: jgentil at sebistar.net (Jon-Pierre Gentil)
Date: Mon Aug 30 16:58:15 2004
Subject: [mod_python] Differences between 2.7 and 3.1
Message-ID: <413394E3.4030103@sebistar.net>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1


What are the major differences between mod_python 2.7 and 3.1 (besides
the fact that one runs under apache 1.3x and the other under 2.0x)?

I'm having to develop software in 3.1, but I need to back-port it
eventually to 2.7.

Thanks.

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.5 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iEYEARECAAYFAkEzlNIACgkQOrVFmaIbww4lXgCgu8ZzVlst6OPFvoOnxJLSUEoU
pUAAoJMDtbUTFS/tIEkj3ROHfc3xmXYz
=tAiz
-----END PGP SIGNATURE-----
From nick at dd.revealed.net  Mon Aug 30 17:35:04 2004
From: nick at dd.revealed.net (Nick)
Date: Mon Aug 30 17:35:21 2004
Subject: [mod_python] Differences between 2.7 and 3.1
In-Reply-To: <413394E3.4030103@sebistar.net>
References: <413394E3.4030103@sebistar.net>
Message-ID: <41339D88.6020807@dd.revealed.net>

1. Some of the req attributes may be in other places, like server, don't 
remember off the top of my head which.  Easy to tell when it breaks :)

2. You need to req.send_headers() in 2.7

3. No PSP, Session, maybe other "new" features in 2.7.

That's off the top of my head.  Your best bet is to just read the Changelog.
Nick

Jon-Pierre Gentil wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
> 
> 
> What are the major differences between mod_python 2.7 and 3.1 (besides
> the fact that one runs under apache 1.3x and the other under 2.0x)?
> 
> I'm having to develop software in 3.1, but I need to back-port it
> eventually to 2.7.
> 
> Thanks.
> 
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.5 (GNU/Linux)
> Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org
> 
> iEYEARECAAYFAkEzlNIACgkQOrVFmaIbww4lXgCgu8ZzVlst6OPFvoOnxJLSUEoU
> pUAAoJMDtbUTFS/tIEkj3ROHfc3xmXYz
> =tAiz
> -----END PGP SIGNATURE-----
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From bje at apnic.net  Tue Aug 31 12:19:46 2004
From: bje at apnic.net (Byron Ellacott)
Date: Mon Aug 30 21:18:39 2004
Subject: [mod_python] Severe problems with importing still happening.
In-Reply-To: <20040826170553.GD10606@tummy.com>
References: <20040826170553.GD10606@tummy.com>
Message-ID: <4133D232.1070606@apnic.net>

Sean Reifschneider wrote:
>    http://www.modpython.org/pipermail/mod_python/2003-June/013807.html

The trouble with submodules not appearing is to do with how mod_python's 
import_module method works.  When it imports foo.bar, it creates an 
entry in sys.modules[] for foo, and for foo.bar, but does not put the 
bar attribute on sys.modules['foo'].  This means that when you try to 
"from foo import bar" python will see that foo.bar exists in 
sys.modules, and try to return the bar attribute of sys.modules['foo'].

I wrote a patch to import_module to fix this problem, which might help you:

http://www.modpython.org/pipermail/mod_python/2004-June/015765.html

As far as I know, it's not been incorporated into mod_python's CVS.

-- 
bje
From davidf at sjsoft.com  Tue Aug 31 09:47:59 2004
From: davidf at sjsoft.com (David Fraser)
Date: Tue Aug 31 02:48:12 2004
Subject: [mod_python] Differences between 2.7 and 3.1
In-Reply-To: <413394E3.4030103@sebistar.net>
References: <413394E3.4030103@sebistar.net>
Message-ID: <41341F1F.2080700@sjsoft.com>

Jon-Pierre Gentil wrote:

>What are the major differences between mod_python 2.7 and 3.1 (besides
>the fact that one runs under apache 1.3x and the other under 2.0x)?
>
>I'm having to develop software in 3.1, but I need to back-port it
>eventually to 2.7.
>
>Thanks.
>  
>
There are some differences in the members / methods of the request 
objects etc.
The easiest way to see is to compare the relevant documentation pages 
for any of the objects you are planning to use.
I wrote stuff for 2.7, then switch to 3.1, and then had to get it 
running again on 2.7 and it wasn't too hard.
Of course it would be more difficult if you used new feature introduced 
for 3.x like sessions or psp code

Regards
David
From ccurvey at earthlink.net  Tue Aug 31 20:34:19 2004
From: ccurvey at earthlink.net (Chris Curvey)
Date: Tue Aug 31 19:20:53 2004
Subject: [mod_python] mod_python bake-off?
Message-ID: <41350AFB.4050201@earthlink.net>

Hi all,

There are a lot of different application frameworks that are popping up 
that use mod_python.  That's a good thing!  Would anyone be interested 
in having a "bake-off" to show the capabilities of each framework?  I'm 
thinking that if we could come up with an easy but non-trivial 
application, various people could implement it using their favorite 
framework.  The results would not only be a nice comparison of different 
frameworks, but would provide some nice examples for newbies.

Thoughts?


From jafo at tummy.com  Tue Aug 31 22:38:29 2004
From: jafo at tummy.com (Sean Reifschneider)
Date: Tue Aug 31 23:38:37 2004
Subject: [mod_python] mod_python bake-off?
In-Reply-To: <41350AFB.4050201@earthlink.net>
References: <41350AFB.4050201@earthlink.net>
Message-ID: <20040901033829.GA8614@tummy.com>

On Tue, Aug 31, 2004 at 07:34:19PM -0400, Chris Curvey wrote:
>in having a "bake-off" to show the capabilities of each framework?  I'm 
>thinking that if we could come up with an easy but non-trivial 

They've already got plans for such a thing in one of the SIGs, I don't
recall what SIG it was, but I wouldn't expect it'd be too hard to find.
They were proposing a webmail app.

Sean
-- 
 Unix actually IS user friendly -- it's just very picky about whom it
 calls its friend.
Sean Reifschneider, Member of Technical Staff <jafo@tummy.com>
tummy.com, ltd. - Linux Consulting since 1995.  Qmail, Python, SysAdmin
From iradik at gmail.com  Tue Aug 31 22:47:57 2004
From: iradik at gmail.com (steven a)
Date: Tue Aug 31 23:48:01 2004
Subject: [mod_python] mod_python bake-off?
In-Reply-To: <87isayyih1.fsf@tapsellferrier.co.uk>
References: <41350AFB.4050201@earthlink.net>
	<87isayyih1.fsf@tapsellferrier.co.uk>
Message-ID: <656b799f0408312047165979f9@mail.gmail.com>

many frameworks are meant to separate programming logic and syntax
from non-programmer web designers.  what good would a bake-off do in
these cases?

though i agree most frameworks suck; but not really, programming is
just so emotional these days.

steven alyari

On 01 Sep 2004 00:51:22 +0100, Nic Ferrier
<nferrier@tapsellferrier.co.uk> wrote:
> Chris Curvey <ccurvey@earthlink.net> writes:
> 
> > There are a lot of different application frameworks that are popping up
> > that use mod_python.  That's a good thing!  Would anyone be interested
> > in having a "bake-off" to show the capabilities of each framework?  I'm
> > thinking that if we could come up with an easy but non-trivial
> > application, various people could implement it using their favorite
> > framework.  The results would not only be a nice comparison of different
> > frameworks, but would provide some nice examples for newbies.
> 
> Yes. I'd like to implement without a framework. To show how silly
> frameworks are   /8->
> 
> I'd suggest something with a database back end.
> 
> 
> Nic
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
