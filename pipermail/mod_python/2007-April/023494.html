<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Exposing additional C APIs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Exposing%20additional%20C%20APIs&In-Reply-To=20070422093432.GA32765%40blim.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023493.html">
   <LINK REL="Next"  HREF="023495.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Exposing additional C APIs</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Exposing%20additional%20C%20APIs&In-Reply-To=20070422093432.GA32765%40blim.org"
       TITLE="[mod_python] Exposing additional C APIs">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Apr 22 06:03:28 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023493.html">[mod_python] Exposing additional C APIs
</A></li>
        <LI>Next message: <A HREF="023495.html">[mod_python] Exposing additional C APIs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23494">[ date ]</a>
              <a href="thread.html#23494">[ thread ]</a>
              <a href="subject.html#23494">[ subject ]</a>
              <a href="author.html#23494">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/04/07, <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">python at longlost.info</A> &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">python at longlost.info</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I've written an apache module encapsulating a data structure and ideally I would like to expose the API to scripts running within mod_python.  My guess is that there is no way to do this right now - but it can't hurt to ask, right?
</I>&gt;<i>
</I>&gt;<i> I was looking into the 'providers' API in the apache portability runtime.  Maybe mod_python could be extended to with a PythonImportProvider directive which allows other apache modules to import their Python API into a python interpreter?  Similar to the existing PythonImport directive.
</I>&gt;<i>
</I>&gt;<i> Thanks in advance for any help/thoughts,
</I>
There are a couple of ways you can go about it, although it is very
much virgin territory for development and using parts of mod_python
that aren't really officially designated public, but more for
experimentation only. Thus these parts of mod_python can possibly
change in the future.

First is that mod_python exports hooks which can be used to
acquire/release designated Python interpreter instances and get hold
of the request object for a request_rec. A separate Apache module can
use these to get to the request object and set an attribute of the
request object to some externally created Python object.

For this approach, see:

  <A HREF="http://issues.apache.org/jira/browse/MODPYTHON-165">http://issues.apache.org/jira/browse/MODPYTHON-165</A>

The second way of possibly going about it is to use the fact that
there are Python CObject references for the underlying Apache
request_rec structure available in the Python request object as
'_request_rec' attribute. This could be passed into a custom Python
module which uses the request_rec to get access to some data
associated with a different Apache module and then returns a Python
object which wraps that data or translates it into a Python only
object. This custom module could be created by hand or could be
generated using SWIG in some way.

I have previously posted an example that does a similar thing before,
although it predates the '_request_rec' attribute so could be done in
better ways now. For this see:

  <A HREF="http://www.modpython.org/pipermail/mod_python/2005-November/019609.html">http://www.modpython.org/pipermail/mod_python/2005-November/019609.html</A>

FWIW, I have Python SWIG bindings for most of the Apache and Apache
Runtime Libraries which I have been playing with. It is probably
somewhat impractical to utilise these in any way in mod_python itself
now due to the way the code was developed, but am looking at making it
possible to hook certain phases of Apache in mod_wsgi with everything
in Python side then being done using the Python SWIG bindings. Also
looking at the concept of being able to develop true Apache modules in
Python, including addition of configuration directives. This though
will all be independent of mod_python though.

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023493.html">[mod_python] Exposing additional C APIs
</A></li>
	<LI>Next message: <A HREF="023495.html">[mod_python] Exposing additional C APIs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23494">[ date ]</a>
              <a href="thread.html#23494">[ thread ]</a>
              <a href="subject.html#23494">[ subject ]</a>
              <a href="author.html#23494">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
