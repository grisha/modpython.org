<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Subinterpreters and index.py
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Subinterpreters%20and%20index.py&In-Reply-To=001801c45f2f%2403d63c90%247400a8c0%40vtn">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015846.html">
   <LINK REL="Next"  HREF="015848.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Subinterpreters and index.py</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nicolas Lehuen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Subinterpreters%20and%20index.py&In-Reply-To=001801c45f2f%2403d63c90%247400a8c0%40vtn"
       TITLE="[mod_python] Subinterpreters and index.py">nicolas at lehuen.com
       </A><BR>
    <I>Thu Jul  1 13:02:07 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015846.html">[mod_python] Module Import
</A></li>
        <LI>Next message: <A HREF="015848.html">[mod_python] Subinterpreters and index.py
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15847">[ date ]</a>
              <a href="thread.html#15847">[ thread ]</a>
              <a href="subject.html#15847">[ subject ]</a>
              <a href="author.html#15847">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
 
I'm encoutering an unexpected behaviours while using the publisher handlers
and two index.py, one in /app/index.py and one in /app/subdir/index.py.
 
When I first call <A HREF="http://localhost/app/,">http://localhost/app/,</A> /app/index.py is called. Then if I
call <A HREF="http://localhost/app/subdir/,">http://localhost/app/subdir/,</A> /app/subdir/index.py is called allright,
but then if I try again <A HREF="http://localhost/app/,">http://localhost/app/,</A> I always get
/app/subdir/index.py !
 
Well, it turns out it's a FAQ, listed here :
 
<A HREF="http://www.modpython.org/FAQ/faqw.py?req=show&amp;file=faq02.016.htp">http://www.modpython.org/FAQ/faqw.py?req=show&amp;file=faq02.016.htp</A>
 
The problem is that if I want to share data between different pages, for
instance a DB connection pool (which is one of the purpose of using
mod_python with one interpreter per application), then I have to make sure
that all those pages have a different name, so I lose the ability to have an
index.py in any subdirectory... Plus, if my app begins to grow, keeping in
mind this limitation is more and more difficult (&quot;damn, did I ever use
'validation.py' as a module name ???&quot;), all the more with the fact that the
bug is quite surprising in its behaviour (no warning message, no error, no
nothing).

At least, this should be written in big bold red prints in the
documentation. This is so unexpected and so big that I think every serious
mod_python user should be aware of this and design his/her applications
AROUND this bug (by having a clever naming scheme, de-modularising the app
etc.).
 
Maybe it would be possible to overcome this limitation if mod_python named
and loaded the page modules according to their path relative to the place
where a PythonInterpreter or PythonHandler (when PythonInterpPerDirective is
On) was last defined. So, if I define &quot;PythonInterpreter myapp&quot; in /app,
/app/index.py would be loaded as the 'index' module and /app/subdir/index.py
would be loaded as the 'subdir.index' module.

Likewise, maybe such an improved behaviour could enable us to do something
which is AFAIK quite difficult right now : importing modules relative to the
current interpreter (maybe by automatically adding the directory where the
interpreter was defined to sys.path). Say I've got a utility module
/app/utils.py, I could use it in /app/index.py and /app/subdir/index.py by
importing 'utils'.

Best regards,

Nicolas Lehuen

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015846.html">[mod_python] Module Import
</A></li>
	<LI>Next message: <A HREF="015848.html">[mod_python] Subinterpreters and index.py
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15847">[ date ]</a>
              <a href="thread.html#15847">[ thread ]</a>
              <a href="subject.html#15847">[ subject ]</a>
              <a href="author.html#15847">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
