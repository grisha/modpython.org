<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] python_cleanup/bsddb error
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20python_cleanup/bsddb%20error&In-Reply-To=20040720121209.A31487%40saint.ironport.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015950.html">
   <LINK REL="Next"  HREF="015953.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] python_cleanup/bsddb error</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>David Fraser</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20python_cleanup/bsddb%20error&In-Reply-To=20040720121209.A31487%40saint.ironport.com"
       TITLE="[mod_python] python_cleanup/bsddb error">davidf at sjsoft.com
       </A><BR>
    <I>Wed Jul 21 00:05:30 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015950.html">[mod_python] python_cleanup/bsddb error
</A></li>
        <LI>Next message: <A HREF="015953.html">[mod_python] Can't get mod_python working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15951">[ date ]</a>
              <a href="thread.html#15951">[ thread ]</a>
              <a href="subject.html#15951">[ subject ]</a>
              <a href="author.html#15951">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Krishna Srinivasan wrote:

&gt;<i>
</I>&gt;<i> Greetings.
</I>&gt;<i>
</I>&gt;&gt;<i> Can you post more details on how you register the cleanup etc, any 
</I>&gt;&gt;<i> reasons why it might be giving an invalid argument?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I don't do anything special at all - I just set up
</I>&gt;<i> the CLEANUP_CHANCE and that's it. Mod_Python is supposed
</I>&gt;<i> to be triggering the cleanup every time the CLEANUP_CHANCE
</I>&gt;<i> probability is hit.
</I>&gt;<i>
</I>&gt;<i> I checked the permissions on '/tmp/mp_sess.dbm' file and
</I>&gt;<i> they are &quot;-rw-r--r--&quot; and owned by user &quot;nobody&quot; (same as
</I>&gt;<i> apache) and group &quot;wheel&quot; (std in freebsd). So I am assuming
</I>&gt;<i> that if 'nobody' can create and write to this file, it should
</I>&gt;<i> also be able to 'write' again (to delete some old stuff).
</I>&gt;<i>
</I>&gt;<i> Any suggestions, help, please ? This memory problem is
</I>&gt;<i> really terrible. Whenever my temp file goes over 25 megs,
</I>&gt;<i> I have to wipe out that file and restart the server.
</I>&gt;<i> But this also means that I trouble all users of my application
</I>&gt;<i> to save all changes and not keep anything in session before
</I>&gt;<i> I do this wipe-out over a weekend.
</I>&gt;<i>
</I>&gt;<i> Many thanks,
</I>&gt;<i> Krishna.
</I>
Actually I have little knowledge of freebsd and none of bsddb, so maybe 
others can help with that.
But it does sound suspiciously similar to the restricted mode problem 
that happens for me in cleanup functions.
This prevents any writing to disk whatsoever from Python.

David

&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> David wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm not sure of this, but sometimes the cleanup functions give an 
</I>&gt;&gt;<i> error because they end up getting run in restricted mode.
</I>&gt;&gt;<i> But in this case the error message posted is here:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; [Thu Jul 12 19:27:04 2004] [error] [client 10.1.1.67] 
</I>&gt;&gt;<i> python_cleanup: &gt; Error calling cleanup object &lt;function dbm_cleanup 
</I>&gt;&gt;<i> at 0x823fc8c&gt;, &gt; referer: <A HREF="http://mymachine/home">http://mymachine/home</A>
</I>&gt;&gt;<i> &gt; [Thu Jul 12 19:27:04 2004] [error] [client 10.1.1.67] bsddb.error: 
</I>&gt;&gt;<i> &gt; (22, 'Invalid argument'), referer: <A HREF="http://mymachine/home">http://mymachine/home</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can you post more details on how you register the cleanup etc, any 
</I>&gt;&gt;<i> reasons why it might be giving an invalid argument?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i> David
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Krishna Srinivasan wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Greetings.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can some one please help me with this ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The /tmp/mp_sess.dbm is just growing
</I>&gt;&gt;<i> with time and doesn't get cleaned
</I>&gt;&gt;<i> up at all. Please atleast let me know
</I>&gt;&gt;<i> if this is NOT a mod_python error or
</I>&gt;&gt;<i> some dbm-module error, so I can investigate
</I>&gt;&gt;<i> further as to what is wrong.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> Krishna.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ---------- Forwarded message ----------
</I>&gt;&gt;<i> Date: Tue, 13 Jul 2004 16:33:19 -0700 (PDT)
</I>&gt;&gt;<i> From: Krishna Srinivasan &lt;krishna at ironport.com&gt;
</I>&gt;&gt;<i> To: Modpython &lt;Mod_python at modpython.org&gt;
</I>&gt;&gt;<i> Subject: python_cleanup/bsddb error
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Greetings.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I get the following errors in my error_log.
</I>&gt;&gt;<i> I guess this is why my sessions don't get
</I>&gt;&gt;<i> cleaned up at all and hence the mp_sess.dbm
</I>&gt;&gt;<i> in /tmp is always growing.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [Thu Jul 12 19:27:04 2004] [notice] [client 10.1.1.67] DbmSession: 
</I>&gt;&gt;<i> registered database cleanup., referer: <A HREF="http://mymachine/home">http://mymachine/home</A>
</I>&gt;&gt;<i> [Thu Jul 12 19:27:04 2004] [error] [client 10.1.1.67] python_cleanup: 
</I>&gt;&gt;<i> Error calling cleanup object &lt;function dbm_cleanup at 0x823fc8c&gt;, 
</I>&gt;&gt;<i> referer: <A HREF="http://mymachine/home">http://mymachine/home</A>
</I>&gt;&gt;<i> [Thu Jul 12 19:27:04 2004] [error] [client 10.1.1.67] bsddb.error: 
</I>&gt;&gt;<i> (22, 'Invalid argument'), referer: <A HREF="http://mymachine/home">http://mymachine/home</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Can someone please give me pointers as to
</I>&gt;&gt;<i> how to correctly clean up the db ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Many thanks,
</I>&gt;&gt;<i> Krishna.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015950.html">[mod_python] python_cleanup/bsddb error
</A></li>
	<LI>Next message: <A HREF="015953.html">[mod_python] Can't get mod_python working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15951">[ date ]</a>
              <a href="thread.html#15951">[ thread ]</a>
              <a href="subject.html#15951">[ subject ]</a>
              <a href="author.html#15951">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
