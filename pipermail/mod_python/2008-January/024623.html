<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] apache.SERVER_RETURN and chunked encoding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20apache.SERVER_RETURN%20and%20chunked%20encoding&In-Reply-To=e94d85500801021457w1e7cdf4g4775d329d47c6800%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024622.html">
   <LINK REL="Next"  HREF="024624.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] apache.SERVER_RETURN and chunked encoding</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20apache.SERVER_RETURN%20and%20chunked%20encoding&In-Reply-To=e94d85500801021457w1e7cdf4g4775d329d47c6800%40mail.gmail.com"
       TITLE="[mod_python] apache.SERVER_RETURN and chunked encoding">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed Jan  2 18:13:18 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024622.html">[mod_python] apache.SERVER_RETURN and chunked encoding
</A></li>
        <LI>Next message: <A HREF="024624.html">[mod_python] apache.SERVER_RETURN and chunked encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24623">[ date ]</a>
              <a href="thread.html#24623">[ thread ]</a>
              <a href="subject.html#24623">[ subject ]</a>
              <a href="author.html#24623">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 03/01/2008, Matthew Dennis &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mdennis at merfer.net</A>&gt; wrote:
&gt;<i> I have a handler that streams large amounts of data.  Using chunked encoding
</I>&gt;<i> in necessary as the total size is not known upfront.  If there is an error
</I>&gt;<i> during the generation, I raise a apache.SERVER_RETURN (with
</I>&gt;<i> HTTP_PARTIAL_RESPONSE I believe).  The problem is that it looks like
</I>&gt;<i> mod_python and/or apache just appends some error html to the output stream
</I>&gt;<i> and continues with the chunked encoding like there was no error.  In other
</I>&gt;<i> words, some data chunks come from the server, then a chunk with the error
</I>&gt;<i> html in it, then the last chunk.  Thus, the client has no way of knowing
</I>&gt;<i> that the data is incomplete (not all of it was generated) and corrupt
</I>&gt;<i> (random html appended onto the end).  Am I just missing something, or is
</I>&gt;<i> this a bug?
</I>
A HTTP status code can only be returned/raised before any data has
been sent as that information is at the beginning of the response. If
you are trying to raise the HTTP response status after data has been
sent then your code is wrong.

What do you think HTTP_PARTIAL_RESPONSE is meant to be used for? Maybe
you understanding is not complete, or you don't understand how HTTP
responses are put together.

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024622.html">[mod_python] apache.SERVER_RETURN and chunked encoding
</A></li>
	<LI>Next message: <A HREF="024624.html">[mod_python] apache.SERVER_RETURN and chunked encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24623">[ date ]</a>
              <a href="thread.html#24623">[ thread ]</a>
              <a href="subject.html#24623">[ subject ]</a>
              <a href="author.html#24623">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
