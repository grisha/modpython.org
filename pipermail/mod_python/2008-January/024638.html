<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Exceptions in the mod_python handler?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Exceptions%20in%20the%20mod_python%20handler%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024637.html">
   <LINK REL="Next"  HREF="024639.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Exceptions in the mod_python handler?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Webb Sprague</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Exceptions%20in%20the%20mod_python%20handler%3F&In-Reply-To="
       TITLE="[mod_python] Exceptions in the mod_python handler?">webb.sprague at gmail.com
       </A><BR>
    <I>Sun Jan  6 23:50:20 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024637.html">[mod_python] Re: mod_python on leopard
</A></li>
        <LI>Next message: <A HREF="024639.html">[mod_python] Exceptions in the mod_python handler?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24638">[ date ]</a>
              <a href="thread.html#24638">[ thread ]</a>
              <a href="subject.html#24638">[ subject ]</a>
              <a href="author.html#24638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

I have a mod_python handler, called &quot;lc.py&quot;, which has a bunch of
functions -- mapped to pages --  called things &quot;index&quot;,
&quot;process_request&quot;, etc.  Before defining those functions, I connect to
the database with psycopg2 and pass that connection handle to each
function/ page.

&lt;Directory /var/www/localhost/htdocs/lcfit&gt;
    SetHandler mod_python
    PythonHandler mod_python.publisher
    PythonDebug On
&lt;/Directory&gt;

# This is lc.py in the lcfit directory
dbcon = pyscopg2.connect(&quot;blah&quot;)
def index(req, dbcon=dbcon):
      curs = dbcon.cursor()
      # etc

This works fine usually.  However,  when the connection fails I don't
know how to get apache to send some text to the user saying &quot;call the
admin and tell him to restart postgres.&quot;  At the moment I get a nice
stack trace that I know how to read, but I would like to catch the
exception, print something less intimidating, and quit processing the
handler. If I can somehow mark it so that apache knows to reload lc.py
and attempt to reconnect the database the next time (hopefully after
postgres is restarted), that would be especially great (touching the
file?).

Is this a bad design?  I am probably misunderstanding the order in
which things are called (handlers, functions, modules, etc...), but I
don't want each page to connect() and close() on each call, and I
don't know where else to put the connection code except in the main
handler.

Thanks again!
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024637.html">[mod_python] Re: mod_python on leopard
</A></li>
	<LI>Next message: <A HREF="024639.html">[mod_python] Exceptions in the mod_python handler?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24638">[ date ]</a>
              <a href="thread.html#24638">[ thread ]</a>
              <a href="subject.html#24638">[ subject ]</a>
              <a href="author.html#24638">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
