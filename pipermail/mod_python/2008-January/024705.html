<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] remnant 'orphan' apache subprocesses
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20remnant%20%27orphan%27%20apache%20subprocesses&In-Reply-To=109001c85cbd%24ed9af930%24c8d0eb90%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024704.html">
   <LINK REL="Next"  HREF="024706.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] remnant 'orphan' apache subprocesses</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20remnant%20%27orphan%27%20apache%20subprocesses&In-Reply-To=109001c85cbd%24ed9af930%24c8d0eb90%24%40com"
       TITLE="[mod_python] remnant 'orphan' apache subprocesses">graham.dumpleton at gmail.com
       </A><BR>
    <I>Tue Jan 22 01:26:54 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024704.html">[mod_python] remnant 'orphan' apache subprocesses
</A></li>
        <LI>Next message: <A HREF="024706.html">[mod_python] remnant 'orphan' apache subprocesses
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24705">[ date ]</a>
              <a href="thread.html#24705">[ thread ]</a>
              <a href="subject.html#24705">[ subject ]</a>
              <a href="author.html#24705">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What do you get if you use a program like lsof or ofiles to work out
what open resources the zombie process may still be holding on to?

Are you absolutely sure that that zombie process is from the current
Apache instance and not perhaps an earlier instance of Apache?

Graham

On 22/01/2008, Alec Matusis &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">matusis at yahoo.com</A>&gt; wrote:
&gt;<i> &gt; Are CGI scripts used anywhere at all on your Apache web site?
</I>&gt;<i>
</I>&gt;<i> No, only mod_python and serving static files.
</I>&gt;<i>
</I>&gt;<i> &gt; -----Original Message-----
</I>&gt;<i> &gt; From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>]
</I>&gt;<i> &gt; Sent: Monday, January 21, 2008 10:07 PM
</I>&gt;<i> &gt; To: Alec Matusis
</I>&gt;<i> &gt; Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> &gt; Subject: Re: [mod_python] remnant 'orphan' apache subprocesses
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Are CGI scripts used anywhere at all on your Apache web site?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On 22/01/2008, Alec Matusis &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">matusis at yahoo.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; What version of Apache are you using?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; 2.2.6
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; What Python web application are you running on top of mod_python, a
</I>&gt;<i> &gt; &gt; &gt; self built one or one that uses one of the larger web frameworks?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Only self-built stuff, nothing complicated.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Does your application create sub processes in any way to perform
</I>&gt;<i> &gt; &gt; &gt; additional work?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; No sub processes and no threads, except that we use MySQLdb module
</I>&gt;<i> &gt; (which
</I>&gt;<i> &gt; &gt; might create threads?).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; I noticed a warning in the error log:
</I>&gt;<i> &gt; &gt; /live/scripts/_pro.py:100: Warning: Rows matched: 1  Changed: 1
</I>&gt;<i> &gt; Warnings: 1
</I>&gt;<i> &gt; &gt; (this is a mysql warning), but I would not think this is relevant...
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; &gt; From: Graham Dumpleton [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">graham.dumpleton at gmail.com</A>]
</I>&gt;<i> &gt; &gt; &gt; Sent: Monday, January 21, 2008 9:22 PM
</I>&gt;<i> &gt; &gt; &gt; To: Alec Matusis
</I>&gt;<i> &gt; &gt; &gt; Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt; &gt; Subject: Re: [mod_python] remnant 'orphan' apache subprocesses
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; What version of Apache are you using?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; What Python web application are you running on top of mod_python, a
</I>&gt;<i> &gt; &gt; &gt; self built one or one that uses one of the larger web frameworks?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Does your application create sub processes in any way to perform
</I>&gt;<i> &gt; &gt; &gt; additional work?
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; Graham
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; On 22/01/2008, Alec Matusis &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">matusis at yahoo.com</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; &gt; &gt; I have been investigating a memory leak that occurs on  an apache
</I>&gt;<i> &gt; &gt; &gt; server
</I>&gt;<i> &gt; &gt; &gt; &gt; since we switched to worker MPM.
</I>&gt;<i> &gt; &gt; &gt; &gt; I found that the source of it are apache subprocesses that lose
</I>&gt;<i> &gt; track
</I>&gt;<i> &gt; &gt; &gt; of
</I>&gt;<i> &gt; &gt; &gt; &gt; their parent and never exit:
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">root at web10</A> ~&gt; ps -ef | grep httpd
</I>&gt;<i> &gt; &gt; &gt; &gt; root     16197     1  0 02:00 ?        00:00:09
</I>&gt;<i> &gt; &gt; &gt; &gt; /usr/local/encap/httpd/bin/httpd -f /p2/web/conf/web10.conf -k
</I>&gt;<i> &gt; start
</I>&gt;<i> &gt; &gt; &gt; &gt; nobody   17750     1  0 17:53 ?        00:00:00
</I>&gt;<i> &gt; &gt; &gt; &gt; /usr/local/encap/httpd/bin/httpd -f /p2/web/conf/web10.conf -k
</I>&gt;<i> &gt; start
</I>&gt;<i> &gt; &gt; &gt; &gt; nobody    5112 16197  4 20:02 ?        00:00:16
</I>&gt;<i> &gt; &gt; &gt; &gt; /usr/local/encap/httpd/bin/httpd -f /p2/web/conf/web10.conf -k
</I>&gt;<i> &gt; start
</I>&gt;<i> &gt; &gt; &gt; &gt; nobody    5159 16197  4 20:02 ?        00:00:15
</I>&gt;<i> &gt; &gt; &gt; &gt; /usr/local/encap/httpd/bin/httpd -f /p2/web/conf/web10.conf -k
</I>&gt;<i> &gt; start
</I>&gt;<i> &gt; &gt; &gt; &gt; nobody    5300 16197  4 20:03 ?        00:00:14
</I>&gt;<i> &gt; &gt; &gt; &gt; /usr/local/encap/httpd/bin/httpd -f /p2/web/conf/web10.conf -k
</I>&gt;<i> &gt; start
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; in this output, apache child pid 17750 has pid 1 as a parent, and
</I>&gt;<i> &gt; it
</I>&gt;<i> &gt; &gt; &gt; is one
</I>&gt;<i> &gt; &gt; &gt; &gt; of those 'zombie children'.
</I>&gt;<i> &gt; &gt; &gt; &gt; Pids 5112,  5159, 5300 were normal (parent is pid 16197), and
</I>&gt;<i> &gt; they
</I>&gt;<i> &gt; &gt; &gt; exited
</I>&gt;<i> &gt; &gt; &gt; &gt; after MaxRequestsPerChild was reached.
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; Does anybody have any advice on this? I cannot correlate this to
</I>&gt;<i> &gt; &gt; &gt; anything,
</I>&gt;<i> &gt; &gt; &gt; &gt; there's nothing interesting in the server error log.
</I>&gt;<i> &gt; &gt; &gt; &gt; These 'zombies' appear at a rate of 2-3 per day; this apache
</I>&gt;<i> &gt; serves
</I>&gt;<i> &gt; &gt; &gt; about
</I>&gt;<i> &gt; &gt; &gt; &gt; 350 requests per second.
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; This Apache configuration is
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; ServerLimit 40
</I>&gt;<i> &gt; &gt; &gt; &gt; ThreadLimit 70
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; StartServers 10
</I>&gt;<i> &gt; &gt; &gt; &gt; MaxClients 1600
</I>&gt;<i> &gt; &gt; &gt; &gt; MinSpareThreads 75
</I>&gt;<i> &gt; &gt; &gt; &gt; MaxSpareThreads 200
</I>&gt;<i> &gt; &gt; &gt; &gt; ThreadsPerChild 40
</I>&gt;<i> &gt; &gt; &gt; &gt; MaxRequestsPerChild 10000
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; &gt; &gt; Mod_python mailing list
</I>&gt;<i> &gt; &gt; &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; &gt; &gt; &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt; &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024704.html">[mod_python] remnant 'orphan' apache subprocesses
</A></li>
	<LI>Next message: <A HREF="024706.html">[mod_python] remnant 'orphan' apache subprocesses
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24705">[ date ]</a>
              <a href="thread.html#24705">[ thread ]</a>
              <a href="subject.html#24705">[ subject ]</a>
              <a href="author.html#24705">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
