<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Apache Fails to load mod_python.so on Windows
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20Fails%20to%20load%20mod_python.so%20on%20Windows&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="024783.html">
   <LINK REL="Next"  HREF="024785.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Apache Fails to load mod_python.so on Windows</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Apache%20Fails%20to%20load%20mod_python.so%20on%20Windows&In-Reply-To="
       TITLE="[mod_python] Apache Fails to load mod_python.so on Windows">graham.dumpleton at gmail.com
       </A><BR>
    <I>Thu Jan 31 17:08:54 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="024783.html">[mod_python] mod_python.Importer.path; set dynamically
</A></li>
        <LI>Next message: <A HREF="024785.html">[mod_python] Problem getting the Publisher handler to return
	nothing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24784">[ date ]</a>
              <a href="thread.html#24784">[ thread ]</a>
              <a href="subject.html#24784">[ subject ]</a>
              <a href="author.html#24784">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please don't follow up to a different thread with a new question.
Subject now changed.

If you are running Apache as a service, it may be running as a
specific user, not the one which you installed the mod_python code as.
If this is the case, you need to make sure that the user that Apache
is running as has correct access rights to be able to read the module
file.

If this has occurred, you may also have problems with loaded module
then being able to read the installed Python code files.

Generally it is recommended that Apache, Python and mod_python all be
installed as an administrator and not as an individual user.

Graham

On 01/02/2008, Manjula Kumar &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">emailmanjula at yahoo.com</A>&gt; wrote:
&gt;<i> Hi All,
</I>&gt;<i>  I downloaded mod_python3.3.1 for Apache 2.2 and python 2.5 for Windows.But
</I>&gt;<i> when i restart the apache it is giving the error,
</I>&gt;<i> httpd.exe: Syntax error on line 116 of C:/Program Files/Apache Software
</I>&gt;<i> Foundation/Apache2.2/conf/httpd.conf: Cannot load
</I>&gt;<i> C:/Program Files/Apache Software
</I>&gt;<i> Foundation/Apache2.2/modules/mod_python.so into server: The
</I>&gt;<i> specified module could not be found.
</I>&gt;<i> But i am able to see the mod_python load module installed.
</I>&gt;<i>  If I comment out:
</I>&gt;<i>  #LoadModule python_module modules/mod_python.so
</I>&gt;<i>   Apache starts just fine without.
</I>&gt;<i>
</I>&gt;<i> Can anyone let me know what I am doing wrong.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Manjula
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Eric Brunson &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">brunson at brunson.com</A>&gt; wrote:
</I>&gt;<i> Scott Bratcher wrote:
</I>&gt;<i> &gt; Thanks Eric,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &quot;setenforce 0&quot; THIS WORKED. Apache started right up
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Below are the results of my attempts as you suggested. I think we are
</I>&gt;<i> &gt; onto the problem because with SELinux enforced it loads right up.
</I>&gt;<i> &gt; However, the chcon command failed to clear up the problem. I'm new to
</I>&gt;<i> &gt; SELinux. Is there another possible SELinux related permission that may
</I>&gt;<i> &gt; be the solution? It's just mod_python that is giving this problem even
</I>&gt;<i> &gt; though all of the others share the same t permission httpd_module.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # ls -Zd modules
</I>&gt;<i> &gt; drwxr-xr-x root root system_u:object_r:httpd_modules_t
</I>&gt;<i> modules/
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So I changed the permissions:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # chcon -t texrel_shlib_t
</I>&gt;<i> /etc/httpd/modules/mod_python.so
</I>&gt;<i> &gt; # service httpd start
</I>&gt;<i> &gt; Starting httpd: httpd: Syntax error on line 210 of
</I>&gt;<i> &gt; /etc/httpd/conf/httpd.conf: Syntax error on line 6 of
</I>&gt;<i> &gt; /etc/httpd/conf.d/python.conf: Cannot load
</I>&gt;<i> &gt; /etc/httpd/modules/mod_python.so into server:
</I>&gt;<i> &gt; /etc/httpd/modules/mod_python.so: cannot restore segment
</I>&gt;<i> prot after
</I>&gt;<i> &gt; reloc: Permission denied
</I>&gt;<i> &gt; [FAILED]
</I>&gt;<i> &gt; # ls -Z /etc/httpd/modules/mod_python.so
</I>&gt;<i> &gt; -rwxr-xr-x root root system_u:object_r:textrel_shlib_t
</I>&gt;<i> &gt; /etc/httpd/modules/mod_python.so*
</I>&gt;<i>
</I>&gt;<i> I'm far from an expert in selinux, so this could be hit and miss. The
</I>&gt;<i> google article I was reading may have been out of date, I know selinux
</I>&gt;<i> policies have been under heavy development in Fedora and RHEL.
</I>&gt;<i>
</I>&gt;<i> Try:
</I>&gt;<i>
</I>&gt;<i> chcon -t system_u:object_r:httpd_modules_t
</I>&gt;<i> /etc/httpd/modules/mod_python.so
</I>&gt;<i>
</I>&gt;<i> Later,
</I>&gt;<i> e.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I also tried changing the permissions of the 2.5 site-packages to the
</I>&gt;<i> &gt; same permissions as the previously working 2.4 site-packages, plus the
</I>&gt;<i> &gt; other listed below, and the still Apache Failure occurs.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # ls -Zd /usr/local/lib/python2.5/site-packages/
</I>&gt;<i> &gt; /usr/lib/python2.4/site-packages/
</I>&gt;<i> &gt; drwxr-xr-x root root system_u:object_r:lib_t
</I>&gt;<i> &gt; /usr/lib/python2.4/site-packages/
</I>&gt;<i> &gt; drwxr-xr-x root root user_u:object_r:lib_t
</I>&gt;<i> &gt; /usr/local/lib/python2.5/site-packages/
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; system_u:object_r:lib_t
</I>&gt;<i> &gt; system_u:object_r:textrel_shlib_t
</I>&gt;<i> &gt; user_u:object_r:textrel_shlib_t
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If you have other tips I'd appreciate any help you can offer.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Scott
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Jan 31, 2008, at 10:13 AM, Eric Brunson wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Scott Bratcher wrote:
</I>&gt;<i> &gt;&gt;&gt; Hello all,
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; THE PROBLEM:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; Starting Apache results in this error:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; # service httpd start
</I>&gt;<i> &gt;&gt;&gt; Starting httpd: httpd: Syntax error on line 210 of
</I>&gt;<i> &gt;&gt;&gt; /etc/httpd/conf/httpd.conf: Syntax error on line 6 of
</I>&gt;<i> &gt;&gt;&gt; /etc/httpd/conf.d/python.conf: Cannot load
</I>&gt;<i> &gt;&gt;&gt; /etc/httpd/modules/mod_python.so into server:
</I>&gt;<i> &gt;&gt;&gt; /etc/httpd/modules/mod_python.so: cannot restore
</I>&gt;<i> segment prot after
</I>&gt;<i> &gt;&gt;&gt; reloc: Permission denied
</I>&gt;<i> &gt;&gt;&gt; [FAILED]
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; This error message is often related to selinux permissions.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; A quick check to see if that is the problem is to disable selinux
</I>&gt;<i> &gt;&gt; with the command (as root) &quot;setenforce 0&quot;. If the module then loads
</I>&gt;<i> &gt;&gt; correctly, it can be fixed permanently with the command:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; chcon -t texrel_shlib_t /etc/httpd/modules/mod_python.so
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Then, re-enable selinux with &quot;setenforce 1&quot;.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; If disabling selinux does not fix the problem, then more
</I>&gt;<i> &gt;&gt; investigation is required.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Hope that helps,
</I>&gt;<i> &gt;&gt; e.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; USING:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; RHEL5 / SELinux
</I>&gt;<i> &gt;&gt;&gt; Apache 2.2
</I>&gt;<i> &gt;&gt;&gt; Python 2.5.1
</I>&gt;<i> &gt;&gt;&gt; mod_pythonn 3.3.1
</I>&gt;<i> &gt;&gt;&gt; httpd.conf (not .htaccess)
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; TESTED THUS FAR:
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; .so file exists with same permissions as other modules
</I>&gt;<i> &gt;&gt;&gt; # ls -Z /etc/httpd/modules/mod_python.so
</I>&gt;<i> &gt;&gt;&gt; -rwxr-xr-x root root system_u:object_r:httpd_modules_t
</I>&gt;<i> &gt;&gt;&gt; /etc/httpd/modules/mod_python.so*
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; If I comment out:
</I>&gt;<i> &gt;&gt;&gt; &quot;#LoadModule python_module modules/mod_python.so&quot;
</I>&gt;<i> &gt;&gt;&gt; and other related python lines Apache starts just fine without
</I>&gt;<i> &gt;&gt;&gt; mod_python.
</I>&gt;<i> &gt;&gt;&gt; # service httpd start
</I>&gt;<i> &gt;&gt;&gt; Starting httpd: [ OK ]
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  ________________________________
</I>&gt;<i> Be a better friend, newshound, and know-it-all with Yahoo! Mobile. Try it
</I>&gt;<i> now.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="024783.html">[mod_python] mod_python.Importer.path; set dynamically
</A></li>
	<LI>Next message: <A HREF="024785.html">[mod_python] Problem getting the Publisher handler to return
	nothing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24784">[ date ]</a>
              <a href="thread.html#24784">[ thread ]</a>
              <a href="subject.html#24784">[ subject ]</a>
              <a href="author.html#24784">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
