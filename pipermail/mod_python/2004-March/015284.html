<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] apache.import_module picks wrong module
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20apache.import_module%20picks%20wrong%20module&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015296.html">
   <LINK REL="Next"  HREF="015285.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] apache.import_module picks wrong module</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Toms Baugis</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20apache.import_module%20picks%20wrong%20module&In-Reply-To="
       TITLE="[mod_python] apache.import_module picks wrong module">toms.baugis at tietoenator.com
       </A><BR>
    <I>Thu Mar 25 16:56:59 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015296.html">[mod_python] apache.import_module picks wrong module
</A></li>
        <LI>Next message: <A HREF="015285.html">[mod_python] apache.import_module picks wrong module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15284">[ date ]</a>
              <a href="thread.html#15284">[ thread ]</a>
              <a href="subject.html#15284">[ subject ]</a>
              <a href="author.html#15284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am using mod_python 1.3.1

Have been using publisher handler for several days and got some problems.
Here is the situation:

In short, i have something like following directory structure

index.py
\dlu\index.py
\dlu\templates\index.py

all 3 files contain only one &quot;def index&quot; function

Now try following thing:
1. open index.py, then \dlu\index.py then \dlu\templates\index.py
2. now open index.py (try several times, if you have autoreload)

As result, sometimes in place of index.py you will get \dlu\index.py or 
\dlu\templates\index.py, also in place of \dlu\index.py you will 
sometimes get \dlu\templates\index.py

Found the problem in import_module function of mod_python.apache module:

.
        # of arbitrary already imported modules, such as os. The
        # reason we use startswith as opposed to exact match is that
        # modules inside packages are actually in subdirectories.

        if not file or (path and not filter(file.startswith, path)):
.

well if I do as i did in #1, then &quot;import \dlu\index.py&quot; will pick 
\dlu\templates\index.py - because &quot;\dlu\templates&quot; really startswith &quot;\dlu\&quot;

problem fixed by changing path checking to following:
        file_path = file[:file.rfind('/')]
        if not file or (path and (file_path &lt;&gt; path)):

(if something looks not good - sorry, i am new in python)

tm
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015296.html">[mod_python] apache.import_module picks wrong module
</A></li>
	<LI>Next message: <A HREF="015285.html">[mod_python] apache.import_module picks wrong module
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15284">[ date ]</a>
              <a href="thread.html#15284">[ thread ]</a>
              <a href="subject.html#15284">[ subject ]</a>
              <a href="author.html#15284">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
