<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] An odd use of the publisher
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20An%20odd%20use%20of%20the%20publisher&In-Reply-To=Pine.LNX.4.58.0403140917520.23507%40ramuh.int.24ksoftware.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015232.html">
   <LINK REL="Next"  HREF="015237.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] An odd use of the publisher</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Colin Fox</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20An%20odd%20use%20of%20the%20publisher&In-Reply-To=Pine.LNX.4.58.0403140917520.23507%40ramuh.int.24ksoftware.com"
       TITLE="[mod_python] An odd use of the publisher">cfox at cfconsulting.ca
       </A><BR>
    <I>Sun Mar 14 13:57:18 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015232.html">[mod_python] An odd use of the publisher
</A></li>
        <LI>Next message: <A HREF="015237.html">[mod_python] An odd use of the publisher
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15235">[ date ]</a>
              <a href="thread.html#15235">[ thread ]</a>
              <a href="subject.html#15235">[ subject ]</a>
              <a href="author.html#15235">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Erik Stephens wrote:
|<i>
</I>|&gt;<i>Raising an exception gives me the control I want, it's just that it
</I>|&gt;<i>feels wierd to be doing that as a normal exit, rather than a problem exit.
</I>|<i>
</I>|<i>
</I>|<i> Yeah, it is very weird.  I'm surprised it's working for you.  Maybe
</I>|<i> I'm missing something about your requirements or architecture.
</I>
Well, what I'm looking for is actually quite simple. If you write your
own handler instead of using the mod_python.publisher, you get handed an
unprocessed req object, and you respond by returning an apache return
code. This is great. The problem is, your single handler gets executed
regardless of where in the tree you are. So, if in your .htaccess file
you say:
PythonHandler myhandler .py

and if you try to execute:

<A HREF="http://localhost/test1.py">http://localhost/test1.py</A>

and

<A HREF="http://localhost/folder/test2.py">http://localhost/folder/test2.py</A>

then your 'myhandler.py' module gets executed for both test1.py and
test2.py. I want to be able to have .py files all over my hierarchy that
get executed, rather than a single handler.

To do that, I have to use mod_python.publisher. However, if I use
mod_python.publisher, then I no longer return an apache code, I return a
string that is to be printed. I don't want to do that - I'll handle that
myself.

So I want some features of both techniques, and to do that I end up
having to end my publisher based calls by raising exceptions.

The system is working perfectly now as far as I can tell, I'm just
concerned that there may be a performance penalty with raising
exceptions like this, or that the system may at  some point be changed
so that any raised exception will be considered an error, which will
cause my stuff to break.

|<i>
</I>|&gt;<i>I'd just like to be sure that nothing odd is going to happen if I raise
</I>|&gt;<i>an exception. Or alternatively, how I could get processing similar to
</I>|&gt;<i>what I get if I write my own handler (where you create a handler()
</I>|&gt;<i>function and return a success code).
</I>|<i>
</I>|<i>
</I>|<i> Can't you just assume that if no exceptions have been raised, then
</I>|<i> everything was successful?  Exception handling seems to me to be more
</I>|<i> powerful and flexible than return codes.
</I>
As I said - *I'M* the one raising the exception, to get the behaviour I
need. It has nothing to do with me assuming what an exception means if
someone else raises it.

|<i> I think you may be over-complicating things a bit.  I'd recommend that
</I>|<i> you continue using publisher and factor out how you want each request
</I>|<i> to get handled into a method or class.  Here's just one way:
</I>|<i>
</I>|<i>
</I>|<i> class Page:
</I>|<i>
</I>|<i>     def __call__(self, req):
</I>|<i>         try:
</I>|<i>             return self.get_contents(req)
</I>|<i>         except:
</I>|<i>             pass # your exception handling code here
</I>|<i>
</I>|<i>
</I>|<i> class IndexPage:
</I>|<i>
</I>|<i>     def get_contents(self, req):
</I>|<i>         # This would be where you could put
</I>|<i>         # your current handler stuff
</I>|<i>
</I>|<i>
</I>|<i> index = IndexPage
</I>|<i> about_us = AboutPage
</I>|<i> ...
</I>|<i>
</I>
I'm not quite sure what you're illustrating here - the Page class isn't
used or referenced - is Page supposed to be derived from IndexPage? Or
vice versa? And I'm not concerned with HANDLING exceptions, I'm
concerned with what happens to the rest of the mod_python system state
if I THROW exceptions under normal circumstances. Zope, for example,
will execute a database rollback if you raise an exception. I don't want
that kind of thing being added on behind the scenes.

|<i>
</I>|<i> Hope it helps and that I didn't misunderstand you completely :)
</I>|<i>
</I>|<i>
</I>|<i> Best regards,
</I>|<i> Erik
</I>
It's funny, but what I need is pretty simple, but the more I explain it
the more it seems to get complicated.

I think the best thing is for me to simply publish what I'm doing, and
point to it so everyone can see in context what I'm doing. I'll put
proper copyright attributions on my files and do just that.

cf

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.4 (GNU/Linux)

iD8DBQFAVNU9oaQ1/feGlJoRAjRZAJwLjeEmoxFC5+f1CSa4OCZx1f7rKQCeNVyK
w7RwcMbPAqjErlpOF85992M=
=xi9V
-----END PGP SIGNATURE-----
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015232.html">[mod_python] An odd use of the publisher
</A></li>
	<LI>Next message: <A HREF="015237.html">[mod_python] An odd use of the publisher
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15235">[ date ]</a>
              <a href="thread.html#15235">[ thread ]</a>
              <a href="subject.html#15235">[ subject ]</a>
              <a href="author.html#15235">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
