<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] zero terminated strings and req.write
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20zero%20terminated%20strings%20and%20req.write&In-Reply-To=20040309142555.GA1744%40golgatha.local">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="015179.html">
   <LINK REL="Next"  HREF="015167.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] zero terminated strings and req.write</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Juli&#225;n Ciccal&#232;</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20zero%20terminated%20strings%20and%20req.write&In-Reply-To=20040309142555.GA1744%40golgatha.local"
       TITLE="[mod_python] zero terminated strings and req.write">jciccale at mac.com
       </A><BR>
    <I>Tue Mar  9 16:47:37 EST 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="015179.html">[mod_python] zero terminated strings and req.write
</A></li>
        <LI>Next message: <A HREF="015167.html">[mod_python] 
	Supporting legacy PHP pages while still giving mod_python the root
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15175">[ date ]</a>
              <a href="thread.html#15175">[ thread ]</a>
              <a href="subject.html#15175">[ subject ]</a>
              <a href="author.html#15175">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes apache.OK equals 0. 

If you are using the Publisher handler, the return value of your function is
writed out on the request.
So you either write your own data to the request and not return any value,
Or return the string to be writed on the request.

Anyway, returning apache.* values is used when you define
your OWN mod_python handler.

- julian

-----Mensaje original-----
De: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>
[mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>] En nombre de Frederick Grim
Enviado el: martes, 09 de marzo de 2004 15:26
Para: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Asunto: Re: [mod_python] zero terminated strings and req.write

Erik Stephens at &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at 24ksoftware.com</A>&gt; replied:
&gt;<i> On Mon, 8 Mar 2004, Frederick Grim wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; def gen_xml():
</I>&gt;<i> &gt; 	return &quot;&quot;&quot;&lt;?xml ... Tons of xhtml stuff here
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &lt;/html&gt;&quot;&quot;&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; def main(req, ERR='0'):
</I>&gt;<i> &gt; 	re.content_type = 'text/xml'
</I>&gt;<i> &gt; 	req.write(gen_xml())
</I>&gt;<i> &gt; 	return apache.OK
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The problem here is that python puts null bytes at the end of a
</I>&gt;<i> &gt; string and req.write fails with the error that there is a 0 after
</I>&gt;<i> &gt; &lt;/html&gt;.
</I>&gt;<i> 
</I>&gt;<i> How does it fail?  Raises an exception?  What is the actual exception
</I>&gt;<i> type and value?  It sounds strange to me cuz I've never had to worry
</I>&gt;<i> about null bytes in strings in my Python travels.
</I>
okay I have tracked the problem down.  It seems that return apache.OK
adds a 0 to the output that the browser picks up so somewhere between
function and
browser mod_python leaves the zero at the end of the string.  The problem
manifested itself with a failure when content_type was set to 'text/xml'
since I
guess mod_python shoved the output through a validating parser.

	1. Is this a correct analysis
	2. Is this a bug or my misuse of mod_python
	if is_bug:
		print 'Has this been addressed?'
	else:
		fred_file_bug_report()

	heh :)
		Fred
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; How do I get this failure to not happen.  Even if i set content_type
</I>&gt;<i> &gt; to 'text/html' there appears a little zero at the end of my
</I>&gt;<i> &gt; script. It seems like a bug? maybe.  I am using mod_python 3.1.3
</I>&gt;<i> &gt; apache 2.0.47, and python 2.3
</I>&gt;<i> 
</I>&gt;<i> Dumb questions maybe, but what handler are you using?  If you're using
</I>&gt;<i> the publisher handler, then maybe that zero at the end is what
</I>&gt;<i> apache.OK equals?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Best regards,
</I>&gt;<i> Erik
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>
-- 
&quot;Windows Longhorn will be like having a little cop right inside your
computer&quot;
	-- Jorge Lopez, MCSE
_______________________________________________
Mod_python mailing list
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="015179.html">[mod_python] zero terminated strings and req.write
</A></li>
	<LI>Next message: <A HREF="015167.html">[mod_python] 
	Supporting legacy PHP pages while still giving mod_python the root
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#15175">[ date ]</a>
              <a href="thread.html#15175">[ thread ]</a>
              <a href="subject.html#15175">[ subject ]</a>
              <a href="author.html#15175">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
