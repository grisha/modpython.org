<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] mod_python with 4Suite tools
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20with%204Suite%20tools&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013289.html">
   <LINK REL="Next"  HREF="013245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] mod_python with 4Suite tools</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Heikki Halonen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20mod_python%20with%204Suite%20tools&In-Reply-To="
       TITLE="[mod_python] mod_python with 4Suite tools">heha at iki.fi
       </A><BR>
    <I>Tue Dec  3 16:13:00 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="013289.html">[mod_python] bug/misfeature in publisher/mod_python
</A></li>
        <LI>Next message: <A HREF="013245.html">[mod_python] mod_python on Win32 Apache 1.3.27
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13239">[ date ]</a>
              <a href="thread.html#13239">[ thread ]</a>
              <a href="subject.html#13239">[ subject ]</a>
              <a href="author.html#13239">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I'm having hard time trying to make 4Suite tools co-operate with
mod_python (or vice versa). I'm using Python 2.2.2, Apache 2.0.43,
mod_python 3.0.1 and newest 4Suite development version. My system is
Debian unstable. python2.2-xml package is not installed.

The test program is in the end of this mail, the xml files used can be
found at <A HREF="http://www.heha.iki.fi/~heha/poll_dev/quiz2html.xsl">http://www.heha.iki.fi/~heha/poll_dev/quiz2html.xsl</A> and
<A HREF="http://www.heha.iki.fi/~heha/poll_dev/polls/quiz_1.xml.">http://www.heha.iki.fi/~heha/poll_dev/polls/quiz_1.xml.</A> Test program works
perfectly when run from the command line. When requested by mod_python,
however, it 'obfuscates' the XML document. Characters used in marking
print out fine but everything else is some random binary data. I figured
out that it probably has something to do with encoding and added the
following lines to sitecustomize.py, as somebody advised in some distantly
similar problem:

u'hello'.encode( 'UTF-8' )
u'hello'.encode( 'iso8859-1' )

This did not help, whatsoever. I have no clue anymore where the problem
could be or how it could be corrected. Any suggestions? The same kind of
code works fine in mod_python 2.7.8 running in Apache 1.3.26 with Python
2.1 and 4Suite version 0.11.1.




#!/usr/bin/python2.2

import sys, os, string

from Ft.Lib import Uri
from Ft.Xml.Xslt import XmlWriter, Processor, OutputParameters
from Ft.Xml import Domlette, InputSource

def processXML():
    mypath = '/home/heha/public_html/poll_dev/'
    pollfile = mypath+'polls/quiz_1.xml'
    pollxsl = mypath+'quiz2html.xsl'

    debugfile = open( mypath+'poll.log', 'w' )
    processor = Processor.Processor()
    node = Domlette.NonvalidatingReader.parseUri( pollfile )
    Domlette.Print( node, debugfile, encoding='iso8859-1' )
    stylesheet = InputSource.DefaultFactory.fromUri( pollxsl )
    processor.appendStylesheet( stylesheet )

    processed_node = processor.runNode( node, Uri.OsPathToUri(
        pollfile, 1) )

    debugfile.write( processed_node )
    debugfile.close()

    return processed_node

    #print writer.getResult()

if __name__ == &quot;__main__&quot;:
    print processXML()
else:
    from mod_python import apache

    def handler( req ):
        req.write( processXML() )
        return apache.OK



     Heikki Halonen # <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">heha at iki.fi</A> # iki.fi/heha # +358 40 828 9972
            &quot;The easy way ain't hard enough and the hard way
                     is such a lonely lonely path&quot;


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013289.html">[mod_python] bug/misfeature in publisher/mod_python
</A></li>
	<LI>Next message: <A HREF="013245.html">[mod_python] mod_python on Win32 Apache 1.3.27
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13239">[ date ]</a>
              <a href="thread.html#13239">[ thread ]</a>
              <a href="subject.html#13239">[ subject ]</a>
              <a href="author.html#13239">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
