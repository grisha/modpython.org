<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] problem with file download in mod-python 3.0.1
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20problem%20with%20file%20download%20in%20mod-python%203.0.1&In-Reply-To=52DC70C1C1575C418CB033523A29CF14104883%40exchange2000.manord.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="013275.html">
   <LINK REL="Next"  HREF="013274.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] problem with file download in mod-python 3.0.1</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Gregory (Grisha) Trubetskoy</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20problem%20with%20file%20download%20in%20mod-python%203.0.1&In-Reply-To=52DC70C1C1575C418CB033523A29CF14104883%40exchange2000.manord.com"
       TITLE="[mod_python] problem with file download in mod-python 3.0.1">grisha at modpython.org
       </A><BR>
    <I>Fri Dec 20 16:34:37 EST 2002</I>
    <P><UL>
        <LI>Previous message: <A HREF="013275.html">[mod_python] problem with file download in mod-python 3.0.1
</A></li>
        <LI>Next message: <A HREF="013274.html">R: [mod_python] problem with file download in mod-python 3.0.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13298">[ date ]</a>
              <a href="thread.html#13298">[ thread ]</a>
              <a href="subject.html#13298">[ subject ]</a>
              <a href="author.html#13298">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I must be missing something obvious, but without testing it and just by
looking at the code, I'm not sure I understand what the benefit is of
filtering out BuiltinMethodType, as opposed to just using straight
dir(obj).

The above might be a moot point since just as Brian Hawthorne suggested
I'm not sure why we don't need the File class at all and am in the process
of trying to fish out any memories from my tired brain about how it came
about in the fist place....

Grisha

On Thu, 12 Dec 2002, Manera, Villiam wrote:

&gt;<i> I'm testing mod-python 3.0.1 with apache 2.0.43 and python 2.2.2
</I>&gt;<i>
</I>&gt;<i> I've founded a older problem in file download (from python 2.1 to 2.2)
</I>&gt;<i>
</I>&gt;<i> the workaround is still the same:
</I>&gt;<i>
</I>&gt;<i> in publisher.py:
</I>&gt;<i>
</I>&gt;<i>  class File:
</I>&gt;<i>      &quot;&quot;&quot; Like a file, but also has headers and filename
</I>&gt;<i>      &quot;&quot;&quot;
</I>&gt;<i>      def __init__(self, field):
</I>&gt;<i>          # steal all the file-like methods
</I>&gt;<i>          for m in dir(field.file):
</I>&gt;<i> 		 self.__dict__[m] = getattr(field.file, m)
</I>&gt;<i>
</I>&gt;<i>          self.headers = field.headers
</I>&gt;<i>          self.filename = field.filename
</I>&gt;<i> ======================workaround
</I>&gt;<i> ==============================================
</I>&gt;<i>  class File:
</I>&gt;<i>      &quot;&quot;&quot; Like a file, but also has headers and filename
</I>&gt;<i>      &quot;&quot;&quot;
</I>&gt;<i>      def __init__(self, field):
</I>&gt;<i>          # steal all the file-like methods
</I>&gt;<i>          #for m in dir(field.file):    #dont' work
</I>&gt;<i>          for m in self.sim_methods(field.file):
</I>&gt;<i>              self.__dict__[m] = getattr(field.file, m)
</I>&gt;<i>
</I>&gt;<i>          self.headers = field.headers
</I>&gt;<i>          self.filename = field.filename
</I>&gt;<i>
</I>&gt;<i> 	#new--------
</I>&gt;<i>      def sim_methods(self,obj):
</I>&gt;<i>          from types import BuiltinMethodType
</I>&gt;<i>          return filter(lambda s, t=obj:
</I>&gt;<i>             type(getattr(t, s)) == BuiltinMethodType, dir(obj))
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I hope it will be put in place
</I>&gt;<i>
</I>&gt;<i> regards
</I>&gt;<i>
</I>&gt;<i> Villiam Manera
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://www.modpython.org/mailman/listinfo/mod_python">http://www.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="013275.html">[mod_python] problem with file download in mod-python 3.0.1
</A></li>
	<LI>Next message: <A HREF="013274.html">R: [mod_python] problem with file download in mod-python 3.0.1
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#13298">[ date ]</a>
              <a href="thread.html#13298">[ thread ]</a>
              <a href="subject.html#13298">[ subject ]</a>
              <a href="author.html#13298">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
