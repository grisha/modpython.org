From grahamd at dscpl.com.au  Fri Sep  1 00:04:36 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Sep  1 00:04:40 2006
Subject: [mod_python] Using mod_python to customise subversion repository
	access.
Message-ID: <1157083476.17522@dscpl.user.openhosting.com>

In my real job, we are finally converting to using subversion. Now
although subversion when used through Apache still supports a
level of user authorisation, whereby one can see if a user has read
or read/write to different parts of a repository, the paths have to
be listed in full, with no support for wildcarding. Also, you can't
use its authorisation mechanism to implement a fine grained level
of authorisation.

For example, we want to allow users to be able to copy the trunk
to a tags directory to effectively mark a specific version, and we
want to be able to users to check out a copy of a tagged version,
but we do not want to allow users to make changes to and commit
back in changes into a tagged version of a package.

So, mod_python to the rescue.

  from mod_python import apache
  import fnmatch

  BLOCK_URI = '/svn/drives/!svn/*/*/packages/tags/*/*/*'

  BLOCK_METHOD = [ 'MKCOL', 'PUT', 'PROPPATCH', 'CHECKOUT',
          'MERGE', 'MKACTIVITY', 'LOCK', 'UNLOCK' ]

  def authzhandler(req):
      if fnmatch.fnmatch(req.uri, BLOCK_URI):
          if req.method in BLOCK_METHOD:
              return apache.HTTP_FORBIDDEN
      return apache.OK

The associated Apache configuration is something like:

  <Location /svn>

    DAV svn
    SVNParentPath /usr/local/repository/subversion

    Require valid-user

    AuthzSVNAccessFile /usr/local/repository/svnserve.conf

    PythonInterpreter subversion_authz
    PythonPath 'sys.path + ["/usr/local/repository/handlers"]'
    PythonFixupHandler drives_authz::authzhandler
    PythonDebug On

  </Location>

In the pattern being matched, '/svn/drives' identifies the actual repository
root path in the URI. The '/packages/tags/*/*/*' is identifying the directories
where we keep our tagged versions. The structure we use is:

  /packages/tags/package-name/package-version

When creating a tag, subversion client uses "COPY" method, so making the
copy still works. When doing commits, it needs to at least use 'CHECKOUT',
and 'PUT'. Depending on what else it does, it could use the others in the
block list.

Anyway, end result is that people can't write over tagged versions.

Gotta run now, so enjoy.

Graham
From deron.meranda at gmail.com  Fri Sep  1 01:39:56 2006
From: deron.meranda at gmail.com (Deron Meranda)
Date: Fri Sep  1 01:40:00 2006
Subject: [mod_python] Using mod_python to customise subversion repository
	access.
In-Reply-To: <1157083476.17522@dscpl.user.openhosting.com>
References: <1157083476.17522@dscpl.user.openhosting.com>
Message-ID: <5c06fa770608312239v418058d8qc61d48c906c83a9f@mail.gmail.com>

On 9/1/06, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
> In my real job, we are finally converting to using subversion. Now
> although subversion when used through Apache still supports a
> level of user authorisation,
>  ... you can't use its authorisation mechanism to implement
>  a fine grained level of authorisation.
> ...
> So, mod_python to the rescue.

Its nice to see somebody else's approach to this too.  I've
done something similar for my subversion respository about
three weeks ago.  Only I'm driving the whole thing through
a set of MySQL tables which contain all the access rules.

>   from mod_python import apache
>   import fnmatch

The fnmatch module is a neat shortcut; I always keep
forgetting about that one.  I tend to do the regexes
the hard(er) way.

>   BLOCK_URI = '/svn/drives/!svn/*/*/packages/tags/*/*/*'
>
>   BLOCK_METHOD = [ 'MKCOL', 'PUT', 'PROPPATCH', 'CHECKOUT',
>           'MERGE', 'MKACTIVITY', 'LOCK', 'UNLOCK' ]
>
>   def authzhandler(req):
>       if fnmatch.fnmatch(req.uri, BLOCK_URI):
>           if req.method in BLOCK_METHOD:
>               return apache.HTTP_FORBIDDEN
>       return apache.OK

I like to reverse this logic and list those methods I want
to allow instead of those to block.  There are so many
different methods (and more being invented by the
DAV working groups all the time), that I don't want
to leave one out.

The methods needed for complete read-only access are:
   ['GET','HEAD','OPTIONS','PROPFIND','REPORT']

As Graham noticed you can also choose to allow some others,
such as COPY, to give something in between a read-only and
full access.  It can get complicated though.

Another trick I use is setting the username which gets
written into the subversion changelogs (when doing
writes/commits).  I need to do this first off because I'm
using mod_python for full authentication and authorization,
instead of any of the Apache auth* modules.  Also I wanted
to be able to have subversion record the user's permanent
id number in addition to the username (which could in
theory change someday).  Well, the trick is really simple;
just assign into the req->user member whatever string
you want to appear in the subversion change logs.

Oh, another subversion+mod_python issue.  I actually
have my website itself stored in subversion, including
all my mod_python module files and so forth.  For
most of the website I use the http:... style URL for the
subversion client (svn) when keeping those files
up to date.

However for the smaller core set of files, including
my authentication module, I have it using the more
direct file:... URLs.  This is important in case your head
revision gets broken.  If you were using the http: urls,
then your subversion access woild also be broken
and you couldn't easily revert back your changes.
  --- And also, obviously, you should implement
careful access control on those parts of the subversion
repository which contain the security-critical portions
of your website.
-- 
Deron Meranda
From grahamd at dscpl.com.au  Fri Sep  1 02:30:45 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Sep  1 02:30:54 2006
Subject: [mod_python] Using mod_python to customise subversion repository
	access.
Message-ID: <1157092244.17811@dscpl.user.openhosting.com>

Deron Meranda wrote ..
> >   BLOCK_URI = '/svn/drives/!svn/*/*/packages/tags/*/*/*'
> >
> >   BLOCK_METHOD = [ 'MKCOL', 'PUT', 'PROPPATCH', 'CHECKOUT',
> >           'MERGE', 'MKACTIVITY', 'LOCK', 'UNLOCK' ]
> >
> >   def authzhandler(req):
> >       if fnmatch.fnmatch(req.uri, BLOCK_URI):
> >           if req.method in BLOCK_METHOD:
> >               return apache.HTTP_FORBIDDEN
> >       return apache.OK
> 
> I like to reverse this logic and list those methods I want
> to allow instead of those to block.  There are so many
> different methods (and more being invented by the
> DAV working groups all the time), that I don't want
> to leave one out.
> 
> The methods needed for complete read-only access are:
>    ['GET','HEAD','OPTIONS','PROPFIND','REPORT']

I knew someone would pick me up on that, as has been done before. My
only excuse is that I am playing at this point.

As it turns out, I should have been blocking "MOVE" and "DELETE" as
well for that part of the tree. If I had taken the other approach of only
allowing 'OPTIONS', 'GET', 'PROPFIND', 'REPORT' and 'COPY', then I
would have indeed been okay for the default case. :-)

Graham
From shadow at mapik.net  Fri Sep  1 04:44:14 2006
From: shadow at mapik.net (=?WINDOWS-1252?Q?Honza_Rame=9A?=)
Date: Fri Sep  1 04:44:20 2006
Subject: [SPAM] Re: [mod_python] Python 2.5
In-Reply-To: <44F750CD.9080904@jgassociates.ca>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>
	<44F750CD.9080904@jgassociates.ca>
Message-ID: <22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>

Thanks for your reply

Python 2.4 works perfectly but when I change to 2.5 RC1 apache can't find
the handler. I have tried to start python console and import
mod_python.apache it worked (accordingly to
http://www.modpython.org/pipermail/mod_python/2004-November/016815.html) and
I double checked evry path and I also tried to copy python25.dll to several
locations in PATH byt I got the same result :-( I was very supprised that it
didn't work. If the 2.4 didn't work as well then it would seem that I hove
done some mistake in configuration but this way I am very confused. I read
the article you sent me before but I couldn't find any usable information.
Is there a possbility that I haven't installed Python correctly? I mean I
compiled it but could there be missing some files that would couse this
problem?
The reason I'm doing all this is because I'm trying to get Trac with SVN to
work. There are no windows SVN bindings for python 2.4 so I tried to make
them but Python 2.4 compiled with VS2005 does not run at all (so I'm using
official release), Python 2.5 does but mod_python doesn't :-(

Regards

Honza Rames

On 8/31/06, Jim Gallacher <jpg@jgassociates.ca> wrote:
>
> I haven't tried 2.5 yet, but I guess we should start testing the
> development branch against it. We're hoping to release mod_python 3.3
> sometime in October or November. Hopefully that would be too long after
> python 2.5 is officially out. I don't know what their timetable is but
> currently it's just the release candidate so the lag shouldn't be too
> great. I'd be very surprised if there was any changes that would break
> mod_python though.
>
> For your particular problem though I suspect it's the usual installation
> funkiness rather than a python 2.5 specific issue. In particular take a
> look at the thread that started on Tuesday. See
> http://www.modpython.org/pipermail/mod_python/2006-August/021944.html
>
> Jim
>
>
> Honza Rame? wrote:
> > Hi,
> > have any of you tried to run mod_python with Python 2.5 on Windows. I
> > cannot run Python 2.4 compiled with VS2005 it always result in an error.
> > And
> > mod_python with Python 2.5 returns Internal server error and
> > error.logcontains:
> >
> >
> >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: could not import
> >> mod_python.apache.\n
> >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: Python path being
> >> used
> >> "['C:\\\\WINDOWS\\\\system32\\\\python25.zip', '.\\\\DLLs', '.\\\\lib',
> >> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> >> 'C:\\\\Inetpub\\\\Apache2\\\\bin']".
> >> [Thu Aug 31 02:40:35 2006] [error] python_handler: no interpreter
> >> callback
> >> found.
> >> [Thu Aug 31 02:40:35 2006] [error] [client 10.0.0.2] python_handler:
> >> Can't
> >> get/create interpreter.
> >
> >
> > I compiled both Apache 2.2.3 and mod_python 3.2.10
> > Thanks
> >
> > Honza Rames
> >
> >
> > ------------------------------------------------------------------------
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060901/e1ba66fd/attachment.html
From guotie.9 at gmail.com  Fri Sep  1 05:11:54 2006
From: guotie.9 at gmail.com (guo tie)
Date: Fri Sep  1 05:11:57 2006
Subject: [mod_python] [SPAM] modpython session under linux apache 2.2
	mpm-worker
Message-ID: <79b73f2b0609010211r30a8c69ta239c2fc1296543@mail.gmail.com>

hi,
   all.
   i found the mod_python session under linux apache 2.2 mpm-worker have
problem.

linux: 2.6.17
apache: 2.2 mpm-worker
python: 2.4.3
mod_python 3.2.10

Now, the test.py is :

from mod_python import apache
from mod_python import Session
import sys

class Dispatcher(object):
    def __init__(self, req):
        self._req = req
        self._uri =  req.uri

    def dispatch(self, req):
        req.content_type =      'text/plain'
        import mod_python
        req.write(mod_python.version)
        req.write('\n')
        self.sess =     Session.Session(req)
        req.write("after create session\n")
        self.sess['obj'] =      'abcdtest'
        req.write("after sess['ob'] = 'abcdtest'\n")
        self.sess.set_timeout(60 * 60)
        req.write("after self.set_timeout(60 * 60)\n")
        self.sess.save()
        req.write("after sess.save()\n")
        req.write(self.sess['obj'])

        return apache.OK

def handler(req):
    mypatch =   Dispatcher(req)
    return mypatch.dispatch(req)

when i use ie or firefox visit the page, i was hanged after output
3.2.10

i think this is the session bug with apache mpm mode, i see somebody else
have mentioned it .
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060901/ce797dbf/attachment.html
From shadow at mapik.net  Fri Sep  1 06:01:29 2006
From: shadow at mapik.net (=?WINDOWS-1252?Q?Honza_Rame=9A?=)
Date: Fri Sep  1 06:01:32 2006
Subject: [mod_python] Python 2.5
In-Reply-To: <22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>
	<44F750CD.9080904@jgassociates.ca>
	<22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
Message-ID: <22e28ea10609010301t342eb200m73c68cb89cfa3f4c@mail.gmail.com>

I've solved it. The whole problem was in windows registry ]:-> there were
missing key that tells python where it is installed.

The reg file that fixes the problem looks like

Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5]

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\InstallPath]
@="<path to python>"

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\InstallPath\InstallGroup]
@="Python 2.5"

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\Modules]

[HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
@="<path to python>\\Lib;<path to python>\\DLLs;<path to
python>\\Lib\\lib-tk"

 On 9/1/06, Honza Rame? <shadow@mapik.net> wrote:

>  Thanks for your reply
>
> Python 2.4 works perfectly but when I change to 2.5 RC1 apache can't find
> the handler. I have tried to start python console and import
> mod_python.apache it worked (accordingly to
> http://www.modpython.org/pipermail/mod_python/2004-November/016815.html)
> and I double checked evry path and I also tried to copy python25.dll to
> several locations in PATH byt I got the same result :-( I was very supprised
> that it didn't work. If the 2.4 didn't work as well then it would seem
> that I hove done some mistake in configuration but this way I am very
> confused. I read the article you sent me before but I couldn't find any
> usable information. Is there a possbility that I haven't installed Python
> correctly? I mean I compiled it but could there be missing some files that
> would couse this problem?
> The reason I'm doing all this is because I'm trying to get Trac with SVN
> to work. There are no windows SVN bindings for python 2.4 so I tried to
> make them but Python 2.4 compiled with VS2005 does not run at all (so I'm
> using official release), Python 2.5 does but mod_python doesn't :-(
>
> Regards
>
> Honza Rames
>
>  On 8/31/06, Jim Gallacher <jpg@jgassociates.ca> wrote:
> >
> > I haven't tried 2.5 yet, but I guess we should start testing the
> > development branch against it. We're hoping to release mod_python 3.3
> > sometime in October or November. Hopefully that would be too long after
> > python 2.5 is officially out. I don't know what their timetable is but
> > currently it's just the release candidate so the lag shouldn't be too
> > great. I'd be very surprised if there was any changes that would break
> > mod_python though.
> >
> > For your particular problem though I suspect it's the usual installation
> > funkiness rather than a python 2.5 specific issue. In particular take a
> > look at the thread that started on Tuesday. See
> > http://www.modpython.org/pipermail/mod_python/2006-August/021944.html
> >
> > Jim
> >
> >
> > Honza Rame? wrote:
> > > Hi,
> > > have any of you tried to run mod_python with Python 2.5 on Windows. I
> > > cannot run Python 2.4 compiled with VS2005 it always result in an
> > error.
> > > And
> > > mod_python with Python 2.5 returns Internal server error and
> > > error.logcontains:
> > >
> > >
> > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: could not import
> > >> mod_python.apache.\n
> > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: Python path being
> >
> > >> used
> > >> "['C:\\\\WINDOWS\\\\system32\\\\python25.zip', '.\\\\DLLs',
> > '.\\\\lib',
> > >> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > >> 'C:\\\\Inetpub\\\\Apache2\\\\bin']".
> > >> [Thu Aug 31 02:40:35 2006] [error] python_handler: no interpreter
> > >> callback
> > >> found.
> > >> [Thu Aug 31 02:40:35 2006] [error] [client 10.0.0.2] python_handler:
> > >> Can't
> > >> get/create interpreter.
> > >
> > >
> > > I compiled both Apache 2.2.3 and mod_python 3.2.10
> > > Thanks
> > >
> > > Honza Rames
> > >
> > >
> > >
> > ------------------------------------------------------------------------
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060901/bda9f5b8/attachment-0001.html
From jpg at jgassociates.ca  Fri Sep  1 08:06:10 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep  1 08:06:11 2006
Subject: [mod_python] Python 2.5
In-Reply-To: <22e28ea10609010301t342eb200m73c68cb89cfa3f4c@mail.gmail.com>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>	<44F750CD.9080904@jgassociates.ca>	<22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
	<22e28ea10609010301t342eb200m73c68cb89cfa3f4c@mail.gmail.com>
Message-ID: <44F82232.7010204@jgassociates.ca>

I'm glad to hear you solved your problem and that pythn 2.5 works.

Jim

Honza Rame? wrote:
> I've solved it. The whole problem was in windows registry ]:-> there were
> missing key that tells python where it is installed.
> 
> The reg file that fixes the problem looks like
> 
> Windows Registry Editor Version 5.00
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5]
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\InstallPath]
> @="<path to python>"
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\InstallPath\InstallGroup] 
> 
> @="Python 2.5"
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\Modules]
> 
> [HKEY_LOCAL_MACHINE\SOFTWARE\Python\PythonCore\2.5\PythonPath]
> @="<path to python>\\Lib;<path to python>\\DLLs;<path to
> python>\\Lib\\lib-tk"
> 
> On 9/1/06, Honza Rame? <shadow@mapik.net> wrote:
> 
>>  Thanks for your reply
>>
>> Python 2.4 works perfectly but when I change to 2.5 RC1 apache can't find
>> the handler. I have tried to start python console and import
>> mod_python.apache it worked (accordingly to
>> http://www.modpython.org/pipermail/mod_python/2004-November/016815.html)
>> and I double checked evry path and I also tried to copy python25.dll to
>> several locations in PATH byt I got the same result :-( I was very 
>> supprised
>> that it didn't work. If the 2.4 didn't work as well then it would seem
>> that I hove done some mistake in configuration but this way I am very
>> confused. I read the article you sent me before but I couldn't find any
>> usable information. Is there a possbility that I haven't installed Python
>> correctly? I mean I compiled it but could there be missing some files 
>> that
>> would couse this problem?
>> The reason I'm doing all this is because I'm trying to get Trac with SVN
>> to work. There are no windows SVN bindings for python 2.4 so I tried to
>> make them but Python 2.4 compiled with VS2005 does not run at all (so I'm
>> using official release), Python 2.5 does but mod_python doesn't :-(
>>
>> Regards
>>
>> Honza Rames
>>
>>  On 8/31/06, Jim Gallacher <jpg@jgassociates.ca> wrote:
>> >
>> > I haven't tried 2.5 yet, but I guess we should start testing the
>> > development branch against it. We're hoping to release mod_python 3.3
>> > sometime in October or November. Hopefully that would be too long after
>> > python 2.5 is officially out. I don't know what their timetable is but
>> > currently it's just the release candidate so the lag shouldn't be too
>> > great. I'd be very surprised if there was any changes that would break
>> > mod_python though.
>> >
>> > For your particular problem though I suspect it's the usual 
>> installation
>> > funkiness rather than a python 2.5 specific issue. In particular take a
>> > look at the thread that started on Tuesday. See
>> > http://www.modpython.org/pipermail/mod_python/2006-August/021944.html
>> >
>> > Jim
>> >
>> >
>> > Honza Rame? wrote:
>> > > Hi,
>> > > have any of you tried to run mod_python with Python 2.5 on Windows. I
>> > > cannot run Python 2.4 compiled with VS2005 it always result in an
>> > error.
>> > > And
>> > > mod_python with Python 2.5 returns Internal server error and
>> > > error.logcontains:
>> > >
>> > >
>> > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: could not import
>> > >> mod_python.apache.\n
>> > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: Python path 
>> being
>> >
>> > >> used
>> > >> "['C:\\\\WINDOWS\\\\system32\\\\python25.zip', '.\\\\DLLs',
>> > '.\\\\lib',
>> > >> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
>> > >> 'C:\\\\Inetpub\\\\Apache2\\\\bin']".
>> > >> [Thu Aug 31 02:40:35 2006] [error] python_handler: no interpreter
>> > >> callback
>> > >> found.
>> > >> [Thu Aug 31 02:40:35 2006] [error] [client 10.0.0.2] python_handler:
>> > >> Can't
>> > >> get/create interpreter.
>> > >
>> > >
>> > > I compiled both Apache 2.2.3 and mod_python 3.2.10
>> > > Thanks
>> > >
>> > > Honza Rames
>> > >
>> > >
>> > >
>> > 
>> ------------------------------------------------------------------------
>> > >
>> > > _______________________________________________
>> > > Mod_python mailing list
>> > > Mod_python@modpython.org
>> > > http://mailman.modpython.org/mailman/listinfo/mod_python
>> >
>> >
>>
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From jpg at jgassociates.ca  Fri Sep  1 08:13:10 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep  1 08:13:15 2006
Subject: [SPAM] [mod_python] [SPAM] modpython session under linux apache
	2.2 mpm-worker
In-Reply-To: <79b73f2b0609010211r30a8c69ta239c2fc1296543@mail.gmail.com>
References: <79b73f2b0609010211r30a8c69ta239c2fc1296543@mail.gmail.com>
Message-ID: <44F823D6.3040307@jgassociates.ca>

It's not immediately obvious from your code why it might hang, but I can 
tell you the session part will not work as written. When a session is 
created a corresponding cookie is set in the response header. However 
your have a req.write() call before you create your session object. The 
first req.write() will cause the headers to be sent to the client, so 
the session cookie will never be sent. Sesssion.Session() must happen 
before any req.write() call.

Jim

guo tie wrote:
> hi,
>   all.
>   i found the mod_python session under linux apache 2.2 mpm-worker have
> problem.
> 
> linux: 2.6.17
> apache: 2.2 mpm-worker
> python: 2.4.3
> mod_python 3.2.10
> 
> Now, the test.py is :
> 
> from mod_python import apache
> from mod_python import Session
> import sys
> 
> class Dispatcher(object):
>    def __init__(self, req):
>        self._req = req
>        self._uri =  req.uri
> 
>    def dispatch(self, req):
>        req.content_type =      'text/plain'
>        import mod_python
>        req.write(mod_python.version)
>        req.write('\n')
>        self.sess =     Session.Session(req)
>        req.write("after create session\n")
>        self.sess['obj'] =      'abcdtest'
>        req.write("after sess['ob'] = 'abcdtest'\n")
>        self.sess.set_timeout(60 * 60)
>        req.write("after self.set_timeout(60 * 60)\n")
>        self.sess.save()
>        req.write("after sess.save()\n")
>        req.write(self.sess['obj'])
> 
>        return apache.OK
> 
> def handler(req):
>    mypatch =   Dispatcher(req)
>    return mypatch.dispatch(req)
> 
> when i use ie or firefox visit the page, i was hanged after output
> 3.2.10
> 
> i think this is the session bug with apache mpm mode, i see somebody else
> have mentioned it .
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From nicolas at lehuen.com  Fri Sep  1 13:34:13 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Fri Sep  1 13:34:23 2006
Subject: [SPAM] Re: [mod_python] Python 2.5
In-Reply-To: <22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>
	<44F750CD.9080904@jgassociates.ca>
	<22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
Message-ID: <c298f2d70609011034n3e1645d0j5254694b0d7cb2a6@mail.gmail.com>

Your input about Trac is interesting. On a machine I'm stuck with
Python 2.3because I want to run Trac. I tried to build the SVN Python
binding for
Python 2.4, but even though I have a full compiler chain (so I can build
Apache, Neon, apr-utils, SVN, Python etc. with the same compiler), the task
is quite daunting, as building SVN for Win32 is not the simplest thing of
earth (you might as well try to make meat stuffed spaghettis).

So, I wonder, how did you manage to get the SVN Python bindings for Python
2.5 ? With the final release coming soon, this would be very great :)

Regards,
Nicolas

2006/9/1, Honza Rame? <shadow@mapik.net>:
>
> Thanks for your reply
>
> Python 2.4 works perfectly but when I change to 2.5 RC1 apache can't find
> the handler. I have tried to start python console and import
> mod_python.apache it worked (accordingly to
> http://www.modpython.org/pipermail/mod_python/2004-November/016815.html)
> and I double checked evry path and I also tried to copy python25.dll to
> several locations in PATH byt I got the same result :-( I was very supprised
> that it didn't work. If the 2.4 didn't work as well then it would seem
> that I hove done some mistake in configuration but this way I am very
> confused. I read the article you sent me before but I couldn't find any
> usable information. Is there a possbility that I haven't installed Python
> correctly? I mean I compiled it but could there be missing some files that
> would couse this problem?
> The reason I'm doing all this is because I'm trying to get Trac with SVN
> to work. There are no windows SVN bindings for python 2.4 so I tried to
> make them but Python 2.4 compiled with VS2005 does not run at all (so I'm
> using official release), Python 2.5 does but mod_python doesn't :-(
>
> Regards
>
> Honza Rames
>
> On 8/31/06, Jim Gallacher <jpg@jgassociates.ca> wrote:
> >
> > I haven't tried 2.5 yet, but I guess we should start testing the
> > development branch against it. We're hoping to release mod_python 3.3
> > sometime in October or November. Hopefully that would be too long after
> > python 2.5 is officially out. I don't know what their timetable is but
> > currently it's just the release candidate so the lag shouldn't be too
> > great. I'd be very surprised if there was any changes that would break
> > mod_python though.
> >
> > For your particular problem though I suspect it's the usual installation
> > funkiness rather than a python 2.5 specific issue. In particular take a
> > look at the thread that started on Tuesday. See
> > http://www.modpython.org/pipermail/mod_python/2006-August/021944.html
> >
> > Jim
> >
> >
> > Honza Rame? wrote:
> > > Hi,
> > > have any of you tried to run mod_python with Python 2.5 on Windows. I
> > > cannot run Python 2.4 compiled with VS2005 it always result in an
> > error.
> > > And
> > > mod_python with Python 2.5 returns Internal server error and
> > > error.logcontains:
> > >
> > >
> > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: could not import
> > >> mod_python.apache.\n
> > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: Python path being
> >
> > >> used
> > >> "['C:\\\\WINDOWS\\\\system32\\\\python25.zip', '.\\\\DLLs',
> > '.\\\\lib',
> > >> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > >> 'C:\\\\Inetpub\\\\Apache2\\\\bin']".
> > >> [Thu Aug 31 02:40:35 2006] [error] python_handler: no interpreter
> > >> callback
> > >> found.
> > >> [Thu Aug 31 02:40:35 2006] [error] [client 10.0.0.2] python_handler:
> > >> Can't
> > >> get/create interpreter.
> > >
> > >
> > > I compiled both Apache 2.2.3 and mod_python 3.2.10
> > > Thanks
> > >
> > > Honza Rames
> > >
> > >
> > >
> > ------------------------------------------------------------------------
> > >
> > > _______________________________________________
> > > Mod_python mailing list
> > > Mod_python@modpython.org
> > > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060901/3ea66f2e/attachment.html
From chad at zetaweb.com  Fri Sep  1 16:58:56 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Fri Sep  1 16:59:05 2006
Subject: [mod_python] threads and FreeBSD: LD_PRELOAD=/usr/lib/libc_r.so the
	same as --enable-threads?
Message-ID: <44F89F10.1090903@zetaweb.com>

Hey all,

I'm installing mod_python 3.2.10 on FreeBSD 6.0-RELEASE w/ Apache 
2.0.55. I hit the 'Undefined symbol "pthread_attr_init"' problem, and 
have dug through the docs and lists trying to piece together the best 
answer. Afaict, the options are three:

   1. add "LD_PRELOAD=/usr/lib/libc_r.so" to Apache's envvars
   2. compile Apache with --enable-threads
   3. compile Python --without-threads

I don't want to choose #2 because of other doc I've found. My question 
is whether #1 (which appears to be the "official" answer) is basically 
the same as #2?

Thanks.



chad
From chad at zetaweb.com  Fri Sep  1 17:17:27 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Fri Sep  1 17:17:36 2006
Subject: [mod_python] threads and FreeBSD: LD_PRELOAD=/usr/lib/libc_r.so
	the	same as --enable-threads?
In-Reply-To: <44F89F10.1090903@zetaweb.com>
References: <44F89F10.1090903@zetaweb.com>
Message-ID: <44F8A367.2050502@zetaweb.com>

All,

Perhaps I ought to include more detail. Below are my install notes thus 
far. Thanks.


chad


========================================
     INSTALLING MOD_PYTHON ON FREEBSD
========================================

Download from http://www.modpython.org/

    $ ./configure --with-apxs=/usr/local/apache2/bin/apxs
    $ make
    $ sudo make install

Unfortunately, doing the standard dance on FreeBSD gives you the 
following error when you try to LoadModule:

   Syntax error on line 36 of /usr/local/apache2/conf/httpd.conf:
   Cannot load /usr/local/apache2/modules/mod_python.so into server:
     /usr/local/apache2/modules/mod_python.so: Undefined symbol
     "pthread_attr_init"

"[T]hreads do not work well with Apache on FreeBSD",[1] so Apache does 
not build with them by default on FreeBSD. You can get mod_python to 
minimally work by compiling Apache with --enable-threads,[2] but using a 
threaded Apache on FreeBSD does indeed appear to be a bad idea:

     * "The general experience is that after not very long, Apache starts
       eating 100% of the CPU and not answering queries."[3]
     * "After doing a apache benchmark test with 'ab' I see a lot of
       stuck http gets in /server-status listing."[4]

Grisha's answer is to "cause Apache to start with threaded libs"[5] by 
adding this to /usr/local/apache2/bin/envvars:[6]

   export LD_PRELOAD=/usr/lib/libc_r.so

But is this the same as compiling Apache with --enable-threads? There be 
dragons, as noted above. Per ld.so(1),[7] LD_PRELOAD denotes "[a] list 
of shared libraries, separated by colons and/or white space, to be 
linked in before any other shared libraries." And here my knowledge 
ends: does linking in the library mean that Apache uses it (acquires 
threadedness), or just that mod_python does? Does this mean I can use 
threads from Python?

Here's the thread on this problem on the mod_python dev list:

     * Re: FreeBSD compile problem (was Getting ready for 3.2 beta 2)[8]

-----

[1] 
http://mail-archives.apache.org/mod_mbox/httpd-python-dev/200509.mbox/%3c4324A60E.9090206@sympatico.ca%3e
[2] 
http://www.monkey.org/freebsd/archive/freebsd-questions/200506/msg02836.html
[3] http://archives.seul.org/or/dev/Sep-2003/msg00016.html
[4] 
http://lists.freebsd.org/pipermail/freebsd-apache/2005-November/000404.html
[5] 
http://mail-archives.apache.org/mod_mbox/httpd-python-dev/200509.mbox/%3c20050912094856.K58317@grisha.dyndns.org%3e
[6] 
http://mail-archives.apache.org/mod_mbox/httpd-python-dev/200509.mbox/%3c20050912121753.W62057@grisha.dyndns.org%3e
[7] 
http://www.freebsd.org/cgi/man.cgi?query=ld.so&manpath=FreeBSD+6.0-RELEASE
[8] 
http://mail-archives.apache.org/mod_mbox/httpd-python-dev/200509.mbox/thread
From grahamd at dscpl.com.au  Fri Sep  1 21:17:35 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Sep  1 21:18:48 2006
Subject: [mod_python] threads and FreeBSD: LD_PRELOAD=/usr/lib/libc_r.so
	the	same as --enable-threads?
In-Reply-To: <44F8A367.2050502@zetaweb.com>
References: <44F89F10.1090903@zetaweb.com> <44F8A367.2050502@zetaweb.com>
Message-ID: <A3B45B35-3640-4249-8584-8CE37235A5EC@dscpl.com.au>


On 02/09/2006, at 7:17 AM, Chad Whitacre wrote:

> Grisha's answer is to "cause Apache to start with threaded libs"[5]  
> by adding this to /usr/local/apache2/bin/envvars:[6]
>
>   export LD_PRELOAD=/usr/lib/libc_r.so
>
> But is this the same as compiling Apache with --enable-threads?

No it is not the same. Apache will still be non threaded and only  
prefork MPM
can be used.

> There be dragons, as noted above. Per ld.so(1),[7] LD_PRELOAD  
> denotes "[a] list of shared libraries, separated by colons and/or  
> white space, to be linked in before any other shared libraries."  
> And here my knowledge ends: does linking in the library mean that  
> Apache uses it (acquires threadedness), or just that mod_python  
> does? Does this mean I can use threads from Python?

As above, Apache does not acquire threadedness. Preloading the  
library will
be enough to satisfy unresolved symbols which Python wants. Yes you  
should
be able to use threads in Python.

I can't understand why this thread problem still persists on FreeBSD  
after all
these years. Why can't they fix it?

Graham


From grahamd at dscpl.com.au  Fri Sep  1 21:30:47 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Sep  1 21:31:46 2006
Subject: [mod_python] errors in default mod_python docs for 3.2.10
	publisher setup
In-Reply-To: <44F7948C.8090405@houghton.net>
References: <44F7948C.8090405@houghton.net>
Message-ID: <2F46CA31-0EDC-47E3-99D6-AD34337B3548@dscpl.com.au>


On 01/09/2006, at 12:01 PM, Blair P. Houghton wrote:

> I happened to get frustrated enough to plug the right magic
> into the right search box (the one at http://modpython.org/,
> as Google wasn't helping) and found the answer to the reason
> that /my/ publisher setup wasn't finding my scripts.  The answer
> is that the setup I was following from the 3.2.10 doc tree is
> incomplete, and doesn't say that the URI for a publisher-mediated
> script has to include the name of the method being invoked.

It does, in as much as the example shows that is the case. It just does
not spell it out in words as a requirement. Ie., it always uses  
"form.py/email".

> I.e., this document is inadequate:
>
> http://www.modpython.org/live/mod_python-3.2.10/doc-html/tut-pub.html
>
> the three .conf lines are correct, but the description omits the
> correct URI formula.  Just browsing to http://domain/path/script
> or http://domain/path/script.py gets a 404 error, while
> http://domain/path/script.py/handler works fine.

Referencing just the script and no function name will work provided that
the code file contains a function called index().

That you use a name "handler" suggests you are getting a bit muddled
with the difference between basic mod_python handlers, where response
handler is always called handler() and name of function doesn't need  
to be
in the URL and mod_python.publisher where with the exception of index(),
the function does have to be in the URL.

> Note that the
> '.py' suffix must be included also.

Not necessarily. Whether this is the case will depend on how Apache is
configured for MultiViews. Try the configuration:

   AddHandler mod_python .py
   PythonHandler mod_python.publisher
   PythonDebug On

   Options +MultiViews
   MultiviewsMatch Handlers

   AddType text/html;qs=1.0 .py
   AddType text/html;qs=0.9 .html
   AddType text/plain;qs=0.8 .txt

On mod_python web site, do searches for "MultiViews MultiviewsMatch" and
"MultiviewsMatch DirectoryIndex" for other discussions on this topic.  
Ones
which include most are probably:

   http://www.modpython.org/pipermail/mod_python/2006-June/021435.html
   http://www.modpython.org/pipermail/mod_python/2006-March/020501.html

> This document has a different .conf, but does give
> the correct instructions for the URI:
>
> http://www.modpython.org/live/current/doc-html/hand-pub-intro.html
>
> Okay.  For grins I just tried the second .conf setup, and
> now it works with or without the '.py' suffix, but the
> handler name is still required.*
>
> I have not tested any PATH environment-variable variations.  I do  
> know that I have one installation (the XAMPP bundle on Win XP) that  
> does not need any explicit Python elements in the PATH at all.  How  
> that works I don't know.  But this one (the DeveloperSide.net  
> bundle, with mod_python added on afterward...I forget whose  
> mod_python build it was, I'm pretty sure I got it from a  
> modpython.org mirror).
>
> I believe that the document from the live/current tree should be  
> moved to the document in the live/mod_python-
> 3.2.10 tree ASAP so that people won't be caught by this any more.

Those two trees are the same document, just different parts of the  
same document.
Both AddHandler and SetHandler approaches can work, but they are used  
for
different reasons.

Graham

> I'd do it myself but I'm not even sure that this email will get  
> through so I'm not quite up to speed on monkeying around the  
> project files, nor even if they're modifiable by mod_python newbs.   
> Another of the pleasures of open source.
>
> --Blair
>
> * - here are the significant lines from the working .conf:
>
>  LoadModule python_module modules/mod_python.so
>
>  &lt;Directory /www/webroot>
>    SetHandler mod_python    PythonHandler mod_python.publisher
>  &lt;/Directory>
>
> The path "modules/mod_python.so" is
> relative to the Apache install directory; in this case
> the full path is C:/www/Apache22/modules/mod_python.so".
> "/www/webroot" is the base of my served-file tree, so it
> could have been just "/" or the Directory lines could
> be omitted entirely and the behavior is the same on my
> system.  The working URI is "http://localhost/script/handler".
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From chad at zetaweb.com  Fri Sep  1 22:06:06 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Fri Sep  1 22:06:20 2006
Subject: [mod_python] threads and FreeBSD: LD_PRELOAD=/usr/lib/libc_r.so
	the	same as --enable-threads?
In-Reply-To: <A3B45B35-3640-4249-8584-8CE37235A5EC@dscpl.com.au>
References: <44F89F10.1090903@zetaweb.com> <44F8A367.2050502@zetaweb.com>
	<A3B45B35-3640-4249-8584-8CE37235A5EC@dscpl.com.au>
Message-ID: <44F8E70E.2090003@zetaweb.com>

Graham,

 > No it is not the same. ... Yes you should be able to use threads in
 > Python.

Great! Thanks for the assurances.


 > I can't understand why this thread problem still persists on FreeBSD
 > after all these years. Why can't they fix it?

Yeah, no kidding. If Python can figure out FreeBSD threading, why can't 
Apache?




chad
From blair at houghton.net  Sat Sep  2 01:51:44 2006
From: blair at houghton.net (Blair P. Houghton)
Date: Sat Sep  2 01:51:57 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <200609020131.k821Vxst024324@modpython.org>
References: <200609020131.k821Vxst024324@modpython.org>
Message-ID: <44F91BEF.7010805@houghton.net>

Graham Dumpleton <grahamd@dscpl.com.au> wrote:
> On 01/09/2006, at 12:01 PM, Blair P. Houghton wrote:
> It does, in as much as the example shows that is the case. It just does
> not spell it out in words as a requirement. Ie., it always uses  
> "form.py/email".

Documentation needs to explain what is going on.

> Referencing just the script and no function name will work provided that
> the code file contains a function called index().
> 
> That you use a name "handler" suggests you are getting a bit muddled
> with the difference between basic mod_python handlers, where response
> handler is always called handler() and name of function doesn't need  
> to be
> in the URL and mod_python.publisher where with the exception of index(),
> the function does have to be in the URL.

I think that the fact that in one setup the default is handler()
and in another it is index(), and that this difference is not
made explicit early in the documentation, is the problem.

Anyone who, like me, tries out the simpler mechanism and learns
that the default is handler(), won't be expecting it to change
when moving to the publisher mechanism.  I wanted to use the
script that I had already been running, because changing more
than one thing at a time is a recipe for error.  Of
course, what happened is that the documentation just expected
I'd throw away everything I'd done before and blindly type in
the publisher example script.  Which is overly complicated for
its purpose, which of course is a recipe for error.  So
of course I didn't do it that way.

>>Note that the
>>'.py' suffix must be included also.
> 
> Not necessarily. Whether this is the case will depend on how Apache is
> configured for MultiViews. Try the configuration:
> 
>    AddHandler mod_python .py
>    PythonHandler mod_python.publisher
>    PythonDebug On
> 
>    Options +MultiViews
>    MultiviewsMatch Handlers
> 
>    AddType text/html;qs=1.0 .py
>    AddType text/html;qs=0.9 .html
>    AddType text/plain;qs=0.8 .txt
> 
> On mod_python web site, do searches for "MultiViews MultiviewsMatch" and
> "MultiviewsMatch DirectoryIndex" for other discussions on this topic.  
> Ones
> which include most are probably:
> 
>    http://www.modpython.org/pipermail/mod_python/2006-June/021435.html
>    http://www.modpython.org/pipermail/mod_python/2006-March/020501.html

This is interesting, but highly non-intuitive in the context of
"just trying to get the thing running so I can start to do some
productive work".

>>I believe that the document from the live/current tree should be  
>>moved to the document in the live/mod_python-
>>3.2.10 tree ASAP so that people won't be caught by this any more.
> 
> Those two trees are the same document, just different parts of the  
> same document.

Interesting.  The "quick-start" page is a lot less "quick" than
the "introduction" one.  And with that hairy example isn't even
close to quick.  I think anything referring to a "quick start"
in the document should point right at the publisher introduction
page.  Which should use the default index() function and point
out accessing it both explicitly and as a default in the URI.
Because nobody who's trying to get a "quick start" is going to
read anything called "Traversal" in the manual.

> Both AddHandler and SetHandler approaches can work, but they are used  
> for
> different reasons.

Hmm.  I didn't even notice that one was AddHandler and the other
was SetHandler.

So here we have the documentation using two different ways to do
the same thing, without, again, pointing out why, in a place where
it would be of the most possible value to be explicit about it.

--Blair
From grahamd at dscpl.com.au  Sat Sep  2 02:08:50 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep  2 02:09:46 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <44F91BEF.7010805@houghton.net>
References: <200609020131.k821Vxst024324@modpython.org>
	<44F91BEF.7010805@houghton.net>
Message-ID: <7ECF081B-811F-477A-83C3-3818BCAAB2E5@dscpl.com.au>

All I can say is that we know the documentation is inadequate.

We have been waiting for a long time for the ASF to setup a wiki
page for mod_python so that we have a more flexible forum for
putting up documentation that can better explain things. Ie., a
place where documentation can be quickly added/changed as
issues come up. At the moment the documentation is LaTeX based
and a part of the source code. This doesn't lend itself to easy or quick
updates as the main site is only updated when major releases occur.
Anyway, for myself I have given up waiting for the wiki and am
turning my existing mod_python articles into my own unofficial
wiki so I can at least more quickly add new stuff. I have quite a
long list of mini articles I want to write that I have been holding off
doing due to the lack of an official wiki. Keep an eye out for more
on this in the near future.

In respect of mod_python vs mod_python.publisher, they are actually
two totally different things. In some respects, mod_python.publisher
and mod_python.psp should be released as totally separate products
from the mod_python core. That they aren't often causes a lot of
confusion as people, like yourself, see mod_python.publisher and
mod_python as one in the same, when in fact mod_python.publisher
is a higher level interface which is used in a totally different way.

In respect of AddHandler, SetHandler, MultiViews etc, you need to  
realise
that mod_python is an extension for Apache. Thus, such things like this
aren't actually implemented by mod_python but are implemented
by Apache. To use mod_python properly, you also need to understand
Apache to some degree and that means also referring to the Apache
documentation.

Graham

On 02/09/2006, at 3:51 PM, Blair P. Houghton wrote:

> Graham Dumpleton <grahamd@dscpl.com.au> wrote:
>> On 01/09/2006, at 12:01 PM, Blair P. Houghton wrote:
>> It does, in as much as the example shows that is the case. It just  
>> does
>> not spell it out in words as a requirement. Ie., it always uses   
>> "form.py/email".
>
> Documentation needs to explain what is going on.
>
>> Referencing just the script and no function name will work  
>> provided that
>> the code file contains a function called index().
>> That you use a name "handler" suggests you are getting a bit muddled
>> with the difference between basic mod_python handlers, where response
>> handler is always called handler() and name of function doesn't  
>> need  to be
>> in the URL and mod_python.publisher where with the exception of  
>> index(),
>> the function does have to be in the URL.
>
> I think that the fact that in one setup the default is handler()
> and in another it is index(), and that this difference is not
> made explicit early in the documentation, is the problem.
>
> Anyone who, like me, tries out the simpler mechanism and learns
> that the default is handler(), won't be expecting it to change
> when moving to the publisher mechanism.  I wanted to use the
> script that I had already been running, because changing more
> than one thing at a time is a recipe for error.  Of
> course, what happened is that the documentation just expected
> I'd throw away everything I'd done before and blindly type in
> the publisher example script.  Which is overly complicated for
> its purpose, which of course is a recipe for error.  So
> of course I didn't do it that way.
>
>>> Note that the
>>> '.py' suffix must be included also.
>> Not necessarily. Whether this is the case will depend on how  
>> Apache is
>> configured for MultiViews. Try the configuration:
>>    AddHandler mod_python .py
>>    PythonHandler mod_python.publisher
>>    PythonDebug On
>>    Options +MultiViews
>>    MultiviewsMatch Handlers
>>    AddType text/html;qs=1.0 .py
>>    AddType text/html;qs=0.9 .html
>>    AddType text/plain;qs=0.8 .txt
>> On mod_python web site, do searches for "MultiViews  
>> MultiviewsMatch" and
>> "MultiviewsMatch DirectoryIndex" for other discussions on this  
>> topic.  Ones
>> which include most are probably:
>>    http://www.modpython.org/pipermail/mod_python/2006-June/ 
>> 021435.html
>>    http://www.modpython.org/pipermail/mod_python/2006-March/ 
>> 020501.html
>
> This is interesting, but highly non-intuitive in the context of
> "just trying to get the thing running so I can start to do some
> productive work".
>
>>> I believe that the document from the live/current tree should be   
>>> moved to the document in the live/mod_python-
>>> 3.2.10 tree ASAP so that people won't be caught by this any more.
>> Those two trees are the same document, just different parts of  
>> the  same document.
>
> Interesting.  The "quick-start" page is a lot less "quick" than
> the "introduction" one.  And with that hairy example isn't even
> close to quick.  I think anything referring to a "quick start"
> in the document should point right at the publisher introduction
> page.  Which should use the default index() function and point
> out accessing it both explicitly and as a default in the URI.
> Because nobody who's trying to get a "quick start" is going to
> read anything called "Traversal" in the manual.
>
>> Both AddHandler and SetHandler approaches can work, but they are  
>> used  for
>> different reasons.
>
> Hmm.  I didn't even notice that one was AddHandler and the other
> was SetHandler.
>
> So here we have the documentation using two different ways to do
> the same thing, without, again, pointing out why, in a place where
> it would be of the most possible value to be explicit about it.
>
> --Blair
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From chad at zetaweb.com  Sat Sep  2 08:26:15 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Sat Sep  2 08:26:26 2006
Subject: [mod_python] lookup
Message-ID: <44F97867.4040304@zetaweb.com>

Dear All,

It looks like mod_perl has API for performing subrequests, lookup_uri 
and lookup_file:

http://www.samspublishing.com/articles/article.asp?p=27110&seqNum=17&rl=1

I don't see anything parallel in mod_python. Has this ever been discussed?



chad
From chad at zetaweb.com  Sat Sep  2 11:25:28 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Sat Sep  2 11:25:37 2006
Subject: [mod_python] Python API for doing subrequests? (was 'lookup')
In-Reply-To: <44F97867.4040304@zetaweb.com>
References: <44F97867.4040304@zetaweb.com>
Message-ID: <44F9A268.9080402@zetaweb.com>

All,

> It looks like mod_perl has API for performing subrequests, lookup_uri 
> and lookup_file:
> 
> http://www.samspublishing.com/articles/article.asp?p=27110&seqNum=17&rl=1
> 
> I don't see anything parallel in mod_python. Has this ever been discussed?

I do see a "main" attribute on the request object with this doc:

  "If this is a sub-request, pointer to the main request."
  http://www.modpython.org/live/current/doc-html/pyapi-mprequest-mem.html

So it appears that it's possible to be called as a subrequest, but I'm 
not seeing a Python API for making that call. Eh?



chad
From blair at houghton.net  Sat Sep  2 19:22:57 2006
From: blair at houghton.net (Blair P. Houghton)
Date: Sat Sep  2 19:23:27 2006
Subject: [mod_python] Re: errors in default mod_python docs for 3.2.10
	publisher setup
In-Reply-To: <200609021600.k82G07Eq006259@modpython.org>
References: <200609021600.k82G07Eq006259@modpython.org>
Message-ID: <44FA1251.8070003@houghton.net>

Graham Dumpleton <grahamd@dscpl.com.au>
> 
> All I can say is that we know the documentation is inadequate.

Which I think is a shame.  Python is an excellent language.
mod_python is an obvious way to leverage that.  It should end
up killing the other server-side systems.  But if the documentation
sets the user up for frustrations, it will never happen.

> We have been waiting for a long time for the ASF to setup a
> [mod_python doc] wiki

At whom would I throw my urging for this?

> Anyway, for myself I have given up waiting for the wiki and am
> turning my existing mod_python articles into my own unofficial
> wiki so I can at least more quickly add new stuff.

Good idea.  Got a URL?  I'd be glad to help.  You could make
a tree of unconverted mod_python doc and we could convert them
as we touch them.  Though given the fairly simple nature of
the document, it might not be hard to make a LaTeX-to-wiki
converter for it.  Wasn't someone just asking about parsers?

> In respect of mod_python vs mod_python.publisher, they are actually
> two totally different things. In some respects, mod_python.publisher
> and mod_python.psp should be released as totally separate products
> from the mod_python core.

I'm not sure I follow about the .psp; I thought that was
different from mod_python.  I do get that the "simple" method
set up a user script as the only handler for a directory and that
the publisher is a handler itself that acts to direct requests
to scripts in a file tree on the server.  In fact, if publisher
wasn't goint to come up for me, I was going to write my own.

> That they aren't often causes a lot of
> confusion as people, like yourself, see mod_python.publisher and
> mod_python as one in the same, when in fact mod_python.publisher
> is a higher level interface which is used in a totally different way.

I'd say it's a slightly different way.

> In respect of AddHandler, SetHandler, MultiViews etc, you need to  
> realise
> that mod_python is an extension for Apache. Thus, such things like this
> aren't actually implemented by mod_python but are implemented
> by Apache. To use mod_python properly, you also need to understand
> Apache to some degree and that means also referring to the Apache
> documentation.

Things I'm sure I'd have eventually had to explore as my needs went
deeper, but at the "get me up and running" phase, I want nothing to
do with server internals or the million configurable items that I
could be tweaking.  The shorter and straighter the time from the
download button to the display of "hello, world!" on the browser
screen, the better mod_python will sell.

--Blair
From grahamd at dscpl.com.au  Sat Sep  2 19:26:25 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep  2 19:27:20 2006
Subject: [mod_python] Python API for doing subrequests? (was 'lookup')
In-Reply-To: <44F9A268.9080402@zetaweb.com>
References: <44F97867.4040304@zetaweb.com> <44F9A268.9080402@zetaweb.com>
Message-ID: <EB6D9319-6A71-4F57-B2B9-79872EAE12B9@dscpl.com.au>


On 03/09/2006, at 1:25 AM, Chad Whitacre wrote:

> All,
>
>> It looks like mod_perl has API for performing subrequests,  
>> lookup_uri and lookup_file:
>> http://www.samspublishing.com/articles/article.asp? 
>> p=27110&seqNum=17&rl=1
>> I don't see anything parallel in mod_python. Has this ever been  
>> discussed?
>
> I do see a "main" attribute on the request object with this doc:
>
>  "If this is a sub-request, pointer to the main request."
>  http://www.modpython.org/live/current/doc-html/pyapi-mprequest- 
> mem.html
>
> So it appears that it's possible to be called as a subrequest, but  
> I'm not seeing a Python API for making that call. Eh?

The closest you will get is the ability to trigger an internal redirect.

The mod_python method is:

   internal_redirect(new_uri)
     Internally redirects the request to the new_uri. new_uri must be  
a string.
     The httpd server handles internal redirection by creating a new  
request object
     and processing all request phases. Within an internal redirect,  
req.prev will
     contain a reference to a request object from which it was  
redirected.

See:

   http://www.modpython.org/live/current/doc-html/pyapi-mprequest- 
meth.html

This method is a wrapper for Apache ap_internal_redirect() function. For
mod_perl it should also have an equivalent call which wraps the Apache
ap_internal_redirect() function. It isn't either the two mod_perl  
functions you
quote though.

Besides an internal redirect, there is no other way in mod_python to  
trigger
sub requests. Not sure how practical it may be to support the other  
mechanisms
for performing sub requests in mod_python, would need to look into it.

What exactly is it you want to do?

Graham
From grahamd at dscpl.com.au  Sat Sep  2 19:45:17 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep  2 19:46:20 2006
Subject: [mod_python] Re: errors in default mod_python docs for 3.2.10
	publisher setup
In-Reply-To: <44FA1251.8070003@houghton.net>
References: <200609021600.k82G07Eq006259@modpython.org>
	<44FA1251.8070003@houghton.net>
Message-ID: <96FD47CC-0526-427B-9C72-624A42395BC9@dscpl.com.au>


On 03/09/2006, at 9:22 AM, Blair P. Houghton wrote:

> Graham Dumpleton <grahamd@dscpl.com.au>
>> All I can say is that we know the documentation is inadequate.
>
> Which I think is a shame.  Python is an excellent language.
> mod_python is an obvious way to leverage that.  It should end
> up killing the other server-side systems.  But if the documentation
> sets the user up for frustrations, it will never happen.

More of a frustration at this point has been the large number of little
problems with mod_python and lack of API for more useful features
of Apache. Have a look through:

   http://issues.apache.org/jira/browse/MODPYTHON

and you will see we have fixing and improving mod_python in more
than trivial ways for mod_python 3.3. This is where most of our
energy has been getting concentrated. There is not much point having
beautiful documentation if the software itself has so many problems
or can't be made to do what is needed anyway.

I too would like to see a decent framework like Django/Turbogears
but built direct on the foundations of Apache and mod_python and
using the features of Apache rather than just using it as a mere hopping
off point. It really just doesn't make sense to be ignoring all the  
stuff
that Apache provides in the way of access control, user authentication
etc etc. We just have a bit of work to do before this is going to be  
seen
as viable.

>> We have been waiting for a long time for the ASF to setup a
>> [mod_python doc] wiki
>
> At whom would I throw my urging for this?

There is already a request in the ASF issue tracking system for it. The
people who handle these requests though generally have a lot of
other stuff to do as well, so it takes a while. There are some people
higher up in the ASF who monitor this list, so maybe they will see this
discussion, be kind to us, and see if they can get it moving more
quickly. :-)

>> Anyway, for myself I have given up waiting for the wiki and am
>> turning my existing mod_python articles into my own unofficial
>> wiki so I can at least more quickly add new stuff.
>
> Good idea.  Got a URL?  I'd be glad to help.  You could make
> a tree of unconverted mod_python doc and we could convert them
> as we touch them.  Though given the fairly simple nature of
> the document, it might not be hard to make a LaTeX-to-wiki
> converter for it.  Wasn't someone just asking about parsers?

Although I would like to see the LaTeX documentation done away
with and replaced with wiki based documentation, it wasn't my intent
to be doing that on my own wiki. My wiki was going to be a personal
wiki for my own stuff on mod_python and wasn't going to be writable
to anyone at this point in case I may want to use the collection of  
stuff
I create for something else later.

>> In respect of AddHandler, SetHandler, MultiViews etc, you need to   
>> realise
>> that mod_python is an extension for Apache. Thus, such things like  
>> this
>> aren't actually implemented by mod_python but are implemented
>> by Apache. To use mod_python properly, you also need to understand
>> Apache to some degree and that means also referring to the Apache
>> documentation.
>
> Things I'm sure I'd have eventually had to explore as my needs went
> deeper, but at the "get me up and running" phase, I want nothing to
> do with server internals or the million configurable items that I
> could be tweaking.  The shorter and straighter the time from the
> download button to the display of "hello, world!" on the browser
> screen, the better mod_python will sell.

And you can get it working without needing them, as long as you use .py
in the URL all the time. I only point it out as too often people  
using SetHandler
see it working without .py and think that translates to AddHandler  
when it
doesn't without the extra magic stuff I mentioned.

Graham
From chad at zetaweb.com  Sat Sep  2 23:18:58 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Sat Sep  2 23:19:07 2006
Subject: [mod_python] Python API for doing subrequests? (was 'lookup')
In-Reply-To: <EB6D9319-6A71-4F57-B2B9-79872EAE12B9@dscpl.com.au>
References: <44F97867.4040304@zetaweb.com> <44F9A268.9080402@zetaweb.com>
	<EB6D9319-6A71-4F57-B2B9-79872EAE12B9@dscpl.com.au>
Message-ID: <44FA49A2.4020301@zetaweb.com>

Graham,

<snip>

Thanks for the helpful explanation.

> What exactly is it you want to do?

I'm experimenting with using Subversion (svn) as a database for content 
management. As you may know svn runs as an Apache module, and I was 
looking at the possibility of interfacing with it from Python w/o 
leaving Apache. Doesn't look like that's going to happen though, which 
is fine. Just researching at this point.



chad

From grahamd at dscpl.com.au  Sat Sep  2 23:52:50 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep  2 23:53:47 2006
Subject: [mod_python] Python API for doing subrequests? (was 'lookup')
In-Reply-To: <44FA49A2.4020301@zetaweb.com>
References: <44F97867.4040304@zetaweb.com> <44F9A268.9080402@zetaweb.com>
	<EB6D9319-6A71-4F57-B2B9-79872EAE12B9@dscpl.com.au>
	<44FA49A2.4020301@zetaweb.com>
Message-ID: <E3CBF0A4-1201-477D-BB46-E531A1AA938D@dscpl.com.au>


On 03/09/2006, at 1:18 PM, Chad Whitacre wrote:

> Graham,
>
> <snip>
>
> Thanks for the helpful explanation.
>
>> What exactly is it you want to do?
>
> I'm experimenting with using Subversion (svn) as a database for  
> content management. As you may know svn runs as an Apache module,  
> and I was looking at the possibility of interfacing with it from  
> Python w/o leaving Apache. Doesn't look like that's going to happen  
> though, which is fine. Just researching at this point.

Actually, that is relatively easy. The Trac system which is written  
in Python and
can run under mod_python accesses Subversion. It doesn't have to loop
back requests to access Subversion through mod_dav_svn though, it just
uses the Python wrappers for Subversion to access the Subversion
repository direct from the file system. In both the case of  
mod_dav_svn and
the use of Python wrappers under mod_python, the user is that of Apache
and so they quite happily coexist as Subversion by nature has to support
multiple concurrent accesses to the file system repository.

The difficultly is only in understanding the API of the Python  
wrappers for
Subversion. For an example of Subversion access from Python see the code
for the following Trac plugin as an example, especially the  
svn_helpers.py
code file in the tracrst directory.

   http://svn.pythonfr.org/public/pythonfr/utils/trac/rest_macro/

Graham
From chad at zetaweb.com  Sun Sep  3 19:55:50 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Sun Sep  3 19:55:03 2006
Subject: [mod_python] Python API for doing subrequests? (was 'lookup')
In-Reply-To: <E3CBF0A4-1201-477D-BB46-E531A1AA938D@dscpl.com.au>
References: <44F97867.4040304@zetaweb.com> <44F9A268.9080402@zetaweb.com>
	<EB6D9319-6A71-4F57-B2B9-79872EAE12B9@dscpl.com.au>
	<44FA49A2.4020301@zetaweb.com>
	<E3CBF0A4-1201-477D-BB46-E531A1AA938D@dscpl.com.au>
Message-ID: <44FB6B86.8090604@zetaweb.com>

Graham,

Thanks for the reply.

 > Actually, that is relatively easy. Trac ... just uses the Python
 > wrappers for Subversion to access the Subversion repository direct
 > from the file system.

Yeah, that's where I went next. I looked at both the SWIG bindings and 
pysvn. The latter appears to basically wrap the client API, and so to 
only be helpful for working copies.


 > The difficulty is only in understanding the API of the Python
 > wrappers for Subversion. For an example ...

And this is where I got stuck, yes. The example is most helpful!


The third option (besides subrequests and SWIG bindings) is to access 
the repo through HTTP/WebDAV. That's what I ended up doing in this case, 
and I kind of like it.

I ended up with a module that imports other modules directly over HTTP. 
The TCP overhead isn't too big a deal since imports usually only happen 
at startup, and you'd need to cache locally anyway (extension modules 
can only be imported from a file AFAICT). And on the plus side you've 
got a fully distributed import system.

I may explore the SWIG option more with some other applications. Thanks 
again for the comments!





chad
From chad at zetaweb.com  Mon Sep  4 09:29:15 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Mon Sep  4 09:27:24 2006
Subject: [mod_python] mod_dav_svn clobbering mod_python?
Message-ID: <44FC2A2B.2060305@zetaweb.com>

Dear All,

It appears that when mod_dav_svn is installed, the handlers it defines 
override any handlers I define for mod_python. Does this sound familiar? 
What can I do about it?

Thanks.


chad
From nicolas at lehuen.com  Mon Sep  4 10:36:50 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Mon Sep  4 10:36:53 2006
Subject: [mod_python] mod_dav_svn clobbering mod_python?
In-Reply-To: <44FC2A2B.2060305@zetaweb.com>
References: <44FC2A2B.2060305@zetaweb.com>
Message-ID: <c298f2d70609040736h5d2bf9b2y3b0abd7d5be9566@mail.gmail.com>

It must be a configuration problem, because I have a server with Subversion
and mod_python without each one stomping on the other's feet. Then again,
the DAV directive is applied to a location where mod_python is not applied.
Do you want to have both DAV and mod_python support on the same directory ?

Regards,
Nicolas

2006/9/4, Chad Whitacre <chad@zetaweb.com>:
>
> Dear All,
>
> It appears that when mod_dav_svn is installed, the handlers it defines
> override any handlers I define for mod_python. Does this sound familiar?
> What can I do about it?
>
> Thanks.
>
>
> chad
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060904/567e05cb/attachment.html
From chad at zetaweb.com  Mon Sep  4 10:51:51 2006
From: chad at zetaweb.com (Chad Whitacre)
Date: Mon Sep  4 10:50:00 2006
Subject: [mod_python] mod_dav_svn clobbering mod_python?
In-Reply-To: <c298f2d70609040736h5d2bf9b2y3b0abd7d5be9566@mail.gmail.com>
References: <44FC2A2B.2060305@zetaweb.com>
	<c298f2d70609040736h5d2bf9b2y3b0abd7d5be9566@mail.gmail.com>
Message-ID: <44FC3D87.3030909@zetaweb.com>

Nicolas,

Thanks for the reply.

> Do you want to have both DAV and mod_python support on the same directory ?

Yes, I was hoping to write some custom auth in python. I suppose I 
should look at the sources/doc for mod_dav_svn to see what it's doing.


chad
From nicolas at lehuen.com  Mon Sep  4 11:19:36 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Mon Sep  4 11:19:39 2006
Subject: [mod_python] mod_dav_svn clobbering mod_python?
In-Reply-To: <44FC3D87.3030909@zetaweb.com>
References: <44FC2A2B.2060305@zetaweb.com>
	<c298f2d70609040736h5d2bf9b2y3b0abd7d5be9566@mail.gmail.com>
	<44FC3D87.3030909@zetaweb.com>
Message-ID: <c298f2d70609040819k795de2beh201964b4b0b31dcb@mail.gmail.com>

Check the mailing list archive, because I think we've already talked about
this a few months ago.

Regards,
Nicolas

2006/9/4, Chad Whitacre <chad@zetaweb.com>:
>
> Nicolas,
>
> Thanks for the reply.
>
> > Do you want to have both DAV and mod_python support on the same
> directory ?
>
> Yes, I was hoping to write some custom auth in python. I suppose I
> should look at the sources/doc for mod_dav_svn to see what it's doing.
>
>
> chad
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060904/34ca25e6/attachment.html
From ethanton at ethanton.com  Mon Sep  4 14:15:08 2006
From: ethanton at ethanton.com (Ethan Toan Ton)
Date: Mon Sep  4 14:15:13 2006
Subject: [mod_python] Mod-Python Help
Message-ID: <17655.69.236.163.99.1157393708.squirrel@webmail.ethanton.com>

Hi,

I'm not sure if this is the correct forum to be asking for help with
Mod-Python, but I figure I'd give it a shot.  I was wondering if anyone
had experience using a Mod-Python request handler to answer a javascript
xmlhttprequest().

When my javascript program does a request on the xml file directly, all of
the javascript parsing of the xml works fine.  However, when I try to call
the request handler and get it to read the file in and return the request,
the javascript can't parse the xml.  Here's the code:


LOCAL_FILE = 'htdocs/ethan/info.xml';

def get_request(req):
	if req.method == 'GET':
		file = open(LOCAL_FILE, 'r')
		req.content_type = "application/xml"
		req.write(file.read())
	return apache.OK

The same data is sent, but I'm not sure if there is a formatting problem
here.  I'm assuming that's the problem, but I'm at a loss as to the
solution.  req.sendfile(LOCAL_FILE) does not work either.

Any help would be greatly appreciated.

Ethan


From nicolas at lehuen.com  Mon Sep  4 14:25:50 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Mon Sep  4 14:25:53 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <17655.69.236.163.99.1157393708.squirrel@webmail.ethanton.com>
References: <17655.69.236.163.99.1157393708.squirrel@webmail.ethanton.com>
Message-ID: <c298f2d70609041125t5915429aycf2dcee745ef4415@mail.gmail.com>

Hi,

You have to provide absolute paths when accessing local file. This is
because the cwd is always /.

I you want to built paths relative to the script you are writing, you can
use the __FILE__ meta variable :

LOCAL_FILE = os.path.join(os.path.dirname(__FILE__),'myfile.txt')

Regards,
Nicolas

2006/9/4, Ethan Toan Ton <ethanton@ethanton.com>:
>
> Hi,
>
> I'm not sure if this is the correct forum to be asking for help with
> Mod-Python, but I figure I'd give it a shot.  I was wondering if anyone
> had experience using a Mod-Python request handler to answer a javascript
> xmlhttprequest().
>
> When my javascript program does a request on the xml file directly, all of
> the javascript parsing of the xml works fine.  However, when I try to call
> the request handler and get it to read the file in and return the request,
> the javascript can't parse the xml.  Here's the code:
>
>
> LOCAL_FILE = 'htdocs/ethan/info.xml';
>
> def get_request(req):
>         if req.method == 'GET':
>                 file = open(LOCAL_FILE, 'r')
>                 req.content_type = "application/xml"
>                 req.write(file.read())
>         return apache.OK
>
> The same data is sent, but I'm not sure if there is a formatting problem
> here.  I'm assuming that's the problem, but I'm at a loss as to the
> solution.  req.sendfile(LOCAL_FILE) does not work either.
>
> Any help would be greatly appreciated.
>
> Ethan
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060904/8b4b337e/attachment.html
From nicolas at lehuen.com  Mon Sep  4 14:41:29 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Mon Sep  4 14:41:31 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>
Message-ID: <c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>

Ooops sorry... I should learn to read questions better than that.

Have you tried to curl or wget the page to see the result ? Is this really
valid XML ?

What have you implemented ? A handler or a published module, i.e. do you use
the mod_python.publisher handler ? If this is the case, then since you are
returning apache.OK instead of returning the document itself, you may get an
additional '0' (the value of apache.OK) at the end of the response, which
may bother the XML parser. But a much better approach is to use send_file()
and return None (or implement a handler).

Another problem might be with the charset encoding of the document. Is it
specified in the XML header ? If not, then a different default charset
encoding between the server and the client platforms may cause the parsing
to fail.

Note that you should be able to add an error handling callback on the
XMLHttpRequest objec to have more info on the problem.

Regards,
Nicolas

2006/9/4, Ethan Toan Ton <tton@stanfordalumni.org>:
>
> Nicolas,
>
> The path isn't the problem.  The handler reads the file fine.  But when it
> outputs to the requester, the formatting is done incorrectly so that it
> can't
> be parsed.
>
> Ethan
>
>
> ------ Original Message ------
> Received: 11:25 AM PDT, 09/04/2006
> From: "Nicolas Lehuen" <nicolas@lehuen.com>
> To: "Ethan Toan Ton" <ethanton@ethanton.com>Cc: mod_python@modpython.org
> Subject: Re: [mod_python] Mod-Python Help
>
> Hi,
>
> You have to provide absolute paths when accessing local file. This is
> because the cwd is always /.
>
> I you want to built paths relative to the script you are writing, you can
> use the __FILE__ meta variable :
>
> LOCAL_FILE = os.path.join(os.path.dirname(__FILE__),'myfile.txt')
>
> Regards,
> Nicolas
>
> 2006/9/4, Ethan Toan Ton <ethanton@ethanton.com>:
> >
> > Hi,
> >
> > I'm not sure if this is the correct forum to be asking for help with
> > Mod-Python, but I figure I'd give it a shot.  I was wondering if anyone
> > had experience using a Mod-Python request handler to answer a javascript
> > xmlhttprequest().
> >
> > When my javascript program does a request on the xml file directly, all
> of
> > the javascript parsing of the xml works fine.  However, when I try to
> call
> > the request handler and get it to read the file in and return the
> request,
> > the javascript can't parse the xml.  Here's the code:
> >
> >
> > LOCAL_FILE = 'htdocs/ethan/info.xml';
> >
> > def get_request(req):
> >         if req.method == 'GET':
> >                 file = open(LOCAL_FILE, 'r')
> >                 req.content_type = "application/xml"
> >                 req.write(file.read())
> >         return apache.OK
> >
> > The same data is sent, but I'm not sure if there is a formatting problem
> > here.  I'm assuming that's the problem, but I'm at a loss as to the
> > solution.  req.sendfile(LOCAL_FILE) does not work either.
> >
> > Any help would be greatly appreciated.
> >
> > Ethan
> >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
>
>
>
>
> ____________________________________________________________________
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060904/2d2115fc/attachment.html
From gavin at premolo.com  Mon Sep  4 15:21:47 2006
From: gavin at premolo.com (Gavin Panella)
Date: Mon Sep  4 15:21:53 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <17655.69.236.163.99.1157393708.squirrel@webmail.ethanton.com>
References: <17655.69.236.163.99.1157393708.squirrel@webmail.ethanton.com>
Message-ID: <200609042121.48085.gavin@premolo.com>

> 		req.content_type = "application/xml"

I think it should be text/xml rather than application/xml. See:

  http://developer.apple.com/internet/webcontent/xmlhttpreq.html

"Note: It is essential that the data returned from the server be sent with a 
Content-Type set to text/xml. Content that is sent as text/plain or text/html 
is accepted by the instance of the request object however it will only be 
available for use via the responseText property."

-- 
Premolo S?rl
Web: http://www.premolo.com/ ; Tel: +352 26687161 ; GSM: +352 091739359
42 rue du Kiem, L-1857 Luxembourg, Grand-Duch? du Luxembourg

From nogradi at gmail.com  Mon Sep  4 17:54:47 2006
From: nogradi at gmail.com (Daniel Nogradi)
Date: Mon Sep  4 17:54:52 2006
Subject: [mod_python] [ANN] markup.py 1.5 - a lightweight HTML/XML generator
Message-ID: <5f56302b0609041454y77d0fce6m86d586efd79866ff@mail.gmail.com>

A new release of markup.py is available at

http://markup.sourceforge.net/

The markup module is an intuitive, lightweight, easy-to-use,
customizable and pythonic HTML/XML generator. New features in the 1.5
release include:

 * use attribute=None to have no value for an attribute
   such as the emptyattr in <option attr='value' emptyattr>

 * new separator keyword to constructor of class page

 * new bodyattrs keyword to init( ) method of class page

 * oneliner object added that returns an element as a
   string so there is no need to instantiate a page class
   and this also allows for nesting


Here I would like to thank all users especially those who sent bug
reports, comments, remarks, etc., I was in fact surprised by the large
amount of feedback I got this makes the developement much more fun.

Cheers,
Daniel
From grahamd at dscpl.com.au  Mon Sep  4 18:12:54 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep  4 18:12:57 2006
Subject: [mod_python] mod_dav_svn clobbering mod_python?
Message-ID: <1157407974.9325@dscpl.user.openhosting.com>

Chad Whitacre wrote ..
> Nicolas,
> 
> Thanks for the reply.
> 
> > Do you want to have both DAV and mod_python support on the same directory
> ?
> 
> Yes, I was hoping to write some custom auth in python. I suppose I 
> should look at the sources/doc for mod_dav_svn to see what it's doing.

In which phase are you trying to implement the authorisation? What does
your Apache configuration look like? What does your custom auth handler
look like?

The mod_authz_svn module registers two handler hooks. These are:

  static void register_hooks(apr_pool_t *p)
  {
    ap_hook_access_checker(access_checker, NULL, NULL, APR_HOOK_LAST);
    ap_hook_auth_checker(auth_checker, NULL, NULL, APR_HOOK_FIRST);
  }

These correspond to the PythonAccessHandler and PythonAuthzHandler
phases.

The problem you will have if you try and define your authorisation as
a PythonAuthzHandler is that the one in Subversion runs as APR_HOOK_FIRST
where as mod_python one runs as APR_HOOK_MIDDLE. As a result the
Subversion one takes precedence, so if it returns anything besides DECLINED
yours will never run. Thus, you probably can't use that phase.

Subversion doesn't use equivalent of PythonAuthHandler phase and so
stuff can be done there, but you still have to be able to trigger your handler
with an appropriate Apache configuration. It also isn't strictly possible to
right correct authentication handlers in mod_python prior to 3.3, but I
think it can be made to work well enough to satisfy Subversion.

Now depending on what you want to do,  you may want to have your handler
run in PythonFixupHandler phase. I posted on the mailing list recently an
example of this whereby commits against tagged versions of code were
prohibited.

Anyway, more information is required from you to be able to comment
further.

Graham
From dan.eloff at gmail.com  Mon Sep  4 18:51:44 2006
From: dan.eloff at gmail.com (Dan Eloff)
Date: Mon Sep  4 18:51:47 2006
Subject: [mod_python] How do you know if the current request is an
	internal redirect?
In-Reply-To: <200608181549.47440.gavin@premolo.com>
References: <4817b6fc0608170642i34f237c2i653324e8df4a58af@mail.gmail.com>
	<200608171604.05525.gavin@premolo.com>
	<200608181549.47440.gavin@premolo.com>
Message-ID: <4817b6fc0609041551s59c8420ao4e565b4ea7a960f4@mail.gmail.com>

On 8/18/06, Gavin Panella <gavin@premolo.com> wrote:
> > > How do you know in your handler if this is an internal redirect?
> > > req.prev is set to a req object even if there was no internal
> > > redirect.
> >
> > In the main request req.main is None, and in a subrequest it points back to
> > the main request, so just test if it's not None.
>
> Actually, this isn't true, for me at least. I've been doing internal
> redirections with mod_python 3.1.4 and Apache 2.0.58 on Linux and getting the
> following:
>
> Main request:
>         req.main is None
>         req.prev is None
>
> Subrequest:
>         req.main is None
>         req.prev is not None
>

I was just experiencing that, hence why I looked up this conversation
again. Thank you for confirming. Maybe the behaviour has changed,
because I seem to recall req.main working as you previously mentioned.

Thanks,
-Dan
From ethanton at ethanton.com  Mon Sep  4 20:03:39 2006
From: ethanton at ethanton.com (Ethan Toan Ton)
Date: Mon Sep  4 20:03:42 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>
	<c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>
Message-ID: <17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>

Gavin/Nicolas,

Thanks for your help.  It turns out the problem was the "return
apache.OK".  I was getting that extra 0 at the end and could not figure
out why.  Thanks for the prompt replies.  I appreciate all the help.

Ethan


> Ooops sorry... I should learn to read questions better than that.
>
> Have you tried to curl or wget the page to see the result ? Is this really
> valid XML ?
>
> What have you implemented ? A handler or a published module, i.e. do you
> use
> the mod_python.publisher handler ? If this is the case, then since you are
> returning apache.OK instead of returning the document itself, you may get
> an
> additional '0' (the value of apache.OK) at the end of the response, which
> may bother the XML parser. But a much better approach is to use
> send_file()
> and return None (or implement a handler).
>
> Another problem might be with the charset encoding of the document. Is it
> specified in the XML header ? If not, then a different default charset
> encoding between the server and the client platforms may cause the parsing
> to fail.
>
> Note that you should be able to add an error handling callback on the
> XMLHttpRequest objec to have more info on the problem.
>
> Regards,
> Nicolas
>
> 2006/9/4, Ethan Toan Ton <tton@stanfordalumni.org>:
>>
>> Nicolas,
>>
>> The path isn't the problem.  The handler reads the file fine.  But when
>> it
>> outputs to the requester, the formatting is done incorrectly so that it
>> can't
>> be parsed.
>>
>> Ethan
>>
>>
>> ------ Original Message ------
>> Received: 11:25 AM PDT, 09/04/2006
>> From: "Nicolas Lehuen" <nicolas@lehuen.com>
>> To: "Ethan Toan Ton" <ethanton@ethanton.com>Cc: mod_python@modpython.org
>> Subject: Re: [mod_python] Mod-Python Help
>>
>> Hi,
>>
>> You have to provide absolute paths when accessing local file. This is
>> because the cwd is always /.
>>
>> I you want to built paths relative to the script you are writing, you
>> can
>> use the __FILE__ meta variable :
>>
>> LOCAL_FILE = os.path.join(os.path.dirname(__FILE__),'myfile.txt')
>>
>> Regards,
>> Nicolas
>>
>> 2006/9/4, Ethan Toan Ton <ethanton@ethanton.com>:
>> >
>> > Hi,
>> >
>> > I'm not sure if this is the correct forum to be asking for help with
>> > Mod-Python, but I figure I'd give it a shot.  I was wondering if
>> anyone
>> > had experience using a Mod-Python request handler to answer a
>> javascript
>> > xmlhttprequest().
>> >
>> > When my javascript program does a request on the xml file directly,
>> all
>> of
>> > the javascript parsing of the xml works fine.  However, when I try to
>> call
>> > the request handler and get it to read the file in and return the
>> request,
>> > the javascript can't parse the xml.  Here's the code:
>> >
>> >
>> > LOCAL_FILE = 'htdocs/ethan/info.xml';
>> >
>> > def get_request(req):
>> >         if req.method == 'GET':
>> >                 file = open(LOCAL_FILE, 'r')
>> >                 req.content_type = "application/xml"
>> >                 req.write(file.read())
>> >         return apache.OK
>> >
>> > The same data is sent, but I'm not sure if there is a formatting
>> problem
>> > here.  I'm assuming that's the problem, but I'm at a loss as to the
>> > solution.  req.sendfile(LOCAL_FILE) does not work either.
>> >
>> > Any help would be greatly appreciated.
>> >
>> > Ethan
>> >
>> >
>> > _______________________________________________
>> > Mod_python mailing list
>> > Mod_python@modpython.org
>> > http://mailman.modpython.org/mailman/listinfo/mod_python
>> >
>>
>>
>>
>>
>> ____________________________________________________________________
>>
>>
>>
>


From guotie.9 at gmail.com  Tue Sep  5 01:52:20 2006
From: guotie.9 at gmail.com (guo tie)
Date: Tue Sep  5 01:52:23 2006
Subject: [mod_python] Bug report: mod_python session hangs linux apache 2.2 .
Message-ID: <79b73f2b0609042252v3870a6fhd8fd9a328fcd47f2@mail.gmail.com>

hi,
   all.
   i found the mod_python session under linux apache 2.2 mpm-worker have
problem.

linux: 2.6.17
apache: 2.2 mpm-worker
python: 2.4.3
mod_python 3.2.10

Now, the test.py is :

from mod_python import apache
from mod_python import Session
import sys

class Dispatcher(object):
    def __init__(self, req):
        self._req = req
        self._uri =  req.uri

    def dispatch(self, req):
        req.content_type =      'text/plain'
        import mod_python
        req.write(mod_python.version)
        req.write('\n')
        self.sess =     Session.Session(req)
        req.write("after create session\n")
        self.sess['obj'] =      'abcdtest'
        req.write("after sess['ob'] = 'abcdtest'\n")
        self.sess.set_timeout(60 * 60)
        req.write("after self.set_timeout(60 * 60)\n")
        self.sess.save()
        req.write("after sess.save()\n")
        req.write(self.sess['obj'])

        return apache.OK

def handler(req):
    mypatch =   Dispatcher(req)
    return mypatch.dispatch(req)

when i use ie or firefox visit the page, i was hanged after output
3.2.10

i think this is the session bug with apache mpm mode, i see somebody else
have mentioned it .

i have test them under windows, apache 2.2, i works ok.

-- 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060905/e81c0ef7/attachment.html
From grahamd at dscpl.com.au  Tue Sep  5 02:09:18 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep  5 02:09:21 2006
Subject: [mod_python] Bug report: mod_python session hangs linux apache
	2.2 .
Message-ID: <1157436558.6262@dscpl.user.openhosting.com>

A few things for you to look at and answer.

guo tie wrote ..
> when i use ie or firefox visit the page, i was hanged after output
> 3.2.10

Sprinkle your code with calls to req.log_error() and look at messages in Apache
error log file to find out exactly where it is hanging.

> i think this is the session bug with apache mpm mode, i see somebody else
> have mentioned it .

There are no known issues with the mod_python code related to sessions that
could cause this. It is more likely to be an issue with your code or your
Apache environment. Did you see any strange mod_python warning messages in the
Apache error log at the time that Apache was restarted? What is the Apache
configuration you are using to trigger your handlers? Is your mod_python
application the only one on the box? Does it happen for the very first request
after Apache is restarted or only some time later? Do you have more than once
instance of Apache running?

> i have test them under windows, apache 2.2, i works ok.

On Windows an in memory session database is used and so it works a lot differently
to a UNIX type system where it will try and use a DBM database in /tmp directory.
Have a look in /tmp and see if you can find a file called something like mp_sess.dbm.
What user owns this file? Is that the same user as Apache runs as?

Graham
From dm at julius.ling.ohio-state.edu  Tue Sep  5 13:28:25 2006
From: dm at julius.ling.ohio-state.edu (Detmar Meurers)
Date: Tue Sep  5 13:28:31 2006
Subject: [mod_python] obtaining html txt from psp template
In-Reply-To: <20060603183600.GA13085@ling.osu.edu>
References: <20060603183600.GA13085@ling.osu.edu>
Message-ID: <20060905172824.GA773@ling.osu.edu>

Hi,

a while ago I recall someone posted a function that takes a psp
template and turns it into plain html - more specifically, I think
it took the result of a psp.PSP call and returned the html (as
opposed to writing it to the req object). But despite searching the
email archives for a while I can't find it any more - could someone
point me to the relevant email/code? Thanks!

Best,
Detmar
From grahamd at dscpl.com.au  Tue Sep  5 16:25:01 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep  5 16:24:24 2006
Subject: [mod_python] obtaining html txt from psp template
In-Reply-To: <20060905172824.GA773@ling.osu.edu>
References: <20060603183600.GA13085@ling.osu.edu>
	<20060905172824.GA773@ling.osu.edu>
Message-ID: <1E99FFB6-AB30-4E59-88EE-0DDE9119B57F@dscpl.com.au>


On 06/09/2006, at 3:28 AM, Detmar Meurers wrote:

> Hi,
>
> a while ago I recall someone posted a function that takes a psp
> template and turns it into plain html - more specifically, I think
> it took the result of a psp.PSP call and returned the html (as
> opposed to writing it to the req object). But despite searching the
> email archives for a while I can't find it any more - could someone
> point me to the relevant email/code? Thanks!

Here is one to get you started:

   http://www.modpython.org/pipermail/mod_python/2006-June/021292.html

Graham
From dm at julius.ling.ohio-state.edu  Tue Sep  5 19:29:44 2006
From: dm at julius.ling.ohio-state.edu (Detmar Meurers)
Date: Tue Sep  5 19:29:51 2006
Subject: [mod_python] obtaining html txt from psp template
In-Reply-To: <1E99FFB6-AB30-4E59-88EE-0DDE9119B57F@dscpl.com.au>
References: <20060603183600.GA13085@ling.osu.edu>
	<20060905172824.GA773@ling.osu.edu>
	<1E99FFB6-AB30-4E59-88EE-0DDE9119B57F@dscpl.com.au>
Message-ID: <20060905232944.GA11775@ling.osu.edu>

Hi Graham,

Thank you for the pointer to Jim Gallacher's posting, which was very
close to what I was looking for.  I modified it to get a simple
string result - the resulting code is included below, in case others
are interested.

Best,
Detmar


# Example code for turning psp template into html string, based on
# http://www.modpython.org/pipermail/mod_python/2006-June/021292.html

from mod_python import _psp

def psp2html(filename,vars={}):
     req = FakeRequestObject()
     vars['req'] = req
     source = _psp.parse(filename)
     code = compile(source, filename, 'exec')
     global_scope = globals().copy()
     global_scope.update(vars)
     exec code in global_scope
     return req.html()

class FakeRequestObject(object):
     def __init__(self):
          self.htmlList = []

     def write(self, value, length):
         self.htmlList.append(value)

     def html(self):
	 return " ".join(self.htmlList)

if __name__ == "__main__":
    print psp2html('template_file.psp',  {'var_in_psp1': 'some value' ,
                                          'var_in_psp2': 'another value'})

### end of python file

For completeness sake, the template_file.psp mentioned above looks as:

<html>
<head>
      <title>
      <%= var_in_psp1 %>
      </title>
</head>

<body>
      <%= var_in_psp2 %>
</body>
</html>
From grahamd at dscpl.com.au  Tue Sep  5 19:47:53 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep  5 19:47:58 2006
Subject: [mod_python] obtaining html txt from psp template
Message-ID: <1157500073.24790@dscpl.user.openhosting.com>

Detmar Meurers wrote ..
> Hi Graham,
> 
> Thank you for the pointer to Jim Gallacher's posting, which was very
> close to what I was looking for.  I modified it to get a simple
> string result - the resulting code is included below, in case others
> are interested.
>
> ...
>
>      def html(self):
> 	 return " ".join(self.htmlList)

You are introducing a space in between blocks. This could have the affect of
changing the way in which the output is interpreted. Use an empty string
instead:

  return "".join(self.htmlList)

Graham
From tjr at acm.org  Tue Sep  5 22:10:18 2006
From: tjr at acm.org (Trevis Rothwell)
Date: Tue Sep  5 22:10:21 2006
Subject: [mod_python] python web site not responding
Message-ID: <4b7c18640609051910p7b554e56x44cbc2ff368cff8a@mail.gmail.com>

Hi!

I've done some Google searching on this topic, but am not entirely
sure what terms to search for, so please accept the usual apology if
this is covered somewhere that I haven't seen yet.  :-)

I run my personal web site as a series of Python scripts and PSP
pages, using mod_python, and it all works great.  I'm now working on
building an online community website using Python/mod_python, and am
finding that pages often don't load, with the browser going into an
indefinite wait state.

I've looked around and don't see any obviously offensive code (e.g.,
infinite loops, etc.).

It seems that if I restart Apache, then the site responds well for a
short time of use, and then sails off into never-never land again.

Any ideas?  Any where in particular to look at for debug info here?

Thanks!

 -- Trevis Rothwell
From grahamd at dscpl.com.au  Tue Sep  5 22:37:46 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep  5 22:38:01 2006
Subject: [mod_python] python web site not responding
Message-ID: <1157510266.19895@dscpl.user.openhosting.com>

Trevis Rothwell wrote ..
> Hi!
> 
> I've done some Google searching on this topic, but am not entirely
> sure what terms to search for, so please accept the usual apology if
> this is covered somewhere that I haven't seen yet.  :-)
> 
> I run my personal web site as a series of Python scripts and PSP
> pages, using mod_python, and it all works great.  I'm now working on
> building an online community website using Python/mod_python, and am
> finding that pages often don't load, with the browser going into an
> indefinite wait state.
> 
> I've looked around and don't see any obviously offensive code (e.g.,
> infinite loops, etc.).
> 
> It seems that if I restart Apache, then the site responds well for a
> short time of use, and then sails off into never-never land again.
> 
> Any ideas?  Any where in particular to look at for debug info here?
> 
> Thanks!

What version of mod_python/Apache are you using? If you use anything before
3.2.8 you may have problems, especially if using Win32 or worker MPM on a
UNIXish system.  The latest version is actually 3.2.10, so use that if you can.

Do you use sessions in your mod_python handlers or PSP pages? Do you use PSP
error pages? Do you have the PythonAutoReload option set to Off? Do you have
multiple distinct mod_python applications running under the same Apache server?
Have you isolated each application to run in a separate interpreter space using
PythonInterpreter?

Do you see any error messages in your Apache error logs?

The above information and anything else you can think of that might
be pertinent would help.

Graham
From ethanton at ethanton.com  Wed Sep  6 03:09:18 2006
From: ethanton at ethanton.com (Ethan Toan Ton)
Date: Wed Sep  6 03:09:21 2006
Subject: [mod_python] Multiple returns to client
In-Reply-To: <1157510266.19895@dscpl.user.openhosting.com>
References: <1157510266.19895@dscpl.user.openhosting.com>
Message-ID: <17680.69.236.163.99.1157526558.squirrel@webmail.ethanton.com>

Hey all,

I was wondering if anyone knew of a way to return multiple times to a
client using a Mod-Python event handler.  Using the req.write() method
does nothing until the actual return statement sends all the data in one
message back to the client.  So before you get to the actual return
statement, can you output back to them more than once?

Ethan


From nlv11281 at natlab.research.philips.com  Wed Sep  6 03:24:57 2006
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Wed Sep  6 03:25:03 2006
Subject: [mod_python] Multiple returns to client
In-Reply-To: <17680.69.236.163.99.1157526558.squirrel@webmail.ethanton.com>
References: <1157510266.19895@dscpl.user.openhosting.com>
	<17680.69.236.163.99.1157526558.squirrel@webmail.ethanton.com>
Message-ID: <44FE77C9.80202@natlab.research.philips.com>

Your output is buffered in multiple stages. In most cases, you can call 
"req.flush()" to send data to the client. This will usually work, unless 
you have a module or a filter installed that collects output until the 
final stage.

For example, this pattern shows how to send output from a slow query 
back to the user, so that he can see the results as they come back. By 
calling req.flush() at smart points, we make sure there's some feedback 
quite efficiently.

...
req.write("<P>Results:</P><table><tr><th>Name</th><th>Date</th></tr>")
req.flush()
c=database.cursor()
c.execute("SELECT name,date FROM persons")
while 1:
    data = c.fetchmany()
    if not data:
        break
    for row in data:
        req.write("<tr><td>%s</td><td>%s</td></tr>" % row)
    req.flush()
req.write("</table>")
...


Mike Looijmans
Philips Natlab / Topic Automation


Ethan Toan Ton wrote:
> I was wondering if anyone knew of a way to return multiple times to a
> client using a Mod-Python event handler.  Using the req.write() method
> does nothing until the actual return statement sends all the data in one
> message back to the client.  So before you get to the actual return
> statement, can you output back to them more than once?

From ethanton at ethanton.com  Wed Sep  6 05:23:02 2006
From: ethanton at ethanton.com (Ethan Toan Ton)
Date: Wed Sep  6 05:23:05 2006
Subject: [mod_python] Multiple returns to client
In-Reply-To: <44FE77C9.80202@natlab.research.philips.com>
References: <1157510266.19895@dscpl.user.openhosting.com>
	<17680.69.236.163.99.1157526558.squirrel@webmail.ethanton.com>
	<44FE77C9.80202@natlab.research.philips.com>
Message-ID: <17487.69.236.163.99.1157534582.squirrel@webmail.ethanton.com>

Mike,

Thanks for the help.  req.flush() works for sending out the data. 
Unfortunately, at the same time, my python program is making requests and
receiving data from other http sources at the same time.  When I run the
req.flush(), it outputs some of the incoming data as well.  Not sure why
that is happening.

Ethan


> Your output is buffered in multiple stages. In most cases, you can call
> "req.flush()" to send data to the client. This will usually work, unless
> you have a module or a filter installed that collects output until the
> final stage.
>
> For example, this pattern shows how to send output from a slow query
> back to the user, so that he can see the results as they come back. By
> calling req.flush() at smart points, we make sure there's some feedback
> quite efficiently.
>
> ...
> req.write("<P>Results:</P><table><tr><th>Name</th><th>Date</th></tr>")
> req.flush()
> c=database.cursor()
> c.execute("SELECT name,date FROM persons")
> while 1:
>     data = c.fetchmany()
>     if not data:
>         break
>     for row in data:
>         req.write("<tr><td>%s</td><td>%s</td></tr>" % row)
>     req.flush()
> req.write("</table>")
> ...
>
>
> Mike Looijmans
> Philips Natlab / Topic Automation
>
>
> Ethan Toan Ton wrote:
>> I was wondering if anyone knew of a way to return multiple times to a
>> client using a Mod-Python event handler.  Using the req.write() method
>> does nothing until the actual return statement sends all the data in one
>> message back to the client.  So before you get to the actual return
>> statement, can you output back to them more than once?
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>


From jpg at jgassociates.ca  Wed Sep  6 07:45:14 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Wed Sep  6 07:45:26 2006
Subject: [mod_python] Multiple returns to client
In-Reply-To: <17487.69.236.163.99.1157534582.squirrel@webmail.ethanton.com>
References: <1157510266.19895@dscpl.user.openhosting.com>	<17680.69.236.163.99.1157526558.squirrel@webmail.ethanton.com>	<44FE77C9.80202@natlab.research.philips.com>
	<17487.69.236.163.99.1157534582.squirrel@webmail.ethanton.com>
Message-ID: <44FEB4CA.8030806@jgassociates.ca>

Ethan Toan Ton wrote:
> Mike,
> 
> Thanks for the help.  req.flush() works for sending out the data. 
> Unfortunately, at the same time, my python program is making requests and
> receiving data from other http sources at the same time.  When I run the
> req.flush(), it outputs some of the incoming data as well.  Not sure why
> that is happening.

That doesn't make any sense at all. Perhaps you can give a concrete 
example? Method req.flush() is a simple wrapper around the Apache 
ap_rflush() call.

Note that you can also use req.write(some_string, flush=1) to 
immediately flush the output. For flush=1 causes ap_rflush() to be 
called as well.

Jim

> Ethan
> 
> 
>> Your output is buffered in multiple stages. In most cases, you can call
>> "req.flush()" to send data to the client. This will usually work, unless
>> you have a module or a filter installed that collects output until the
>> final stage.
>>
>> For example, this pattern shows how to send output from a slow query
>> back to the user, so that he can see the results as they come back. By
>> calling req.flush() at smart points, we make sure there's some feedback
>> quite efficiently.
>>
>> ...
>> req.write("<P>Results:</P><table><tr><th>Name</th><th>Date</th></tr>")
>> req.flush()
>> c=database.cursor()
>> c.execute("SELECT name,date FROM persons")
>> while 1:
>>     data = c.fetchmany()
>>     if not data:
>>         break
>>     for row in data:
>>         req.write("<tr><td>%s</td><td>%s</td></tr>" % row)
>>     req.flush()
>> req.write("</table>")
>> ...
>>
>>
>> Mike Looijmans
>> Philips Natlab / Topic Automation
>>
>>
>> Ethan Toan Ton wrote:
>>> I was wondering if anyone knew of a way to return multiple times to a
>>> client using a Mod-Python event handler.  Using the req.write() method
>>> does nothing until the actual return statement sends all the data in one
>>> message back to the client.  So before you get to the actual return
>>> statement, can you output back to them more than once?
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From rsynnott at gmail.com  Wed Sep  6 07:58:00 2006
From: rsynnott at gmail.com (Robert Synnott)
Date: Wed Sep  6 07:58:22 2006
Subject: [mod_python] python web site not responding
In-Reply-To: <4b7c18640609051910p7b554e56x44cbc2ff368cff8a@mail.gmail.com>
References: <4b7c18640609051910p7b554e56x44cbc2ff368cff8a@mail.gmail.com>
Message-ID: <24f203480609060458i40c1585ey3c058264af894f89@mail.gmail.com>

On 9/6/06, Trevis Rothwell <tjr@acm.org> wrote:
> Hi!
>
> I've done some Google searching on this topic, but am not entirely
> sure what terms to search for, so please accept the usual apology if
> this is covered somewhere that I haven't seen yet.  :-)
>
> I run my personal web site as a series of Python scripts and PSP
> pages, using mod_python, and it all works great.  I'm now working on
> building an online community website using Python/mod_python, and am
> finding that pages often don't load, with the browser going into an
> indefinite wait state.
>
> I've looked around and don't see any obviously offensive code (e.g.,
> infinite loops, etc.).
>
> It seems that if I restart Apache, then the site responds well for a
> short time of use, and then sails off into never-never land again.
>
> Any ideas?  Any where in particular to look at for debug info here?
>
> Thanks!
>
>  -- Trevis Rothwell
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

Sessions not being unlocked in hander code, then re-used in PSP, possibly?
Rob
From martijn at xs4us.nu  Wed Sep  6 11:16:03 2006
From: martijn at xs4us.nu (Martijn Moeling)
Date: Wed Sep  6 11:16:17 2006
Subject: [mod_python] Multiple returns to client
Message-ID: <B6C73A5E30565245BB6D32B5F5DF7A520BED12@sense.emmastraat.pijnacker>

I had similair behaviour when I started working with mod_python,
After some digging in the mod_python docs I found that it had to do with
global vars in the python module where the handler is defined.

Something like:

Host = ""
Def handler(req)
	Global host
	Host=req.host.split(".")[0]

I solved this by creating a class which is created and destroyed in the
handler, within the init of the class I set the database connection and
I can use global vars


Class visitor:
	Def __init__(self):
		Self.Db.init
		Self.var=""
	
	Def myhandler(Self,req):
		#Do all the stuff you want
		Return apache.OK
8<-------------------------------

Import visitors

Def handler(req):
    Vis_con=visitor()
    Result = Vis_con.myhandler(req)
    Return result

(this is rough unchecked code but just explains my point)

-----Original Message-----
From: mod_python-bounces@modpython.org
[mailto:mod_python-bounces@modpython.org] On Behalf Of Jim Gallacher
Sent: Wednesday, September 06, 2006 1:45 PM
To: Ethan Toan Ton
Cc: mod_python@modpython.org
Subject: Re: [mod_python] Multiple returns to client

Ethan Toan Ton wrote:
> Mike,
> 
> Thanks for the help.  req.flush() works for sending out the data. 
> Unfortunately, at the same time, my python program is making requests
and
> receiving data from other http sources at the same time.  When I run
the
> req.flush(), it outputs some of the incoming data as well.  Not sure
why
> that is happening.

That doesn't make any sense at all. Perhaps you can give a concrete 
example? Method req.flush() is a simple wrapper around the Apache 
ap_rflush() call.

Note that you can also use req.write(some_string, flush=1) to 
immediately flush the output. For flush=1 causes ap_rflush() to be 
called as well.

Jim

> Ethan
> 
> 
>> Your output is buffered in multiple stages. In most cases, you can
call
>> "req.flush()" to send data to the client. This will usually work,
unless
>> you have a module or a filter installed that collects output until
the
>> final stage.
>>
>> For example, this pattern shows how to send output from a slow query
>> back to the user, so that he can see the results as they come back.
By
>> calling req.flush() at smart points, we make sure there's some
feedback
>> quite efficiently.
>>
>> ...
>>
req.write("<P>Results:</P><table><tr><th>Name</th><th>Date</th></tr>")
>> req.flush()
>> c=database.cursor()
>> c.execute("SELECT name,date FROM persons")
>> while 1:
>>     data = c.fetchmany()
>>     if not data:
>>         break
>>     for row in data:
>>         req.write("<tr><td>%s</td><td>%s</td></tr>" % row)
>>     req.flush()
>> req.write("</table>")
>> ...
>>
>>
>> Mike Looijmans
>> Philips Natlab / Topic Automation
>>
>>
>> Ethan Toan Ton wrote:
>>> I was wondering if anyone knew of a way to return multiple times to
a
>>> client using a Mod-Python event handler.  Using the req.write()
method
>>> does nothing until the actual return statement sends all the data in
one
>>> message back to the client.  So before you get to the actual return
>>> statement, can you output back to them more than once?
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From shadow at mapik.net  Wed Sep  6 11:38:05 2006
From: shadow at mapik.net (=?WINDOWS-1252?Q?Honza_Rame=9A?=)
Date: Wed Sep  6 11:38:08 2006
Subject: [mod_python] Python 2.5
In-Reply-To: <c298f2d70609011034n3e1645d0j5254694b0d7cb2a6@mail.gmail.com>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>
	<44F750CD.9080904@jgassociates.ca>
	<22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
	<c298f2d70609011034n3e1645d0j5254694b0d7cb2a6@mail.gmail.com>
Message-ID: <22e28ea10609060838x2bcb3fcck6fad2b5b0ed5fc9c@mail.gmail.com>

 Today I managed to get SVN for 2.5 working but using with Trac is
impossible bacause apache raises an exception in Python25.dll so I suggest
you use either older Python/SVN or wait a while until someone fixes whatever
is causing this bug. If this happens I'll be happy to provide you with
compiled versions of Apache, Python, SVN etc etc etc....
But If you want to try to build it anyway I'll be happy to provide you with
any information you need.
My approach was:

   1. Read the SVN docs
   2. Build zlib
   3. Build openssl
   4. Build apache (to get Apr iconv etc)
   5. Build svn
   6. Build python
   7. Build mod_python
   8. Get swig (you will need older version the newest one isn't working
   with the SVN sources, it took me half a day to figure it out)
   9. Buld swig SVN bindings for python

But this is not the ultimate guide. During the build proccess I had to
change several include paths and find static libraries.

You probably know how I feel right now when I have everything built but the
Trac with SVN isn't working.

Honza Rames


On 9/1/06, Nicolas Lehuen <nicolas@lehuen.com> wrote:
>
> Your input about Trac is interesting. On a machine I'm stuck with Python
> 2.3 because I want to run Trac. I tried to build the SVN Python binding
> for Python 2.4, but even though I have a full compiler chain (so I can
> build Apache, Neon, apr-utils, SVN, Python etc. with the same compiler), the
> task is quite daunting, as building SVN for Win32 is not the simplest thing
> of earth (you might as well try to make meat stuffed spaghettis).
>
> So, I wonder, how did you manage to get the SVN Python bindings for Python
> 2.5 ? With the final release coming soon, this would be very great :)
>
> Regards,
> Nicolas
>
> 2006/9/1, Honza Rame? < shadow@mapik.net>:
>
> >  Thanks for your reply
> >
> > Python 2.4 works perfectly but when I change to 2.5 RC1 apache can't
> > find the handler. I have tried to start python console and import
> > mod_python.apache it worked (accordingly to
> > http://www.modpython.org/pipermail/mod_python/2004-November/016815.html)
> > and I double checked evry path and I also tried to copy python25.dll to
> > several locations in PATH byt I got the same result :-( I was very supprised
> > that it didn't work. If the 2.4 didn't work as well then it would seem
> > that I hove done some mistake in configuration but this way I am very
> > confused. I read the article you sent me before but I couldn't find any
> > usable information. Is there a possbility that I haven't installed Python
> > correctly? I mean I compiled it but could there be missing some files that
> > would couse this problem?
> > The reason I'm doing all this is because I'm trying to get Trac with SVN
> > to work. There are no windows SVN bindings for python 2.4 so I tried to
> > make them but Python 2.4 compiled with VS2005 does not run at all (so
> > I'm using official release), Python 2.5 does but mod_python doesn't :-(
> >
> > Regards
> >
> > Honza Rames
> >
> >  On 8/31/06, Jim Gallacher <jpg@jgassociates.ca > wrote:
> > >
> > > I haven't tried 2.5 yet, but I guess we should start testing the
> > > development branch against it. We're hoping to release mod_python 3.3
> > > sometime in October or November. Hopefully that would be too long
> > > after
> > > python 2.5 is officially out. I don't know what their timetable is but
> > > currently it's just the release candidate so the lag shouldn't be too
> > > great. I'd be very surprised if there was any changes that would break
> > > mod_python though.
> > >
> > > For your particular problem though I suspect it's the usual
> > > installation
> > > funkiness rather than a python 2.5 specific issue. In particular take
> > > a
> > > look at the thread that started on Tuesday. See
> > > http://www.modpython.org/pipermail/mod_python/2006-August/021944.html
> > >
> > > Jim
> > >
> > >
> > > Honza Rame? wrote:
> > > > Hi,
> > > > have any of you tried to run mod_python with Python 2.5 on Windows.
> > > I
> > > > cannot run Python 2.4 compiled with VS2005 it always result in an
> > > error.
> > > > And
> > > > mod_python with Python 2.5 returns Internal server error and
> > > > error.logcontains:
> > > >
> > > >
> > > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: could not
> > > import
> > > >> mod_python.apache.\n
> > > >> [Thu Aug 31 02:40:35 2006] [error] make_obcallback: Python path
> > > being
> > > >> used
> > > >> "['C:\\\\WINDOWS\\\\system32\\\\python25.zip', '.\\\\DLLs',
> > > '.\\\\lib',
> > > >> '.\\\\lib\\\\plat-win', '.\\\\lib\\\\lib-tk',
> > > >> 'C:\\\\Inetpub\\\\Apache2\\\\bin']".
> > > >> [Thu Aug 31 02:40:35 2006] [error] python_handler: no interpreter
> > > >> callback
> > > >> found.
> > > >> [Thu Aug 31 02:40:35 2006] [error] [client 10.0.0.2]
> > > python_handler:
> > > >> Can't
> > > >> get/create interpreter.
> > > >
> > > >
> > > > I compiled both Apache 2.2.3 and mod_python 3.2.10
> > > > Thanks
> > > >
> > > > Honza Rames
> > > >
> > > >
> > > >
> > > ------------------------------------------------------------------------
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python
> > >
> > >
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060906/ab475aa1/attachment.html
From yehuda.rajuan at yadata.com  Wed Sep  6 12:19:46 2006
From: yehuda.rajuan at yadata.com (Yehuda Rajuan)
Date: Wed Sep  6 12:18:20 2006
Subject: [mod_python] installing on JBoss
Message-ID: <E3E70822E856B2408D0901EFC4A24AD906441A@server.yadata.com>

Hello I have Jboss on windows  which suppose to have a tomcat on it,

 

I run install from your site, what directory should I choose for the
apache (I do not have directory named 'apache').

 

Please if you have any helping document I will be gratfull. 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060906/ff95290e/attachment.html
From list at joreybump.com  Wed Sep  6 12:27:54 2006
From: list at joreybump.com (Jorey Bump)
Date: Wed Sep  6 12:28:01 2006
Subject: [mod_python] installing on JBoss
In-Reply-To: <E3E70822E856B2408D0901EFC4A24AD906441A@server.yadata.com>
References: <E3E70822E856B2408D0901EFC4A24AD906441A@server.yadata.com>
Message-ID: <44FEF70A.6050909@joreybump.com>

Yehuda Rajuan wrote:
> Hello I have Jboss on windows  which suppose to have a tomcat on it,
> 
> I run install from your site, what directory should I choose for the 
> apache (I do not have directory named ?apache?).
> 
> Please if you have any helping document I will be gratfull.

mod_python will only work with the Apache httpd web server. You must 
install this first. Use either the latest version of 2.0.x or 2.2.x.

From gkelly at gmail.com  Wed Sep  6 13:34:53 2006
From: gkelly at gmail.com (Grant Kelly)
Date: Wed Sep  6 13:34:56 2006
Subject: [mod_python] not using correct python library path
Message-ID: <646de7490609061034i59bb363fqeaed4f59c8753a5a@mail.gmail.com>

Hello,

I'm having a problem with mod_python.

I have two versions of python:

  The system version: /usr/bin/python (2.3)
  Local installed version: /usr/local/bin/python (2.4)

I configured mod_python with:
./configure --with-apxs=/usr/sbin/apxs
--with-python=/usr/local/bin/python2.4
--with-python-src=/usr/local/src/python
----------------------

But when I try to use mod_python, I receive the following in the
apache error log:

[Wed Sep 06 10:23:12 2006] [error] make_obcallback: could not import
mod_python.apache.\n
Traceback (most recent call last):
  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py",
line 24, in ?
    import pdb
  File "/usr/lib/python2.3/pdb.py", line 13, in ?
    import re
  File "/usr/lib/python2.3/re.py", line 5, in ?
    from sre import *
  File "/usr/lib/python2.3/sre.py", line 97, in ?
    import sre_compile
  File "/usr/lib/python2.3/sre_compile.py", line 17, in ?
    assert _sre.MAGIC == MAGIC, "SRE module mismatch"
AssertionError: SRE module mismatch
--------------------

So it appears that python is trying to import modules from the
python2.3 library path. How can I force it to use the python2.4
library path, /usr/local/lib/python2.4 ?

Thanks in advance,
Grant
From jpg at jgassociates.ca  Wed Sep  6 15:30:48 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Wed Sep  6 15:30:56 2006
Subject: [mod_python] not using correct python library path
In-Reply-To: <646de7490609061034i59bb363fqeaed4f59c8753a5a@mail.gmail.com>
References: <646de7490609061034i59bb363fqeaed4f59c8753a5a@mail.gmail.com>
Message-ID: <44FF21E8.4040700@jgassociates.ca>

Grant Kelly wrote:
> Hello,
> 
> I'm having a problem with mod_python.
> 
> I have two versions of python:
> 
>  The system version: /usr/bin/python (2.3)
>  Local installed version: /usr/local/bin/python (2.4)
> 
> I configured mod_python with:
> ./configure --with-apxs=/usr/sbin/apxs
> --with-python=/usr/local/bin/python2.4
> --with-python-src=/usr/local/src/python
> ----------------------
> 
> But when I try to use mod_python, I receive the following in the
> apache error log:
> 
> [Wed Sep 06 10:23:12 2006] [error] make_obcallback: could not import
> mod_python.apache.\n
> Traceback (most recent call last):
>  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py",
> line 24, in ?
>    import pdb
>  File "/usr/lib/python2.3/pdb.py", line 13, in ?
>    import re
>  File "/usr/lib/python2.3/re.py", line 5, in ?
>    from sre import *
>  File "/usr/lib/python2.3/sre.py", line 97, in ?
>    import sre_compile
>  File "/usr/lib/python2.3/sre_compile.py", line 17, in ?
>    assert _sre.MAGIC == MAGIC, "SRE module mismatch"
> AssertionError: SRE module mismatch
> --------------------

That looks completely messed up. The path for apache.py in the traceback 
seems to indicate that apache is using python2.4, but then it quickly 
goes pear shaped. What happens if you do the following from the command 
line?

$ /usr/local/bin/python2.4
 >>> import pdb

By the way, you don't need --with-python-src. Thats only required for 
building the docs, which are already included in the source tarball.

Jim
From gkelly at gmail.com  Wed Sep  6 16:05:05 2006
From: gkelly at gmail.com (Grant Kelly)
Date: Wed Sep  6 16:05:09 2006
Subject: [mod_python] not using correct python library path
In-Reply-To: <44FF21E8.4040700@jgassociates.ca>
References: <646de7490609061034i59bb363fqeaed4f59c8753a5a@mail.gmail.com>
	<44FF21E8.4040700@jgassociates.ca>
Message-ID: <646de7490609061305q6150b8e5u58441dcf5258aeb@mail.gmail.com>

I think I've solved my problem with mod_python. It had to do with
having a manual PYTHONPATH specified for root versus the user I
compiled mod_python with. root was using python2.3 (to run `make
install`) and the user was using python2.4, so mod_python.so was
compiled for 2.4 but when it ran, it was using the 2.3 library path.
This is my best guess at what happened...could be wrong, but it seems
to be working now.

Thanks,
Grant


On 9/6/06, Jim Gallacher <jpg@jgassociates.ca> wrote:
> Grant Kelly wrote:
> > Hello,
> >
> > I'm having a problem with mod_python.
> >
> > I have two versions of python:
> >
> >  The system version: /usr/bin/python (2.3)
> >  Local installed version: /usr/local/bin/python (2.4)
> >
> > I configured mod_python with:
> > ./configure --with-apxs=/usr/sbin/apxs
> > --with-python=/usr/local/bin/python2.4
> > --with-python-src=/usr/local/src/python
> > ----------------------
> >
> > But when I try to use mod_python, I receive the following in the
> > apache error log:
> >
> > [Wed Sep 06 10:23:12 2006] [error] make_obcallback: could not import
> > mod_python.apache.\n
> > Traceback (most recent call last):
> >  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py",
> > line 24, in ?
> >    import pdb
> >  File "/usr/lib/python2.3/pdb.py", line 13, in ?
> >    import re
> >  File "/usr/lib/python2.3/re.py", line 5, in ?
> >    from sre import *
> >  File "/usr/lib/python2.3/sre.py", line 97, in ?
> >    import sre_compile
> >  File "/usr/lib/python2.3/sre_compile.py", line 17, in ?
> >    assert _sre.MAGIC == MAGIC, "SRE module mismatch"
> > AssertionError: SRE module mismatch
> > --------------------
>
> That looks completely messed up. The path for apache.py in the traceback
> seems to indicate that apache is using python2.4, but then it quickly
> goes pear shaped. What happens if you do the following from the command
> line?
>
> $ /usr/local/bin/python2.4
>  >>> import pdb
>
> By the way, you don't need --with-python-src. Thats only required for
> building the docs, which are already included in the source tarball.
>
> Jim
>
From grahamd at dscpl.com.au  Wed Sep  6 17:55:37 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep  6 17:56:51 2006
Subject: [mod_python] Python 2.5
In-Reply-To: <22e28ea10609060838x2bcb3fcck6fad2b5b0ed5fc9c@mail.gmail.com>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>
	<44F750CD.9080904@jgassociates.ca>
	<22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
	<c298f2d70609011034n3e1645d0j5254694b0d7cb2a6@mail.gmail.com>
	<22e28ea10609060838x2bcb3fcck6fad2b5b0ed5fc9c@mail.gmail.com>
Message-ID: <6D7BC46E-AD33-4514-B9F8-40B54A3504E3@dscpl.com.au>


On 07/09/2006, at 1:38 AM, Honza Rame? wrote:

> Today I managed to get SVN for 2.5 working but using with Trac is  
> impossible bacause apache raises an exception in Python25.dll so I  
> suggest you use either older Python/SVN or wait a while until  
> someone fixes whatever is causing this bug. If this happens I'll be  
> happy to provide you with compiled versions of Apache, Python, SVN  
> etc etc etc....
> But If you want to try to build it anyway I'll be happy to provide  
> you with any information you need.
> My approach was:
> Read the SVN docs
> Build zlib
> Build openssl
> Build apache (to get Apr iconv etc)
> Build svn
> Build python
> Build mod_python
> Get swig (you will need older version the newest one isn't working  
> with the SVN sources, it took me half a day to figure it out)
> Buld swig SVN bindings for python
> But this is not the ultimate guide. During the build proccess I had  
> to change several include paths and find static libraries.
>
> You probably know how I feel right now when I have everything built  
> but the Trac with SVN isn't working.

Which version of mod_python were you using? Current official release  
of Trac will
not work with mod_python 3.3 out of Subversion trunk because it  
relied on accessing
internals of util.FieldStorage which have changed in 3.3. You would  
need to be using
Trac from their Subversion repository which uses a WSGI style adapter  
instead and
doesn't fiddle with util.FieldStorage.

Graham



From grahamd at dscpl.com.au  Wed Sep  6 17:58:31 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep  6 17:59:32 2006
Subject: [mod_python] not using correct python library path
In-Reply-To: <646de7490609061305q6150b8e5u58441dcf5258aeb@mail.gmail.com>
References: <646de7490609061034i59bb363fqeaed4f59c8753a5a@mail.gmail.com>
	<44FF21E8.4040700@jgassociates.ca>
	<646de7490609061305q6150b8e5u58441dcf5258aeb@mail.gmail.com>
Message-ID: <D50B40F0-47FF-4FD5-BA3E-B353BE6AB8A5@dscpl.com.au>


On 07/09/2006, at 6:05 AM, Grant Kelly wrote:

> I think I've solved my problem with mod_python. It had to do with
> having a manual PYTHONPATH specified for root versus the user I
> compiled mod_python with. root was using python2.3 (to run `make
> install`) and the user was using python2.4, so mod_python.so was
> compiled for 2.4 but when it ran, it was using the 2.3 library path.
> This is my best guess at what happened...could be wrong, but it seems
> to be working now.

Also ensure that the user that Apache runs as has a PATH variable  
setting
such that the required version of Python is what is found in PATH. If  
you do
not and it finds an incorrect version first, that can cause problems.

Graham
From grahamd at dscpl.com.au  Wed Sep  6 18:10:30 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep  6 18:11:29 2006
Subject: [mod_python] python web site not responding
In-Reply-To: <4b7c18640609051946ne29e102x8582709db0b69309@mail.gmail.com>
References: <1157510266.19895@dscpl.user.openhosting.com>
	<4b7c18640609051946ne29e102x8582709db0b69309@mail.gmail.com>
Message-ID: <CB1CA34A-51E1-4927-AC8D-5B6BF5832326@dscpl.com.au>


On 06/09/2006, at 12:46 PM, Trevis Rothwell wrote:

> On 9/5/06, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
>
>> What version of mod_python/Apache are you using? If you use  
>> anything before
>> 3.2.8 you may have problems, especially if using Win32 or worker  
>> MPM on a
>> UNIXish system.  The latest version is actually 3.2.10, so use  
>> that if you can.
>
> I just upgraded to 3.2.10 tonight, but it doesn't seem to fix  
> anything.
>
>
>> Do you use sessions in your mod_python handlers or PSP pages?
>
> I am using sessions for my new project, which I did not for my
> personal website (which works).  I am not using PSP for this.

Sessions are often a source of hangs. When using sessions, you should  
only
create one instance of the Session object for any specific request.  
If you try
and create a second, the handler will deadlock on itself. How are you  
using
sessions in your code? Are you do non trivial stuff line using the  
function
req.internal_redirect()? Using this function can also cause session  
hangs if
the target of the sub request also uses sessions and the session in main
handler hasn't be unlocked.

>> Do you have the PythonAutoReload option set to Off?
>
> I don't have it set to anything in particular.
>
>
>> Do you have multiple distinct mod_python applications running
>> under the same Apache server?
>
> Yes, as "virtual servers" at Apache.
>
>
>> Have you isolated each application to run in a separate  
>> interpreter space using
>> PythonInterpreter?
>
> No.
>
>
>> Do you see any error messages in your Apache error logs?
>
> Nothing particularly interesting to me.  This kind of line is common:
>
> [Tue Sep 05 21:18:59 2006] [notice] mod_python: Creating 8 session
> mutexes based on 256 max processes and 0 max threads.
>
>
>> The above information and anything else you can think of that might
>> be pertinent would help.
>
> Thanks, you've already given me some things to explore that I hadn't
> before.  I naively assumed that since my previous Python-powered site
> worked without problems, I could just add a virtual server and make
> another one...  there might be more to it!  :-)
>
> -- Trevis Rothwell

From shadow at mapik.net  Wed Sep  6 19:19:56 2006
From: shadow at mapik.net (=?WINDOWS-1252?Q?Honza_Rame=9A?=)
Date: Wed Sep  6 19:20:02 2006
Subject: [mod_python] Python 2.5
In-Reply-To: <6D7BC46E-AD33-4514-B9F8-40B54A3504E3@dscpl.com.au>
References: <22e28ea10608310922y230fback57f87e68cbe09fba@mail.gmail.com>
	<44F750CD.9080904@jgassociates.ca>
	<22e28ea10609010144m1a5f0e13ha01fec2ce44e7744@mail.gmail.com>
	<c298f2d70609011034n3e1645d0j5254694b0d7cb2a6@mail.gmail.com>
	<22e28ea10609060838x2bcb3fcck6fad2b5b0ed5fc9c@mail.gmail.com>
	<6D7BC46E-AD33-4514-B9F8-40B54A3504E3@dscpl.com.au>
Message-ID: <22e28ea10609061619y2383c112u203f65172da303de@mail.gmail.com>

I'm using mod_python 3.2.10 and Trac 0.10 from SVN. But trac works perfectly
but without SVN repo browser :-( . There is some problem in Python's memory
management routine it causes access violation under some circumstances. And
apache is not usable since then and must be restarted. I'll try to post a
message either to SVN or Python mailing list...or both. I can provide any
debugging information neccesary for fixing this problem since I have
complete sources with debugging info.

Honza


On 9/6/06, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
>
>
> On 07/09/2006, at 1:38 AM, Honza Rame? wrote:
>
> > Today I managed to get SVN for 2.5 working but using with Trac is
> > impossible bacause apache raises an exception in Python25.dll so I
> > suggest you use either older Python/SVN or wait a while until
> > someone fixes whatever is causing this bug. If this happens I'll be
> > happy to provide you with compiled versions of Apache, Python, SVN
> > etc etc etc....
> > But If you want to try to build it anyway I'll be happy to provide
> > you with any information you need.
> > My approach was:
> > Read the SVN docs
> > Build zlib
> > Build openssl
> > Build apache (to get Apr iconv etc)
> > Build svn
> > Build python
> > Build mod_python
> > Get swig (you will need older version the newest one isn't working
> > with the SVN sources, it took me half a day to figure it out)
> > Buld swig SVN bindings for python
> > But this is not the ultimate guide. During the build proccess I had
> > to change several include paths and find static libraries.
> >
> > You probably know how I feel right now when I have everything built
> > but the Trac with SVN isn't working.
>
> Which version of mod_python were you using? Current official release
> of Trac will
> not work with mod_python 3.3 out of Subversion trunk because it
> relied on accessing
> internals of util.FieldStorage which have changed in 3.3. You would
> need to be using
> Trac from their Subversion repository which uses a WSGI style adapter
> instead and
> doesn't fiddle with util.FieldStorage.
>
> Graham
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060907/1a6db58f/attachment-0001.html
From david at neuraliq.com  Wed Sep  6 20:39:38 2006
From: david at neuraliq.com (David Beal)
Date: Wed Sep  6 20:39:18 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>
	<c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>
	<17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>
Message-ID: <1157589578.5516.14.camel@anthracite.dev.neuraliq.com>

Ethan,

> Thanks for your help.  It turns out the problem was the "return
> apache.OK".  I was getting that extra 0 at the end and could not
> figure
> out why.  Thanks for the prompt replies.  I appreciate all the help.
> 

The problem is probably not with return apache.OK, but maybe with the
client's XmlHttpRequest handler not understanding chunked encoding
markers.  The 0 is for HTTP chunked encoding.  Look for the header:

Transfer-Encoding: chunked

and the first line of the content will be a hexadecimal number of the
content-length for the first chunk.  Each subsequent chunk comes with a
chunk length marker.  The 0 at the end of the file indicates that there
are no more chunks.  Chunk length markers will also appear whenever an
output flush occurs.

To disable chunked encoding, you should specify a content length:

req.headers_out['Content-Length']=str(len(code))

Best Regards,
David

From grahamd at dscpl.com.au  Wed Sep  6 20:58:42 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep  6 20:59:42 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <1157589578.5516.14.camel@anthracite.dev.neuraliq.com>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>
	<c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>
	<17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>
	<1157589578.5516.14.camel@anthracite.dev.neuraliq.com>
Message-ID: <BB46BF13-E6E5-49AA-9CF6-71EBE8D53937@dscpl.com.au>


On 07/09/2006, at 10:39 AM, David Beal wrote:

> Ethan,
>
>> Thanks for your help.  It turns out the problem was the "return
>> apache.OK".  I was getting that extra 0 at the end and could not
>> figure
>> out why.  Thanks for the prompt replies.  I appreciate all the help.
>>
>
> The problem is probably not with return apache.OK, but maybe with the
> client's XmlHttpRequest handler not understanding chunked encoding
> markers.  The 0 is for HTTP chunked encoding.  Look for the header:
>
> Transfer-Encoding: chunked
>
> and the first line of the content will be a hexadecimal number of the
> content-length for the first chunk.  Each subsequent chunk comes  
> with a
> chunk length marker.  The 0 at the end of the file indicates that  
> there
> are no more chunks.  Chunk length markers will also appear whenever an
> output flush occurs.
>
> To disable chunked encoding, you should specify a content length:
>
> req.headers_out['Content-Length']=str(len(code))

I'd suggest it isn't anything to do with chunked encoding and the  
original
suggestion about apache.OK is going to be correct.

It is an occasional problem we have to correct whereby people who move
from a mod_python basic handler to mod_python.publisher keep returning
apache.OK as a status when they shouldn't with result of an extra '0'
appearing in response.

Ie., a mod_python basic handler of:

   def handler(req):
     req.content_type = 'text/plain'
     req.write("content")
     return apache.OK

can not simply be taken and then used as mod_python.publisher  
function as:

   def index(req):
     req.content_type = 'text/plain'
     req.write("content")
     return apache.OK

This is because mod_python.publisher will always take the result of  
the function
and convert it to a string and append it to the response, even if  
req.write() were
used. Thus, must be written as:

   def index(req):
     req.content_type = 'text/plain'
     req.write("content")

or for older versions of mod_python where returning None or an empty  
string is
a problem, written as:

   def index(req):
     req.content_type = 'text/plain'
     req.write("content")
     return ' '

Graham
From ethanton at ethanton.com  Thu Sep  7 01:55:34 2006
From: ethanton at ethanton.com (Ethan Toan Ton)
Date: Thu Sep  7 01:55:38 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <BB46BF13-E6E5-49AA-9CF6-71EBE8D53937@dscpl.com.au>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>
	<c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>
	<17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>
	<1157589578.5516.14.camel@anthracite.dev.neuraliq.com>
	<BB46BF13-E6E5-49AA-9CF6-71EBE8D53937@dscpl.com.au>
Message-ID: <17770.69.236.163.99.1157608534.squirrel@webmail.ethanton.com>

Graham/David,

Thanks for the help. My packet sniffer is looking at the packets, and instead
of a new packet header, all these req.flush() calls are keeping the
connection
alive. Unfortunately, the javascript xmlhttprequest will only process the
packet once, instead of during every call to req.flush().

Is there a way to close the connection and open it again afterwards? I'm
trying to get the xmlhttprequest.onreadystatechange to process after each
call
to req.flush().

Ethan


> On 07/09/2006, at 10:39 AM, David Beal wrote:
>
>> Ethan,
>>
>>> Thanks for your help.  It turns out the problem was the "return
>>> apache.OK".  I was getting that extra 0 at the end and could not
>>> figure
>>> out why.  Thanks for the prompt replies.  I appreciate all the help.
>>>
>>
>> The problem is probably not with return apache.OK, but maybe with the
>> client's XmlHttpRequest handler not understanding chunked encoding
>> markers.  The 0 is for HTTP chunked encoding.  Look for the header:
>>
>> Transfer-Encoding: chunked
>>
>> and the first line of the content will be a hexadecimal number of the
>> content-length for the first chunk.  Each subsequent chunk comes
>> with a
>> chunk length marker.  The 0 at the end of the file indicates that
>> there
>> are no more chunks.  Chunk length markers will also appear whenever an
>> output flush occurs.
>>
>> To disable chunked encoding, you should specify a content length:
>>
>> req.headers_out['Content-Length']=str(len(code))
>
> I'd suggest it isn't anything to do with chunked encoding and the
> original
> suggestion about apache.OK is going to be correct.
>
> It is an occasional problem we have to correct whereby people who move
> from a mod_python basic handler to mod_python.publisher keep returning
> apache.OK as a status when they shouldn't with result of an extra '0'
> appearing in response.
>
> Ie., a mod_python basic handler of:
>
>    def handler(req):
>      req.content_type = 'text/plain'
>      req.write("content")
>      return apache.OK
>
> can not simply be taken and then used as mod_python.publisher
> function as:
>
>    def index(req):
>      req.content_type = 'text/plain'
>      req.write("content")
>      return apache.OK
>
> This is because mod_python.publisher will always take the result of
> the function
> and convert it to a string and append it to the response, even if
> req.write() were
> used. Thus, must be written as:
>
>    def index(req):
>      req.content_type = 'text/plain'
>      req.write("content")
>
> or for older versions of mod_python where returning None or an empty
> string is
> a problem, written as:
>
>    def index(req):
>      req.content_type = 'text/plain'
>      req.write("content")
>      return ' '
>
> Graham
>


From jpg at jgassociates.ca  Thu Sep  7 08:05:11 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Sep  7 08:05:12 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <17770.69.236.163.99.1157608534.squirrel@webmail.ethanton.com>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>	<c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>	<17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>	<1157589578.5516.14.camel@anthracite.dev.neuraliq.com>	<BB46BF13-E6E5-49AA-9CF6-71EBE8D53937@dscpl.com.au>
	<17770.69.236.163.99.1157608534.squirrel@webmail.ethanton.com>
Message-ID: <45000AF7.4060705@jgassociates.ca>

Ethan Toan Ton wrote:
> Graham/David,
> 
> Thanks for the help. My packet sniffer is looking at the packets, and instead
> of a new packet header, all these req.flush() calls are keeping the
> connection
> alive. Unfortunately, the javascript xmlhttprequest will only process the
> packet once, instead of during every call to req.flush().
> 
> Is there a way to close the connection and open it again afterwards? I'm
> trying to get the xmlhttprequest.onreadystatechange to process after each
> call
> to req.flush().

Of course req.flush() does not close the connection. It just causes 
apache to send the current contents of the response buffer. Apache will 
close the connection only when the request processing has completed. 
This is the way http works.

Jim

> Ethan
> 
> 
>> On 07/09/2006, at 10:39 AM, David Beal wrote:
>>
>>> Ethan,
>>>
>>>> Thanks for your help.  It turns out the problem was the "return
>>>> apache.OK".  I was getting that extra 0 at the end and could not
>>>> figure
>>>> out why.  Thanks for the prompt replies.  I appreciate all the help.
>>>>
>>> The problem is probably not with return apache.OK, but maybe with the
>>> client's XmlHttpRequest handler not understanding chunked encoding
>>> markers.  The 0 is for HTTP chunked encoding.  Look for the header:
>>>
>>> Transfer-Encoding: chunked
>>>
>>> and the first line of the content will be a hexadecimal number of the
>>> content-length for the first chunk.  Each subsequent chunk comes
>>> with a
>>> chunk length marker.  The 0 at the end of the file indicates that
>>> there
>>> are no more chunks.  Chunk length markers will also appear whenever an
>>> output flush occurs.
>>>
>>> To disable chunked encoding, you should specify a content length:
>>>
>>> req.headers_out['Content-Length']=str(len(code))
>> I'd suggest it isn't anything to do with chunked encoding and the
>> original
>> suggestion about apache.OK is going to be correct.
>>
>> It is an occasional problem we have to correct whereby people who move
>> from a mod_python basic handler to mod_python.publisher keep returning
>> apache.OK as a status when they shouldn't with result of an extra '0'
>> appearing in response.
>>
>> Ie., a mod_python basic handler of:
>>
>>    def handler(req):
>>      req.content_type = 'text/plain'
>>      req.write("content")
>>      return apache.OK
>>
>> can not simply be taken and then used as mod_python.publisher
>> function as:
>>
>>    def index(req):
>>      req.content_type = 'text/plain'
>>      req.write("content")
>>      return apache.OK
>>
>> This is because mod_python.publisher will always take the result of
>> the function
>> and convert it to a string and append it to the response, even if
>> req.write() were
>> used. Thus, must be written as:
>>
>>    def index(req):
>>      req.content_type = 'text/plain'
>>      req.write("content")
>>
>> or for older versions of mod_python where returning None or an empty
>> string is
>> a problem, written as:
>>
>>    def index(req):
>>      req.content_type = 'text/plain'
>>      req.write("content")
>>      return ' '
>>
>> Graham
>>
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From list at joreybump.com  Thu Sep  7 08:11:29 2006
From: list at joreybump.com (Jorey Bump)
Date: Thu Sep  7 08:11:34 2006
Subject: [mod_python] installing on JBoss
In-Reply-To: <E3E70822E856B2408D0901EFC4A24AD906442F@server.yadata.com>
References: <E3E70822E856B2408D0901EFC4A24AD906442F@server.yadata.com>
Message-ID: <45000C71.3020504@joreybump.com>

Please keep responses on the list. :)

Yehuda Rajuan wrote:

> I read that Jboss has in it embedded Apache Tomcat, how can I use that
> one, do I must install another apache Tomcat that will standalone. 

Although most of us mean httpd when we simply say "Apache", Apache has 
evolved from a single project into an umbrella organization that host a 
number of projects, including httpd, mod_python, Tomcat, SpamAssassin, 
and more:

  http://www.apache.org/

The mod_python software is dependent on httpd:

  http://httpd.apache.org/

Tomcat is entirely different software. You must install httpd to use 
mod_python.

From nlv11281 at natlab.research.philips.com  Thu Sep  7 08:40:41 2006
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Thu Sep  7 08:41:16 2006
Subject: [mod_python] Mod-Python Help
In-Reply-To: <17770.69.236.163.99.1157608534.squirrel@webmail.ethanton.com>
References: <506kiDsbl1476S06.1157394518@cmsweb06.cms.usa.net>	<c298f2d70609041141j3883d555pef8b887bb527cc39@mail.gmail.com>	<17454.69.236.163.99.1157414619.squirrel@webmail.ethanton.com>	<1157589578.5516.14.camel@anthracite.dev.neuraliq.com>	<BB46BF13-E6E5-49AA-9CF6-71EBE8D53937@dscpl.com.au>
	<17770.69.236.163.99.1157608534.squirrel@webmail.ethanton.com>
Message-ID: <45001349.5090600@natlab.research.philips.com>

> Thanks for the help. My packet sniffer is looking at the packets, and instead
> of a new packet header, all these req.flush() calls are keeping the
> connection
> alive. Unfortunately, the javascript xmlhttprequest will only process the
> packet once, instead of during every call to req.flush().

In fact, the TCP connection will outlive the HTTP request if you use 
KeepAlive (which is default on HTTP/1.1).

The problem is not with mod_python, it's with your xmlhttprequest. If 
that reads from the request until the end, you have to change it and 
make it do something before the stream ends.

> Is there a way to close the connection and open it again afterwards? I'm
> trying to get the xmlhttprequest.onreadystatechange to process after each
> call
> to req.flush().

Yes, there's a very simple way. Just send a new HTTP request for every 
"chunk" you want to process.

Note that ONLY the client can OPEN connections. Both client and server 
may close connections as they see fit. So if you want to open a 
connection, you must do so at the client side. Once closed (by any side) 
a connection can never be re-opened and you'll have to make a new one.

Mike.

From list at joreybump.com  Thu Sep  7 10:24:05 2006
From: list at joreybump.com (Jorey Bump)
Date: Thu Sep  7 10:24:29 2006
Subject: [mod_python] installing on JBoss
In-Reply-To: <E3E70822E856B2408D0901EFC4A24AD906444E@server.yadata.com>
References: <E3E70822E856B2408D0901EFC4A24AD906444E@server.yadata.com>
Message-ID: <45002B85.5030409@joreybump.com>

Yehuda Rajuan wrote:
> How do I keep my responses on the list, just answer there and mail to
> everyone?

I usually click on Reply All (I normally use Thunderbird), and delete 
all of the addresses except the list's, unless I feel it's important to 
CC the sender (who will end up getting a duplicate, but might want to 
see the message sooner than they would normally check list traffic). 
There are better ways, but I do it this way because I subscribe to a 
number of lists that act differently or don't follow mailing list standards.

> Can I link between httpd and Jboss so I would not have two servers
> running, just to use python.

I assume so. I don't use Jboss, but I use Jrun (for ColdFusion) on some 
servers, and install a connector, which is just another Apache module.

> My task is to ad python to my Jboss application server so java and
> python can exchange data easily.

I encourage you to try mod_python, but you may not need it, unless you 
want to build some kind of web service that uses existing Python code 
you've written. You might also want to look at Jython, which is Python 
written in Java:

  http://www.jython.org/Project/index.html

I've never used it, but if you're simply looking for Java/Python 
integration, it's worth a peek.

From nicolas at lehuen.com  Thu Sep  7 14:08:49 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Thu Sep  7 14:08:58 2006
Subject: [mod_python] installing on JBoss
In-Reply-To: <45002B85.5030409@joreybump.com>
References: <E3E70822E856B2408D0901EFC4A24AD906444E@server.yadata.com>
	<45002B85.5030409@joreybump.com>
Message-ID: <c298f2d70609071108l1a89bbeeld9cc0fbac2aceeee@mail.gmail.com>

2006/9/7, Jorey Bump <list@joreybump.com>:
>
> Yehuda Rajuan wrote:
> > How do I keep my responses on the list, just answer there and mail to
> > everyone?
>
> I usually click on Reply All (I normally use Thunderbird), and delete
> all of the addresses except the list's, unless I feel it's important to
> CC the sender (who will end up getting a duplicate, but might want to
> see the message sooner than they would normally check list traffic).
> There are better ways, but I do it this way because I subscribe to a
> number of lists that act differently or don't follow mailing list
> standards.


MailMan is intelligent enough to notice that you have individually CCed some
people and not send them a duplicate of the message. The end result is that
you can always safely use the Reply to all function, nobody will get any
duplicate message, whatever their recipient list is.

Regards,
Nicolas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060907/71753c80/attachment.html
From Mary.Boholst at iop.kcl.ac.uk  Fri Sep  8 07:30:02 2006
From: Mary.Boholst at iop.kcl.ac.uk (Mary Jane Boholst)
Date: Fri Sep  8 07:27:20 2006
Subject: [mod_python] problems with apxs in suse 10.1
Message-ID: <4501543A.8010602@iop.kcl.ac.uk>

Hi,
I am a newbie to linux and have been trying unsuccessfully to install 
mod_python. I keep getting an error message regarding the apxs, i.e. it 
is not found or not executable. I have tried to see if the file is on 
the system but it appears it is not. Is there anywhere where I could get 
this file for suse 10.1 from? Any help with this would be gratefully 
received.
MJ
From jpg at jgassociates.ca  Fri Sep  8 08:16:26 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep  8 08:16:54 2006
Subject: [mod_python] problems with apxs in suse 10.1
In-Reply-To: <4501543A.8010602@iop.kcl.ac.uk>
References: <4501543A.8010602@iop.kcl.ac.uk>
Message-ID: <45015F1A.1000605@jgassociates.ca>

Mary Jane Boholst wrote:
> Hi,
> I am a newbie to linux and have been trying unsuccessfully to install 
> mod_python. I keep getting an error message regarding the apxs, i.e. it 
> is not found or not executable. I have tried to see if the file is on 
> the system but it appears it is not. Is there anywhere where I could get 
> this file for suse 10.1 from? Any help with this would be gratefully 
> received.
> MJ

Hi MJ,

I'm not familiar with the SUSE packaging for apache, but in Debian apxs 
(called apxs2 for Apache 2.0) comes with the development packages - 
either apache2-perfork-dev or apache2-threaded-dev, depending on which 
mpm you are using. I suspect it would be similar on SUSE. These packages 
also contain the apache header files which you will need to compile 
mod_python.

Jim

From dummy at habmalnefrage.de  Sun Sep 10 17:45:22 2006
From: dummy at habmalnefrage.de (dummy@habmalnefrage.de)
Date: Sun Sep 10 17:45:28 2006
Subject: [mod_python] crash with apache 2.2.3
Message-ID: <20060910214522.181670@gmx.net>

Hi all,

I have build apache 2.2.3 and mod_python 3.2.10 from suse src rpms and after calling the first python programm the server crashed with the debug output attached below.

If I compile apache 2.2.3 and mod_python vanilla plain with simple configure/make/make install the server works fine and didn't crash.

Can anybody take the debug output and interpret why the server crashed ?

Regards,
Dirk
-- 


"Feel free" ? 10 GB Mailbox, 100 FreeSMS/Monat ...
Jetzt GMX TopMail testen: http://www.gmx.net/de/go/topmail
-------------- next part --------------
A non-text attachment was scrubbed...
Name: notes
Type: application/octet-stream
Size: 1854 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060910/93b402b4/notes.obj
From grahamd at dscpl.com.au  Sun Sep 10 18:22:14 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sun Sep 10 18:22:19 2006
Subject: [mod_python] crash with apache 2.2.3
Message-ID: <1157926934.4358@dscpl.user.openhosting.com>

dummy@habmalnefrage.de wrote ..
> Hi all,
> 
> I have build apache 2.2.3 and mod_python 3.2.10 from suse src rpms and
> after calling the first python programm the server crashed with the debug
> output attached below.
> 
> If I compile apache 2.2.3 and mod_python vanilla plain with simple configure/make/make
> install the server works fine and didn't crash.
> 
> Can anybody take the debug output and interpret why the server crashed

Debugger output doesn't particularly help much.

My first thought though is whether the version of mod_python was actually
built for that version of Apache and Apache runtime libraries. Second thought
is whether there is a mix of packages being used which do and don't support
64 bit.

BTW, how simple was your mod_python test handler, was it a really basic hello
world or something else?

Graham
From Mary.Boholst at iop.kcl.ac.uk  Mon Sep 11 11:13:59 2006
From: Mary.Boholst at iop.kcl.ac.uk (Mary Jane Boholst)
Date: Mon Sep 11 11:11:17 2006
Subject: [mod_python] [SPAM] hello world program problems
Message-ID: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>


Hello again,
I have since the last time managed to get mod_python setup in suse 10.1
but I am having problems with running the hello world test. When I
access the localhost address I get a pop up box asking me if I want to
save or open the file which is just the source code that I have
entered. I am sure I saw the solution to this on this mailing list
somewhere but cant seem to find it again.
I am using Python 2.4, Apache 2.2 and mod_python 3.2.1.
I attach my httpd.conf file if that will help.
Thanks in advance.
MJ

-------------- next part --------------
A non-text attachment was scrubbed...
Name: httpd.conf
Type: text/x-c++hdr
Size: 8253 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060911/5f18ba9e/httpd.bin
From pfunix at gmail.com  Mon Sep 11 12:21:19 2006
From: pfunix at gmail.com (edgar mortiz)
Date: Mon Sep 11 12:21:23 2006
Subject: [mod_python] mod_python on OpenBSD
Message-ID: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>

hello guys. was wondering if any of you can help me out on building
mod_python. I have the following configuration

OpenBSD 3.9

Python 2.4 (source build) --disabled-share
Apache 2.0.59 --enable-so
mod_python 3.2.10 --with-apxs

I was successfully able to build python and apache from source my only
problem is whenever i build mod_python it breaks during make install.
here's how i build mod_python


./configure --with-apxs=/web/httpd/bin/apxs

it looks like I'm missing something else that is not on my openbsd
box. and i was wondering if someone here can help me out to determine
what is needed.


1.) For a Python (source) build what is needed by mod_python?

here's my make install output

# make install

Compiling for DSO.

/usr/chroot/httpd/bin/apxs
-I/usr/chroot/src/mod_python-3.2.10/src/include -I/us
r/chroot/httpd/include -I/usr/local/include/python2.4 -c mod_python.c
_apachemod ule.c requestobject.c tableobject.c util.c  serverobject.c
connobject.c filterob ject.c hlist.c hlistobject.c
-L/usr/local/lib/python2.4/config  -Wl,--export-dyn amic -lm
-lpython2.4   -lpthread  -lutil   -lm
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HA VE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/i nclude  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include  -I/usr/chroot
/src/mod_python-3.2.10/src/include -I/usr/chroot/httpd/include
-I/usr/local/incl ude/python2.4  -c -o mod_python.lo mod_python.c &&
touch mod_python.slo
mod_python.c: In function `python_cleanup':
mod_python.c:313: warning: passing arg 1 of `free' discards qualifiers
from poin ter target type
mod_python.c: In function `init_mutexes':
mod_python.c:427: warning: assignment discards qualifiers from pointer
target ty pe
mod_python.c:458: warning: assignment discards qualifiers from pointer
target ty pe
mod_python.c: In function `reinit_mutexes':
mod_python.c:540: warning: assignment discards qualifiers from pointer
target ty pe
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
_apachemodule.lo _apachemodule.c && touch _apachemodule.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
requestobject.lo requestobject.c && touch requestobject.slo
requestobject.c: In function `req_get_options':
requestobject.c:426: warning: initialization discards qualifiers from
pointer target type
requestobject.c:427: warning: initialization from incompatible pointer type
requestobject.c: In function `getmakeobj':
requestobject.c:1447: warning: assignment from incompatible pointer type
requestobject.c:1454: warning: assignment from incompatible pointer type
requestobject.c: In function `request_tp_clear':
requestobject.c:1569: warning: assignment from incompatible pointer type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
tableobject.lo tableobject.c && touch tableobject.slo
tableobject.c:1057: warning: initialization from incompatible pointer type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
util.lo util.c && touch util.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
serverobject.lo serverobject.c && touch serverobject.slo
serverobject.c:351: warning: initialization from incompatible pointer type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
connobject.lo connobject.c && touch connobject.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
filterobject.lo filterobject.c && touch filterobject.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
hlist.lo hlist.c && touch hlist.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic  -DAP_HAVE_DESIGNATED_INITIALIZER -D_POSIX_THREADS -g -O2
-pthread -I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
hlistobject.lo hlistobject.c && touch hlistobject.slo
/usr/chroot/httpd/build/libtool --silent --mode=link gcc -o
mod_python.la  -rpath /usr/chroot/httpd/modules -module -avoid-version
   hlistobject.lo hlist.lo filterobject.lo connobject.lo
serverobject.lo util.lo tableobject.lo requestobject.lo
_apachemodule.lo mod_python.lo -L/usr/local/lib/python2.4/config
-Wl,--export-dynamic -lm -lpython2.4 -lpthread -lutil -lm

*** Warning: linker path does not have real file for library -lpython2.4.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have
*** because I did check the linker path looking for a file starting
*** with libpython2.4 but no candidates were found. (...for regex pattern test)

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.
`psp_parser.c' is up to date.
/usr/local/bin/python setup.py build
/usr/local/bin/python: not found
*** Error code 1

Stop in /usr/chroot/src/mod_python-3.2.10/dist (line 24 of Makefile).
*** Error code 1

Stop in /usr/chroot/src/mod_python-3.2.10 (line 32 of Makefile).
*** Error code 1

Stop in /usr/chroot/src/mod_python-3.2.10 (line 56 of Makefile).


any help will be greatly appreciated.


-ed
From list at joreybump.com  Mon Sep 11 12:30:01 2006
From: list at joreybump.com (Jorey Bump)
Date: Mon Sep 11 12:30:06 2006
Subject: [mod_python] mod_python on OpenBSD
In-Reply-To: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>
References: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>
Message-ID: <45058F09.8040508@joreybump.com>

edgar mortiz wrote:

> Python 2.4 (source build) --disabled-share

> ./configure --with-apxs=/web/httpd/bin/apxs

Look at --with-python:

http://www.modpython.org/live/current/doc-html/inst-configure.html

From jpg at jgassociates.ca  Mon Sep 11 14:59:19 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Mon Sep 11 14:59:22 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
Message-ID: <4505B207.90106@jgassociates.ca>

Does the mod_python signature show up in your apache error.log?

    If no, have you modified your apache config to load the module? You 
need something like:

    LoadModule python_module /usr/lib/apache2/modules/mod_python.so
    (The path /usr/lib/apache2/modules may be different on your system).

If yes, where are you configuring the mod_python handler? If you are 
using a .htaccess file, make sure AllowOverride is set properly.
   (AllowOverride All is good for testing).


Jim

Mary Jane Boholst wrote:
> Hello again,
> I have since the last time managed to get mod_python setup in suse 10.1
> but I am having problems with running the hello world test. When I
> access the localhost address I get a pop up box asking me if I want to
> save or open the file which is just the source code that I have
> entered. I am sure I saw the solution to this on this mailing list
> somewhere but cant seem to find it again.
> I am using Python 2.4, Apache 2.2 and mod_python 3.2.1.
> I attach my httpd.conf file if that will help.
> Thanks in advance.
> MJ
> 
From grahamd at dscpl.com.au  Tue Sep 12 02:26:01 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 12 02:25:37 2006
Subject: [mod_python] crash with apache 2.2.3
In-Reply-To: <450586FF.6020306@datzert.de>
References: <1157926934.4358@dscpl.user.openhosting.com>
	<450586FF.6020306@datzert.de>
Message-ID: <9653E8C0-6CE1-4731-990B-5C1F2C61584F@dscpl.com.au>

I have pushed your response back onto the mailing list as it doesn't
give me any more ideas. Please try and keep followups on the mailing
list in case others can also help.

All I can say is that I have never seen so many configure options being
used. Do you really need to try and override so much stuff??

Graham

On 12/09/2006, at 1:55 AM, dirk wrote:

> Hi Graham,
>
> the simplest test case was:
>
> httpd.conf.local
>
> <Location /mpinfo>
>  SetHandler mod_python
>  PythonHandler mod_python.testhandler
> </Location>
>
> or
>
> <Location /mpinfo>
>  SetHandler python-program
>  PythonHandler mod_python.testhandler
> </Location>
>
> I compiled the packages (apache2, mod_python) both for i586.
>
> apache2 configure:
>
>  $ ./configure --enable-maintainer-mode --enable-so --enable- 
> layout=SuSE81 --with-program-name=httpd2-event --with-apr=/usr/bin/ 
> apr-1-config --with-apr-util=/usr/bin/apu-1-config --with-mpm=event  
> --enable-exception-hook --enable-mods-shared=all --enable- 
> ssl=shared --disable-isapi --enable-deflate --enable-echo --enable- 
> filter --enable-ext-filter --enable-charset-lite --enable-file- 
> cache --enable-logio --enable-dumpio --enable-bucketeer --enable- 
> case_filter --enable-case_filter_in --with-ldap --enable-ldap -- 
> enable-authnz_ldap --enable-proxy --enable-proxy-connect --enable- 
> proxy-ftp --enable-proxy-http --enable-cache --enable-disk-cache -- 
> enable-mem-cache --enable-dav-lock --enable-authn-alias --enable- 
> optional-hook-export --enable-optional-hook-import --enable- 
> optional-fn-import --enable-optional-fn-export --enable-suexec -- 
> with-suexec-bin=/usr/sbin/suexec2 --with-suexec-caller=wwwrun -- 
> with-suexec-docroot=/srv/www --with-suexec-logfile=/var/log/apache2/ 
> suexec.log --with-suexec-userdir=public_html --with-suexec- 
> uidmin=96 --with-suexec-gidmin=96 --with-suexec-safepath=/usr/local/ 
> bin:/usr/bin:/bin
>
> mod_python configure:
>
>  $ ./configure --with-apxs=/usr/sbin/apxs2 --libdir=/usr/lib
>
> Regards,
> Dirk
>
>
> Graham Dumpleton schrieb:
>> dummy@habmalnefrage.de wrote ..
>>
>>> Hi all,
>>>
>>> I have build apache 2.2.3 and mod_python 3.2.10 from suse src  
>>> rpms and
>>> after calling the first python programm the server crashed with  
>>> the debug
>>> output attached below.
>>>
>>> If I compile apache 2.2.3 and mod_python vanilla plain with  
>>> simple configure/make/make
>>> install the server works fine and didn't crash.
>>>
>>> Can anybody take the debug output and interpret why the server  
>>> crashed
>>>
>>
>> Debugger output doesn't particularly help much.
>>
>> My first thought though is whether the version of mod_python was  
>> actually
>> built for that version of Apache and Apache runtime libraries.  
>> Second thought
>> is whether there is a mix of packages being used which do and  
>> don't support
>> 64 bit.
>>
>> BTW, how simple was your mod_python test handler, was it a really  
>> basic hello
>> world or something else?
>>
>> Graham
>>
>>
>>
>>
From grahamd at dscpl.com.au  Tue Sep 12 02:34:20 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 12 02:33:42 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <4505B207.90106@jgassociates.ca>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
	<4505B207.90106@jgassociates.ca>
Message-ID: <1FFA6CDA-3C39-44C4-900A-0D3CA4E36E55@dscpl.com.au>

For a more detailed guide on setting up a first hello world test also  
see:

   http://www.dscpl.com.au/articles/modpython-001.html

That your attached httpd.conf file does not load the mod_python module
would be a good fix to resolve first as Jim points out.

Graham

On 12/09/2006, at 4:59 AM, Jim Gallacher wrote:

> Does the mod_python signature show up in your apache error.log?
>
>    If no, have you modified your apache config to load the module?  
> You need something like:
>
>    LoadModule python_module /usr/lib/apache2/modules/mod_python.so
>    (The path /usr/lib/apache2/modules may be different on your  
> system).
>
> If yes, where are you configuring the mod_python handler? If you  
> are using a .htaccess file, make sure AllowOverride is set properly.
>   (AllowOverride All is good for testing).
>
>
> Jim
>
> Mary Jane Boholst wrote:
>> Hello again,
>> I have since the last time managed to get mod_python setup in suse  
>> 10.1
>> but I am having problems with running the hello world test. When I
>> access the localhost address I get a pop up box asking me if I  
>> want to
>> save or open the file which is just the source code that I have
>> entered. I am sure I saw the solution to this on this mailing list
>> somewhere but cant seem to find it again.
>> I am using Python 2.4, Apache 2.2 and mod_python 3.2.1.
>> I attach my httpd.conf file if that will help.
>> Thanks in advance.
>> MJ
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From rsynnott at gmail.com  Tue Sep 12 05:56:24 2006
From: rsynnott at gmail.com (Robert Synnott)
Date: Tue Sep 12 05:56:29 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
Message-ID: <24f203480609120256i41232e10jc5d4eecda692fb7c@mail.gmail.com>

On 9/11/06, Mary Jane Boholst <Mary.Boholst@iop.kcl.ac.uk> wrote:
>
> Hello again,
> I have since the last time managed to get mod_python setup in suse 10.1
> but I am having problems with running the hello world test. When I
> access the localhost address I get a pop up box asking me if I want to
> save or open the file which is just the source code that I have
> entered. I am sure I saw the solution to this on this mailing list
> somewhere but cant seem to find it again.
> I am using Python 2.4, Apache 2.2 and mod_python 3.2.1.
> I attach my httpd.conf file if that will help.
> Thanks in advance.
> MJ
>
>
I'm moderately certain that mod_python 3.2.1 doesn't support Apache
2.2. You'll need mod_python 3.2.10.
Rob
From grahamd at dscpl.com.au  Tue Sep 12 06:13:31 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 12 06:12:51 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <24f203480609120256i41232e10jc5d4eecda692fb7c@mail.gmail.com>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
	<24f203480609120256i41232e10jc5d4eecda692fb7c@mail.gmail.com>
Message-ID: <604B7BF3-C49F-40BF-B9D6-5239725E3EF2@dscpl.com.au>


On 12/09/2006, at 7:56 PM, Robert Synnott wrote:

> On 9/11/06, Mary Jane Boholst <Mary.Boholst@iop.kcl.ac.uk> wrote:
>>
>> Hello again,
>> I have since the last time managed to get mod_python setup in suse  
>> 10.1
>> but I am having problems with running the hello world test. When I
>> access the localhost address I get a pop up box asking me if I  
>> want to
>> save or open the file which is just the source code that I have
>> entered. I am sure I saw the solution to this on this mailing list
>> somewhere but cant seem to find it again.
>> I am using Python 2.4, Apache 2.2 and mod_python 3.2.1.
>> I attach my httpd.conf file if that will help.
>> Thanks in advance.
>> MJ
>>
>>
> I'm moderately certain that mod_python 3.2.1 doesn't support Apache
> 2.2. You'll need mod_python 3.2.10.

Version 3.2.1 of mod_python was never released, so I'd say they meant
to say 3.2.10.

Graham
From Mary.Boholst at iop.kcl.ac.uk  Tue Sep 12 08:40:10 2006
From: Mary.Boholst at iop.kcl.ac.uk (Mary Jane Boholst)
Date: Tue Sep 12 08:38:55 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <4505B207.90106@jgassociates.ca>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>
	<4505B207.90106@jgassociates.ca>
Message-ID: <200609121340.11564.Mary.Boholst@iop.kcl.ac.uk>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
</head>
<body bgcolor="#ffffff" text="#000000">
Hi,<br>
mod_python does show in the apache error.log.<br>
I am using the httpd.conf file to configure the mod_python handler. The hello 
<br> world program is still not working as expected. I feel like I am just 
missing something simple. 
 <br>
Thanks for all your help.<br>
MJ<br>
Jim Gallacher wrote:
<blockquote cite="mid4505B207.90106@jgassociates.ca" type="cite">Does
the mod_python signature show up in your apache error.log?
  <br>
  <br>
&nbsp;&nbsp; If no, have you modified your apache config to load the module? 
You
need something like:
  <br>
  <br>
&nbsp;&nbsp; LoadModule python_module /usr/lib/apache2/modules/mod_python.so
  <br>
&nbsp;&nbsp; (The path /usr/lib/apache2/modules may be different on your 
system).
  <br>
  <br>
If yes, where are you configuring the mod_python handler? If you are
using a .htaccess file, make sure AllowOverride is set properly.
  <br>
&nbsp; (AllowOverride All is good for testing).
  <br>
  <br>
  <br>
Jim
  <br>
  <br>
Mary Jane Boholst wrote:
  <br>
  <blockquote type="cite">Hello again,
    <br>
I have since the last time managed to get mod_python setup in suse 10.1
    <br>
but I am having problems with running the hello world test. When I
    <br>
access the localhost address I get a pop up box asking me if I want to
    <br>
save or open the file which is just the source code that I have
    <br>
entered. I am sure I saw the solution to this on this mailing list
    <br>
somewhere but cant seem to find it again.
    <br>
I am using Python 2.4, Apache 2.2 and mod_python 3.2.1.
    <br>
I attach my httpd.conf file if that will help.
    <br>
Thanks in advance.
    <br>
MJ
    <br>
    <br>
  </blockquote>
</blockquote>
<br>
</body>
</html>

From jpg at jgassociates.ca  Tue Sep 12 08:56:55 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Tue Sep 12 08:57:44 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <200609121340.11564.Mary.Boholst@iop.kcl.ac.uk>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>	<4505B207.90106@jgassociates.ca>
	<200609121340.11564.Mary.Boholst@iop.kcl.ac.uk>
Message-ID: <4506AE97.8090707@jgassociates.ca>

Please don't send HTML messages to the list.

Mary Jane Boholst wrote:

> Hi,<br>
> mod_python does show in the apache error.log.<br>
> I am using the httpd.conf file to configure the mod_python handler.

Are you sure? There was no such configuration in the httpd.conf file 
attached to your original message. Perhaps you could send the snippet 
containing that part again (not the whole httpd.conf).

Jim
From Mary.Boholst at iop.kcl.ac.uk  Tue Sep 12 09:13:48 2006
From: Mary.Boholst at iop.kcl.ac.uk (Mary Jane Boholst)
Date: Tue Sep 12 09:12:01 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <4506AE97.8090707@jgassociates.ca>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>	<4505B207.90106@jgassociates.ca>
	<200609121340.11564.Mary.Boholst@iop.kcl.ac.uk>
	<4506AE97.8090707@jgassociates.ca>
Message-ID: <4506B28C.1080802@iop.kcl.ac.uk>

Jim Gallacher wrote:
> Please don't send HTML messages to the list.
>
> Mary Jane Boholst wrote:
>
>> Hi,<br>
>> mod_python does show in the apache error.log.<br>
>> I am using the httpd.conf file to configure the mod_python handler.
>
> Are you sure? There was no such configuration in the httpd.conf file 
> attached to your original message. Perhaps you could send the snippet 
> containing that part again (not the whole httpd.conf).
>
> Jim
Hi again,
Sorry about the html. The python handler snippet is as on the 
http://modpythin.org/live/current/doc-html/inst-testing.html:
LoadModule python_module /usr/lib/python2.4/site-packages/mod-python.so
<Directory /srv/www/htdocs/test>
    AddHandler mod_python .py
    PythonHandler mptest
    PythonDebug on
</Directory>
The only other thing that I can think that could be a problem is that I 
used the command apt-get install apache2-mod_python which perhaps 
dowloaded and installed a different package? Maybe I am just clutching 
at straws.
Thanks again.
MJ

From pfunix at gmail.com  Tue Sep 12 12:44:22 2006
From: pfunix at gmail.com (edgar mortiz)
Date: Tue Sep 12 12:44:27 2006
Subject: [mod_python] mod_python on OpenBSD
In-Reply-To: <45058F09.8040508@joreybump.com>
References: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>
	<45058F09.8040508@joreybump.com>
Message-ID: <e02ea4ef0609120944y7f5cd734g8394e3c64402809c@mail.gmail.com>

thanks for the tip. I was able to build mod_python successfully after
updating flex. but i guess im still missing something.

after i finished the build i added

LoadModule python_module modules/mod_python.so

as indicated on the docs but when i start up apache i get this

# bin/apachectl start
Syntax error on line 233 of /httpd/conf/httpd.conf:
Cannot load /httpd/modules/mod_python.so into server: Can't open file

i checked out /httpd/modules and there's no mod_python.so on it i
tried copying the one that is on my mod_python/src/mod_python.so and
reload apache but with no luck. any ideas guys?


-Ed



On 9/11/06, Jorey Bump <list@joreybump.com> wrote:
> edgar mortiz wrote:
>
> > Python 2.4 (source build) --disabled-share
>
> > ./configure --with-apxs=/web/httpd/bin/apxs
>
> Look at --with-python:
>
> http://www.modpython.org/live/current/doc-html/inst-configure.html
>
>
From list at joreybump.com  Tue Sep 12 13:14:52 2006
From: list at joreybump.com (Jorey Bump)
Date: Tue Sep 12 13:14:56 2006
Subject: [mod_python] mod_python on OpenBSD
In-Reply-To: <e02ea4ef0609120944y7f5cd734g8394e3c64402809c@mail.gmail.com>
References: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>	<45058F09.8040508@joreybump.com>
	<e02ea4ef0609120944y7f5cd734g8394e3c64402809c@mail.gmail.com>
Message-ID: <4506EB0C.3040407@joreybump.com>

edgar mortiz wrote:

> # bin/apachectl start
> Syntax error on line 233 of /httpd/conf/httpd.conf:

This path:

> Cannot load /httpd/modules/mod_python.so into server: Can't open file

Doesn't match this path:

>> > ./configure --with-apxs=/web/httpd/bin/apxs

Is there a reason for this? I don't know how OpenBSD installs apache.
Do you have both 1.3.x and 2.0.x installed?
From grahamd at dscpl.com.au  Tue Sep 12 18:39:07 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 12 18:38:24 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <4506B28C.1080802@iop.kcl.ac.uk>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>	<4505B207.90106@jgassociates.ca>
	<200609121340.11564.Mary.Boholst@iop.kcl.ac.uk>
	<4506AE97.8090707@jgassociates.ca> <4506B28C.1080802@iop.kcl.ac.uk>
Message-ID: <EB64452C-92D3-44A9-BA70-DEB4E7C7B464@dscpl.com.au>


On 12/09/2006, at 11:13 PM, Mary Jane Boholst wrote:

> Jim Gallacher wrote:
>> Please don't send HTML messages to the list.
>>
>> Mary Jane Boholst wrote:
>>
>>> Hi,<br>
>>> mod_python does show in the apache error.log.<br>
>>> I am using the httpd.conf file to configure the mod_python handler.
>>
>> Are you sure? There was no such configuration in the httpd.conf  
>> file attached to your original message. Perhaps you could send the  
>> snippet containing that part again (not the whole httpd.conf).
>>
>> Jim
> Hi again,
> Sorry about the html. The python handler snippet is as on the  
> http://modpythin.org/live/current/doc-html/inst-testing.html:
> LoadModule python_module /usr/lib/python2.4/site-packages/mod- 
> python.so
> <Directory /srv/www/htdocs/test>
>    AddHandler mod_python .py
>    PythonHandler mptest
>    PythonDebug on
> </Directory>
> The only other thing that I can think that could be a problem is  
> that I used the command apt-get install apache2-mod_python which  
> perhaps dowloaded and installed a different package? Maybe I am  
> just clutching at straws.

Have you tried yet the alternate instructions at:

   http://www.dscpl.com.au/articles/modpython-001.html

that I sent you?

These alternate instructions use a different means of configuring Apache
and tell you what to check at each point when things don't go wrong. If
you use the alternate instructions, it might help you to in turn work  
out
why the current way you are doing it doesn't work.

Graham
From pfunix at gmail.com  Wed Sep 13 00:40:44 2006
From: pfunix at gmail.com (edgar mortiz)
Date: Wed Sep 13 00:40:47 2006
Subject: [mod_python] mod_python on OpenBSD
In-Reply-To: <e02ea4ef0609121333v2fd76a14v4782571c2dbdc841@mail.gmail.com>
References: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>
	<45058F09.8040508@joreybump.com>
	<e02ea4ef0609120944y7f5cd734g8394e3c64402809c@mail.gmail.com>
	<4506EB0C.3040407@joreybump.com>
	<e02ea4ef0609121333v2fd76a14v4782571c2dbdc841@mail.gmail.com>
Message-ID: <e02ea4ef0609122140p1ce66c5fs6a31103a880acb48@mail.gmail.com>

it seems that whenever i do a make install no files are getting
coppied to the modules folder on  apache.

this is a bit frustrating. is ther any way to build python via static
instead of the regular DSO (even if it says on the docs that DSO is
the only think that is available)


any help will be greatly appreciated.

-eD

On 9/12/06, edgar mortiz <pfunix@gmail.com> wrote:
> sorry about the confusion the --with-apxs=/web/httpd the first time i
> did it (this was when building mod_python breaks during 'make
> install')
>
> the new one i did is on /httpd so my apxs would be in /httpd/bin/apxs
>
> -ed
>
> On 9/12/06, Jorey Bump <list@joreybump.com> wrote:
> > edgar mortiz wrote:
> >
> > > # bin/apachectl start
> > > Syntax error on line 233 of /httpd/conf/httpd.conf:
> >
> > This path:
> >
> > > Cannot load /httpd/modules/mod_python.so into server: Can't open file
> >
> > Doesn't match this path:
> >
> > >> > ./configure --with-apxs=/web/httpd/bin/apxs
> >
> > Is there a reason for this? I don't know how OpenBSD installs apache.
> > Do you have both 1.3.x and 2.0.x installed?
> >
>
From grahamd at dscpl.com.au  Wed Sep 13 01:11:26 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep 13 01:12:26 2006
Subject: [mod_python] mod_python on OpenBSD
In-Reply-To: <e02ea4ef0609122140p1ce66c5fs6a31103a880acb48@mail.gmail.com>
References: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>
	<45058F09.8040508@joreybump.com>
	<e02ea4ef0609120944y7f5cd734g8394e3c64402809c@mail.gmail.com>
	<4506EB0C.3040407@joreybump.com>
	<e02ea4ef0609121333v2fd76a14v4782571c2dbdc841@mail.gmail.com>
	<e02ea4ef0609122140p1ce66c5fs6a31103a880acb48@mail.gmail.com>
Message-ID: <C49FF6C4-C507-443A-BB89-8D888A36691C@dscpl.com.au>

Run:

   make install_dso

Copy and paste the output here so we can see where it is trying to  
install
it. Also tell us where it is meant to be going.

Does the user you are running the install as, have permission to install
in that location.

Graham

On 13/09/2006, at 2:40 PM, edgar mortiz wrote:

> it seems that whenever i do a make install no files are getting
> coppied to the modules folder on  apache.
>
> this is a bit frustrating. is ther any way to build python via static
> instead of the regular DSO (even if it says on the docs that DSO is
> the only think that is available)
>
>
> any help will be greatly appreciated.
>
> -eD
>
> On 9/12/06, edgar mortiz <pfunix@gmail.com> wrote:
>> sorry about the confusion the --with-apxs=/web/httpd the first time i
>> did it (this was when building mod_python breaks during 'make
>> install')
>>
>> the new one i did is on /httpd so my apxs would be in /httpd/bin/apxs
>>
>> -ed
>>
>> On 9/12/06, Jorey Bump <list@joreybump.com> wrote:
>> > edgar mortiz wrote:
>> >
>> > > # bin/apachectl start
>> > > Syntax error on line 233 of /httpd/conf/httpd.conf:
>> >
>> > This path:
>> >
>> > > Cannot load /httpd/modules/mod_python.so into server: Can't  
>> open file
>> >
>> > Doesn't match this path:
>> >
>> > >> > ./configure --with-apxs=/web/httpd/bin/apxs
>> >
>> > Is there a reason for this? I don't know how OpenBSD installs  
>> apache.
>> > Do you have both 1.3.x and 2.0.x installed?
>> >
>>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From Mary.Boholst at iop.kcl.ac.uk  Wed Sep 13 04:08:03 2006
From: Mary.Boholst at iop.kcl.ac.uk (Mary Jane Boholst)
Date: Wed Sep 13 04:05:07 2006
Subject: [mod_python] [SPAM] hello world program problems
In-Reply-To: <EB64452C-92D3-44A9-BA70-DEB4E7C7B464@dscpl.com.au>
References: <200609111613.59293.Mary.Boholst@iop.kcl.ac.uk>	<4505B207.90106@jgassociates.ca>
	<200609121340.11564.Mary.Boholst@iop.kcl.ac.uk>
	<4506AE97.8090707@jgassociates.ca> <4506B28C.1080802@iop.kcl.ac.uk>
	<EB64452C-92D3-44A9-BA70-DEB4E7C7B464@dscpl.com.au>
Message-ID: <4507BC63.3080202@iop.kcl.ac.uk>

Graham Dumpleton wrote:
>
> On 12/09/2006, at 11:13 PM, Mary Jane Boholst wrote:
>
>> Jim Gallacher wrote:
>>> Please don't send HTML messages to the list.
>>>
>>> Mary Jane Boholst wrote:
>>>
>>>> Hi,<br>
>>>> mod_python does show in the apache error.log.<br>
>>>> I am using the httpd.conf file to configure the mod_python handler.
>>>
>>> Are you sure? There was no such configuration in the httpd.conf file 
>>> attached to your original message. Perhaps you could send the 
>>> snippet containing that part again (not the whole httpd.conf).
>>>
>>> Jim
>> Hi again,
>> Sorry about the html. The python handler snippet is as on the 
>> http://modpythin.org/live/current/doc-html/inst-testing.html:
>> LoadModule python_module /usr/lib/python2.4/site-packages/mod-python.so
>> <Directory /srv/www/htdocs/test>
>>    AddHandler mod_python .py
>>    PythonHandler mptest
>>    PythonDebug on
>> </Directory>
>> The only other thing that I can think that could be a problem is that 
>> I used the command apt-get install apache2-mod_python which perhaps 
>> dowloaded and installed a different package? Maybe I am just 
>> clutching at straws.
>
> Have you tried yet the alternate instructions at:
>
>   http://www.dscpl.com.au/articles/modpython-001.html
>
> that I sent you?
>
> These alternate instructions use a different means of configuring Apache
> and tell you what to check at each point when things don't go wrong. If
> you use the alternate instructions, it might help you to in turn work out
> why the current way you are doing it doesn't work.
>
> Graham
Thanks. I checked the alternate instructions you gave after I sent the 
other post and I think that this is working now. Thank you very much for 
your help. Now to finally start programming!
Cheers,
MJ
From scarfboy at gmail.com  Wed Sep 13 20:01:12 2006
From: scarfboy at gmail.com (Bart)
Date: Wed Sep 13 20:01:18 2006
Subject: [mod_python] req.write and unicode
Message-ID: <b71082d80609131701r2554640dw45c3cf792979fbee@mail.gmail.com>

Hi all,

Apologies if this has been discussed before.
(the mod_python archives are a bit hard to search decisively)


I wonder whether req.write() really has to bork on unicode strings.
We have lovely no-worries pythonic unicode handling in python,
but in m_p you have to either .encode('utf8') on every single req.write,
or less redundantly with code perhaps like:

def handler():
 ret=[]
 # code
 ret.append('I am text')
 ret.append(u'I am \u2222 other text')
 # more code
 req.write( ''.join(ret).encode('utf8') )
 return apache.OK

(...which is of course sort of annoying if you do do occasionally
 want the write-and-flush ability, e.g. when the process is slow
 and you want immediate feedback)

(I believe this currently fails because the unicode.__str__
 uses the site.py encoding, which you can't always set)


Wouldn't it be relatively trivial to make the write function always
encode (unicode) strings according to a configured encoding?
(with a sane default like utf8, and settable via code, and
 also PythonOptions apache config so that there won't be a
 you-need-to-set-this-in-every-file requirement)



Of course, this isn't a problem with one true solution(tm),
because you still need to set content_type (now perhaps
with a default like "text/html; charset=utf-8") or something
still makes it work, but the suggestion still seems like
handier default behaviour.


This probably deserves some documentation attention anyway,
partly because the more intuitive-from-python "charset=utf8"
seems to be wrong (should be utf-8)


Poker of suggestions,
--Bart
From pfunix at gmail.com  Wed Sep 13 22:06:46 2006
From: pfunix at gmail.com (edgar mortiz)
Date: Wed Sep 13 22:06:49 2006
Subject: [mod_python] mod_python on OpenBSD
In-Reply-To: <C49FF6C4-C507-443A-BB89-8D888A36691C@dscpl.com.au>
References: <e02ea4ef0609110921l7432cabcw673e942658ae90ed@mail.gmail.com>
	<45058F09.8040508@joreybump.com>
	<e02ea4ef0609120944y7f5cd734g8394e3c64402809c@mail.gmail.com>
	<4506EB0C.3040407@joreybump.com>
	<e02ea4ef0609121333v2fd76a14v4782571c2dbdc841@mail.gmail.com>
	<e02ea4ef0609122140p1ce66c5fs6a31103a880acb48@mail.gmail.com>
	<C49FF6C4-C507-443A-BB89-8D888A36691C@dscpl.com.au>
Message-ID: <e02ea4ef0609131906x3b7359ccv83fa9adf367fe1e@mail.gmail.com>

Graham,

   I'm installing mod_python as root. I redid everything on the mod_python part

./configure --with-apxs=/usr/chroot/httpd/bin/apxs
--with-python=/usr/local/bin/python2.4
--with-flex=/usr/chroot/flex/bin/flex

gmake

# gmake install_dso
gmake[1]: Entering directory `/usr/chroot/src/mod_python-3.2.10/src'

Compiling for DSO.

/usr/chroot/httpd/bin/apxs
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4 -c
mod_python.c _apachemodule.c requestobject.c tableobject.c util.c
serverobject.c connobject.c filterobject.c hlist.c hlistobject.c
-L/usr/local/lib/python2.4/config  -Wl,--export-dynamic      -lm
-lpython2.4    -lutil   -lm
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
mod_python.lo mod_python.c && touch mod_python.slo
mod_python.c: In function `python_cleanup':
mod_python.c:313: warning: passing arg 1 of `free' discards qualifiers
from pointer target type
mod_python.c: In function `init_mutexes':
mod_python.c:427: warning: assignment discards qualifiers from pointer
target type
mod_python.c:458: warning: assignment discards qualifiers from pointer
target type
mod_python.c: In function `reinit_mutexes':
mod_python.c:540: warning: assignment discards qualifiers from pointer
target type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
_apachemodule.lo _apachemodule.c && touch _apachemodule.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
requestobject.lo requestobject.c && touch requestobject.slo
requestobject.c: In function `req_get_options':
requestobject.c:426: warning: initialization discards qualifiers from
pointer target type
requestobject.c:427: warning: initialization from incompatible pointer type
requestobject.c: In function `getmakeobj':
requestobject.c:1447: warning: assignment from incompatible pointer type
requestobject.c:1454: warning: assignment from incompatible pointer type
requestobject.c: In function `request_tp_clear':
requestobject.c:1569: warning: assignment from incompatible pointer type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
tableobject.lo tableobject.c && touch tableobject.slo
tableobject.c:1057: warning: initialization from incompatible pointer type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
util.lo util.c && touch util.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
serverobject.lo serverobject.c && touch serverobject.slo
serverobject.c:351: warning: initialization from incompatible pointer type
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
connobject.lo connobject.c && touch connobject.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
filterobject.lo filterobject.c && touch filterobject.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
hlist.lo hlist.c && touch hlist.slo
/usr/chroot/httpd/build/libtool --silent --mode=compile gcc
-prefer-pic   -D_POSIX_THREADS -g -O2 -pthread
-I/usr/chroot/httpd/include  -I/usr/chroot/httpd/include
-I/usr/chroot/httpd/include
-I/usr/chroot/src/mod_python-3.2.10/src/include
-I/usr/chroot/httpd/include -I/usr/local/include/python2.4  -c -o
hlistobject.lo hlistobject.c && touch hlistobject.slo
/usr/chroot/httpd/build/libtool --silent --mode=link gcc -o
mod_python.la  -rpath /usr/chroot/httpd/modules -module -avoid-version
   hlistobject.lo hlist.lo filterobject.lo connobject.lo
serverobject.lo util.lo tableobject.lo requestobject.lo
_apachemodule.lo mod_python.lo -L/usr/local/lib/python2.4/config
-Wl,--export-dynamic -lm -lpython2.4 -lutil -lm

*** Warning: linker path does not have real file for library -lpython2.4.
*** I have the capability to make that library automatically link in when
*** you link to this library.  But I can only do this if you have a
*** shared version of the library, which you do not appear to have
*** because I did check the linker path looking for a file starting
*** with libpython2.4 and none of the candidates passed a file format test
*** using a regex pattern. Last file checked:
/usr/local/lib/python2.4/config/libpython2.4.a

*** Warning: libtool could not satisfy all declared inter-library
*** dependencies of module mod_python.  Therefore, libtool will create
*** a static module, that should work as long as the dlopening
*** application is linked with the -dlopen flag.
gmake[1]: Leaving directory `/usr/chroot/src/mod_python-3.2.10/src'
gmake[1]: Entering directory `/usr/chroot/src/mod_python-3.2.10/dist'
gmake[2]: Entering directory `/usr/chroot/src/mod_python-3.2.10/src'
gmake[2]: `psp_parser.c' is up to date.
gmake[2]: Leaving directory `/usr/chroot/src/mod_python-3.2.10/src'
/usr/local/bin/python2.4 setup.py build
running build
running build_py
running build_ext
gmake[1]: Leaving directory `/usr/chroot/src/mod_python-3.2.10/dist'

Now su and make install
  (or, if you only want to perform a partial install,
   you can use make install_dso and make install_py_lib)


Performing DSO installation.

/usr/bin/install -c -d /usr/chroot/httpd/modules
/usr/bin/install -c src/mod_python.so /usr/chroot/httpd/modules
install: src/mod_python.so: No such file or directory
gmake: *** [install_dso] Error 71
#

it breaks when i do install_dso

-eD

On 9/12/06, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
> Run:
>
>    make install_dso
>
> Copy and paste the output here so we can see where it is trying to
> install
> it. Also tell us where it is meant to be going.
>
> Does the user you are running the install as, have permission to install
> in that location.
>
> Graham
>
> On 13/09/2006, at 2:40 PM, edgar mortiz wrote:
>
> > it seems that whenever i do a make install no files are getting
> > coppied to the modules folder on  apache.
> >
> > this is a bit frustrating. is ther any way to build python via static
> > instead of the regular DSO (even if it says on the docs that DSO is
> > the only think that is available)
> >
> >
> > any help will be greatly appreciated.
> >
> > -eD
> >
> > On 9/12/06, edgar mortiz <pfunix@gmail.com> wrote:
> >> sorry about the confusion the --with-apxs=/web/httpd the first time i
> >> did it (this was when building mod_python breaks during 'make
> >> install')
> >>
> >> the new one i did is on /httpd so my apxs would be in /httpd/bin/apxs
> >>
> >> -ed
> >>
> >> On 9/12/06, Jorey Bump <list@joreybump.com> wrote:
> >> > edgar mortiz wrote:
> >> >
> >> > > # bin/apachectl start
> >> > > Syntax error on line 233 of /httpd/conf/httpd.conf:
> >> >
> >> > This path:
> >> >
> >> > > Cannot load /httpd/modules/mod_python.so into server: Can't
> >> open file
> >> >
> >> > Doesn't match this path:
> >> >
> >> > >> > ./configure --with-apxs=/web/httpd/bin/apxs
> >> >
> >> > Is there a reason for this? I don't know how OpenBSD installs
> >> apache.
> >> > Do you have both 1.3.x and 2.0.x installed?
> >> >
> >>
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
From grahamd at dscpl.com.au  Wed Sep 13 22:34:37 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep 13 22:34:41 2006
Subject: [mod_python] mod_python on OpenBSD
Message-ID: <1158201277.21709@dscpl.user.openhosting.com>

edgar mortiz wrote ..
> /usr/chroot/httpd/build/libtool --silent --mode=link gcc -o
> mod_python.la  -rpath /usr/chroot/httpd/modules -module -avoid-version
>    hlistobject.lo hlist.lo filterobject.lo connobject.lo
> serverobject.lo util.lo tableobject.lo requestobject.lo
> _apachemodule.lo mod_python.lo -L/usr/local/lib/python2.4/config
> -Wl,--export-dynamic -lm -lpython2.4 -lutil -lm
> 
> *** Warning: linker path does not have real file for library -lpython2.4.
> *** I have the capability to make that library automatically link in when
> *** you link to this library.  But I can only do this if you have a
> *** shared version of the library, which you do not appear to have
> *** because I did check the linker path looking for a file starting
> *** with libpython2.4 and none of the candidates passed a file format test
> *** using a regex pattern. Last file checked:
> /usr/local/lib/python2.4/config/libpython2.4.a
> 
> *** Warning: libtool could not satisfy all declared inter-library
> *** dependencies of module mod_python.  Therefore, libtool will create
> *** a static module, that should work as long as the dlopening
> *** application is linked with the -dlopen flag.
>
> ...
>
> Performing DSO installation.
> 
> /usr/bin/install -c -d /usr/chroot/httpd/modules
> /usr/bin/install -c src/mod_python.so /usr/chroot/httpd/modules
> install: src/mod_python.so: No such file or directory
> gmake: *** [install_dso] Error 71
> #
> 
> it breaks when i do install_dso

That libtool complains the way it does is the issue. I don't know the OpenBSD
platform, so others who have built for that platform will be better qualified
than I to comment. It may be that libtool couldn't manage to create a useable
loadable object from the static library because of some limitation with the
platform.

Graham

From steve at holdenweb.com  Thu Sep 14 07:51:28 2006
From: steve at holdenweb.com (Steve Holden)
Date: Thu Sep 14 09:01:23 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <7ECF081B-811F-477A-83C3-3818BCAAB2E5@dscpl.com.au>
References: <200609020131.k821Vxst024324@modpython.org>	<44F91BEF.7010805@houghton.net>
	<7ECF081B-811F-477A-83C3-3818BCAAB2E5@dscpl.com.au>
Message-ID: <eebfmq$2m8$1@sea.gmane.org>

Graham Dumpleton wrote:
> All I can say is that we know the documentation is inadequate.
> 
> We have been waiting for a long time for the ASF to setup a wiki
> page for mod_python so that we have a more flexible forum for
> putting up documentation that can better explain things. Ie., a
> place where documentation can be quickly added/changed as
> issues come up. At the moment the documentation is LaTeX based
> and a part of the source code. This doesn't lend itself to easy or quick
> updates as the main site is only updated when major releases occur.
> Anyway, for myself I have given up waiting for the wiki and am
> turning my existing mod_python articles into my own unofficial
> wiki so I can at least more quickly add new stuff. I have quite a
> long list of mini articles I want to write that I have been holding off
> doing due to the lack of an official wiki. Keep an eye out for more
> on this in the near future.
> 
Why not just start using an exisitng Wiki like the one at python.org, 
then migrate when the ASF wiki is ready?

> In respect of mod_python vs mod_python.publisher, they are actually
> two totally different things. In some respects, mod_python.publisher
> and mod_python.psp should be released as totally separate products
> from the mod_python core. That they aren't often causes a lot of
> confusion as people, like yourself, see mod_python.publisher and
> mod_python as one in the same, when in fact mod_python.publisher
> is a higher level interface which is used in a totally different way.
> 
Yup. It might make more sense to distinguish it as an add-on (or at 
least flag the differences clearly for novices).

> In respect of AddHandler, SetHandler, MultiViews etc, you need to  realise
> that mod_python is an extension for Apache. Thus, such things like this
> aren't actually implemented by mod_python but are implemented
> by Apache. To use mod_python properly, you also need to understand
> Apache to some degree and that means also referring to the Apache
> documentation.
> 
Which, IMHO, is even more obscurantist than the mod_python 
documentation. It seems to assume you've already read much of the source 
code and are familiar with C ... in which case why would you be using 
mod_python in the first place :-) ?

regards
  Steve
-- 
Steve Holden       +44 150 684 7255  +1 800 494 3119
Holden Web LLC/Ltd          http://www.holdenweb.com
Skype: holdenweb       http://holdenweb.blogspot.com
Recent Ramblings     http://del.icio.us/steve.holden

From nferrier at tapsellferrier.co.uk  Thu Sep 14 09:30:55 2006
From: nferrier at tapsellferrier.co.uk (Nic James Ferrier)
Date: Thu Sep 14 09:38:21 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <eebfmq$2m8$1@sea.gmane.org> (Steve Holden's message of "Thu,
	14 Sep 2006 07:51:28 -0400")
References: <200609020131.k821Vxst024324@modpython.org>
	<44F91BEF.7010805@houghton.net>
	<7ECF081B-811F-477A-83C3-3818BCAAB2E5@dscpl.com.au>
	<eebfmq$2m8$1@sea.gmane.org>
Message-ID: <877j06zib4.fsf@nicferrier.tapsellferrier.co.uk>

Steve Holden <steve@holdenweb.com> writes:

> Which, IMHO, is even more obscurantist than the mod_python 
> documentation. It seems to assume you've already read much of the source 
> code and are familiar with C ... in which case why would you be using 
> mod_python in the first place :-) ?

I agree with this... I think mod_python documentation needs to:


- explain apache to python programmers

- explain python to apache programmers


At the moment it only does a bit of each of those.


If there was a wiki for documentation I would help document things.


-- 
Nic Ferrier
http://www.tapsellferrier.co.uk   for all your tapsell ferrier needs
From jpg at jgassociates.ca  Thu Sep 14 15:44:48 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Sep 14 15:44:49 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <eebfmq$2m8$1@sea.gmane.org>
References: <200609020131.k821Vxst024324@modpython.org>	<44F91BEF.7010805@houghton.net>	<7ECF081B-811F-477A-83C3-3818BCAAB2E5@dscpl.com.au>
	<eebfmq$2m8$1@sea.gmane.org>
Message-ID: <4509B130.7060606@jgassociates.ca>

Steve Holden wrote:
> Graham Dumpleton wrote:
>> All I can say is that we know the documentation is inadequate.
>>
>> We have been waiting for a long time for the ASF to setup a wiki
>> page for mod_python so that we have a more flexible forum for
>> putting up documentation that can better explain things. Ie., a
>> place where documentation can be quickly added/changed as
>> issues come up. At the moment the documentation is LaTeX based
>> and a part of the source code. This doesn't lend itself to easy or quick
>> updates as the main site is only updated when major releases occur.
>> Anyway, for myself I have given up waiting for the wiki and am
>> turning my existing mod_python articles into my own unofficial
>> wiki so I can at least more quickly add new stuff. I have quite a
>> long list of mini articles I want to write that I have been holding off
>> doing due to the lack of an official wiki. Keep an eye out for more
>> on this in the near future.
>>
> Why not just start using an exisitng Wiki like the one at python.org, 
> then migrate when the ASF wiki is ready?

Because we now have our own, as of Sept 12! We've not made an official 
announcement on this list yet, as I wanted to have a discussion on what 
should go in the wiki vs. the official documentation vs. the website 
before we starting piling in. There is a problem potential licensing 
problem if we use the wiki for the official documentation and then in 
turn want to distribute those docs with the mod_python source.

>> In respect of mod_python vs mod_python.publisher, they are actually
>> two totally different things. In some respects, mod_python.publisher
>> and mod_python.psp should be released as totally separate products
>> from the mod_python core. That they aren't often causes a lot of
>> confusion as people, like yourself, see mod_python.publisher and
>> mod_python as one in the same, when in fact mod_python.publisher
>> is a higher level interface which is used in a totally different way.
>>
> Yup. It might make more sense to distinguish it as an add-on (or at 
> least flag the differences clearly for novices).
> 
>> In respect of AddHandler, SetHandler, MultiViews etc, you need to  
>> realise
>> that mod_python is an extension for Apache. Thus, such things like this
>> aren't actually implemented by mod_python but are implemented
>> by Apache. To use mod_python properly, you also need to understand
>> Apache to some degree and that means also referring to the Apache
>> documentation.
>>
> Which, IMHO, is even more obscurantist than the mod_python 
> documentation. It seems to assume you've already read much of the source 
> code and are familiar with C ... in which case why would you be using 
> mod_python in the first place :-) ?

Graham can speak for himself of course, but I don't think he meant the C 
API. You need to understand the various phases of Apache request 
processing to really use the full potential of mod_python. This 
understanding is independent of the Apache C API, but will be new 
territory for someone coming from something like of php (as an example). 
In this respect our documentation could be *much* better. I think people 
can get really excited about the possibilities once they realize the 
power that mod_python offers. It's more than just a nice way to run some 
python scripts.

Jim

From blair at houghton.net  Thu Sep 14 15:50:20 2006
From: blair at houghton.net (Blair P. Houghton)
Date: Thu Sep 14 15:48:29 2006
Subject: [mod_python] ...generic discussion at this point
Message-ID: <4509B27C.8080603@houghton.net>

An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060914/f4e33900/attachment.html
From jpg at jgassociates.ca  Thu Sep 14 16:03:56 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Sep 14 16:03:57 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <877j06zib4.fsf@nicferrier.tapsellferrier.co.uk>
References: <200609020131.k821Vxst024324@modpython.org>	<44F91BEF.7010805@houghton.net>	<7ECF081B-811F-477A-83C3-3818BCAAB2E5@dscpl.com.au>	<eebfmq$2m8$1@sea.gmane.org>
	<877j06zib4.fsf@nicferrier.tapsellferrier.co.uk>
Message-ID: <4509B5AC.8050107@jgassociates.ca>

Nic James Ferrier wrote:
> Steve Holden <steve@holdenweb.com> writes:
> 
>> Which, IMHO, is even more obscurantist than the mod_python 
>> documentation. It seems to assume you've already read much of the source 
>> code and are familiar with C ... in which case why would you be using 
>> mod_python in the first place :-) ?
> 
> I agree with this... I think mod_python documentation needs to:
> 
> 
> - explain apache to python programmers
> 
> - explain python to apache programmers
> 
> 
> At the moment it only does a bit of each of those.
> 
> 
> If there was a wiki for documentation I would help document things.

There is, as of a few days ago. I think we need to discuss what role of 
the wiki will play in the overall documentation scheme and put a 
coherent structure in place before we start jamming stuff in, so I 
haven't made any official announcement on this list yet.

I'd suggest anyone interested in helping with the wiki subscribe to the 
developer's list so we don't end up splitting the discussion between the 
user and dev lists. To subscribe send a message to 
python-dev-subscribe@httpd.apache.org.

People always say they want better documentation, so now's the time to 
step forward and prove it. Nic has, anyone else? :)

Let's get a discussion going, roll up our sleeves and see just how good 
we can make mod_python.

Jim





From jbnivoit at gmail.com  Thu Sep 14 16:27:10 2006
From: jbnivoit at gmail.com (Jean-Baptiste Nivoit)
Date: Thu Sep 14 16:26:15 2006
Subject: [mod_python] potential threading bug?
Message-ID: <4509BB1E.3040800@gmail.com>

Hi,

reading the source code to mod_python 3.2.10, i found that the "write" 
method is defined twice in request_methods, that's probably harmless.
And a second thing: in mod_python.c, in function get_interpreter, 
there's a "return NULL;" that exits without releasing the PyEval lock at 
line 213 when "interpreters" is not set (which never happens, i'm just 
mentionning it for the sake of correctness).
Anyway, that's just my reading of the source, i could be wrong.

	jb.
From grahamd at dscpl.com.au  Thu Sep 14 18:29:41 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Thu Sep 14 18:29:49 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
Message-ID: <1158272981.6488@dscpl.user.openhosting.com>

Steve Holden wrote ..
> Graham Dumpleton wrote:
> > In respect of AddHandler, SetHandler, MultiViews etc, you need to  realise
> > that mod_python is an extension for Apache. Thus, such things like this
> > aren't actually implemented by mod_python but are implemented
> > by Apache. To use mod_python properly, you also need to understand
> > Apache to some degree and that means also referring to the Apache
> > documentation.
> > 
> Which, IMHO, is even more obscurantist than the mod_python 
> documentation. It seems to assume you've already read much of the source
> code and are familiar with C ... in which case why would you be using 
> mod_python in the first place :-) ?

As Jim effectively commented, mod_python is more than just a jumping off
point for a content handler. It is quite sad (and frustrating) at times to see
that more often than not people ignore all the richness that Apache offers.
They just want to use Python for absolutely everything when there are other
modules or features provided by Apache that could be used in conjunction
with mod_python and their own Python code to get the job done quicker and
more efficiently. More than anything else, this is why mod_python development
has languished, because the majority of people cant seem to see the bigger
picture. It is only with mod_python 3.3 that one will be able to finally do
with mod_python what mod_perl people have had for years and even then
we still don't go anywhere near as far as they do in being able to harness
the full power of Apache.

Anyway, that is my grumpy rant for this week.

In respect of AddHandler/SetHandler/MultiViews, I now have a article of
my own up on my still not officially launched personal wiki pages about it.

  http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler

This has been referenced on the developers list, but not here as yet.

Graham
From steve at holdenweb.com  Thu Sep 14 22:25:50 2006
From: steve at holdenweb.com (Steve Holden)
Date: Thu Sep 14 22:25:23 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <1158272981.6488@dscpl.user.openhosting.com>
References: <1158272981.6488@dscpl.user.openhosting.com>
Message-ID: <eed2u2$kjn$1@sea.gmane.org>

Graham Dumpleton wrote:
> Steve Holden wrote ..
> 
>>Graham Dumpleton wrote:
>>
>>>In respect of AddHandler, SetHandler, MultiViews etc, you need to  realise
>>>that mod_python is an extension for Apache. Thus, such things like this
>>>aren't actually implemented by mod_python but are implemented
>>>by Apache. To use mod_python properly, you also need to understand
>>>Apache to some degree and that means also referring to the Apache
>>>documentation.
>>>
>>
>>Which, IMHO, is even more obscurantist than the mod_python 
>>documentation. It seems to assume you've already read much of the source
>>code and are familiar with C ... in which case why would you be using 
>>mod_python in the first place :-) ?
> 
> 
> As Jim effectively commented, mod_python is more than just a jumping off
> point for a content handler. It is quite sad (and frustrating) at times to see
> that more often than not people ignore all the richness that Apache offers.
> They just want to use Python for absolutely everything when there are other
> modules or features provided by Apache that could be used in conjunction
> with mod_python and their own Python code to get the job done quicker and
> more efficiently. More than anything else, this is why mod_python development
> has languished, because the majority of people cant seem to see the bigger
> picture. It is only with mod_python 3.3 that one will be able to finally do
> with mod_python what mod_perl people have had for years and even then
> we still don't go anywhere near as far as they do in being able to harness
> the full power of Apache.
> 
That's great. However, those of us who aren't particularly clued in to 
Apache find it difficult to locate appropriate documentation: and I 
*have* tried - there just doesn't seem to be that much introductory 
documentation. Or I am crap at searching, perhaps.

> Anyway, that is my grumpy rant for this week.
> 
We're all entitled to the occasional one.

> In respect of AddHandler/SetHandler/MultiViews, I now have a article of
> my own up on my still not officially launched personal wiki pages about it.
> 
>   http://www.dscpl.com.au/wiki/ModPython/Articles/SetHandlerVersusAddHandler
> 
> This has been referenced on the developers list, but not here as yet.
> 
It looks like there's a lot more information there than simply 
discussing the difference between AddHandler and Sethandler. I'll give 
it a serious read - thanks!

regards
  Steve
-- 
Steve Holden       +44 150 684 7255  +1 800 494 3119
Holden Web LLC/Ltd          http://www.holdenweb.com
Skype: holdenweb       http://holdenweb.blogspot.com
Recent Ramblings     http://del.icio.us/steve.holden

From jpg at jgassociates.ca  Fri Sep 15 08:26:51 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep 15 08:26:53 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <eed2u2$kjn$1@sea.gmane.org>
References: <1158272981.6488@dscpl.user.openhosting.com>
	<eed2u2$kjn$1@sea.gmane.org>
Message-ID: <450A9C0B.1070301@jgassociates.ca>

Steve Holden wrote:
> Graham Dumpleton wrote:
>> Steve Holden wrote ..
>>
>>> Graham Dumpleton wrote:
>>>
>>>> In respect of AddHandler, SetHandler, MultiViews etc, you need to  
>>>> realise
>>>> that mod_python is an extension for Apache. Thus, such things like this
>>>> aren't actually implemented by mod_python but are implemented
>>>> by Apache. To use mod_python properly, you also need to understand
>>>> Apache to some degree and that means also referring to the Apache
>>>> documentation.
>>>>
>>>
>>> Which, IMHO, is even more obscurantist than the mod_python 
>>> documentation. It seems to assume you've already read much of the source
>>> code and are familiar with C ... in which case why would you be using 
>>> mod_python in the first place :-) ?
>>
>>
>> As Jim effectively commented, mod_python is more than just a jumping off
>> point for a content handler. It is quite sad (and frustrating) at 
>> times to see
>> that more often than not people ignore all the richness that Apache 
>> offers.
>> They just want to use Python for absolutely everything when there are 
>> other
>> modules or features provided by Apache that could be used in conjunction
>> with mod_python and their own Python code to get the job done quicker and
>> more efficiently. More than anything else, this is why mod_python 
>> development
>> has languished, because the majority of people cant seem to see the 
>> bigger
>> picture. It is only with mod_python 3.3 that one will be able to 
>> finally do
>> with mod_python what mod_perl people have had for years and even then
>> we still don't go anywhere near as far as they do in being able to 
>> harness
>> the full power of Apache.
>>
> That's great. However, those of us who aren't particularly clued in to 
> Apache find it difficult to locate appropriate documentation: and I 
> *have* tried - there just doesn't seem to be that much introductory 
> documentation. Or I am crap at searching, perhaps.

You are correct. (About the available documentation... I'm sure your 
search abilities are just fine ;) ). Everyone here acknowledges that the 
mod_python documentation could be improved, especially on how it fits 
into the Apache ecosystem.

One of the better resources is the book  "Writing Apache Modules with 
Perl and C". See http://www.modperl.com.  There is some really good 
information in there that can aid in understanding how Apache works. 
Unfortunately the examples are in perl, so it helps to already know 
mod_python so you can translate on the fly - not an ideal situation.

Jim
From richardlewis at fastmail.co.uk  Fri Sep 15 08:35:03 2006
From: richardlewis at fastmail.co.uk (Richard Lewis)
Date: Fri Sep 15 08:35:13 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <450A9C0B.1070301@jgassociates.ca>
References: <1158272981.6488@dscpl.user.openhosting.com>
	<eed2u2$kjn$1@sea.gmane.org> <450A9C0B.1070301@jgassociates.ca>
Message-ID: <200609151335.04932.richardlewis@fastmail.co.uk>

On Friday 15 September 2006 13:26, Jim Gallacher wrote:
> Unfortunately the examples are in perl
And I wouldn't wish having to /read/ Perl scripts on anyone!

Richard
-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
Sonic Arts Research Archive
http://www.sara.uea.ac.uk/
JID: ironchicken@jabber.earth.li
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
From jpg at jgassociates.ca  Fri Sep 15 08:48:55 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep 15 08:49:33 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <200609151335.04932.richardlewis@fastmail.co.uk>
References: <1158272981.6488@dscpl.user.openhosting.com>	<eed2u2$kjn$1@sea.gmane.org>
	<450A9C0B.1070301@jgassociates.ca>
	<200609151335.04932.richardlewis@fastmail.co.uk>
Message-ID: <450AA137.20804@jgassociates.ca>

Richard Lewis wrote:
> On Friday 15 September 2006 13:26, Jim Gallacher wrote:
>> Unfortunately the examples are in perl
> And I wouldn't wish having to /read/ Perl scripts on anyone!

*That* goes without saying. :)

Jim
From steve at holdenweb.com  Fri Sep 15 08:56:24 2006
From: steve at holdenweb.com (Steve Holden)
Date: Fri Sep 15 08:56:27 2006
Subject: [mod_python] Re: Mod_python Digest, Vol 42, Issue 4
In-Reply-To: <450A9C0B.1070301@jgassociates.ca>
References: <1158272981.6488@dscpl.user.openhosting.com>	<eed2u2$kjn$1@sea.gmane.org>
	<450A9C0B.1070301@jgassociates.ca>
Message-ID: <eee7sb$s2$1@sea.gmane.org>

Jim Gallacher wrote:
> Steve Holden wrote:
> 
>> Graham Dumpleton wrote:
>>
>>> Steve Holden wrote ..
>>>
>>>> Graham Dumpleton wrote:
>>>>
>>>>> In respect of AddHandler, SetHandler, MultiViews etc, you need to  
>>>>> realise
>>>>> that mod_python is an extension for Apache. Thus, such things like 
>>>>> this
>>>>> aren't actually implemented by mod_python but are implemented
>>>>> by Apache. To use mod_python properly, you also need to understand
>>>>> Apache to some degree and that means also referring to the Apache
>>>>> documentation.
>>>>>
>>>>
>>>> Which, IMHO, is even more obscurantist than the mod_python 
>>>> documentation. It seems to assume you've already read much of the 
>>>> source
>>>> code and are familiar with C ... in which case why would you be 
>>>> using mod_python in the first place :-) ?
>>>
>>>
>>>
>>> As Jim effectively commented, mod_python is more than just a jumping off
>>> point for a content handler. It is quite sad (and frustrating) at 
>>> times to see
>>> that more often than not people ignore all the richness that Apache 
>>> offers.
>>> They just want to use Python for absolutely everything when there are 
>>> other
>>> modules or features provided by Apache that could be used in conjunction
>>> with mod_python and their own Python code to get the job done quicker 
>>> and
>>> more efficiently. More than anything else, this is why mod_python 
>>> development
>>> has languished, because the majority of people cant seem to see the 
>>> bigger
>>> picture. It is only with mod_python 3.3 that one will be able to 
>>> finally do
>>> with mod_python what mod_perl people have had for years and even then
>>> we still don't go anywhere near as far as they do in being able to 
>>> harness
>>> the full power of Apache.
>>>
>> That's great. However, those of us who aren't particularly clued in to 
>> Apache find it difficult to locate appropriate documentation: and I 
>> *have* tried - there just doesn't seem to be that much introductory 
>> documentation. Or I am crap at searching, perhaps.
> 
> 
> You are correct. (About the available documentation... I'm sure your 
> search abilities are just fine ;) ). Everyone here acknowledges that the 
> mod_python documentation could be improved, especially on how it fits 
> into the Apache ecosystem.
> 
> One of the better resources is the book  "Writing Apache Modules with 
> Perl and C". See http://www.modperl.com.  There is some really good 
> information in there that can aid in understanding how Apache works. 
> Unfortunately the examples are in perl, so it helps to already know 
> mod_python so you can translate on the fly - not an ideal situation.
> 
Thanks for the pointer, Jom. Looks like that would be worth the money to 
buy. Maybe there should be a book on Python web programming that 
includes a proper treatment of mod_python.

regards
  Steve
-- 
Steve Holden       +44 150 684 7255  +1 800 494 3119
Holden Web LLC/Ltd          http://www.holdenweb.com
Skype: holdenweb       http://holdenweb.blogspot.com
Recent Ramblings     http://del.icio.us/steve.holden

From brunson at brunson.com  Fri Sep 15 14:41:36 2006
From: brunson at brunson.com (Eric Brunson)
Date: Fri Sep 15 14:41:40 2006
Subject: [mod_python] Very odd behavior using mysqldb
Message-ID: <450AF3E0.4080403@brunson.com>

I've been working on a project using mod_python to access a mysql 
database using the MySQLdb API.  I know mod_python is still considered 
beta under Apache 2, so I thought I'd bring an issue to the attention of 
the list.

I was seeing some very bizarre results when generating dynamic content 
from the database, which I first attributed to PSP caching, but then 
investigated further when I switched to using the publisher handler.  It 
may be the way I've set up my modules and database connections, but I 
haven't convinced myself that I really understand the problem and until 
I do, I'm not going to be happy about it.  I have found a workaround 
that I can live with, but I don't really like it that much because it 
requires constantly connecting to and disconnection from the database.

The problem was simply getting old, wrong results interleaved with new, 
correct results after updating the database.  Simply put, I'm displaying 
data from a table.  My index.py imports a module for generating HTML 
which, in turn, includes a module for doing database access.  The odd 
thing about how I set up the database access, and I think it's pertinent 
to the problem, was that I automatically connect to the database when I 
import the database module.  Like this:

----- database.py -----
import MySQLdb
from mod_python import apache

def Connect():
    return MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )

dbc = Connect()

def someExampleAccessFunction():
    global dbc
    curs = dbc.cursor()
    curs.execute( "select count(0) from sometable" )
    result = curs.fetchall()[0][0]
    curs.close()
    apache.log_error( "result was %s" % result )
    return result

----- end database.py -----

Let's disregard whether that's good programming practice or not, the 
fact is, I could query that value several times by doing a page reload, 
then delete a record from the database and commit the change, then 
subsequent page loads would interleave old results with new results, 
seemingly cyclically.

The key to my confusion is that the error logs for apache would show a 
message for every page reload, and the result from the query would agree 
with whatever data was displayed on the page, correct or incorrect.  
Meanwhile a direct query to the database from the command line would 
always return the correct result from the database.

My best guess so far is that multiple threads in apache get multiple 
copies of mod_python, each with it's own copy of the imported database 
module in memory and each module maintaining a different database 
connection that is somehow caching results.  I've never seen this 
behavior in any application until I tried this under mod_python.  I was 
able to force the correct results to always be returned by getting rid 
of the module variable, dbc, and moving the mysqldb.connect() call to 
inside each function call, opening the database connection, executing my 
sql, then closing the database connection.  This is less than optimal, 
since I may make several database queries during each page load, so 
later today I'll try making the database connection in the index.py, 
then passing the connection handle to each of the calls that need it.  
Also a little less than optimal, but tolerable.

Does anyone have any insight into this behavior?  It's more of an 
academic question at this point, but I wonder if it may lead to an 
improvement if we were able to identify the problem and implement a 
transparent fix.  Also, feel free to let me know if I'm completely 
offbase with my theory of what's going on under the hood.

Thanks,
e.


From brunson at brunson.com  Fri Sep 15 15:06:58 2006
From: brunson at brunson.com (Eric Brunson)
Date: Fri Sep 15 15:07:02 2006
Subject: [mod_python] Very odd behavior using mysqldb
In-Reply-To: <450AF3E0.4080403@brunson.com>
References: <450AF3E0.4080403@brunson.com>
Message-ID: <450AF9D2.8020803@brunson.com>


Sorry, forgot to include version info:

wbebrunsonlx(~)$ uname -a
Linux wbebrunsonlx 2.6.17-1.2174_FC5 #1 Tue Aug 8 15:30:55 EDT 2006 i686 
i686 i386 GNU/Linux
wbebrunsonlx(~)$ cat /etc/fedora-release
Fedora Core release 5 (Bordeaux)
wbebrunsonlx(~)$ rpm -q httpd mod_python python MySQL-python MySQL-server
httpd-2.2.2-1.2
mod_python-3.2.8-3
python-2.4.3-8.FC5
MySQL-python-1.2.0-3.2.2
MySQL-server-5.0.24-0.glibc23


Eric Brunson wrote:
> I've been working on a project using mod_python to access a mysql 
> database using the MySQLdb API.  I know mod_python is still considered 
> beta under Apache 2, so I thought I'd bring an issue to the attention 
> of the list.
>
> I was seeing some very bizarre results when generating dynamic content 
> from the database, which I first attributed to PSP caching, but then 
> investigated further when I switched to using the publisher handler.  
> It may be the way I've set up my modules and database connections, but 
> I haven't convinced myself that I really understand the problem and 
> until I do, I'm not going to be happy about it.  I have found a 
> workaround that I can live with, but I don't really like it that much 
> because it requires constantly connecting to and disconnection from 
> the database.
>
> The problem was simply getting old, wrong results interleaved with 
> new, correct results after updating the database.  Simply put, I'm 
> displaying data from a table.  My index.py imports a module for 
> generating HTML which, in turn, includes a module for doing database 
> access.  The odd thing about how I set up the database access, and I 
> think it's pertinent to the problem, was that I automatically connect 
> to the database when I import the database module.  Like this:
>
> ----- database.py -----
> import MySQLdb
> from mod_python import apache
>
> def Connect():
>    return MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
>
> dbc = Connect()
>
> def someExampleAccessFunction():
>    global dbc
>    curs = dbc.cursor()
>    curs.execute( "select count(0) from sometable" )
>    result = curs.fetchall()[0][0]
>    curs.close()
>    apache.log_error( "result was %s" % result )
>    return result
>
> ----- end database.py -----
>
> Let's disregard whether that's good programming practice or not, the 
> fact is, I could query that value several times by doing a page 
> reload, then delete a record from the database and commit the change, 
> then subsequent page loads would interleave old results with new 
> results, seemingly cyclically.
>
> The key to my confusion is that the error logs for apache would show a 
> message for every page reload, and the result from the query would 
> agree with whatever data was displayed on the page, correct or 
> incorrect.  Meanwhile a direct query to the database from the command 
> line would always return the correct result from the database.
>
> My best guess so far is that multiple threads in apache get multiple 
> copies of mod_python, each with it's own copy of the imported database 
> module in memory and each module maintaining a different database 
> connection that is somehow caching results.  I've never seen this 
> behavior in any application until I tried this under mod_python.  I 
> was able to force the correct results to always be returned by getting 
> rid of the module variable, dbc, and moving the mysqldb.connect() call 
> to inside each function call, opening the database connection, 
> executing my sql, then closing the database connection.  This is less 
> than optimal, since I may make several database queries during each 
> page load, so later today I'll try making the database connection in 
> the index.py, then passing the connection handle to each of the calls 
> that need it.  Also a little less than optimal, but tolerable.
>
> Does anyone have any insight into this behavior?  It's more of an 
> academic question at this point, but I wonder if it may lead to an 
> improvement if we were able to identify the problem and implement a 
> transparent fix.  Also, feel free to let me know if I'm completely 
> offbase with my theory of what's going on under the hood.
>
> Thanks,
> e.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From mathstuf at gmail.com  Fri Sep 15 23:36:27 2006
From: mathstuf at gmail.com (Ben Boeckel)
Date: Fri Sep 15 23:36:31 2006
Subject: [mod_python] mod_python not loading
Message-ID: <143d192b0609152036o495717btd9f5dd7d0c6a5def@mail.gmail.com>

Hi, I'm having trouble getting the tutorials to work with the
mptest.py stuff. I've searched and searched for anything that could
help me to get the Python pages to render, but I have not been able to
so yet. I keep getting Internal Server errors and the error logs don't
list anything other than:

[Fri Sep 15 23:24:07 2006] [error] make_obcallback: could not import
mod_python.apache.\n
[Fri Sep 15 23:24:07 2006] [error] python_handler: no interpreter
callback found.
[Fri Sep 15 23:24:07 2006] [error] [client 127.0.0.1] python_handler:
Can't get/create interpreter.

My httpd.conf also has:

<Directory "D:/Program Files/Apache Group/Apache2/htdocs/test">
    AddHandler mod_python .py
    PythonHandler mptest
    PythonDebug On
</Directory>

I'm running:
Apache 2.0.59
Python 2.4.3
mod_python 3.2.8
Windows XP SP2

Also, can mod_python handle embedded Python in HTML (sort of like PHP)
or is another module needed for that?
From blair at houghton.net  Sat Sep 16 00:46:01 2006
From: blair at houghton.net (Blair P. Houghton)
Date: Sat Sep 16 00:46:41 2006
Subject: [mod_python] re: ...generic discussion at this point
Message-ID: <450B8189.7090200@houghton.net>


This was attributed to me in an earlier mod_python mailing list digest:

>Message: 2
>Date: Thu, 14 Sep 2006 12:50:20 -0700
>From: "Blair P. Houghton" <blair@houghton.net>
>Subject: [mod_python] ...generic discussion at this point
>To: mod_python@modpython.org
>Message-ID: <4509B27C.8080603@houghton.net>
>Content-Type: text/plain; charset="us-ascii"
>
>An HTML attachment was scrubbed...
>URL: >http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060914/f4e33900/attachment-0001.html

How this happened, I don't know, but that link and its target certainly weren't the message I sent.  It's almost year old.  And mine was plaintext.  Is this common around here?

--Blair
From jpg at jgassociates.ca  Sat Sep 16 13:06:57 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 16 13:07:06 2006
Subject: [mod_python] re: ...generic discussion at this point
In-Reply-To: <450B8189.7090200@houghton.net>
References: <450B8189.7090200@houghton.net>
Message-ID: <450C2F31.1080406@jgassociates.ca>

Blair P. Houghton wrote:
> 
> This was attributed to me in an earlier mod_python mailing list digest:
> 
>> Message: 2
>> Date: Thu, 14 Sep 2006 12:50:20 -0700
>> From: "Blair P. Houghton" <blair@houghton.net>
>> Subject: [mod_python] ...generic discussion at this point
>> To: mod_python@modpython.org
>> Message-ID: <4509B27C.8080603@houghton.net>
>> Content-Type: text/plain; charset="us-ascii"
>>
>> An HTML attachment was scrubbed...
>> URL: 
>> >http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060914/f4e33900/attachment-0001.html 
>>
> 
> How this happened, I don't know, but that link and its target certainly 
> weren't the message I sent.  It's almost year old.  And mine was 
> plaintext.  Is this common around here?

So you are saying that you didn't write the following on Sept 14, 2006 
(which I received on the list on the same day)?

"""
Because you're familiar with C.

(beat)

(and don't need blazing speed in the code that may not save you
the time it took to implement it)

--Blair
"""

Or that you didn't write it in html? Or the mail archive is messed up? 
The text you quote is not just in the list digest but also in the archive:
http://modpython.org/pipermail/mod_python/2006-September/022070.html

I can send you the message header if you want to take a look. It 
certainly does seem odd.

Jim

From jpg at jgassociates.ca  Sat Sep 16 13:44:57 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 16 13:44:58 2006
Subject: [mod_python] Very odd behavior using mysqldb
In-Reply-To: <450AF3E0.4080403@brunson.com>
References: <450AF3E0.4080403@brunson.com>
Message-ID: <450C3819.4070600@jgassociates.ca>

Eric Brunson wrote:
> I've been working on a project using mod_python to access a mysql 
> database using the MySQLdb API.  I know mod_python is still considered 
> beta under Apache 2, so I thought I'd bring an issue to the attention of 
> the list.
> 
> I was seeing some very bizarre results when generating dynamic content 
> from the database, which I first attributed to PSP caching, but then 
> investigated further when I switched to using the publisher handler.  It 
> may be the way I've set up my modules and database connections, but I 
> haven't convinced myself that I really understand the problem and until 
> I do, I'm not going to be happy about it.  I have found a workaround 
> that I can live with, but I don't really like it that much because it 
> requires constantly connecting to and disconnection from the database.
> 
> The problem was simply getting old, wrong results interleaved with new, 
> correct results after updating the database.  Simply put, I'm displaying 
> data from a table.  My index.py imports a module for generating HTML 
> which, in turn, includes a module for doing database access.  The odd 
> thing about how I set up the database access, and I think it's pertinent 
> to the problem, was that I automatically connect to the database when I 
> import the database module.  Like this:
> 
> ----- database.py -----
> import MySQLdb
> from mod_python import apache
> 
> def Connect():
>    return MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
> 
> dbc = Connect()
> 
> def someExampleAccessFunction():
>    global dbc
>    curs = dbc.cursor()
>    curs.execute( "select count(0) from sometable" )
>    result = curs.fetchall()[0][0]
>    curs.close()
>    apache.log_error( "result was %s" % result )
>    return result
> 
> ----- end database.py -----
> 
> Let's disregard whether that's good programming practice or not, the 
> fact is, I could query that value several times by doing a page reload, 
> then delete a record from the database and commit the change, then 
> subsequent page loads would interleave old results with new results, 
> seemingly cyclically.
> 
> The key to my confusion is that the error logs for apache would show a 
> message for every page reload, and the result from the query would agree 
> with whatever data was displayed on the page, correct or incorrect.  
> Meanwhile a direct query to the database from the command line would 
> always return the correct result from the database.
> 
> My best guess so far is that multiple threads in apache get multiple 
> copies of mod_python, each with it's own copy of the imported database 
> module in memory and each module maintaining a different database 
> connection that is somehow caching results.  I've never seen this 
> behavior in any application until I tried this under mod_python.  I was 
> able to force the correct results to always be returned by getting rid 
> of the module variable, dbc, and moving the mysqldb.connect() call to 
> inside each function call, opening the database connection, executing my 
> sql, then closing the database connection.  This is less than optimal, 
> since I may make several database queries during each page load, so 
> later today I'll try making the database connection in the index.py, 
> then passing the connection handle to each of the calls that need it.  
> Also a little less than optimal, but tolerable.
> 
> Does anyone have any insight into this behavior?  It's more of an 
> academic question at this point, but I wonder if it may lead to an 
> improvement if we were able to identify the problem and implement a 
> transparent fix.  Also, feel free to let me know if I'm completely 
> offbase with my theory of what's going on under the hood.

Your assessment with respect to having multiple copies of mod_python, 
each with its own copy of the imported modules and data is correct. It 
is not a bug but rather the way apache works. Depending on which 
apache-mpm you are using (either prefork or worker on Fedora) and your 
configuration, you may have anywhere from a few, to dozens of 
independent child processes. Indeed if you are using the prefork mpm on 
a heavily loaded server you could have hundreds of processes. In such 
cases using a persistent db connection will likely cause problems with 
exhausting the number of available mysql connections. Persistent 
connections in such a scenario are discouraged in general - not just in 
mod_python.

As to your particular problem, I wonder if you are using transactions, 
but are not committing immediately after an update? The process which 
apache chooses to to handle a request is random. Say for example you 
update in process A without a commit. The next request may be handled by 
  another process, which will see the old data. A subsequent request may 
then come in but be handled by process A again, which will see the new 
data since it is using the same connection as that used for the update. 
Thus you will get the interleaving effect.

This is not unique to db connections. Don't be fooled into thinking that 
module-level attributes are global across your application as they are 
not. In anything other than winnt-mpm (which is a single, threaded 
process), you will have multiple, independent copies of that variable.

Opening and closing your db connection for each request is the usual 
solution, as you've discovered. It is possible to do connection pooling, 
but you need to be a little smarter about it ensure you don't run into 
problems or exhaust the number of mysql connections configured. Don't 
forget that leaving open a connection consumes memory resources as well.

This is not to say that you need to open and close the connection each 
time you want to access the database within a request. The usual method 
is to stuff your db connection into the request object itself. For example:

def handler(req):
     req.db = MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
     req.register_cleanup(close_db, req.db)
     delete_stuff(req)
     add_stuff(req)
     req.write('stuff done')
     return apache.OK

def add_stuff(req):
     cur = req.db.cursor()
     cur.execute("insert into stuff (foo) values ('bar')")
     cur.close()

def add_stuff(req):
     cur = req.db.cursor()
     cur.execute("DELETE from stuff where foo = 'baz'")
     cur.close()

def close_db(db):
     db.close()

Notice the use of register_cleanup() to register a function which will 
close the connection, rather than explicitly closing it. This ensures 
that your db connection will always be closed, even if an exception 
occurs somewhere in your code.

Jim
From jpg at jgassociates.ca  Sat Sep 16 13:54:51 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 16 13:54:55 2006
Subject: [mod_python] potential threading bug?
In-Reply-To: <4509BB1E.3040800@gmail.com>
References: <4509BB1E.3040800@gmail.com>
Message-ID: <450C3A6B.1060308@jgassociates.ca>

Jean-Baptiste Nivoit wrote:
> Hi,
> 
> reading the source code to mod_python 3.2.10, i found that the "write" 
> method is defined twice in request_methods, that's probably harmless.

Harmless, but sloppy.

> And a second thing: in mod_python.c, in function get_interpreter, 
> there's a "return NULL;" that exits without releasing the PyEval lock at 
> line 213 when "interpreters" is not set (which never happens, i'm just 
> mentionning it for the sake of correctness).
> Anyway, that's just my reading of the source, i could be wrong.

I think you're right but it's likely harmless as well. I do like having 
symmetry in the code though, so like you, I'd be inclined to change it 
for the sake of correctness.

If you have an itch to dig into the C-code you might want to join the 
developer's list, where this sort of discussion is more appropriate.

To subscribe, send a message to python-dev-subscribe@httpd.apache.org

Jim
From jpg at jgassociates.ca  Sat Sep 16 14:05:56 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 16 14:05:55 2006
Subject: [mod_python] Very odd behavior using mysqldb
In-Reply-To: <450AF3E0.4080403@brunson.com>
References: <450AF3E0.4080403@brunson.com>
Message-ID: <450C3D04.7020708@jgassociates.ca>

Eric Brunson wrote:
> I've been working on a project using mod_python to access a mysql 
> database using the MySQLdb API.  I know mod_python is still considered 
> beta under Apache 2

In my previous reply I forgot to correct the factual error above. 
Mod_python is *not* considered beta under apache 2. In fact mod_python 
version 3.0 and above *only* runs on apache 2.

If you are referring to Apache 2.2, then there was a small change in the 
apache APR which broke mod_python. This was fixed in mod_python 3.2.10, 
the current stable version. For the gory details see:
http://issues.apache.org/jira/browse/MODPYTHON-78

We don't yet support some of the nifty new features introduced in Apache 
2.2, but that does not mean that 3.2.10 is a beta release.

Jim
From jpg at jgassociates.ca  Sat Sep 16 14:17:43 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Sat Sep 16 14:17:44 2006
Subject: [mod_python] mod_python not loading
In-Reply-To: <143d192b0609152036o495717btd9f5dd7d0c6a5def@mail.gmail.com>
References: <143d192b0609152036o495717btd9f5dd7d0c6a5def@mail.gmail.com>
Message-ID: <450C3FC7.2030108@jgassociates.ca>

Ben Boeckel wrote:
> Hi, I'm having trouble getting the tutorials to work with the
> mptest.py stuff. I've searched and searched for anything that could
> help me to get the Python pages to render, but I have not been able to
> so yet. I keep getting Internal Server errors and the error logs don't
> list anything other than:
> 
> [Fri Sep 15 23:24:07 2006] [error] make_obcallback: could not import
> mod_python.apache.\n
> [Fri Sep 15 23:24:07 2006] [error] python_handler: no interpreter
> callback found.
> [Fri Sep 15 23:24:07 2006] [error] [client 127.0.0.1] python_handler:
> Can't get/create interpreter.
> 
> My httpd.conf also has:
> 
> <Directory "D:/Program Files/Apache Group/Apache2/htdocs/test">
>    AddHandler mod_python .py
>    PythonHandler mptest
>    PythonDebug On
> </Directory>
> 
> I'm running:
> Apache 2.0.59
> Python 2.4.3
> mod_python 3.2.8
> Windows XP SP2

Take a look at these threads as they are likely to help.
http://modpython.org/pipermail/mod_python/2006-August/021754.html
http://modpython.org/pipermail/mod_python/2006-August/021944.html


> Also, can mod_python handle embedded Python in HTML (sort of like PHP)
> or is another module needed for that?

Yes. Take a look at psp.
http://www.modpython.org/live/current/doc-html/pyapi-psp.html
http://www.modpython.org/live/current/doc-html/hand-psp.html
From grahamd at dscpl.com.au  Sat Sep 16 18:17:31 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep 16 18:16:45 2006
Subject: [mod_python] Very odd behavior using mysqldb
In-Reply-To: <450C3819.4070600@jgassociates.ca>
References: <450AF3E0.4080403@brunson.com> <450C3819.4070600@jgassociates.ca>
Message-ID: <46D678A0-D225-4869-8CA2-ED7A8860744D@dscpl.com.au>

In addition to what Jim has says, having the database connection created
at global module scope of a handler code file isn't necessarily a  
good idea.
The problem here is if automatic module reloading is on and you make  
changes
to your handler file over time. What will happen is that when the  
handler code
file is reloaded, your existing database connection objects will be  
discarded
and reinitialised. If normal object cleanup doesn't result in the  
database
handles being cleaned up properly, you can get a leak in database  
resource
handles and eventually you will run out of connections to the database.

For details on issues like this and others which will affect you with  
the version
of mod_python you are running, check out:

   http://www.dscpl.com.au/wiki/ModPython/Articles/ 
TheProcessInterpreterModel
   http://www.dscpl.com.au/wiki/ModPython/Articles/ 
ModuleImportingIsBroken

Graham

On 17/09/2006, at 3:44 AM, Jim Gallacher wrote:

> Eric Brunson wrote:
>> I've been working on a project using mod_python to access a mysql  
>> database using the MySQLdb API.  I know mod_python is still  
>> considered beta under Apache 2, so I thought I'd bring an issue to  
>> the attention of the list.
>> I was seeing some very bizarre results when generating dynamic  
>> content from the database, which I first attributed to PSP  
>> caching, but then investigated further when I switched to using  
>> the publisher handler.  It may be the way I've set up my modules  
>> and database connections, but I haven't convinced myself that I  
>> really understand the problem and until I do, I'm not going to be  
>> happy about it.  I have found a workaround that I can live with,  
>> but I don't really like it that much because it requires  
>> constantly connecting to and disconnection from the database.
>> The problem was simply getting old, wrong results interleaved with  
>> new, correct results after updating the database.  Simply put, I'm  
>> displaying data from a table.  My index.py imports a module for  
>> generating HTML which, in turn, includes a module for doing  
>> database access.  The odd thing about how I set up the database  
>> access, and I think it's pertinent to the problem, was that I  
>> automatically connect to the database when I import the database  
>> module.  Like this:
>> ----- database.py -----
>> import MySQLdb
>> from mod_python import apache
>> def Connect():
>>    return MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
>> dbc = Connect()
>> def someExampleAccessFunction():
>>    global dbc
>>    curs = dbc.cursor()
>>    curs.execute( "select count(0) from sometable" )
>>    result = curs.fetchall()[0][0]
>>    curs.close()
>>    apache.log_error( "result was %s" % result )
>>    return result
>> ----- end database.py -----
>> Let's disregard whether that's good programming practice or not,  
>> the fact is, I could query that value several times by doing a  
>> page reload, then delete a record from the database and commit the  
>> change, then subsequent page loads would interleave old results  
>> with new results, seemingly cyclically.
>> The key to my confusion is that the error logs for apache would  
>> show a message for every page reload, and the result from the  
>> query would agree with whatever data was displayed on the page,  
>> correct or incorrect.  Meanwhile a direct query to the database  
>> from the command line would always return the correct result from  
>> the database.
>> My best guess so far is that multiple threads in apache get  
>> multiple copies of mod_python, each with it's own copy of the  
>> imported database module in memory and each module maintaining a  
>> different database connection that is somehow caching results.   
>> I've never seen this behavior in any application until I tried  
>> this under mod_python.  I was able to force the correct results to  
>> always be returned by getting rid of the module variable, dbc, and  
>> moving the mysqldb.connect() call to inside each function call,  
>> opening the database connection, executing my sql, then closing  
>> the database connection.  This is less than optimal, since I may  
>> make several database queries during each page load, so later  
>> today I'll try making the database connection in the index.py,  
>> then passing the connection handle to each of the calls that need  
>> it.  Also a little less than optimal, but tolerable.
>> Does anyone have any insight into this behavior?  It's more of an  
>> academic question at this point, but I wonder if it may lead to an  
>> improvement if we were able to identify the problem and implement  
>> a transparent fix.  Also, feel free to let me know if I'm  
>> completely offbase with my theory of what's going on under the hood.
>
> Your assessment with respect to having multiple copies of  
> mod_python, each with its own copy of the imported modules and data  
> is correct. It is not a bug but rather the way apache works.  
> Depending on which apache-mpm you are using (either prefork or  
> worker on Fedora) and your configuration, you may have anywhere  
> from a few, to dozens of independent child processes. Indeed if you  
> are using the prefork mpm on a heavily loaded server you could have  
> hundreds of processes. In such cases using a persistent db  
> connection will likely cause problems with exhausting the number of  
> available mysql connections. Persistent connections in such a  
> scenario are discouraged in general - not just in mod_python.
>
> As to your particular problem, I wonder if you are using  
> transactions, but are not committing immediately after an update?  
> The process which apache chooses to to handle a request is random.  
> Say for example you update in process A without a commit. The next  
> request may be handled by  another process, which will see the old  
> data. A subsequent request may then come in but be handled by  
> process A again, which will see the new data since it is using the  
> same connection as that used for the update. Thus you will get the  
> interleaving effect.
>
> This is not unique to db connections. Don't be fooled into thinking  
> that module-level attributes are global across your application as  
> they are not. In anything other than winnt-mpm (which is a single,  
> threaded process), you will have multiple, independent copies of  
> that variable.
>
> Opening and closing your db connection for each request is the  
> usual solution, as you've discovered. It is possible to do  
> connection pooling, but you need to be a little smarter about it  
> ensure you don't run into problems or exhaust the number of mysql  
> connections configured. Don't forget that leaving open a connection  
> consumes memory resources as well.
>
> This is not to say that you need to open and close the connection  
> each time you want to access the database within a request. The  
> usual method is to stuff your db connection into the request object  
> itself. For example:
>
> def handler(req):
>     req.db = MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
>     req.register_cleanup(close_db, req.db)
>     delete_stuff(req)
>     add_stuff(req)
>     req.write('stuff done')
>     return apache.OK
>
> def add_stuff(req):
>     cur = req.db.cursor()
>     cur.execute("insert into stuff (foo) values ('bar')")
>     cur.close()
>
> def add_stuff(req):
>     cur = req.db.cursor()
>     cur.execute("DELETE from stuff where foo = 'baz'")
>     cur.close()
>
> def close_db(db):
>     db.close()
>
> Notice the use of register_cleanup() to register a function which  
> will close the connection, rather than explicitly closing it. This  
> ensures that your db connection will always be closed, even if an  
> exception occurs somewhere in your code.
>
> Jim
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From grahamd at dscpl.com.au  Sat Sep 16 18:20:35 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep 16 18:19:49 2006
Subject: [mod_python] mod_python not loading
In-Reply-To: <450C3FC7.2030108@jgassociates.ca>
References: <143d192b0609152036o495717btd9f5dd7d0c6a5def@mail.gmail.com>
	<450C3FC7.2030108@jgassociates.ca>
Message-ID: <2105546B-18DC-4D39-AE60-77FFCA6C7007@dscpl.com.au>


On 17/09/2006, at 4:17 AM, Jim Gallacher wrote:

>> Also, can mod_python handle embedded Python in HTML (sort of like  
>> PHP)
>> or is another module needed for that?
>
> Yes. Take a look at psp.
> http://www.modpython.org/live/current/doc-html/pyapi-psp.html
> http://www.modpython.org/live/current/doc-html/hand-psp.html

Version 3.3 of mod_python will also support use of Python code in
server side include files. See:

   http://issues.apache.org/jira/browse/MODPYTHON-104

There are also various templating toolkits for Python which can also be
used in conjunction with mod_python with just a little bit of work.

Graham
From brunson at brunson.com  Sun Sep 17 14:02:20 2006
From: brunson at brunson.com (Eric Brunson)
Date: Sun Sep 17 14:03:48 2006
Subject: [mod_python] Very odd behavior using mysqldb
In-Reply-To: <46D678A0-D225-4869-8CA2-ED7A8860744D@dscpl.com.au>
References: <450AF3E0.4080403@brunson.com> <450C3819.4070600@jgassociates.ca>
	<46D678A0-D225-4869-8CA2-ED7A8860744D@dscpl.com.au>
Message-ID: <450D8DAC.1040009@brunson.com>


Jim and Graham,

Thanks for the replies, it's good to have my suspicions confirmed and 
better explained.  Jim, thanks especially for the tip on adding the 
database connection as an attribute of the req.  The main think I didn't 
like about instantiating the connection in the handler was having to 
pass yet another argument to my function calls.  This will clean up my 
code quite a bit.

Thanks again,
e.

Graham Dumpleton wrote:
> In addition to what Jim has says, having the database connection created
> at global module scope of a handler code file isn't necessarily a good 
> idea.
> The problem here is if automatic module reloading is on and you make 
> changes
> to your handler file over time. What will happen is that when the 
> handler code
> file is reloaded, your existing database connection objects will be 
> discarded
> and reinitialised. If normal object cleanup doesn't result in the 
> database
> handles being cleaned up properly, you can get a leak in database 
> resource
> handles and eventually you will run out of connections to the database.
>
> For details on issues like this and others which will affect you with 
> the version
> of mod_python you are running, check out:
>
>   
> http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel 
>
>   http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken
>
> Graham
>
> On 17/09/2006, at 3:44 AM, Jim Gallacher wrote:
>
>> Eric Brunson wrote:
>>> I've been working on a project using mod_python to access a mysql 
>>> database using the MySQLdb API.  I know mod_python is still 
>>> considered beta under Apache 2, so I thought I'd bring an issue to 
>>> the attention of the list.
>>> I was seeing some very bizarre results when generating dynamic 
>>> content from the database, which I first attributed to PSP caching, 
>>> but then investigated further when I switched to using the publisher 
>>> handler.  It may be the way I've set up my modules and database 
>>> connections, but I haven't convinced myself that I really understand 
>>> the problem and until I do, I'm not going to be happy about it.  I 
>>> have found a workaround that I can live with, but I don't really 
>>> like it that much because it requires constantly connecting to and 
>>> disconnection from the database.
>>> The problem was simply getting old, wrong results interleaved with 
>>> new, correct results after updating the database.  Simply put, I'm 
>>> displaying data from a table.  My index.py imports a module for 
>>> generating HTML which, in turn, includes a module for doing database 
>>> access.  The odd thing about how I set up the database access, and I 
>>> think it's pertinent to the problem, was that I automatically 
>>> connect to the database when I import the database module.  Like this:
>>> ----- database.py -----
>>> import MySQLdb
>>> from mod_python import apache
>>> def Connect():
>>>    return MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
>>> dbc = Connect()
>>> def someExampleAccessFunction():
>>>    global dbc
>>>    curs = dbc.cursor()
>>>    curs.execute( "select count(0) from sometable" )
>>>    result = curs.fetchall()[0][0]
>>>    curs.close()
>>>    apache.log_error( "result was %s" % result )
>>>    return result
>>> ----- end database.py -----
>>> Let's disregard whether that's good programming practice or not, the 
>>> fact is, I could query that value several times by doing a page 
>>> reload, then delete a record from the database and commit the 
>>> change, then subsequent page loads would interleave old results with 
>>> new results, seemingly cyclically.
>>> The key to my confusion is that the error logs for apache would show 
>>> a message for every page reload, and the result from the query would 
>>> agree with whatever data was displayed on the page, correct or 
>>> incorrect.  Meanwhile a direct query to the database from the 
>>> command line would always return the correct result from the database.
>>> My best guess so far is that multiple threads in apache get multiple 
>>> copies of mod_python, each with it's own copy of the imported 
>>> database module in memory and each module maintaining a different 
>>> database connection that is somehow caching results.  I've never 
>>> seen this behavior in any application until I tried this under 
>>> mod_python.  I was able to force the correct results to always be 
>>> returned by getting rid of the module variable, dbc, and moving the 
>>> mysqldb.connect() call to inside each function call, opening the 
>>> database connection, executing my sql, then closing the database 
>>> connection.  This is less than optimal, since I may make several 
>>> database queries during each page load, so later today I'll try 
>>> making the database connection in the index.py, then passing the 
>>> connection handle to each of the calls that need it.  Also a little 
>>> less than optimal, but tolerable.
>>> Does anyone have any insight into this behavior?  It's more of an 
>>> academic question at this point, but I wonder if it may lead to an 
>>> improvement if we were able to identify the problem and implement a 
>>> transparent fix.  Also, feel free to let me know if I'm completely 
>>> offbase with my theory of what's going on under the hood.
>>
>> Your assessment with respect to having multiple copies of mod_python, 
>> each with its own copy of the imported modules and data is correct. 
>> It is not a bug but rather the way apache works. Depending on which 
>> apache-mpm you are using (either prefork or worker on Fedora) and 
>> your configuration, you may have anywhere from a few, to dozens of 
>> independent child processes. Indeed if you are using the prefork mpm 
>> on a heavily loaded server you could have hundreds of processes. In 
>> such cases using a persistent db connection will likely cause 
>> problems with exhausting the number of available mysql connections. 
>> Persistent connections in such a scenario are discouraged in general 
>> - not just in mod_python.
>>
>> As to your particular problem, I wonder if you are using 
>> transactions, but are not committing immediately after an update? The 
>> process which apache chooses to to handle a request is random. Say 
>> for example you update in process A without a commit. The next 
>> request may be handled by  another process, which will see the old 
>> data. A subsequent request may then come in but be handled by process 
>> A again, which will see the new data since it is using the same 
>> connection as that used for the update. Thus you will get the 
>> interleaving effect.
>>
>> This is not unique to db connections. Don't be fooled into thinking 
>> that module-level attributes are global across your application as 
>> they are not. In anything other than winnt-mpm (which is a single, 
>> threaded process), you will have multiple, independent copies of that 
>> variable.
>>
>> Opening and closing your db connection for each request is the usual 
>> solution, as you've discovered. It is possible to do connection 
>> pooling, but you need to be a little smarter about it ensure you 
>> don't run into problems or exhaust the number of mysql connections 
>> configured. Don't forget that leaving open a connection consumes 
>> memory resources as well.
>>
>> This is not to say that you need to open and close the connection 
>> each time you want to access the database within a request. The usual 
>> method is to stuff your db connection into the request object itself. 
>> For example:
>>
>> def handler(req):
>>     req.db = MySQLdb.connect( 'mysql://me:pass@localhost/mydatabase' )
>>     req.register_cleanup(close_db, req.db)
>>     delete_stuff(req)
>>     add_stuff(req)
>>     req.write('stuff done')
>>     return apache.OK
>>
>> def add_stuff(req):
>>     cur = req.db.cursor()
>>     cur.execute("insert into stuff (foo) values ('bar')")
>>     cur.close()
>>
>> def add_stuff(req):
>>     cur = req.db.cursor()
>>     cur.execute("DELETE from stuff where foo = 'baz'")
>>     cur.close()
>>
>> def close_db(db):
>>     db.close()
>>
>> Notice the use of register_cleanup() to register a function which 
>> will close the connection, rather than explicitly closing it. This 
>> ensures that your db connection will always be closed, even if an 
>> exception occurs somewhere in your code.
>>
>> Jim
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python

From yjfuk at 126.com  Sun Sep 17 22:21:17 2006
From: yjfuk at 126.com (yjfuk)
Date: Sun Sep 17 22:22:49 2006
Subject: [mod_python] how to compile mod_python3.2.10  in the windows,
 is there something to reference
Message-ID: <450E029D.5060509@126.com>

how to compile mod_python3.2.10 in the windows,is there something to
reference

From nicolas at lehuen.com  Mon Sep 18 02:51:14 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Mon Sep 18 02:51:19 2006
Subject: [mod_python] how to compile mod_python3.2.10 in the windows,
	is there something to reference
In-Reply-To: <450E029D.5060509@126.com>
References: <450E029D.5060509@126.com>
Message-ID: <c298f2d70609172351w57a1302en7c9cdbb7fb2c6972@mail.gmail.com>

Hi,

No, the reference is strongly lacking right now, I really need to do
something about this.

1) Here are the requirements :

- For Python 2.3, Visual Studio 6 (only the C++ compiler is required)
- For Python 2.4, Visual Studio .NET 2003 (only the C++ compiler is
required)
- An Apache 2.0 or 2.2 binary installation

I know, the dependency on the Microsoft payware is quite annoying. But then
again, it's nearly the same as when building Python itself. I need to
perform a few experiments with MinGW or the new free Microsoft C++ compiler
in order to get a full free building environment.

2) You then set the APACHESRC environment variable to the root directory of
the Apache Setup. Be careful, if you compile mod_python against an Apache
2.0 distrib, it won't work with an Apache 2.2 distrib, and vice versa.

3) Just cd to the dist directory of your mod_python source directory.

4) Launch build_installer.bat

5) If everything is correctly configured, you should get an installer in the
dist/dist directory.

Regards,
Nicolas

2006/9/18, yjfuk <yjfuk@126.com>:
>
> how to compile mod_python3.2.10 in the windows,is there something to
> reference
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060918/9ef3dd31/attachment.html
From Guy.CARTWRIGHT at rbos.com  Mon Sep 18 09:13:03 2006
From: Guy.CARTWRIGHT at rbos.com (CARTWRIGHT, Guy, GBM)
Date: Mon Sep 18 09:18:25 2006
Subject: [mod_python] Cookies & mod_rewrite
Message-ID: <30213CE8581C6C418BD0941763A1E2D4353764@lonms01001.fm.rbsgrp.net>

Hi

I'm using mod_python to perform NTLM authentication. In my handler script
"ntlmhandler.py" a cookie gets set using the following code:

cookie = Cookie.Cookie('username', user, path='/')
Cookie.add_cookie(req, cookie)   

With the following apache conf for some reason the cookie is not getting
passed in the request to the rewrite url. When requesting a page in the
/ntlm directory without the rewrite rule in place, the above cookie is
getting set fine. Does anybody have any ideas why this might be the case?

<VirtualHost 192.168.100.100:80>
    ServerName myserver.com
    KeepAlive On

    DocumentRoot /ntlm/

    <Directory /ntlm> 
        AddHandler mod_python .py
        PythonAuthenHandler ntlmhandler
        PythonDebug On
        AuthType NTLM
        require valid-user

        RewriteEngine On
        RewriteRule ^(.*)$
http://192.168.100.100:5090/VirtualHostBase/http/myserver.com:80/dev/content
_root/VirtualHostRoot/$1 [P,L]    

    </Directory>    

</VirtualHost>

Regards

Guy

***********************************************************************************
The Royal Bank of Scotland plc. Registered in Scotland No 90312. Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB. 
Authorised and regulated by the Financial Services Authority 
 
This e-mail message is confidential and for use by the 
addressee only. If the message is received by anyone other 
than the addressee, please return the message to the sender 
by replying to it and then delete the message from your 
computer. Internet e-mails are not necessarily secure. The 
Royal Bank of Scotland plc does not accept responsibility for 
changes made to this message after it was sent. 

Whilst all reasonable care has been taken to avoid the 
transmission of viruses, it is the responsibility of the recipient to 
ensure that the onward transmission, opening or use of this 
message and any attachments will not adversely affect its 
systems or data. No responsibility is accepted by The 
Royal Bank of Scotland plc in this regard and the recipient should carry 
out such virus and other checks as it considers appropriate. 
Visit our websites at: 
http://www.rbos.com
http://www.rbsmarkets.com 
***********************************************************************************
From durumdara at gmail.com  Mon Sep 18 10:59:50 2006
From: durumdara at gmail.com (durumdara)
Date: Mon Sep 18 10:59:58 2006
Subject: [mod_python] Lama, sorry: Windows, Apache 2.2.3, ModPy
Message-ID: <450EB466.2030400@gmail.com>

Hi !

Sorry for Lamaism.

I used modpy in the years 2002-2003, but later I need to use Zope, so I 
forget many things in it.

Then now I want to install it in WXP, with Py2.4.

The first installation is not working, because when I start apache 2.2.3 
with httpd -x, it showed error message (some function(s) not found in 
the library).
The latest modpy versions are not working for me with Apache 2.2.3
Next I trying to downgrade the version of modpy.
The Apache is starting succf. with 3.2.10 version of modpy.

But when I trying with the test.py, the source of the py showed, not the 
result of.

Next I tried with manually loading of mod_py. I started the interpreter, 
and tried to import something from modpy lib.
And then I get error too: no module _apache.

How to I get solution to this problem ?
Every of the tests are showing Unix-based examples/solutions, but I need 
to working on XP.

Sorry for bas english, I must write quickly... :-(

Thanks for your help:
    dd


From grahamd at dscpl.com.au  Mon Sep 18 18:01:36 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 18 18:01:40 2006
Subject: [mod_python] Lama, sorry: Windows, Apache 2.2.3, ModPy
Message-ID: <1158616896.25838@dscpl.user.openhosting.com>

durumdara wrote ..
> Hi !
> 
> Sorry for Lamaism.
> 
> I used modpy in the years 2002-2003, but later I need to use Zope, so I
> forget many things in it.
> 
> Then now I want to install it in WXP, with Py2.4.
> 
> The first installation is not working, because when I start apache 2.2.3
> with httpd -x, it showed error message (some function(s) not found in 
> the library).
> The latest modpy versions are not working for me with Apache 2.2.3
> Next I trying to downgrade the version of modpy.
> The Apache is starting succf. with 3.2.10 version of modpy.
> 
> But when I trying with the test.py, the source of the py showed, not the
> result of.

If Apache showed mod_python loading with no error and you got this,
it is possibly a misconfiguration on your part. I would suggest you might
step through the procedure outlined in:

  http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking

> Next I tried with manually loading of mod_py. I started the interpreter,
> and tried to import something from modpy lib.
> And then I get error too: no module _apache.

That is normal.

> How to I get solution to this problem ?
> Every of the tests are showing Unix-based examples/solutions, but I need
> to working on XP.
> 
> Sorry for bas english, I must write quickly... :-(

Write more slowly then. ;-)

Graham
From grahamd at dscpl.com.au  Mon Sep 18 18:13:14 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 18 18:13:16 2006
Subject: [mod_python] Cookies & mod_rewrite
Message-ID: <1158617594.32441@dscpl.user.openhosting.com>

CARTWRIGHT, Guy, GBM wrote ..
> Hi
> 
> I'm using mod_python to perform NTLM authentication. In my handler script
> "ntlmhandler.py" a cookie gets set using the following code:
> 
> cookie = Cookie.Cookie('username', user, path='/')
> Cookie.add_cookie(req, cookie)   
> 
> With the following apache conf for some reason the cookie is not getting
> passed in the request to the rewrite url. When requesting a page in the
> /ntlm directory without the rewrite rule in place, the above cookie is
> getting set fine. Does anybody have any ideas why this might be the case?
> 
> <VirtualHost 192.168.100.100:80>
>     ServerName myserver.com
>     KeepAlive On
> 
>     DocumentRoot /ntlm/
> 
>     <Directory /ntlm> 
>         AddHandler mod_python .py

You don't need AddHandler if you aren't defining a response handler, ie. only
need that or SetHandler when using PythonHandler directive.

>         PythonAuthenHandler ntlmhandler

Have you added logging in your authenhandler and know for sure that it is being
called?

>         PythonDebug On
>         AuthType NTLM
>         require valid-user
> 
>         RewriteEngine On
>         RewriteRule ^(.*)$
> http://192.168.100.100:5090/VirtualHostBase/http/myserver.com:80/dev/content
> _root/VirtualHostRoot/$1 [P,L]    
> 
>     </Directory>    
> 
> </VirtualHost>

I am not very good at mod_rewrite, but I read this as you using mod_rewrite to
proxy the request through to a backend server. If this is true and your
expectation is that the cookie will be passed through to the backend to be used
there somehow before perhaps also being sent back to the client, your
assumption would be wrong. This is because setting a cookie in the
authenhandler is going to be done in the headers_out where only headers_in
would be getting proxied through.

Is that what you were expecting?

Graham

From grahamd at dscpl.com.au  Mon Sep 18 18:26:00 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 18 18:26:03 2006
Subject: [mod_python] Cookies & mod_rewrite
Message-ID: <1158618359.6442@dscpl.user.openhosting.com>

CARTWRIGHT, Guy, GBM wrote ..
>         RewriteEngine On
>         RewriteRule ^(.*)$
> http://192.168.100.100:5090/VirtualHostBase/http/myserver.com:80/dev/content
> _root/VirtualHostRoot/$1 [P,L]    

BTW. not that it will help in your case, but in mod_python 3.3 it will be
possible to set up proxying of requests from within a mod_python
handler.

I don't know about others, but I find mod_rewrite to be hard to
follow at the best of times and so being able to setup proxying from
Python code is a welcome addition. :-)

See:

  http://issues.apache.org/jira/browse/MODPYTHON-141

for further details.

Graham
From durumdara at gmail.com  Tue Sep 19 04:10:46 2006
From: durumdara at gmail.com (durumdara)
Date: Tue Sep 19 04:10:48 2006
Subject: [mod_python] Lama, sorry: Windows, Apache 2.2.3, ModPy
In-Reply-To: <1158616896.25838@dscpl.user.openhosting.com>
References: <1158616896.25838@dscpl.user.openhosting.com>
Message-ID: <450FA606.1060402@gmail.com>

Hi !

Graham Dumpleton ?rta:
> If Apache showed mod_python loading with no error and you got this,
> it is possibly a misconfiguration on your part. I would suggest you might
> step through the procedure outlined in:
>
>   http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking
>
>   

Thanks ! It is worked for me, but...

... I want to hear the position of the BigModPythonGurus on this question:

Why I got Apache error messages when I try to use the latest version of 
modpy ? What's the function name that missing from so/dll ?
Why it isn't documented ?

Apache 2.2.3 / later versions than modpy 3.2.10 / Python 2.4

Thanks for your help:
  dd

From nicolas at lehuen.com  Tue Sep 19 05:15:29 2006
From: nicolas at lehuen.com (Nicolas Lehuen)
Date: Tue Sep 19 05:15:33 2006
Subject: [mod_python] Lama, sorry: Windows, Apache 2.2.3, ModPy
In-Reply-To: <450FA606.1060402@gmail.com>
References: <1158616896.25838@dscpl.user.openhosting.com>
	<450FA606.1060402@gmail.com>
Message-ID: <c298f2d70609190215j1faa87e4kfd5ce652301e129a@mail.gmail.com>

Hi,

You have to use the mod_python binary version that matches your Apache
version. I've built a binary version for Apache 2.0 and one for Apache 2.2,
as mentionned in the filename.

Regards,
Nicolas

2006/9/19, durumdara <durumdara@gmail.com>:
>
> Hi !
>
> Graham Dumpleton ?rta:
> > If Apache showed mod_python loading with no error and you got this,
> > it is possibly a misconfiguration on your part. I would suggest you
> might
> > step through the procedure outlined in:
> >
> >
> http://www.dscpl.com.au/wiki/ModPython/Articles/GettingModPythonWorking
> >
> >
>
> Thanks ! It is worked for me, but...
>
> ... I want to hear the position of the BigModPythonGurus on this question:
>
> Why I got Apache error messages when I try to use the latest version of
> modpy ? What's the function name that missing from so/dll ?
> Why it isn't documented ?
>
> Apache 2.2.3 / later versions than modpy 3.2.10 / Python 2.4
>
> Thanks for your help:
>   dd
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060919/94244a26/attachment.html
From Guy.CARTWRIGHT at rbos.com  Tue Sep 19 09:24:21 2006
From: Guy.CARTWRIGHT at rbos.com (CARTWRIGHT, Guy, GBM)
Date: Tue Sep 19 09:24:42 2006
Subject: [mod_python] Cookies & mod_rewrite
Message-ID: <30213CE8581C6C418BD0941763A1E2D4353768@lonms01001.fm.rbsgrp.net>

>Have you added logging in your authenhandler and know for sure that it is
being called?

Yep, it's definitely being called

>I am not very good at mod_rewrite, but I read this as you using mod_rewrite
to proxy the request 
>through to a backend server. If this is true and your expectation is that
the cookie will be passed
>through to the backend to be used there somehow before perhaps also being
sent back to the client,
>your assumption would be wrong. This is because setting a cookie in the
authenhandler is going to be 
>done in the headers_out where only headers_in would be getting proxied
through.

>Is that what you were expecting?

Yeah, that's what I was expecting or wanted to happen. Is there any way of
setting a cookie in the handler that can be read by the back-end server?
Maybe changing headers_in?

Thanks & reagrds

Guy

***********************************************************************************
The Royal Bank of Scotland plc. Registered in Scotland No 90312. Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB. 
Authorised and regulated by the Financial Services Authority 
 
This e-mail message is confidential and for use by the 
addressee only. If the message is received by anyone other 
than the addressee, please return the message to the sender 
by replying to it and then delete the message from your 
computer. Internet e-mails are not necessarily secure. The 
Royal Bank of Scotland plc does not accept responsibility for 
changes made to this message after it was sent. 

Whilst all reasonable care has been taken to avoid the 
transmission of viruses, it is the responsibility of the recipient to 
ensure that the onward transmission, opening or use of this 
message and any attachments will not adversely affect its 
systems or data. No responsibility is accepted by The 
Royal Bank of Scotland plc in this regard and the recipient should carry 
out such virus and other checks as it considers appropriate. 
Visit our websites at: 
http://www.rbos.com
http://www.rbsmarkets.com 
***********************************************************************************
From rl at ronaldlevine.com  Tue Sep 19 15:19:33 2006
From: rl at ronaldlevine.com (Ronald Levine)
Date: Tue Sep 19 15:21:30 2006
Subject: [mod_python] Cant make test work
Message-ID: <mnf0h21jbnfo0eb5bkpkflv7ti6i60p2fi@4ax.com>

Installed mod_python 3.2.10 into this environment
	OS CentOS 4 (default in the Rocks 4.1 distribution)
	Apache 2.0.52
	Python 2.3

Followed the install instructions to the letter.
However the test does not work for me. I.e., pointing my browser at
http://localhost/mptest/mptest.py
just returns the listing of mptest.py, but not the results of running
it against the python interpreter.

/etc/httpd/conf/httpd.conf does contain the line
LoadModule python_module modules/mod_python.so


and /usr/lib/httpd/modules/mod_python.so exists.

/var/www/html/mptest/.htaccess does contain
AddHandler python_module .py
PythonHandler mptest 
PythonDebug On 

and mptest.py contains

from mod_python import apache
def handler(req):
   req.content_type = 'text/plain'
   req.write("Hello World!")
   return apache.OK

I'm stuck

Ronald

From grahamd at dscpl.com.au  Tue Sep 19 16:53:44 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 19 16:54:46 2006
Subject: [mod_python] Cant make test work
In-Reply-To: <mnf0h21jbnfo0eb5bkpkflv7ti6i60p2fi@4ax.com>
References: <mnf0h21jbnfo0eb5bkpkflv7ti6i60p2fi@4ax.com>
Message-ID: <F8A83399-7212-40C0-976A-81E20DE5C2B2@dscpl.com.au>


On 20/09/2006, at 5:19 AM, Ronald Levine wrote:

> Installed mod_python 3.2.10 into this environment
> 	OS CentOS 4 (default in the Rocks 4.1 distribution)
> 	Apache 2.0.52
> 	Python 2.3
>
> Followed the install instructions to the letter.
> However the test does not work for me. I.e., pointing my browser at
> http://localhost/mptest/mptest.py
> just returns the listing of mptest.py, but not the results of running
> it against the python interpreter.
>
> /etc/httpd/conf/httpd.conf does contain the line
> LoadModule python_module modules/mod_python.so
>
>
> and /usr/lib/httpd/modules/mod_python.so exists.
>
> /var/www/html/mptest/.htaccess does contain
> AddHandler python_module .py

It isn't 'python_module' for a start. For the version of mod_python
you are using, use:

   AddHandler mod_python .py

> PythonHandler mptest
> PythonDebug On
>
> and mptest.py contains
>
> from mod_python import apache
> def handler(req):
>    req.content_type = 'text/plain'
>    req.write("Hello World!")
>    return apache.OK
>
> I'm stuck

Try the following alternate set of instructions.

   http://www.dscpl.com.au/wiki/ModPython/Articles/ 
GettingModPythonWorking

It steps you through some of the other configuration issues you might be
missing.

Graham
From grahamd at dscpl.com.au  Tue Sep 19 16:56:39 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 19 16:57:41 2006
Subject: [mod_python] Cookies & mod_rewrite
In-Reply-To: <30213CE8581C6C418BD0941763A1E2D4353768@lonms01001.fm.rbsgrp.net>
References: <30213CE8581C6C418BD0941763A1E2D4353768@lonms01001.fm.rbsgrp.net>
Message-ID: <6E7CD034-9BA0-4234-BFF9-21F0CE5B5374@dscpl.com.au>

 From memory, you can set req.headers_in and it will go through to
backend via proxy. Give it a try anyway. Simply go:

   req.headers_in['X-MyHeader'] = 'test'

and see if it gets through.

Graham

On 19/09/2006, at 11:24 PM, CARTWRIGHT, Guy, GBM wrote:

>> Have you added logging in your authenhandler and know for sure  
>> that it is
> being called?
>
> Yep, it's definitely being called
>
>> I am not very good at mod_rewrite, but I read this as you using  
>> mod_rewrite
> to proxy the request
>> through to a backend server. If this is true and your expectation  
>> is that
> the cookie will be passed
>> through to the backend to be used there somehow before perhaps  
>> also being
> sent back to the client,
>> your assumption would be wrong. This is because setting a cookie  
>> in the
> authenhandler is going to be
>> done in the headers_out where only headers_in would be getting  
>> proxied
> through.
>
>> Is that what you were expecting?
>
> Yeah, that's what I was expecting or wanted to happen. Is there any  
> way of
> setting a cookie in the handler that can be read by the back-end  
> server?
> Maybe changing headers_in?
>
> Thanks & reagrds
>
> Guy
>
> ********************************************************************** 
> *************
> The Royal Bank of Scotland plc. Registered in Scotland No 90312.  
> Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB.
> Authorised and regulated by the Financial Services Authority
>
> This e-mail message is confidential and for use by the
> addressee only. If the message is received by anyone other
> than the addressee, please return the message to the sender
> by replying to it and then delete the message from your
> computer. Internet e-mails are not necessarily secure. The
> Royal Bank of Scotland plc does not accept responsibility for
> changes made to this message after it was sent.
>
> Whilst all reasonable care has been taken to avoid the
> transmission of viruses, it is the responsibility of the recipient to
> ensure that the onward transmission, opening or use of this
> message and any attachments will not adversely affect its
> systems or data. No responsibility is accepted by The
> Royal Bank of Scotland plc in this regard and the recipient should  
> carry
> out such virus and other checks as it considers appropriate.
> Visit our websites at:
> http://www.rbos.com
> http://www.rbsmarkets.com
> ********************************************************************** 
> *************
From yjfuk at 126.com  Wed Sep 20 03:13:18 2006
From: yjfuk at 126.com (yjfuk)
Date: Wed Sep 20 03:14:44 2006
Subject: [mod_python] in modpython ,how to restrict the upload file size?
Message-ID: <4510EA0E.9020707@126.com>

in modpython ,how to restrict the upload file size?

From durumdara at gmail.com  Wed Sep 20 06:32:23 2006
From: durumdara at gmail.com (durumdara)
Date: Wed Sep 20 06:32:31 2006
Subject: [mod_python] Good example site with py, psp, and structure
Message-ID: <451118B7.2070900@gmail.com>

Hi !

I want to understand the modpy technics, to I create good structure for 
my new modpy site. An example needed.

I used PHP, Zope, CGI before this project.

If I understand it good, I can specify one handler script for one directory.
Anywhere, where I specify a handler, the handler script working for all 
.py (both for existing and not existing).
So if I need a centralized web application, I need to import a shared 
module that helps me to start and finish to handle the process 
(example:  pre - collect the important informations, make global 
variables, open the db connections, open the session datas; post - save 
the session if need, close the db connection, drop the content if we 
have redirection, etc.). I thinking good ?

1.)
But I need to protect some area in the htdocs (restricted area). How to 
I force it ? (auth module ?). I need to define to every dir I used 
(httpd.conf) ?

2.)
In Zope the header/footer objects used for handle the pre/post actions, 
and the zpts/scripts used for make the content of the page.
Is better to I use psp-s that call pre/post scripts, or is better if I 
use py scripts, and they are get psp-s I need ?

3.)
How to avoid to user type any .py to browser's address textbox, and get 
same result that handler present ?
Example: I use main.py for handle requests. The address is: 
www.foo.hu/main.py.
The user can type www.foo.hu/sux.py, and get same result !

4.)
How to prevent the .py extension showing in the browser ?
To I see (can type):
www.foo.hu/
or
www.foo.hu/index
not
www.foo.hu/index.py.
I want to protect my site - if anyone see it, he/she don't know, what 
engine I used.


Thanks for your answers:
dd





From durumdara at gmail.com  Wed Sep 20 06:34:21 2006
From: durumdara at gmail.com (durumdara)
Date: Wed Sep 20 06:34:26 2006
Subject: [mod_python] Is PSP block embeddable to another PSP block ?
Message-ID: <4511192D.6070806@gmail.com>

Hi !

I search for the same thing in PSP like in Zope ZPT.

<p tal:repeat=....>
    <p tal:replace=....>
        <p tal:repeat=...>
            ....
<%
for i in range(3):
%>
    <p>
    <%= i %>
   </p>
<%
    for j in range(3):
%>
        <p>
        <%= j %>
       </p>


But how can I do ? Anyone knows an example to it ?

Thanks for it:

    dd

From list at joreybump.com  Wed Sep 20 08:18:40 2006
From: list at joreybump.com (Jorey Bump)
Date: Wed Sep 20 08:19:21 2006
Subject: [mod_python] in modpython ,how to restrict the upload file size?
In-Reply-To: <4510EA0E.9020707@126.com>
References: <4510EA0E.9020707@126.com>
Message-ID: <451131A0.40706@joreybump.com>

yjfuk wrote:
> in modpython ,how to restrict the upload file size?

I prefer to do this in the apache config, so it applies to all applications:

# limit size of uploads
# 3MB
LimitRequestBody 3072000

For more info:

 http://httpd.apache.org/docs/2.2/mod/core.html#limitrequestbody
From Guy.CARTWRIGHT at rbos.com  Wed Sep 20 08:45:54 2006
From: Guy.CARTWRIGHT at rbos.com (CARTWRIGHT, Guy, GBM)
Date: Wed Sep 20 08:46:19 2006
Subject: [mod_python] Cookies & mod_rewrite
Message-ID: <30213CE8581C6C418BD0941763A1E2D4353770@lonms01001.fm.rbsgrp.net>

>  From memory, you can set req.headers_in and it will go 
> through to backend via proxy. Give it a try anyway. Simply go:
> 
>    req.headers_in['X-MyHeader'] = 'test'
> 
> and see if it gets through.
> 

No luck with the above, or with:

    req.headers_out['X-MyHeader'] = 'test'

but the following does work and gets passed through to the back-end
server...

    req.err_headers_out['X-MyHeader'] = 'test'
    return apache.OK

Weird...




***********************************************************************************
The Royal Bank of Scotland plc. Registered in Scotland No 90312. Registered Office: 36 St Andrew Square, Edinburgh EH2 2YB. 
Authorised and regulated by the Financial Services Authority 
 
This e-mail message is confidential and for use by the 
addressee only. If the message is received by anyone other 
than the addressee, please return the message to the sender 
by replying to it and then delete the message from your 
computer. Internet e-mails are not necessarily secure. The 
Royal Bank of Scotland plc does not accept responsibility for 
changes made to this message after it was sent. 

Whilst all reasonable care has been taken to avoid the 
transmission of viruses, it is the responsibility of the recipient to 
ensure that the onward transmission, opening or use of this 
message and any attachments will not adversely affect its 
systems or data. No responsibility is accepted by The 
Royal Bank of Scotland plc in this regard and the recipient should carry 
out such virus and other checks as it considers appropriate. 
Visit our websites at: 
http://www.rbos.com
http://www.rbsmarkets.com 
***********************************************************************************
From brunson at brunson.com  Wed Sep 20 13:24:40 2006
From: brunson at brunson.com (Eric Brunson)
Date: Wed Sep 20 13:24:44 2006
Subject: [mod_python] Good example site with py, psp, and structure
In-Reply-To: <451118B7.2070900@gmail.com>
References: <451118B7.2070900@gmail.com>
Message-ID: <45117958.2030102@brunson.com>

durumdara wrote:
> Hi !

Hi,

>
> I want to understand the modpy technics, to I create good structure 
> for my new modpy site. An example needed.

I'm by no means an expert, but I think I can address a couple of your 
questions, I'm sure someone will correct me if I steer you wrong.

>
> I used PHP, Zope, CGI before this project.
I've used PHP and CGI, but never Zope, so I won't be able to make any 
comparisons to Zope.
>
> If I understand it good, I can specify one handler script for one 
> directory.
> Anywhere, where I specify a handler, the handler script working for 
> all .py (both for existing and not existing).

Not precisely (and someone please help out if I express this 
incorrectly).  You can add a handler for dealing with .py files in which 
case .py files will be handled by that handler, or you can set a handler 
for URLs, which will perform a sort of module resolution algorithm on 
the URL.  In the first case, which I'm least familiar with, if you 
associate a handler with a .py file, referencing a file that doesn't 
exist will give you a 404 error.

In the second case apache passes the URL to a python handler, like the 
supplied publisher handler, which is advertised to be modeled after 
Zope's publisher, but I don't know anything about that.  Say I have a 
directory called ip_management (which I do) and you access that 
directory via the URL "http://yourserver/ip_management", and in there 
you have a .htaccess file containing:

SetHandler python-program
PythonHandler mod_python.publisher

You have set the handler for that directory to be the 
mod_python.publisher handler, even if a file "example.html" exists in 
that directory, apache will not server the contents of that file when 
the URL "http://yourserver/ip_management/example.html" is requested.  It 
passes the URL to the specified handler and that python code decides 
what to do with it.  If your python code decides to look for a file with 
that name and serve the contents, then great, but it doesn't have to.

The mod_python.publisher will break the URL up and try to find a python 
module that will satisfy its own rules.  In a simple sense, it takes the 
part of the URL after the directory specification and tries to find a 
module that contains a function of the same name.  So 
"http://yourserver/ip_management/something/otherthing" will result in 
the publisher looking for a module called "something" with a function 
called "otherthing" inside it, then will execute the function 
"otherthing".  If at any point it doesn't find a file or directory with 
the module name it will look through a file called "index.py" for the 
function name.  If it finds a module that matches the fill path, i.e. 
"something.otherthing" then it will try to execute a function called 
"index".

You can write your own handler that will simply be passed the apache 
request object and you can do whatever  your heart desires with it.

> So if I need a centralized web application, I need to import a shared 
> module that helps me to start and finish to handle the process 
> (example:  pre - collect the important informations, make global 
> variables, open the db connections, open the session datas; post - 
> save the session if need, close the db connection, drop the content if 
> we have redirection, etc.). I thinking good ?

Sure, you can do whatever your heart desires in your handler.

>
> 1.)
> But I need to protect some area in the htdocs (restricted area). How 
> to I force it ? (auth module ?). I need to define to every dir I used 
> (httpd.conf) ?

There's an example of writing an auth handler in the documentation.  The 
publisher handler makes it super simple, simply defining a __auth__ 
object in the module, either a list, dict or function, you can 
authenticate a user using Basic HTTP Auth mechanism.  You can also 
define an __auth__ method within your method.  There is also a separate 
__access__ object that can restrict authenticated users do certain 
functions.

I personally let Apache do the authorization, then use __access__ to 
restrict access.  Your milage may vary.

>
> 2.)
> In Zope the header/footer objects used for handle the pre/post 
> actions, and the zpts/scripts used for make the content of the page.
> Is better to I use psp-s that call pre/post scripts, or is better if I 
> use py scripts, and they are get psp-s I need ?

I'm not qualified to judge your architecture.  I don't use PSP, I found 
it a bit cumbersome, I do all my processing in the handler, build my own 
sort of "mini DOM" objects that can render themselves.  Your way should 
work, whether there's a better design is a matter of taste.

>
> 3.)
> How to avoid to user type any .py to browser's address textbox, and 
> get same result that handler present ?
> Example: I use main.py for handle requests. The address is: 
> www.foo.hu/main.py.
> The user can type www.foo.hu/sux.py, and get same result !

It's up to the handler.  Using Apache's "AddHandler somehandler .py" to 
add a handler for python scripts will not serve a non-existent file, you 
will get a 404.  The publisher handler will not server content to a URL 
you have not defined in your code, you will get a 404.  If you write 
your own handler you can do whatever your heart desires.

>
> 4.)
> How to prevent the .py extension showing in the browser ?
> To I see (can type):
> www.foo.hu/
> or
> www.foo.hu/index
> not
> www.foo.hu/index.py.
> I want to protect my site - if anyone see it, he/she don't know, what 
> engine I used.

Please see the answer to #3.

>
>
> Thanks for your answers:
> dd

I'm still learning the intricacies of mod_python myself, but everything 
I've told you is very well documented.  Try reading through the docs, I 
had to go through them a few times before the puzzle pieces started 
falling into place.  It helps to have a passing understanding of the 
Apache API and the Apache request objects.

Hope that helped,
e.


From brunson at brunson.com  Wed Sep 20 13:29:56 2006
From: brunson at brunson.com (Eric Brunson)
Date: Wed Sep 20 13:29:53 2006
Subject: [mod_python] Good example site with py, psp, and structure
In-Reply-To: <45117958.2030102@brunson.com>
References: <451118B7.2070900@gmail.com> <45117958.2030102@brunson.com>
Message-ID: <45117A94.3010905@brunson.com>


I should have proofread this *before* I sent it.

Eric Brunson wrote:
> durumdara wrote:
>> Hi !
>
> Hi,
>
>>
>> I want to understand the modpy technics, to I create good structure 
>> for my new modpy site. An example needed.
>
> I'm by no means an expert, but I think I can address a couple of your 
> questions, I'm sure someone will correct me if I steer you wrong.
>
>>
>> I used PHP, Zope, CGI before this project.
> I've used PHP and CGI, but never Zope, so I won't be able to make any 
> comparisons to Zope.
>>
>> If I understand it good, I can specify one handler script for one 
>> directory.
>> Anywhere, where I specify a handler, the handler script working for 
>> all .py (both for existing and not existing).
>
> Not precisely (and someone please help out if I express this 
> incorrectly).  You can add a handler for dealing with .py files in 
> which case .py files will be handled by that handler, or you can set a 
> handler for URLs, which will perform a sort of module resolution 
> algorithm on the URL.

This statement applies to the mod_python.publisher handler.  A handler 
that you write doesn't have to do any module resolution, you can parse 
and handle the URL however you see fit.

> In the first case, which I'm least familiar with, if you associate a 
> handler with a .py file, referencing a file that doesn't exist will 
> give you a 404 error.
>
> In the second case apache passes the URL to a python handler, like the 
> supplied publisher handler, which is advertised to be modeled after 
> Zope's publisher, but I don't know anything about that.  Say I have a 
> directory called ip_management (which I do) and you access that 
> directory via the URL "http://yourserver/ip_management", and in there 
> you have a .htaccess file containing:
>
> SetHandler python-program
> PythonHandler mod_python.publisher
>
> You have set the handler for that directory to be the 
> mod_python.publisher handler, even if a file "example.html" exists in 
> that directory, apache will not server the contents of that file when 
> the URL "http://yourserver/ip_management/example.html" is requested.  
> It passes the URL to the specified handler and that python code 
> decides what to do with it.  If your python code decides to look for a 
> file with that name and serve the contents, then great, but it doesn't 
> have to.
>
> The mod_python.publisher will break the URL up and try to find a 
> python module that will satisfy its own rules.  In a simple sense, it 
> takes the part of the URL after the directory specification and tries 
> to find a module that contains a function of the same name.  So 
> "http://yourserver/ip_management/something/otherthing" will result in 
> the publisher looking for a module called "something" with a function 
> called "otherthing" inside it, then will execute the function 
> "otherthing".  If at any point it doesn't find a file or directory 
> with the module name it will look through a file called "index.py" for 
> the function name.  If it finds a module that matches the fill path, 
> i.e. "something.otherthing" then it will try to execute a function 
> called "index".
>
> You can write your own handler that will simply be passed the apache 
> request object and you can do whatever  your heart desires with it.
>
>> So if I need a centralized web application, I need to import a shared 
>> module that helps me to start and finish to handle the process 
>> (example:  pre - collect the important informations, make global 
>> variables, open the db connections, open the session datas; post - 
>> save the session if need, close the db connection, drop the content 
>> if we have redirection, etc.). I thinking good ?
>
> Sure, you can do whatever your heart desires in your handler.
>
>>
>> 1.)
>> But I need to protect some area in the htdocs (restricted area). How 
>> to I force it ? (auth module ?). I need to define to every dir I used 
>> (httpd.conf) ?
>
> There's an example of writing an auth handler in the documentation.  
> The publisher handler makes it super simple, simply defining a 
> __auth__ object in the module, either a list, dict or function, you 
> can authenticate a user using Basic HTTP Auth mechanism.  You can also 
> define an __auth__ method within your method.  There is also a 
> separate __access__ object that can restrict authenticated users do 
> certain functions.
>
> I personally let Apache do the authorization, then use __access__ to 
> restrict access.  Your milage may vary.
>
>>
>> 2.)
>> In Zope the header/footer objects used for handle the pre/post 
>> actions, and the zpts/scripts used for make the content of the page.
>> Is better to I use psp-s that call pre/post scripts, or is better if 
>> I use py scripts, and they are get psp-s I need ?
>
> I'm not qualified to judge your architecture.  I don't use PSP, I 
> found it a bit cumbersome, I do all my processing in the handler, 
> build my own sort of "mini DOM" objects that can render themselves.  
> Your way should work, whether there's a better design is a matter of 
> taste.
>
>>
>> 3.)
>> How to avoid to user type any .py to browser's address textbox, and 
>> get same result that handler present ?
>> Example: I use main.py for handle requests. The address is: 
>> www.foo.hu/main.py.
>> The user can type www.foo.hu/sux.py, and get same result !
>
> It's up to the handler.  Using Apache's "AddHandler somehandler .py" 
> to add a handler for python scripts will not serve a non-existent 
> file, you will get a 404.  The publisher handler will not server 
> content to a URL you have not defined in your code, you will get a 
> 404.  If you write your own handler you can do whatever your heart 
> desires.
>
>>
>> 4.)
>> How to prevent the .py extension showing in the browser ?
>> To I see (can type):
>> www.foo.hu/
>> or
>> www.foo.hu/index
>> not
>> www.foo.hu/index.py.
>> I want to protect my site - if anyone see it, he/she don't know, what 
>> engine I used.
>
> Please see the answer to #3.
>
>>
>>
>> Thanks for your answers:
>> dd
>
> I'm still learning the intricacies of mod_python myself, but 
> everything I've told you is very well documented.  Try reading through 
> the docs, I had to go through them a few times before the puzzle 
> pieces started falling into place.  It helps to have a passing 
> understanding of the Apache API and the Apache request objects.
>
> Hope that helped,
> e.
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From paddu12 at gmail.com  Wed Sep 20 22:26:24 2006
From: paddu12 at gmail.com (Padmashree B)
Date: Wed Sep 20 22:26:29 2006
Subject: [mod_python] Integration of CGI with Mod Python
Message-ID: <5fb2ad360609201926m53f26d38iadf420db6316c16f@mail.gmail.com>

Hi all,
I am in the process of customising a wiki engine Leonardo
http://leonardo.pyworks.org written in CGI( especially the authentication
part ) to work with our intranet portal TCENet http://203.129.194.18/
whose session and cookie stuff is written using Mod python.. Is there a way
to integrate these both. as in use same session ID for both Leonardo and
TCENet once Leonardo comes inside our TCENet package.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060921/bba4cd55/attachment.html
From sandipm at talentica.com  Thu Sep 21 01:20:52 2006
From: sandipm at talentica.com (sandip)
Date: Thu Sep 21 01:20:59 2006
Subject: [mod_python] util.Fieldstorage and form   
References: <451118B7.2070900@gmail.com> <45117958.2030102@brunson.com>
	<45117A94.3010905@brunson.com>
Message-ID: <013e01c6dd3d$b6b5a920$c7010a0a@talentica.com>

Hi all,
    Other day i was trying to build upload functionality in psp. I am 
handling form(method: POST) submission in psp.
this form contain a hidden element and  a element of type file for upload.
I observed certain things. When I use form['field'] to access value of 
hidden form element,and in same code
if I use FieldStorage(req) to get the attributes of uploaded file. I can't 
access file attributes.

but if I use only FieldStorage to access all the elements of form, I could 
access it.

so why can't I  use both form and FieldStorage in same code?


Thanks
Sandip



From jpg at jgassociates.ca  Thu Sep 21 08:32:03 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Sep 21 08:32:20 2006
Subject: [mod_python] util.Fieldstorage and form
In-Reply-To: <013e01c6dd3d$b6b5a920$c7010a0a@talentica.com>
References: <451118B7.2070900@gmail.com>
	<45117958.2030102@brunson.com>	<45117A94.3010905@brunson.com>
	<013e01c6dd3d$b6b5a920$c7010a0a@talentica.com>
Message-ID: <45128643.50703@jgassociates.ca>

sandip wrote:
> Hi all,
>    Other day i was trying to build upload functionality in psp. I am 
> handling form(method: POST) submission in psp.
> this form contain a hidden element and  a element of type file for upload.
> I observed certain things. When I use form['field'] to access value of 
> hidden form element,and in same code
> if I use FieldStorage(req) to get the attributes of uploaded file. I 
> can't access file attributes.
> 
> but if I use only FieldStorage to access all the elements of form, I 
> could access it.
> 
> so why can't I  use both form and FieldStorage in same code?

The form you see in psp is actually a FieldStorage instance which is 
automatically created when the psp parse encounters mention of the form 
variable.

FieldStorage may only be called once per request, as it consumes the 
request body. Wnen it is called a second time, there is nothing left to 
read.

The usual solution is to store a reference to the form in your request 
object, and pass that around to any functions that need it.

<%
   stuff = form['stuff']
   req.form = form
%>

You'll then be able to access the form in code outside of the psp page.

Jim

From sandipm at talentica.com  Thu Sep 21 09:17:12 2006
From: sandipm at talentica.com (sandip)
Date: Thu Sep 21 09:17:36 2006
Subject: [mod_python] util.Fieldstorage and form
References: <451118B7.2070900@gmail.com>
	<45117958.2030102@brunson.com>	<45117A94.3010905@brunson.com>
	<013e01c6dd3d$b6b5a920$c7010a0a@talentica.com>
	<45128643.50703@jgassociates.ca>
Message-ID: <024a01c6dd80$422fd060$c7010a0a@talentica.com>

Thanks Jim. This explains the puzzle.
but form['filefield'] doesn't work for accessing file data.
how to use form to access file data? or Is form being implemented partially 
in mod_python?

thanks
sandip


----- Original Message ----- 
From: "Jim Gallacher" <jpg@jgassociates.ca>
To: "sandip" <sandip.more@gmail.com>
Cc: <mod_python@modpython.org>
Sent: Thursday, September 21, 2006 6:02 PM
Subject: Re: [mod_python] util.Fieldstorage and form


> sandip wrote:
>> Hi all,
>>    Other day i was trying to build upload functionality in psp. I am 
>> handling form(method: POST) submission in psp.
>> this form contain a hidden element and  a element of type file for 
>> upload.
>> I observed certain things. When I use form['field'] to access value of 
>> hidden form element,and in same code
>> if I use FieldStorage(req) to get the attributes of uploaded file. I 
>> can't access file attributes.
>>
>> but if I use only FieldStorage to access all the elements of form, I 
>> could access it.
>>
>> so why can't I  use both form and FieldStorage in same code?
>
> The form you see in psp is actually a FieldStorage instance which is 
> automatically created when the psp parse encounters mention of the form 
> variable.
>
> FieldStorage may only be called once per request, as it consumes the 
> request body. Wnen it is called a second time, there is nothing left to 
> read.
>
> The usual solution is to store a reference to the form in your request 
> object, and pass that around to any functions that need it.
>
> <%
>   stuff = form['stuff']
>   req.form = form
> %>
>
> You'll then be able to access the form in code outside of the psp page.
>
> Jim
> 

From durumdara at gmail.com  Fri Sep 22 04:22:40 2006
From: durumdara at gmail.com (durumdara)
Date: Fri Sep 22 04:22:47 2006
Subject: [mod_python] Good example site with py, psp, and structure
In-Reply-To: <45117958.2030102@brunson.com>
References: <451118B7.2070900@gmail.com> <45117958.2030102@brunson.com>
Message-ID: <45139D50.8080302@gmail.com>

Hi !

Eric Brunson ?rta:
>> If I understand it good, I can specify one handler script for one 
>> directory.
>> Anywhere, where I specify a handler, the handler script working for 
>> all .py (both for existing and not existing).
>
> Not precisely (and someone please help out if I express this 
> incorrectly).  You can add a handler for dealing with .py files in 
> which case .py files will be handled by that handler, or you can set a 
> handler for URLs, which will perform a sort of module resolution 
> algorithm on the URL.  In the first case, which I'm least familiar 
> with, if you associate a handler with a .py file, referencing a file 
> that doesn't exist will give you a 404 error.
>
When I used this model (see below),  I not got error: every py filename
accepted, but only mptest.py started:

    LoadModule python_module modules/mod_python.so

    <Directory c:/web/apache22/htdocs/>
      AddHandler python-program .py
      PythonHandler mptest
      PythonDebug On
    </Directory>

    mptest.py:

    from mod_python import apache

    def handler(req):
          req.content_type = 'text/html'
          req.write('Handler: mptest.py<br>')
          req.write('Actual (URL defined) filename: '+req.filename)
          req.write('<br>Some random number: ')
          import random
          req.write(str(random.randint(0,1000)))
          return apache.OK

The URL I write:

    http://localhost:7080/index_ssss.py

The result is:

    Handler: mptest.py
    Actual (URL defined) filename: C:/web/apache22/htdocs/index_ssss.py
    Some random number: 594

The index_ssss does not exists, but the handler catched it, and handle
the request with mptest.py.

So I don't get 404 error, but this is good for me: I can handle every
problem in one script !

Thanks for your help:
    dd


From durumdara at gmail.com  Fri Sep 22 04:24:20 2006
From: durumdara at gmail.com (durumdara)
Date: Fri Sep 22 04:24:24 2006
Subject: [mod_python] Subdirectory handler...
Message-ID: <45139DB4.1030904@gmail.com>

Hi !

Can I define a python handler that global for htdocs and subdirectories 
too ?
How to do it ?

Thanks for help:
    dd
From jpg at jgassociates.ca  Fri Sep 22 08:38:10 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep 22 08:38:14 2006
Subject: [mod_python] Subdirectory handler...
In-Reply-To: <45139DB4.1030904@gmail.com>
References: <45139DB4.1030904@gmail.com>
Message-ID: <4513D932.9030606@jgassociates.ca>

durumdara wrote:
> Hi !
> 
> Can I define a python handler that global for htdocs and subdirectories 
> too ?
> How to do it ?

Same as you are doing now, but in the server context (or virtual host
context), not the directory context. The only trick is to make sure your 
script is on your python path so mod_python can find it. If it is 
outside your python path, use the PythonPath directive

# Setup the default handler
# Handler script is /tmp/stuff/foo.py

AddHandler mod_python .py
PythonHandler foo
PythonPath "['/tmp/stuff',] + sys.path"
PythonDebug On


<Directory c:/web/apache22/htdocs/>
  # htdocs and subdirectories will be handled by
  # the default /tmp/stuff/foo.py script
</Directory>

# you can override the default handler for a subdirectory

<Directory c:/web/apache22/htdocs/special/>
   AddHandler mod_python .py
   PythonHandler bar
   PythonDebug On
</Directory>

Jim
From paddu12 at gmail.com  Fri Sep 22 10:08:08 2006
From: paddu12 at gmail.com (Padmashree B)
Date: Fri Sep 22 10:08:38 2006
Subject: [mod_python] Is PSP block embeddable to another PSP block ?
In-Reply-To: <4511192D.6070806@gmail.com>
References: <4511192D.6070806@gmail.com>
Message-ID: <5fb2ad360609220708r2def2500ie15a9de813a09873@mail.gmail.com>

Hi.. i am trying to figure out cgi code written using Python..
I create a cookie using
import Cookie
c=Cookie.SimpleCookie()
c["cookie1"]="value1"

Now when I want to retrive the cookie value in CGI written using python do I
necessary have to depend on the environment variable HTTP_COOKIE which is
set in os.environ..

as in

thiscookie = Cookie.SimpleCookie()
if os.environ.has_key('HTTP_COOKIE'):
    thiscookie.load(os.environ['HTTP_COOKIE'])
 print thiscookie['aparam'].value

Is there any other way to do without using the variable HTTP_COOKIE set in
os.environ..

Also, is it ok to use this code in mod_python.. as in getting the cookie
values using the environment variable HTTP_COOKIE...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060922/0e06f782/attachment.html
From paddu12 at gmail.com  Fri Sep 22 10:10:14 2006
From: paddu12 at gmail.com (Padmashree B)
Date: Fri Sep 22 10:10:18 2006
Subject: [mod_python] CGI in Python Cookies
Message-ID: <5fb2ad360609220710m22f4deduc211f9fc543afe71@mail.gmail.com>

http://www.voidspace.org.uk/python/articles/cgi_web_applications_two.shtml
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060922/dcf7f5aa/attachment.html
From grahamd at dscpl.com.au  Mon Sep 25 04:24:30 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 25 04:25:36 2006
Subject: [mod_python] Is PSP block embeddable to another PSP block ?
In-Reply-To: <5fb2ad360609220708r2def2500ie15a9de813a09873@mail.gmail.com>
References: <4511192D.6070806@gmail.com>
	<5fb2ad360609220708r2def2500ie15a9de813a09873@mail.gmail.com>
Message-ID: <64B175CC-7AB1-4CC7-88DD-7D31838C8BD6@dscpl.com.au>


On 23/09/2006, at 12:08 AM, Padmashree B wrote:

>
> Hi.. i am trying to figure out cgi code written using Python..
> I create a cookie using
> import Cookie
> c=Cookie.SimpleCookie()
> c["cookie1"]="value1"
>
> Now when I want to retrive the cookie value in CGI written using  
> python do I necessary have to depend on the environment variable  
> HTTP_COOKIE which is set in os.environ..
>
> as in
>
> thiscookie = Cookie.SimpleCookie( )
> if os.environ.has_key ('HTTP_COOKIE'):
>     thiscookie.load(os. environ['HTTP_COOKIE'])
>  print thiscookie['aparam']. value
>
> Is there any other way to do without using the variable HTTP_COOKIE  
> set in os.environ..
>
> Also, is it ok to use this code in mod_python.. as in getting the  
> cookie values using the environment variable HTTP_COOKIE...

Programming a CGI script with Python is a totally different thing to  
using
mod_python. With CGI, Apache is executing your script as an independent
program each time a request arrives which is for a URL which maps to the
script. In mod_python, the Python interpreter is embedded as an integral
part of Apache and stays resident between requests.

Thus, this question isn't even appropriate for this mailing list.

If you want questions answered purely on how to program CGI scripts in
Python, you would be better off posting on comp.lang.python at Google
groups site.

When you work out how CGI is different to mod_python and work out that
you need to convert your CGI scripts for use under mod_python, then by
all means return and ask your mod_python specific questions here.

Graham

From grahamd at dscpl.com.au  Mon Sep 25 07:15:34 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 25 07:16:37 2006
Subject: [mod_python] Is PSP block embeddable to another PSP block ?
In-Reply-To: <4511192D.6070806@gmail.com>
References: <4511192D.6070806@gmail.com>
Message-ID: <10F287A1-6BE7-4481-8207-782222860B24@dscpl.com.au>


On 20/09/2006, at 8:34 PM, durumdara wrote:

> Hi !
>
> I search for the same thing in PSP like in Zope ZPT.
>
> <p tal:repeat=....>
>    <p tal:replace=....>
>        <p tal:repeat=...>
>            ....
> <%
> for i in range(3):
> %>
>    <p>
>    <%= i %>
>   </p>
> <%
>    for j in range(3):
> %>
>        <p>
>        <%= j %>
>       </p>
>
>
> But how can I do ? Anyone knows an example to it ?

See previous postings in mailing list archives about this. For example:

   http://www.modpython.org/pipermail/mod_python/2005-May/018102.html

In short, you need to use comment hints so that indenting is understood
in some cases.

Graham
From grahamd at dscpl.com.au  Mon Sep 25 07:36:37 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 25 07:37:39 2006
Subject: [mod_python] util.Fieldstorage and form
In-Reply-To: <024a01c6dd80$422fd060$c7010a0a@talentica.com>
References: <451118B7.2070900@gmail.com>
	<45117958.2030102@brunson.com>	<45117A94.3010905@brunson.com>
	<013e01c6dd3d$b6b5a920$c7010a0a@talentica.com>
	<45128643.50703@jgassociates.ca>
	<024a01c6dd80$422fd060$c7010a0a@talentica.com>
Message-ID: <EBE155F9-FEF1-48D1-B015-5D0082DD6989@dscpl.com.au>

Your questions may in part be answered by:

   http://issues.apache.org/jira/browse/MODPYTHON-38

If FieldStorage object is constructed twice, on the second time  
round, it
will only be able to provide access to form fields which are part of the
query string of the URL itself and not any field embedded as multipart
form data within the content of the POST request. This was what Jim
was getting as except that he didn't mention case where mix of query
string and multipart form parameters used.

What is not clear from your message is whether you are doing absolutely
everything within a self contained PSP page, or whether you are actually
using a wrapper around it in the form of a custom handler or a handler
such as mod_python.publisher.

If you are wrapping PSP stuff on mod_python.publisher functions, you
actually need to pass in "form" something like:

     settings = {}
     ...
     settings.update({"form":req.form})
     template = psp.PSP(req,filename=path,vars=settings)
     template.run()

In mod_python 3.3, this will no longer be necessary as PSP has been
changed to  use req.form which may be inherited from a custom handler
which has already created it and stored it as that named attribute of  
the
request object.

Can you be clearer about whether you are using mix of query string
parameters and multipart form parameters within content of request,
and clarify whether you are using PSP only or in conjunction with
another handler.

Posting an actual small working example of what you are talking about
would be good, as then we don't need to guess.

Graham

On 21/09/2006, at 11:17 PM, sandip wrote:

> Thanks Jim. This explains the puzzle.
> but form['filefield'] doesn't work for accessing file data.
> how to use form to access file data? or Is form being implemented  
> partially in mod_python?
>
> thanks
> sandip
>
>
> ----- Original Message ----- From: "Jim Gallacher"  
> <jpg@jgassociates.ca>
> To: "sandip" <sandip.more@gmail.com>
> Cc: <mod_python@modpython.org>
> Sent: Thursday, September 21, 2006 6:02 PM
> Subject: Re: [mod_python] util.Fieldstorage and form
>
>
>> sandip wrote:
>>> Hi all,
>>>    Other day i was trying to build upload functionality in psp. I  
>>> am handling form(method: POST) submission in psp.
>>> this form contain a hidden element and  a element of type file  
>>> for upload.
>>> I observed certain things. When I use form['field'] to access  
>>> value of hidden form element,and in same code
>>> if I use FieldStorage(req) to get the attributes of uploaded  
>>> file. I can't access file attributes.
>>>
>>> but if I use only FieldStorage to access all the elements of  
>>> form, I could access it.
>>>
>>> so why can't I  use both form and FieldStorage in same code?
>>
>> The form you see in psp is actually a FieldStorage instance which  
>> is automatically created when the psp parse encounters mention of  
>> the form variable.
>>
>> FieldStorage may only be called once per request, as it consumes  
>> the request body. Wnen it is called a second time, there is  
>> nothing left to read.
>>
>> The usual solution is to store a reference to the form in your  
>> request object, and pass that around to any functions that need it.
>>
>> <%
>>   stuff = form['stuff']
>>   req.form = form
>> %>
>>
>> You'll then be able to access the form in code outside of the psp  
>> page.
>>
>> Jim
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From grahamd at dscpl.com.au  Mon Sep 25 07:41:18 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 25 07:42:22 2006
Subject: [mod_python] Good example site with py, psp, and structure
In-Reply-To: <45139D50.8080302@gmail.com>
References: <451118B7.2070900@gmail.com> <45117958.2030102@brunson.com>
	<45139D50.8080302@gmail.com>
Message-ID: <24E8FA84-B3D1-4AEC-96E4-D4D05ED7F7BE@dscpl.com.au>


On 22/09/2006, at 6:22 PM, durumdara wrote:

> Hi !
>
> Eric Brunson ?rta:
>>> If I understand it good, I can specify one handler script for one  
>>> directory.
>>> Anywhere, where I specify a handler, the handler script working  
>>> for all .py (both for existing and not existing).
>>
>> Not precisely (and someone please help out if I express this  
>> incorrectly).  You can add a handler for dealing with .py files in  
>> which case .py files will be handled by that handler, or you can  
>> set a handler for URLs, which will perform a sort of module  
>> resolution algorithm on the URL.  In the first case, which I'm  
>> least familiar with, if you associate a handler with a .py file,  
>> referencing a file that doesn't exist will give you a 404 error.
>>
> When I used this model (see below),  I not got error: every py  
> filename
> accepted, but only mptest.py started:
>
>    LoadModule python_module modules/mod_python.so
>
>    <Directory c:/web/apache22/htdocs/>
>      AddHandler python-program .py
>      PythonHandler mptest
>      PythonDebug On
>    </Directory>
>
>    mptest.py:
>
>    from mod_python import apache
>
>    def handler(req):
>          req.content_type = 'text/html'
>          req.write('Handler: mptest.py<br>')
>          req.write('Actual (URL defined) filename: '+req.filename)
>          req.write('<br>Some random number: ')
>          import random
>          req.write(str(random.randint(0,1000)))
>          return apache.OK
>
> The URL I write:
>
>    http://localhost:7080/index_ssss.py
>
> The result is:
>
>    Handler: mptest.py
>    Actual (URL defined) filename: C:/web/apache22/htdocs/index_ssss.py
>    Some random number: 594
>
> The index_ssss does not exists, but the handler catched it, and handle
> the request with mptest.py.
>
> So I don't get 404 error, but this is good for me: I can handle every
> problem in one script !

The person who gave you the answer was using SetHandler and not
AddHandler, there is a significant difference. Most of his discussion
was also alluding to use of mod_python.publisher and not a custom
handler like you are using. The mod_python.publisher handler adds
an extra level of interpretation of the URL on top of basic mod_python
handler.

For difference between AddHandler and SetHandler in the context of
mod_python, see:

   http://www.dscpl.com.au/wiki/ModPython/Articles/ 
SetHandlerVersusAddHandler

This article may also go a long way to answering some of your other
questions in respect of how to avoid needing to specific a .py extension
all the time.

Graham


From grahamd at dscpl.com.au  Mon Sep 25 08:04:30 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 25 08:05:33 2006
Subject: [mod_python] util.Fieldstorage and form
In-Reply-To: <021a01c6e098$9b33ec80$c7010a0a@talentica.com>
References: <451118B7.2070900@gmail.com>
	<45117958.2030102@brunson.com>	<45117A94.3010905@brunson.com>
	<013e01c6dd3d$b6b5a920$c7010a0a@talentica.com>
	<45128643.50703@jgassociates.ca>
	<024a01c6dd80$422fd060$c7010a0a@talentica.com>
	<EBE155F9-FEF1-48D1-B015-5D0082DD6989@dscpl.com.au>
	<021a01c6e098$9b33ec80$c7010a0a@talentica.com>
Message-ID: <4B7731EE-4E55-4C98-85BD-15860FEEEFE9@dscpl.com.au>

Please keep followups on mailing list.

On 25/09/2006, at 9:49 PM, sandip wrote:

> Hi,
> Thanks Graham, I am using self contained psp.
>
> my html form is
> <form enctype="multipart/form-data" method="post">
> <input name=x1>
> <input name=x2>
> <input name=UploadFile type=file>
> </form>
>
>
> following is my working code...
> frm = util.FieldStorage(req)
> x1= int(frm.getlist('x1')[0])
> x2 = str(frm.getlist('x2')[0])
> upfile = frm.getlist('UploadFile')[0]
> filename = upfile.filename
> filedata = upfile.value
>
>
> Previously i did this, it didn't worked...means it gave me correct  
> values of x1,x2 byut didn't gave me any attributes of uploaded file..
> x1 = form['x1']
> x2 = form['x2']
> frm = util.FieldStorage(req)
> filename = upfile.filename
> filedata = upfile.value

Which will fail because of a second instance of FieldStorage being  
created.
The first having been created automatically by PSP handler when 'form'
variable is referenced.

What happens when you use:

x1 = form['x1']
x2 = form['x2']
upfile = form['UploadFile']
filename = upfile.filename
filedata = upfile.value

Graham

> Regards,
> Sandip
> ---- Original Message ----- From: "Graham Dumpleton"  
> <grahamd@dscpl.com.au>
> To: "sandip" <sandip.more@gmail.com>
> Cc: <mod_python@modpython.org>
> Sent: Monday, September 25, 2006 5:06 PM
> Subject: Re: [mod_python] util.Fieldstorage and form
>
>
>> Your questions may in part be answered by:
>>
>>   http://issues.apache.org/jira/browse/MODPYTHON-38
>>
>> If FieldStorage object is constructed twice, on the second time   
>> round, it
>> will only be able to provide access to form fields which are part  
>> of the
>> query string of the URL itself and not any field embedded as  
>> multipart
>> form data within the content of the POST request. This was what Jim
>> was getting as except that he didn't mention case where mix of query
>> string and multipart form parameters used.
>>
>> What is not clear from your message is whether you are doing  
>> absolutely
>> everything within a self contained PSP page, or whether you are  
>> actually
>> using a wrapper around it in the form of a custom handler or a  
>> handler
>> such as mod_python.publisher.
>>
>> If you are wrapping PSP stuff on mod_python.publisher functions, you
>> actually need to pass in "form" something like:
>>
>>     settings = {}
>>     ...
>>     settings.update({"form":req.form})
>>     template = psp.PSP(req,filename=path,vars=settings)
>>     template.run()
>>
>> In mod_python 3.3, this will no longer be necessary as PSP has been
>> changed to  use req.form which may be inherited from a custom handler
>> which has already created it and stored it as that named attribute  
>> of  the
>> request object.
>>
>> Can you be clearer about whether you are using mix of query string
>> parameters and multipart form parameters within content of request,
>> and clarify whether you are using PSP only or in conjunction with
>> another handler.
>>
>> Posting an actual small working example of what you are talking about
>> would be good, as then we don't need to guess.
>>
>> Graham
>>
>> On 21/09/2006, at 11:17 PM, sandip wrote:
>>
>>> Thanks Jim. This explains the puzzle.
>>> but form['filefield'] doesn't work for accessing file data.
>>> how to use form to access file data? or Is form being implemented  
>>> partially in mod_python?
>>>
>>> thanks
>>> sandip
>>>
>>>
>>> ----- Original Message ----- From: "Jim Gallacher"   
>>> <jpg@jgassociates.ca>
>>> To: "sandip" <sandip.more@gmail.com>
>>> Cc: <mod_python@modpython.org>
>>> Sent: Thursday, September 21, 2006 6:02 PM
>>> Subject: Re: [mod_python] util.Fieldstorage and form
>>>
>>>
>>>> sandip wrote:
>>>>> Hi all,
>>>>>    Other day i was trying to build upload functionality in psp.  
>>>>> I  am handling form(method: POST) submission in psp.
>>>>> this form contain a hidden element and  a element of type file   
>>>>> for upload.
>>>>> I observed certain things. When I use form['field'] to access   
>>>>> value of hidden form element,and in same code
>>>>> if I use FieldStorage(req) to get the attributes of uploaded   
>>>>> file. I can't access file attributes.
>>>>>
>>>>> but if I use only FieldStorage to access all the elements of   
>>>>> form, I could access it.
>>>>>
>>>>> so why can't I  use both form and FieldStorage in same code?
>>>>
>>>> The form you see in psp is actually a FieldStorage instance  
>>>> which  is automatically created when the psp parse encounters  
>>>> mention of  the form variable.
>>>>
>>>> FieldStorage may only be called once per request, as it  
>>>> consumes  the request body. Wnen it is called a second time,  
>>>> there is  nothing left to read.
>>>>
>>>> The usual solution is to store a reference to the form in your   
>>>> request object, and pass that around to any functions that need it.
>>>>
>>>> <%
>>>>   stuff = form['stuff']
>>>>   req.form = form
>>>> %>
>>>>
>>>> You'll then be able to access the form in code outside of the  
>>>> psp  page.
>>>>
>>>> Jim
>>>
>>> _______________________________________________
>>> Mod_python mailing list
>>> Mod_python@modpython.org
>>> http://mailman.modpython.org/mailman/listinfo/mod_python

From grahamd at dscpl.com.au  Mon Sep 25 08:14:50 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Mon Sep 25 08:15:50 2006
Subject: [mod_python] Good example site with py, psp, and structure
In-Reply-To: <451118B7.2070900@gmail.com>
References: <451118B7.2070900@gmail.com>
Message-ID: <C811D54A-4DB7-4741-A4B5-4198CAF12E62@dscpl.com.au>

With what will be possible in mod_python 3.3, I don't necessarily
think it is a good example of how to do things, but have you looked
at the example on the mod_python web site at:

   http://www.modpython.org/examples/

Graham

On 20/09/2006, at 8:32 PM, durumdara wrote:

> Hi !
>
> I want to understand the modpy technics, to I create good structure  
> for my new modpy site. An example needed.
>
> I used PHP, Zope, CGI before this project.
>
> If I understand it good, I can specify one handler script for one  
> directory.
> Anywhere, where I specify a handler, the handler script working for  
> all .py (both for existing and not existing).
> So if I need a centralized web application, I need to import a  
> shared module that helps me to start and finish to handle the  
> process (example:  pre - collect the important informations, make  
> global variables, open the db connections, open the session datas;  
> post - save the session if need, close the db connection, drop the  
> content if we have redirection, etc.). I thinking good ?
>
> 1.)
> But I need to protect some area in the htdocs (restricted area).  
> How to I force it ? (auth module ?). I need to define to every dir  
> I used (httpd.conf) ?
>
> 2.)
> In Zope the header/footer objects used for handle the pre/post  
> actions, and the zpts/scripts used for make the content of the page.
> Is better to I use psp-s that call pre/post scripts, or is better  
> if I use py scripts, and they are get psp-s I need ?
>
> 3.)
> How to avoid to user type any .py to browser's address textbox, and  
> get same result that handler present ?
> Example: I use main.py for handle requests. The address is:  
> www.foo.hu/main.py.
> The user can type www.foo.hu/sux.py, and get same result !
>
> 4.)
> How to prevent the .py extension showing in the browser ?
> To I see (can type):
> www.foo.hu/
> or
> www.foo.hu/index
> not
> www.foo.hu/index.py.
> I want to protect my site - if anyone see it, he/she don't know,  
> what engine I used.
>
>
> Thanks for your answers:
> dd
>
>
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From grahamd at dscpl.com.au  Tue Sep 26 00:02:10 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 26 00:02:15 2006
Subject: [mod_python] Cookies & mod_rewrite
Message-ID: <1159243330.23791@dscpl.user.openhosting.com>

CARTWRIGHT, Guy, GBM wrote ..
> >  From memory, you can set req.headers_in and it will go 
> > through to backend via proxy. Give it a try anyway. Simply go:
> > 
> >    req.headers_in['X-MyHeader'] = 'test'
> > 
> > and see if it gets through.
> > 
> 
> No luck with the above, or with:
> 
>     req.headers_out['X-MyHeader'] = 'test'
> 
> but the following does work and gets passed through to the back-end
> server...
> 
>     req.err_headers_out['X-MyHeader'] = 'test'
>     return apache.OK
> 
> Weird...

That doesn't make a great deal of sense and I wouldn't rely on it.

FWIW, after I got proxying in mod_python 3.3 working again (I had managed to
break it), I found the following worked fine.

import posixpath 

from mod_python import apache, Cookie

def fixuphandler(req): 

  if req.proxyreq: 
    return apache.DECLINED 

  normalised_uri = posixpath.normpath(req.uri) 

  if normalised_uri: 
    if normalised_uri != '/' and req.uri[-1] == '/': 
      normalised_uri += '/' 

  length = len(req.filename) 
  length -= len(req.hlist.directory) - 1 
  length += len(req.path_info or '') 

  baseurl = normalised_uri[:-length] 
  path = normalised_uri[len(baseurl):] 

  req.proxyreq = apache.PROXYREQ_REVERSE 
  req.uri = 'http://localhost:8082/~grahamd/headers' + path 
  req.filename = 'proxy:%s' % req.uri 
  req.handler = 'proxy-server' 

  req.headers_in['Cookie'] = str(Cookie.Cookie('XXX', 'YYY'))

  req.log_error('uri = %s' % req.uri)
  req.log_error('filename = %s' % req.filename)
  req.log_error('handler = %s' % req.handler)

  return apache.OK 

In the backend server, could then use:

from mod_python import apache, Cookie

def handler(req):
  req.content_type = 'text/plain'
  for name in req.headers_in:
    req.write('%s: %s\n' % (name, req.headers_in[name]))

  req.write('\n')
  req.write(str(Cookie.get_cookies(req)))
  return apache.OK

I still need to commit changes back into mod_python repository to fix what I
broke, but mod_python 3.3 certainly provides more flexibility than perhaps
using mod_rewrite.

I'll get around to trying to do it with mod_rewrite later.

Sorry, for late followup, have been away for a week.

Graham
From deron.meranda at gmail.com  Tue Sep 26 17:02:40 2006
From: deron.meranda at gmail.com (Deron Meranda)
Date: Tue Sep 26 17:02:46 2006
Subject: [mod_python] Cookies & mod_rewrite
In-Reply-To: <30213CE8581C6C418BD0941763A1E2D4353770@lonms01001.fm.rbsgrp.net>
References: <30213CE8581C6C418BD0941763A1E2D4353770@lonms01001.fm.rbsgrp.net>
Message-ID: <5c06fa770609261402n53be5964o97ffad03325b67d4@mail.gmail.com>

On 9/20/06, CARTWRIGHT, Guy, GBM <Guy.CARTWRIGHT@rbos.com> wrote:
> >  From memory, you can set req.headers_in and it will go
> > through to backend via proxy. Give it a try anyway. Simply go:
> >    req.headers_in['X-MyHeader'] = 'test'
> > and see if it gets through.
>
> No luck with the above, or with:
>     req.headers_out['X-MyHeader'] = 'test'

Hmm, setting req.headers_in should allow you to pass additional
headers onto the reverse proxied "backend" server.  It does need
to be in an early phase, such as fixups or access.  Remember that
you are modifying (or adding to) the client's headers on their
way into the request, hence the headers_in instead of headers_out.

Be aware that some special headers will be filtered out though by the
mod_proxy handler, such as proxy related or headers like Max-Forwards,
Via, X-Forwarded-*, or any hop-specific headers such as Connection or
Transfer-Encoding.  But all other non-special headers should be passed
through.  mod_proxy can be configured to do some URL munging though,
so check if you have any ProxyPassReverseCookie* directives.

I can definitely get synthetic cookies working with just plain mod_proxy
using the ProxyPass directive, such as:

<Location /proxytest>
    PythonAccessHandler myproxymod::revproxyhandler
    PythonDebug On
    ProxyPass http://my.backend.server/content
</Location>

And my handler code is just:
  def revproxyhandler(req):
      req.headers_in['X-This-Is-A-Test'] = 'Hello'
      return apache.OK

You can of course use an Auth* handler, Fixup, etc. as long as it's
before the main request processing phase (and after mapping or
storage phases).

I can't seem to get mod_rewrite's [P] flag to work currently though.
But I'm sure I just don't understand mod_rewrite well enough.

Just curious--why you are using mod_rewrite in this case
since mod_proxy should be sufficient (you're not really using
any regex functionality).

> but the following does work and gets passed through to the back-end
> server...
>     req.err_headers_out['X-MyHeader'] = 'test'
>     return apache.OK
> Weird...

Can't explain that one either!

Also just a few notes on security.  I assume your backend server
is checking it's authentication by looking for this cookie.  And your
front-end proxy server is doing NTLM and synthetically creating
that cookie.

Realize that this cookie should be "private" between your webserver
and the backend server.  At a minimum you should make sure that
the browser can never send this cookie in a Cookie header.  So you
should probably always delete it from the req.headers_in.
-- 
Deron Meranda
From sid_docs at yahoo.com  Tue Sep 26 20:16:40 2006
From: sid_docs at yahoo.com (Siddhartha Azad)
Date: Tue Sep 26 20:16:48 2006
Subject: [mod_python] Segmentation fault when loading modules
Message-ID: <20060927001640.19771.qmail@web53114.mail.yahoo.com>

Hi,
I have mod_python 3.2.10 built with apache 2.2.3 on RH
Linux. All was working fine for me until I changed my
directory structure (and hence the location of the
python modules). After doing so I apache started
seg-faulting. I  debugged with gdb -X and the
stacktrace points (as I suspected) to some
module-loading code that eventually crashes in some
pyexpat module due to a null string.

When I change my directory structure to what it was
before, everything works perfectly.

1. The directory structure that works:

   /dev/www/xyz.py
   /dev/www/modules/*.py

 When I invoke xyz.py from the browser (xyz.py imports
modules from "modules.py") everything works fine (i.e.
when the modules sub-directory is under within the
same parent directory as xyz.py.


2. The directory structure that doesn't work:

  /dev/www/xyz.py
  /dev/modules/*.py


Notice that the modules are no longer under the "www"
directory. Also, this only happens when my PYTHONPATH
actually has the "modules" directory (otherwise of
course I get an error from xyz.py that the import of
the modules failed).
Please help, I have been trying to fix this for 2 days
now and cannot find any references anyplace else.
The output from the apache error log and some walkback
from "gdb" follow.
Thanks, Sid.

APACHE ERROR LOG
----------------

[Tue Sep 26 20:12:47 2006] [notice] mod_python:
(Re)importing module 'mod_python.publisher'
[Tue Sep 26 20:12:47 2006] [notice] [client 127.0.0.1]
Publisher loading page /home/sid/dev/www/xyz.py
[Tue Sep 26 20:12:48 2006] [notice] child pid 32091
exit signal Segmentation fault (11)


WALKBACK FROM DEBUGGER
----------------------


#0  0x40167892 in PyString_FromString (str=0x0) at
Objects/stringobject.c:106
#1  0x401b8373 in PyModule_AddStringConstant
(m=0x4081e0ec,
   name=0x4092f6ba "XML_ERROR_UNBOUND_PREFIX",
value=0x0) at
Python/modsupport.c:531
#2  0x40913fa1 in initpyexpat () at
/usr/python-2.4.2/Python-2.4.2/Modules/pyexpat.c:1970
#3  0x401b2bad in _PyImport_LoadDynamicModule
(name=0xbfffadfc "pyexpat",
   pathname=0xbfffa960
"/usr/local/lib/python2.4/lib-dynload/pyexpat.so",
fp=0x8253090)
   at Python/importdl.c:53
#4  0x401af90d in load_module (name=0xbfffadfc
"pyexpat", fp=0x8253090,
   buf=0xbfffa960
"/usr/local/lib/python2.4/lib-dynload/pyexpat.so",
type=3, loader=0x1b)
   at Python/import.c:1677
#5  0x401b0615 in import_submodule (mod=0x40208de0,
subname=0xbfffadfc
"pyexpat",
   fullname=0xbfffadfc "pyexpat") at
Python/import.c:2262


From grahamd at dscpl.com.au  Tue Sep 26 20:51:50 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Tue Sep 26 20:51:54 2006
Subject: [mod_python] Segmentation fault when loading modules
Message-ID: <1159318310.16816@dscpl.user.openhosting.com>

Read:

  http://www.dscpl.com.au/wiki/ModPython/Articles/ExpatCausingApacheCrash

This will answer all your questions and tell you what you need to do.

Graham

Siddhartha Azad wrote ..
> Hi,
> I have mod_python 3.2.10 built with apache 2.2.3 on RH
> Linux. All was working fine for me until I changed my
> directory structure (and hence the location of the
> python modules). After doing so I apache started
> seg-faulting. I  debugged with gdb -X and the
> stacktrace points (as I suspected) to some
> module-loading code that eventually crashes in some
> pyexpat module due to a null string.
> 
> When I change my directory structure to what it was
> before, everything works perfectly.
> 
> 1. The directory structure that works:
> 
>    /dev/www/xyz.py
>    /dev/www/modules/*.py
> 
>  When I invoke xyz.py from the browser (xyz.py imports
> modules from "modules.py") everything works fine (i.e.
> when the modules sub-directory is under within the
> same parent directory as xyz.py.
> 
> 
> 2. The directory structure that doesn't work:
> 
>   /dev/www/xyz.py
>   /dev/modules/*.py
> 
> 
> Notice that the modules are no longer under the "www"
> directory. Also, this only happens when my PYTHONPATH
> actually has the "modules" directory (otherwise of
> course I get an error from xyz.py that the import of
> the modules failed).
> Please help, I have been trying to fix this for 2 days
> now and cannot find any references anyplace else.
> The output from the apache error log and some walkback
> from "gdb" follow.
> Thanks, Sid.
> 
> APACHE ERROR LOG
> ----------------
> 
> [Tue Sep 26 20:12:47 2006] [notice] mod_python:
> (Re)importing module 'mod_python.publisher'
> [Tue Sep 26 20:12:47 2006] [notice] [client 127.0.0.1]
> Publisher loading page /home/sid/dev/www/xyz.py
> [Tue Sep 26 20:12:48 2006] [notice] child pid 32091
> exit signal Segmentation fault (11)
> 
> 
> WALKBACK FROM DEBUGGER
> ----------------------
> 
> 
> #0  0x40167892 in PyString_FromString (str=0x0) at
> Objects/stringobject.c:106
> #1  0x401b8373 in PyModule_AddStringConstant
> (m=0x4081e0ec,
>    name=0x4092f6ba "XML_ERROR_UNBOUND_PREFIX",
> value=0x0) at
> Python/modsupport.c:531
> #2  0x40913fa1 in initpyexpat () at
> /usr/python-2.4.2/Python-2.4.2/Modules/pyexpat.c:1970
> #3  0x401b2bad in _PyImport_LoadDynamicModule
> (name=0xbfffadfc "pyexpat",
>    pathname=0xbfffa960
> "/usr/local/lib/python2.4/lib-dynload/pyexpat.so",
> fp=0x8253090)
>    at Python/importdl.c:53
> #4  0x401af90d in load_module (name=0xbfffadfc
> "pyexpat", fp=0x8253090,
>    buf=0xbfffa960
> "/usr/local/lib/python2.4/lib-dynload/pyexpat.so",
> type=3, loader=0x1b)
>    at Python/import.c:1677
> #5  0x401b0615 in import_submodule (mod=0x40208de0,
> subname=0xbfffadfc
> "pyexpat",
>    fullname=0xbfffadfc "pyexpat") at
> Python/import.c:2262
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From durumdara at gmail.com  Wed Sep 27 08:20:24 2006
From: durumdara at gmail.com (durumdara)
Date: Wed Sep 27 08:20:54 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - where I put them ?
Message-ID: <451A6C88.8000608@gmail.com>

Hi !

I not fully understand that in this dynamic wwwserver context where I 
can put persist objects.
What I can do to keep my objects in the background ?
Anybody can help me ?

Thanks for it:
dd
From fredrik.sandin at ltu.se  Wed Sep 27 09:16:01 2006
From: fredrik.sandin at ltu.se (Fredrik Sandin)
Date: Wed Sep 27 09:33:16 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - where I put them ?
In-Reply-To: <451A6C88.8000608@gmail.com>
References: <451A6C88.8000608@gmail.com>
Message-ID: <op.tgjggzn99etm87@avari254.mt.ltu.se>


I asked the same question some time ago:
http://modpython.org/pipermail/mod_python/2006-August/021924.html
Graham Dumpleton suggested to use XML-RPC.

As far as I have understood mod_python, or actually Apache, was
not designed to allow for object persistency.

Cheers,
Fredrik


On Wed, 27 Sep 2006 14:20:24 +0200, durumdara <durumdara@gmail.com> wrote:

> Hi !
>
> I not fully understand that in this dynamic wwwserver context where I  
> can put persist objects.
> What I can do to keep my objects in the background ?
> Anybody can help me ?
>
> Thanks for it:
> dd
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python


From durumdara at gmail.com  Wed Sep 27 09:37:23 2006
From: durumdara at gmail.com (durumdara)
Date: Wed Sep 27 09:37:32 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <451A7B8A.8070106@dsl.pipex.com>
References: <451A6C88.8000608@gmail.com> <451A7B8A.8070106@dsl.pipex.com>
Message-ID: <451A7E93.1020808@gmail.com>

Terry Macdonald ?rta:
> durumdara wrote:
>> I not fully understand that in this dynamic wwwserver context where I 
>> can put persist objects.
>> What I can do to keep my objects in the background ?
> Use a database
>

Hi !

Sorry, but I don't understand you.
I cannot store my ODBC connection in a database !

dd
From sdavis2 at mail.nih.gov  Wed Sep 27 09:55:27 2006
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Wed Sep 27 09:55:30 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - where I put them ?
In-Reply-To: <op.tgjggzn99etm87@avari254.mt.ltu.se>
References: <451A6C88.8000608@gmail.com> <op.tgjggzn99etm87@avari254.mt.ltu.se>
Message-ID: <200609270955.27051.sdavis2@mail.nih.gov>

On Wednesday 27 September 2006 09:16, Fredrik Sandin wrote:
> I asked the same question some time ago:
> http://modpython.org/pipermail/mod_python/2006-August/021924.html
> Graham Dumpleton suggested to use XML-RPC.
>
> As far as I have understood mod_python, or actually Apache, was
> not designed to allow for object persistency.

Is this actually true (at least the Apache part)?  Under mod_perl (I'm a 
mod_python total newbie), object persistence can be accomplished in several 
ways including global variables that remain in shared memory (but this is 
only within a single child), a database, in an in-memory or on-disk cache, or 
in a session (just an interface to a cache or database).  Depends on your 
definition, but Apache, it seems to me, is absolutely suited to allow object 
persistence.

Sean
From richardlewis at fastmail.co.uk  Wed Sep 27 10:04:56 2006
From: richardlewis at fastmail.co.uk (Richard Lewis)
Date: Wed Sep 27 10:05:05 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - where I put them ?
In-Reply-To: <200609270955.27051.sdavis2@mail.nih.gov>
References: <451A6C88.8000608@gmail.com> <op.tgjggzn99etm87@avari254.mt.ltu.se>
	<200609270955.27051.sdavis2@mail.nih.gov>
Message-ID: <200609271504.56692.richardlewis@fastmail.co.uk>

On Wednesday 27 September 2006 14:55, Sean Davis wrote:
> On Wednesday 27 September 2006 09:16, Fredrik Sandin wrote:
> > I asked the same question some time ago:
> > http://modpython.org/pipermail/mod_python/2006-August/021924.html
> > Graham Dumpleton suggested to use XML-RPC.
> >
> > As far as I have understood mod_python, or actually Apache, was
> > not designed to allow for object persistency.
>
> Is this actually true (at least the Apache part)?  Under mod_perl (I'm a
> mod_python total newbie), object persistence can be accomplished in several
> ways including global variables that remain in shared memory (but this is
> only within a single child), a database, in an in-memory or on-disk cache,
> or in a session (just an interface to a cache or database).  Depends on
> your definition, but Apache, it seems to me, is absolutely suited to allow
> object persistence.
>
Persistance is all right: you can use global variables as you suggested.

The problem comes at tidying up time. Apache provides no method of performing 
operations when the server shuts down. This is especially relevant with 
things like open database connections and is probably why the original poster 
was talking about XML-RPC. A workable solution is to open your database 
connections in a separate process to Apache/mod_python and connect via a 
local socket or with something like XML-RPC or with 
http://sourceforge.net/projects/sqlrelay

Cheers,
Richard
-- 
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Richard Lewis
Sonic Arts Research Archive
http://www.sara.uea.ac.uk/
JID: ironchicken@jabber.earth.li
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
From calderano at sgaspa.it  Wed Sep 27 10:06:52 2006
From: calderano at sgaspa.it (Luca Calderano)
Date: Wed Sep 27 10:07:32 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - whereI put them ?
References: <451A6C88.8000608@gmail.com> <451A7B8A.8070106@dsl.pipex.com>
	<451A7E93.1020808@gmail.com>
Message-ID: <002801c6e23e$2fb21ed0$410100a4@sga.dom>

try this:
(it implies using maxdb as database server)

from mod_python import apache, Session
from maxdb import sql

cnn=sql.connect(user,password,database,'')
req.session['cnn']=cnn
req.session.save()

Bye
Luca
----- Original Message ----- 
From: "durumdara" <durumdara@gmail.com>
To: <mod_python@modpython.org>
Sent: Wednesday, September 27, 2006 3:37 PM
Subject: Re: [mod_python] Persist database conn, or pers. variables - whereI
put them ?


> Terry Macdonald ?rta:
> > durumdara wrote:
> >> I not fully understand that in this dynamic wwwserver context where I
> >> can put persist objects.
> >> What I can do to keep my objects in the background ?
> > Use a database
> >
>
> Hi !
>
> Sorry, but I don't understand you.
> I cannot store my ODBC connection in a database !
>
> dd
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From nferrier at tapsellferrier.co.uk  Wed Sep 27 10:06:03 2006
From: nferrier at tapsellferrier.co.uk (Nic James Ferrier)
Date: Wed Sep 27 10:09:20 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - where  I put them ?
In-Reply-To: <451A7E93.1020808@gmail.com> (durumdara@gmail.com's message of
	"Wed, 27 Sep 2006 15:37:23 +0200")
References: <451A6C88.8000608@gmail.com> <451A7B8A.8070106@dsl.pipex.com>
	<451A7E93.1020808@gmail.com>
Message-ID: <87d59hz9o4.fsf@nicferrier.tapsellferrier.co.uk>

durumdara <durumdara@gmail.com> writes:

> Terry Macdonald ?rta:
>> durumdara wrote:
>>> I not fully understand that in this dynamic wwwserver context where I 
>>> can put persist objects.
>>> What I can do to keep my objects in the background ?
>> Use a database
>>
>
> Hi !
>
> Sorry, but I don't understand you.
> I cannot store my ODBC connection in a database !

You could use an external connection pool such as sqlrelay.

Many of the advantages of connection pools are to do with tcp latency
which goes away if you have the db on the same box.

You can also create database connections per-python interpreter simply
by using global variables. Then you can use simple checkin/checkout
methods to use them as a pool.

The apache solution is mod_dbd but this isn't available from
mod_python yet.

-- 
Nic Ferrier
http://www.tapsellferrier.co.uk   for all your tapsell ferrier needs

From durumdara at gmail.com  Wed Sep 27 10:13:17 2006
From: durumdara at gmail.com (durumdara)
Date: Wed Sep 27 10:13:23 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <200609270955.27051.sdavis2@mail.nih.gov>
References: <451A6C88.8000608@gmail.com> <op.tgjggzn99etm87@avari254.mt.ltu.se>
	<200609270955.27051.sdavis2@mail.nih.gov>
Message-ID: <451A86FD.5010703@gmail.com>

Sean Davis ?rta:
> On Wednesday 27 September 2006 09:16, Fredrik Sandin wrote:
>   
>> I asked the same question some time ago:
>> http://modpython.org/pipermail/mod_python/2006-August/021924.html
>> Graham Dumpleton suggested to use XML-RPC.
>>
>> As far as I have understood mod_python, or actually Apache, was
>> not designed to allow for object persistency.
>>     
>
> Is this actually true (at least the Apache part)?  Under mod_perl (I'm a 
> mod_python total newbie), object persistence can be accomplished in several 
> ways including global variables that remain in shared memory (but this is 
> only within a single child), a database, in an in-memory or on-disk cache, or 
> in a session (just an interface to a cache or database).  Depends on your 
> definition, but Apache, it seems to me, is absolutely suited to allow object 
> persistence.
>
> Sean
>   
That was I thought too when I read your mail.
In PHP, Perl, the mod_* interface supports some possibility for the 
persistency - see the database connections.

I don't understand the whole thing.
As  I know the Python code is running in a subinterpreter that started 
by a server subprocess.
What I see in the experience:
When I import some module with import * (normal, pythonic way), this 
module not reloaded, so can hold some static (persistent) values.
I don't know, when this module destroyed - on number limitation of 
requests, on time limit, on subprocess dying, on Apache dying - I don't 
know.
Also I don't know, the apace.import_module destroy the module variables 
on reload, or not.

But this working mode is confuse me, because I don't know, where I store 
the database connections. Ok, another things I hold in session, or db, 
or dbm, but these objects not serializable.

So: I don't think that does not exists a mechanism in mod_py that 
determine, what sections are persistent, and what are not...
In Zope same thing exists: a db connection holder (DataBase Adapter), 
and other thing are reloaded on requests.

Anyone can help me ?

Thanks:
    dd

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060927/6c17e892/attachment.html
From terry.macdonald at dsl.pipex.com  Wed Sep 27 10:15:03 2006
From: terry.macdonald at dsl.pipex.com (Terry Macdonald)
Date: Wed Sep 27 10:15:15 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <451A7E93.1020808@gmail.com>
References: <451A6C88.8000608@gmail.com> <451A7B8A.8070106@dsl.pipex.com>
	<451A7E93.1020808@gmail.com>
Message-ID: <451A8767.8080704@dsl.pipex.com>

durumdara wrote:
> Terry Macdonald ?rta:
>> durumdara wrote:
>>> I not fully understand that in this dynamic wwwserver context where 
>>> I can put persist objects.
>>> What I can do to keep my objects in the background ?
>> Use a database
>>
>
> Hi !
>
> Sorry, but I don't understand you.
> I cannot store my ODBC connection in a database !
>
Ahh! but you didn't specify what type of objects you wanted to persist.

From jcea at argo.es  Wed Sep 27 10:15:44 2006
From: jcea at argo.es (Jesus Cea)
Date: Wed Sep 27 10:15:51 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <op.tgjggzn99etm87@avari254.mt.ltu.se>
References: <451A6C88.8000608@gmail.com> <op.tgjggzn99etm87@avari254.mt.ltu.se>
Message-ID: <451A8790.3020804@argo.es>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Try out Durus:

http://www.mems-exchange.org/software/durus/

http://www.argo.es/~jcea/programacion/durus-berkeleydbstorage.htm

- --
Jesus Cea Avion                         _/_/      _/_/_/        _/_/_/
jcea@argo.es http://www.argo.es/~jcea/ _/_/    _/_/  _/_/    _/_/  _/_/
jabber / xmpp:jcea@jabber.org         _/_/    _/_/          _/_/_/_/_/
                               _/_/  _/_/    _/_/          _/_/  _/_/
"Things are not so easy"      _/_/  _/_/    _/_/  _/_/    _/_/  _/_/
"My name is Dump, Core Dump"   _/_/_/        _/_/_/      _/_/  _/_/
"El amor es poner tu felicidad en la felicidad de otro" - Leibniz
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iQCVAwUBRRqHkJlgi5GaxT1NAQK0zwQAmFQlarqfhtLgCKcRQT0EkIjH0z/2kSVn
jNwRSN+H56Infy1RAQZMsxCf+CaeuPszSgRzctJeCco6x50FKimZli27gW3hGdCr
LNq97zKRYVriDhQAQksxw8pk8w2PyERbHl487FaeYOnnjtD1e5Bo7FNmaTINr5M+
HJzrZIyGkTw=
=Cwuj
-----END PGP SIGNATURE-----
From nlv11281 at natlab.research.philips.com  Wed Sep 27 10:37:07 2006
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Wed Sep 27 10:37:37 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <451A6C88.8000608@gmail.com>
References: <451A6C88.8000608@gmail.com>
Message-ID: <451A8C93.80506@natlab.research.philips.com>

Start with "if it's not a problem, it's not a problem".

I benchmarked MySQL with mod_python years ago. There was no noticable performance benefit whatsoever 
between re-using one connection for all DB traffic, multiple global connections in a pool, versus 
opening and closing a DB connection on every request.

With connection pooling comes the risk that you keep too many connections open for too long. If you 
serve both static and dynamic content, a pre-fork apache mpm may have 20 open connections while 
you're using only one...


Mike Looijmans
Philips Natlab / Topic Automation


durumdara wrote:
> I not fully understand that in this dynamic wwwserver context where I 
> can put persist objects.
> What I can do to keep my objects in the background ?

From ppathiakis at eagleaccess.com  Wed Sep 27 13:56:13 2006
From: ppathiakis at eagleaccess.com (Paul J. Pathiakis)
Date: Wed Sep 27 13:56:02 2006
Subject: [mod_python] Can't get it to interpret
Message-ID: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C908@BIGMAIL.eagleinvsys.com>

Hi,

I've been trying, according to the manual, to get things to work on the mptest.py example.  It doesn't go.  However, I did move onto the trouble shooting and I hope someone can help.  My problem is that the information comes up as just plain text.  I have tried AllowOverrides all and a few other things but this is not my forte'.  I'm trying to get NAV up and running for the network (I already have nagios, orca and several other tools but NAV with cricket would be a boon.)  However, I can't get mod_python to work.  I believe I had it working at COB Friday, but come Monday... well...

Give me what you can.  I can usually ramp fairly quickly.  I've been on this for 3 days and I'm starting to dislike it. :-(

Thank you all!

Paul


General information
Apache version	Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3
Apache threaded MPM	No (single thread MPM)
Apache forked MPM	Yes, maximum 256 processes
Apache server root	/usr/local
Apache document root	/usr/local/www/data
Apache error log	/var/log/httpd-error.log (view last 100 lines)
Python sys.version	2.4.3 (#1, Aug 9 2006, 09:05:59) [GCC 3.4.4 [FreeBSD] 20050518]
Python sys.path	

/mpinfo/
/usr/local/lib/python24.zip
/usr/local/lib/python2.4
/usr/local/lib/python2.4/plat-freebsd6
/usr/local/lib/python2.4/lib-tk
/usr/local/lib/python2.4/lib-dynload
/usr/local/lib/python2.4/site-packages

Python interpreter name	monitor.foo.com
mod_python.publisher available	Yes
mod_python.psp available	Yes
Request input headers
Key	Value
Host	10.170.1.241
User-Agent	Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.7) Gecko/20060927 Firefox/1.5.0.7
Accept	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
Accept-Language	en-us,en;q=0.5
Accept-Encoding	gzip,deflate
Accept-Charset	ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive	300
Connection	keep-alive
Cache-Control	max-age=0
Request environment
Key	Value
UNIQUE_ID	0xEf2n8AAAEAACmwBDcAAAAA
GATEWAY_INTERFACE	CGI/1.1
SERVER_PROTOCOL	HTTP/1.1
REQUEST_METHOD	GET
QUERY_STRING	
REQUEST_URI	/mpinfo
SCRIPT_NAME	/mpinfo
HTTP_HOST	10.10.10.10
HTTP_USER_AGENT	Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.7) Gecko/20060927 Firefox/1.5.0.7
HTTP_ACCEPT	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
HTTP_ACCEPT_LANGUAGE	en-us,en;q=0.5
HTTP_ACCEPT_ENCODING	gzip,deflate
HTTP_ACCEPT_CHARSET	ISO-8859-1,utf-8;q=0.7,*;q=0.7
HTTP_KEEP_ALIVE	300
HTTP_CONNECTION	keep-alive
HTTP_CACHE_CONTROL	max-age=0
PATH	/sbin:/bin:/usr/sbin:/usr/bin:/usr/games:/usr/local/sbin:/usr/local/bin:/usr/X11R6/bin:/root/bin
SERVER_SIGNATURE	
Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3 Server at 10.170.1.241 Port 80
SERVER_SOFTWARE	Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3
SERVER_NAME	10.10.10.10
SERVER_ADDR	10.10.10.10
SERVER_PORT	80
REMOTE_ADDR	10.100.11.47
DOCUMENT_ROOT	/usr/local/www/data
SERVER_ADMIN	root@monitor.foo.com
SCRIPT_FILENAME	/usr/local/www/data/mpinfo
REMOTE_PORT	55673
Request configuration
Key	Value
Request options
Key	Value
Request notes
Key	Value
python_init_ran	1
Server configuration
Key	Value
Server options
Key	Value
Server configuration tree

PidFile /var/run/httpd.pid
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 15
StartServers 5
MinSpareServers 5
MaxSpareServers 10
MaxClients 150
MaxRequestsPerChild 0
Listen 80
User www
Group www
ServerAdmin root@monitor.foo.com
ServerName monitor.foo.com:80
UseCanonicalName Off
DocumentRoot "/usr/local/www/data"

    AllowOverride None
    Order Deny,Allow
    Deny from all

    Options Indexes FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
UserDir public_html
UserDir disabled root toor daemon operator bin tty kmem games news man sshd bind proxy _pflogd _dhcp uucp pop www nobody mailnull smmsp

    AllowOverride FileInfo AuthConfig Limit Indexes
    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
    
        Order allow,deny
        Allow from all
    
        Order deny,allow
        Deny from all
DirectoryIndex index.html index.html.var
AccessFileName .htaccess

    Order allow,deny
    Deny from all
TypesConfig etc/apache2/mime.types
DefaultType text/plain
MIMEMagicFile etc/apache2/magic
HostnameLookups Off
ErrorLog /var/log/httpd-error.log
LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent
CustomLog /var/log/httpd-access.log combined
ServerTokens Full
ServerSignature On
Alias /icons/ "/usr/local/www/icons/"

    Options Indexes MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|ru))?(/.*)?$ "/usr/local/share/doc/apache2$1"

    Options Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
    
        SetHandler type-map
    SetEnvIf Request_URI ^/manual/(de|en|es|fr|ja|ko|ru)/ prefer-language=$1
    RedirectMatch 301 ^/manual(?:/(de|en|es|fr|ja|ko|ru)){2,}(/.*)?$ /manual/$1$2
ScriptAlias /nagios/cgi-bin/ /usr/local/www/nagios/cgi-bin/

    Options ExecCGI
    AllowOverride None
    Order allow,deny
    Allow from all
    AuthName "Nagios Access"
    AuthType Basic
    AuthUserFile /usr/local/etc/nagios/htpasswd.users
    Require valid-user
Alias /nagios/  "/usr/local/www/nagios/"

    Options None
    AllowOverride None
    Order allow,deny
    Allow from all
    AuthName "Nagios Access"
    AuthType Basic
    AuthUserFile /usr/local/etc/nagios/htpasswd.users
    Require valid-user

    Order allow,deny
    Allow from all

    Options ExecCGI
ScriptAlias /nessus/cgi-bin/ /usr/local/www/nessus/cgi-bin/
Alias /nessus/  /usr/local/www/nessus/

    Options Indexes FollowSymLinks ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
Alias /cricket/ /usr/local/cricket/cricket/doc/

    SetHandler mod_python
    PythonHandler mod_python.testhandler
ScriptAlias /nav/ /usr/local/nav/apache/webroot/

    Options Indexes FollowSymLinks ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
ScriptAlias /cgi-bin/ "/usr/local/www/cgi-bin/"

    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
IndexOptions FancyIndexing VersionSort
AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*
AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core
AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^
DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
AddLanguage ca .ca
AddLanguage cs .cz .cs
AddLanguage da .dk
AddLanguage de .de
AddLanguage el .el
AddLanguage en .en
AddLanguage eo .eo
AddLanguage es .es
AddLanguage et .et
AddLanguage fr .fr
AddLanguage he .he
AddLanguage hr .hr
AddLanguage it .it
AddLanguage ja .ja
AddLanguage ko .ko
AddLanguage ltz .ltz
AddLanguage nl .nl
AddLanguage nn .nn
AddLanguage no .no
AddLanguage pl .po
AddLanguage pt .pt
AddLanguage pt-BR .pt-br
AddLanguage ru .ru
AddLanguage sv .sv
AddLanguage zh-CN .zh-cn
AddLanguage zh-TW .zh-tw
LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv zh-CN zh-TW
ForceLanguagePriority Prefer Fallback
AddCharset ISO-8859-1  .iso8859-1  .latin1
AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
AddCharset ISO-8859-3  .iso8859-3  .latin3
AddCharset ISO-8859-4  .iso8859-4  .latin4
AddCharset ISO-8859-5  .iso8859-5  .latin5 .cyr .iso-ru
AddCharset ISO-8859-6  .iso8859-6  .latin6 .arb
AddCharset ISO-8859-7  .iso8859-7  .latin7 .grk
AddCharset ISO-8859-8  .iso8859-8  .latin8 .heb
AddCharset ISO-8859-9  .iso8859-9  .latin9 .trk
AddCharset ISO-2022-JP .iso2022-jp .jis
AddCharset ISO-2022-KR .iso2022-kr .kis
AddCharset ISO-2022-CN .iso2022-cn .cis
AddCharset Big5        .Big5       .big5
AddCharset WINDOWS-1251 .cp-1251   .win-1251
AddCharset CP866       .cp866
AddCharset KOI8-r      .koi8-r .koi8-ru
AddCharset KOI8-ru     .koi8-uk .ua
AddCharset ISO-10646-UCS-2 .ucs2
AddCharset ISO-10646-UCS-4 .ucs4
AddCharset UTF-8       .utf8
AddCharset GB2312      .gb2312 .gb
AddCharset utf-7       .utf7
AddCharset utf-8       .utf8
AddCharset big5        .big5 .b5
AddCharset EUC-TW      .euc-tw
AddCharset EUC-JP      .euc-jp
AddCharset EUC-KR      .euc-kr
AddCharset shift_jis   .sjis
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddHandler type-map var
BrowserMatch "Mozilla/2" nokeepalive
BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
BrowserMatch "RealPlayer 4\.0" force-response-1.0
BrowserMatch "Java/1\.0" force-response-1.0
BrowserMatch "JDK/1\.0" force-response-1.0
BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "^gnome-vfs" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060927/faaeae8a/attachment.html
From ppathiakis at eagleaccess.com  Wed Sep 27 14:27:18 2006
From: ppathiakis at eagleaccess.com (Paul J. Pathiakis)
Date: Wed Sep 27 14:27:07 2006
Subject: [mod_python] Can't get it to interpret
References: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C908@BIGMAIL.eagleinvsys.com>
Message-ID: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C90A@BIGMAIL.eagleinvsys.com>

Interesting... I got it to work but it was due to the AllowOverrides allowing FileInfo only.... so...
Now I'm trying to get this to follow the link to nav (NAV) that is in the Document Root that goes to Nav's webroot (on FreeBSD - /usr/local/nav/apache/webroot)  After moving NAV's sudirectory to be under the document root, everything goes fine until I enter the python files:

Mod_python error: "PythonHeaderParserHandler nav.web"

Traceback (most recent call last):

  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py", line 287, in HandlerDispatch
    log=debug)

  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py", line 461, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named nav


Thanks again,

Paul


-----Original Message-----
From: mod_python-bounces@modpython.org on behalf of Paul J. Pathiakis
Sent: Wed 9/27/2006 1:56 PM
To: mod_python@modpython.org
Subject: [mod_python] Can't get it to interpret
 
Hi,

I've been trying, according to the manual, to get things to work on the mptest.py example.  It doesn't go.  However, I did move onto the trouble shooting and I hope someone can help.  My problem is that the information comes up as just plain text.  I have tried AllowOverrides all and a few other things but this is not my forte'.  I'm trying to get NAV up and running for the network (I already have nagios, orca and several other tools but NAV with cricket would be a boon.)  However, I can't get mod_python to work.  I believe I had it working at COB Friday, but come Monday... well...

Give me what you can.  I can usually ramp fairly quickly.  I've been on this for 3 days and I'm starting to dislike it. :-(

Thank you all!

Paul


General information
Apache version	Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3
Apache threaded MPM	No (single thread MPM)
Apache forked MPM	Yes, maximum 256 processes
Apache server root	/usr/local
Apache document root	/usr/local/www/data
Apache error log	/var/log/httpd-error.log (view last 100 lines)
Python sys.version	2.4.3 (#1, Aug 9 2006, 09:05:59) [GCC 3.4.4 [FreeBSD] 20050518]
Python sys.path	

/mpinfo/
/usr/local/lib/python24.zip
/usr/local/lib/python2.4
/usr/local/lib/python2.4/plat-freebsd6
/usr/local/lib/python2.4/lib-tk
/usr/local/lib/python2.4/lib-dynload
/usr/local/lib/python2.4/site-packages

Python interpreter name	monitor.foo.com
mod_python.publisher available	Yes
mod_python.psp available	Yes
Request input headers
Key	Value
Host	10.170.1.241
User-Agent	Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.7) Gecko/20060927 Firefox/1.5.0.7
Accept	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
Accept-Language	en-us,en;q=0.5
Accept-Encoding	gzip,deflate
Accept-Charset	ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive	300
Connection	keep-alive
Cache-Control	max-age=0
Request environment
Key	Value
UNIQUE_ID	0xEf2n8AAAEAACmwBDcAAAAA
GATEWAY_INTERFACE	CGI/1.1
SERVER_PROTOCOL	HTTP/1.1
REQUEST_METHOD	GET
QUERY_STRING	
REQUEST_URI	/mpinfo
SCRIPT_NAME	/mpinfo
HTTP_HOST	10.10.10.10
HTTP_USER_AGENT	Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.7) Gecko/20060927 Firefox/1.5.0.7
HTTP_ACCEPT	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
HTTP_ACCEPT_LANGUAGE	en-us,en;q=0.5
HTTP_ACCEPT_ENCODING	gzip,deflate
HTTP_ACCEPT_CHARSET	ISO-8859-1,utf-8;q=0.7,*;q=0.7
HTTP_KEEP_ALIVE	300
HTTP_CONNECTION	keep-alive
HTTP_CACHE_CONTROL	max-age=0
PATH	/sbin:/bin:/usr/sbin:/usr/bin:/usr/games:/usr/local/sbin:/usr/local/bin:/usr/X11R6/bin:/root/bin
SERVER_SIGNATURE	
Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3 Server at 10.170.1.241 Port 80
SERVER_SOFTWARE	Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3
SERVER_NAME	10.10.10.10
SERVER_ADDR	10.10.10.10
SERVER_PORT	80
REMOTE_ADDR	10.100.11.47
DOCUMENT_ROOT	/usr/local/www/data
SERVER_ADMIN	root@monitor.foo.com
SCRIPT_FILENAME	/usr/local/www/data/mpinfo
REMOTE_PORT	55673
Request configuration
Key	Value
Request options
Key	Value
Request notes
Key	Value
python_init_ran	1
Server configuration
Key	Value
Server options
Key	Value
Server configuration tree

PidFile /var/run/httpd.pid
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 15
StartServers 5
MinSpareServers 5
MaxSpareServers 10
MaxClients 150
MaxRequestsPerChild 0
Listen 80
User www
Group www
ServerAdmin root@monitor.foo.com
ServerName monitor.foo.com:80
UseCanonicalName Off
DocumentRoot "/usr/local/www/data"

    AllowOverride None
    Order Deny,Allow
    Deny from all

    Options Indexes FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
UserDir public_html
UserDir disabled root toor daemon operator bin tty kmem games news man sshd bind proxy _pflogd _dhcp uucp pop www nobody mailnull smmsp

    AllowOverride FileInfo AuthConfig Limit Indexes
    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
    
        Order allow,deny
        Allow from all
    
        Order deny,allow
        Deny from all
DirectoryIndex index.html index.html.var
AccessFileName .htaccess

    Order allow,deny
    Deny from all
TypesConfig etc/apache2/mime.types
DefaultType text/plain
MIMEMagicFile etc/apache2/magic
HostnameLookups Off
ErrorLog /var/log/httpd-error.log
LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent
CustomLog /var/log/httpd-access.log combined
ServerTokens Full
ServerSignature On
Alias /icons/ "/usr/local/www/icons/"

    Options Indexes MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|ru))?(/.*)?$ "/usr/local/share/doc/apache2$1"

    Options Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
    
        SetHandler type-map
    SetEnvIf Request_URI ^/manual/(de|en|es|fr|ja|ko|ru)/ prefer-language=$1
    RedirectMatch 301 ^/manual(?:/(de|en|es|fr|ja|ko|ru)){2,}(/.*)?$ /manual/$1$2
ScriptAlias /nagios/cgi-bin/ /usr/local/www/nagios/cgi-bin/

    Options ExecCGI
    AllowOverride None
    Order allow,deny
    Allow from all
    AuthName "Nagios Access"
    AuthType Basic
    AuthUserFile /usr/local/etc/nagios/htpasswd.users
    Require valid-user
Alias /nagios/  "/usr/local/www/nagios/"

    Options None
    AllowOverride None
    Order allow,deny
    Allow from all
    AuthName "Nagios Access"
    AuthType Basic
    AuthUserFile /usr/local/etc/nagios/htpasswd.users
    Require valid-user

    Order allow,deny
    Allow from all

    Options ExecCGI
ScriptAlias /nessus/cgi-bin/ /usr/local/www/nessus/cgi-bin/
Alias /nessus/  /usr/local/www/nessus/

    Options Indexes FollowSymLinks ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
Alias /cricket/ /usr/local/cricket/cricket/doc/

    SetHandler mod_python
    PythonHandler mod_python.testhandler
ScriptAlias /nav/ /usr/local/nav/apache/webroot/

    Options Indexes FollowSymLinks ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
ScriptAlias /cgi-bin/ "/usr/local/www/cgi-bin/"

    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
IndexOptions FancyIndexing VersionSort
AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*
AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core
AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^
DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
AddLanguage ca .ca
AddLanguage cs .cz .cs
AddLanguage da .dk
AddLanguage de .de
AddLanguage el .el
AddLanguage en .en
AddLanguage eo .eo
AddLanguage es .es
AddLanguage et .et
AddLanguage fr .fr
AddLanguage he .he
AddLanguage hr .hr
AddLanguage it .it
AddLanguage ja .ja
AddLanguage ko .ko
AddLanguage ltz .ltz
AddLanguage nl .nl
AddLanguage nn .nn
AddLanguage no .no
AddLanguage pl .po
AddLanguage pt .pt
AddLanguage pt-BR .pt-br
AddLanguage ru .ru
AddLanguage sv .sv
AddLanguage zh-CN .zh-cn
AddLanguage zh-TW .zh-tw
LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv zh-CN zh-TW
ForceLanguagePriority Prefer Fallback
AddCharset ISO-8859-1  .iso8859-1  .latin1
AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
AddCharset ISO-8859-3  .iso8859-3  .latin3
AddCharset ISO-8859-4  .iso8859-4  .latin4
AddCharset ISO-8859-5  .iso8859-5  .latin5 .cyr .iso-ru
AddCharset ISO-8859-6  .iso8859-6  .latin6 .arb
AddCharset ISO-8859-7  .iso8859-7  .latin7 .grk
AddCharset ISO-8859-8  .iso8859-8  .latin8 .heb
AddCharset ISO-8859-9  .iso8859-9  .latin9 .trk
AddCharset ISO-2022-JP .iso2022-jp .jis
AddCharset ISO-2022-KR .iso2022-kr .kis
AddCharset ISO-2022-CN .iso2022-cn .cis
AddCharset Big5        .Big5       .big5
AddCharset WINDOWS-1251 .cp-1251   .win-1251
AddCharset CP866       .cp866
AddCharset KOI8-r      .koi8-r .koi8-ru
AddCharset KOI8-ru     .koi8-uk .ua
AddCharset ISO-10646-UCS-2 .ucs2
AddCharset ISO-10646-UCS-4 .ucs4
AddCharset UTF-8       .utf8
AddCharset GB2312      .gb2312 .gb
AddCharset utf-7       .utf7
AddCharset utf-8       .utf8
AddCharset big5        .big5 .b5
AddCharset EUC-TW      .euc-tw
AddCharset EUC-JP      .euc-jp
AddCharset EUC-KR      .euc-kr
AddCharset shift_jis   .sjis
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddHandler type-map var
BrowserMatch "Mozilla/2" nokeepalive
BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
BrowserMatch "RealPlayer 4\.0" force-response-1.0
BrowserMatch "Java/1\.0" force-response-1.0
BrowserMatch "JDK/1\.0" force-response-1.0
BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "^gnome-vfs" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060927/55e55324/attachment-0001.html
From arnaudsj at emedialibrary.org  Wed Sep 27 17:02:48 2006
From: arnaudsj at emedialibrary.org (=?ISO-8859-1?Q?S=E9bastien_Arnaud?=)
Date: Wed Sep 27 17:02:56 2006
Subject: [mod_python] No expiration datestamp on SessionID cookie
Message-ID: <A8C6B899-5E9C-4AD3-9AFA-9869CC265B1F@emedialibrary.org>

Hi,

I have a few webapp running with mod_python, and I just had the  
request to expire a Session when the browser window is closed. I have  
done that in other web framework by NOT setting the expiration of a  
cookie, usually the browser then understand that it needs to destroy  
the cookie when the window/tab is closed.

I am looked through the last 2-3 year on the list and in the current  
3.2 doc but I can't find anywhere a way to specify the expiration  
date of the SessionID cookie.

Thank you in advance for sharing if you managed to get the described  
behavior working in mod_python, or if I missed something in the doc.

Regards,

S?bastien



From deron.meranda at gmail.com  Wed Sep 27 17:34:56 2006
From: deron.meranda at gmail.com (Deron Meranda)
Date: Wed Sep 27 17:35:03 2006
Subject: [mod_python] No expiration datestamp on SessionID cookie
In-Reply-To: <A8C6B899-5E9C-4AD3-9AFA-9869CC265B1F@emedialibrary.org>
References: <A8C6B899-5E9C-4AD3-9AFA-9869CC265B1F@emedialibrary.org>
Message-ID: <5c06fa770609271434q7c95c1b7gbaa925f5cb42cc12@mail.gmail.com>

On 9/27/06, S?bastien Arnaud <arnaudsj@emedialibrary.org> wrote:
> I have a few webapp running with mod_python, and I just had the
> request to expire a Session when the browser window is closed. I have
> done that in other web framework by NOT setting the expiration of a
> cookie, usually the browser then understand that it needs to destroy
> the cookie when the window/tab is closed.
>
> I am looked through the last 2-3 year on the list and in the current
> 3.2 doc but I can't find anywhere a way to specify the expiration
> date of the SessionID cookie.

If you use the lower-level mod_python Cookie class directly you
can affect all the possible cookie parameters, including the
expires parameter.

To leave off the expiration parameter is simple.

   from mod_python import Cookie
   k = Cookie.Cookie( 'sample', 'value' )
  Cookie.add_cookie( req, k )

The value of the cookie (as with str(k)) will be:
    sample=value

If you want to put an expiration time on it, the only really tricky
part is that the cookie standards don't use ISO-8859 formats.

   from mod_python import Cookie
   import datetime

   now = datetime.datetime.uitcnow()
   expires = now + datetime.timedelta( 1, 0 ) # 1 day
   k = Cookie.Cookie( 'sample', 'value', \
              expires.strftime('%a, %d-%b-%Y %H:%M:%S GMT') )
  Cookie.add_cookie( req, k )

Then str(k) gives somethine like:
    sample=value, expires=Wed, 27-Sep-2006 21:17:16 GMT


If you're wanting for force cookies to expire (for security reasons),
note that relying on the expired parameter (or the lack thereof)
is not very good.

What I do is to use a SignedCookie object instead of a plain
Cookie.  Then I format a specific expiration time into the
cookie contents (usually with ISO 8859 UTC format), and
sign the cookie.

When I later extract and use the cookie, I always validate
that the embedded expiration time is still in the future.
In this way I can make sure it is impossible for anybody to
ever artificially extend the life of their cookies.

Note you can do both...embed the expiration time inside a
SignedCookie, as well as omiting the expires= parameter.
Then the cookie will under normal use disappear when the
browser is closed; but you also have a secondary check
that makes sure it can never outlive your intended maximum
cookie lifetime.

Oh, and if you're really secure and want to help avoid some
recent cross-site scripting cookie stealing; also set the secure
cookie parameter (but see Issue #108 as it's not available
in mod_python until very recently)
https://issues.apache.org/jira/browse/MODPYTHON-108

Deron Meranda

From deron.meranda at gmail.com  Wed Sep 27 17:38:31 2006
From: deron.meranda at gmail.com (Deron Meranda)
Date: Wed Sep 27 17:38:35 2006
Subject: [mod_python] No expiration datestamp on SessionID cookie
In-Reply-To: <5c06fa770609271434q7c95c1b7gbaa925f5cb42cc12@mail.gmail.com>
References: <A8C6B899-5E9C-4AD3-9AFA-9869CC265B1F@emedialibrary.org>
	<5c06fa770609271434q7c95c1b7gbaa925f5cb42cc12@mail.gmail.com>
Message-ID: <5c06fa770609271438o7d290494r496eb26ba58556a0@mail.gmail.com>

Oops, I made a couple typos...

On 9/27/06, Deron Meranda <deron.meranda@gmail.com> wrote:
>    from mod_python import Cookie
>    import datetime
>
>    now = datetime.datetime.uitcnow()

utcnow, not uitcnow

>    expires = now + datetime.timedelta( 1, 0 ) # 1 day
>    k = Cookie.Cookie( 'sample', 'value', \
>               expires.strftime('%a, %d-%b-%Y %H:%M:%S GMT') )

you need the parameter name, so it should read
        expires=expires.strftime(....)

>   Cookie.add_cookie( req, k )

Deron Meranda
From grahamd at dscpl.com.au  Wed Sep 27 18:47:24 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep 27 18:47:32 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - where I put them ?
Message-ID: <1159397244.28051@dscpl.user.openhosting.com>

Fredrik Sandin wrote ..
> 
> I asked the same question some time ago:
> http://modpython.org/pipermail/mod_python/2006-August/021924.html
> Graham Dumpleton suggested to use XML-RPC.
> 
> As far as I have understood mod_python, or actually Apache, was
> not designed to allow for object persistency.
> 
> Cheers,
> Fredrik
> 
> 
> On Wed, 27 Sep 2006 14:20:24 +0200, durumdara <durumdara@gmail.com> wrote:
> 
> > Hi !
> >
> > I not fully understand that in this dynamic wwwserver context where I
> > can put persist objects.
> > What I can do to keep my objects in the background ?
> > Anybody can help me ?
> >
> > Thanks for it:
> > dd

For the record, the question which prompted the suggestion of looking at XML-
RPC was not the same so one can't draw any parallels. In that prior case it was
communication between a GUI front end and mod_python as a back end. In this
case it is communication between mod_python and a database backend. In this
case the true persistent data is in the database and what is really being
talked about is the ability to reuse client side database handles in
mod_python. Thus, the persistence being talked about is on objects relate to
the controller mediating access to the data and not the model or data itself.
As others have pointed out, the need to persist these client side database
handles is actually optional. In the old example, there was a desire to persist
the data of the model in mod_python itself, which is totally different issue.

Having said all that, one should read:

  http://www.dscpl.com.au/wiki/ModPython/Articles/TheProcessInterpreterModel

This explains a bit about the ability to persist data in the mod_python world.

One issue not discussed there though is the issues that can arise when data is
held in modules which can be reloaded by mod_python. This is covered a bit in:

  http://www.dscpl.com.au/wiki/ModPython/Articles/ModuleImportingIsBroken

Especially issues 9, 12, 13, 17, 19 and possibly others.

Because of the way the module importer changes between versions 3.1, 3.2 and
3.3 of mod_python, about the only totally reliably way of ensuring data is
persisted in only one spot and not lost or corrupted due to module reloading in
some way, is to create a module instance explicitly, stash it in sys.modules
under a pseudo name and store your data in their. Doing that helps to avoid
reloading problems or needing to contend with mod_python 3.3 specific means of
migrating data between module instances when reloaded. I can give an example
of this later if need be, but for what you are doing with database connections
don't think you need to persist them until you have shown that creating them
each time is a problem.

Finally, you need to be careful with doing work at global scope in a module which
might result in an exception occurring, like creating persisting database connections.
This is because a failure will cause the loading of the module to fail which can
cause problems on subsequent reloads or in worst cases require Apache to be
restarted. For one example of this in relation to the PythonImport directive, see
notes associated with:

  http://issues.apache.org/jira/browse/MODPYTHON-118

If you really want to create persisting database connections, do it in a function
which acts like a singleton returning the object. Ie., it would only create the object
if it doesn't exist. The function would be called every time you need the object
and thus it would only be created first time you need it. If using mod_python 3.3
you might use ability of PythonImport to call a function if you really want it done
on child process initialisation before any requests handled.

Graham
From sdavis at sherlock.nci.nih.gov  Thu Sep 28 07:50:43 2006
From: sdavis at sherlock.nci.nih.gov (Sean Davis)
Date: Wed Sep 27 19:50:45 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <200609271504.56692.richardlewis@fastmail.co.uk>
References: <451A6C88.8000608@gmail.com>
	<op.tgjggzn99etm87@avari254.mt.ltu.se>	<200609270955.27051.sdavis2@mail.nih.gov>
	<200609271504.56692.richardlewis@fastmail.co.uk>
Message-ID: <451BB713.9030606@sherlock.nci.nih.gov>

Richard Lewis wrote:
> On Wednesday 27 September 2006 14:55, Sean Davis wrote:
>   
>> On Wednesday 27 September 2006 09:16, Fredrik Sandin wrote:
>>     
>>> I asked the same question some time ago:
>>> http://modpython.org/pipermail/mod_python/2006-August/021924.html
>>> Graham Dumpleton suggested to use XML-RPC.
>>>
>>> As far as I have understood mod_python, or actually Apache, was
>>> not designed to allow for object persistency.
>>>       
>> Is this actually true (at least the Apache part)?  Under mod_perl (I'm a
>> mod_python total newbie), object persistence can be accomplished in several
>> ways including global variables that remain in shared memory (but this is
>> only within a single child), a database, in an in-memory or on-disk cache,
>> or in a session (just an interface to a cache or database).  Depends on
>> your definition, but Apache, it seems to me, is absolutely suited to allow
>> object persistence.
>>
>>     
> Persistance is all right: you can use global variables as you suggested.
>
> The problem comes at tidying up time. Apache provides no method of performing 
> operations when the server shuts down. This is especially relevant with 
> things like open database connections 
Richard,

Thanks for the clarification. 

Under mod_perl, there is Apache::DBI that overrides the connect() method 
of the DBI module to allow reuse of connections (maintaining a 
persistent connection).  When the server process dies, the DESTROY() 
method is called and the connections are cleaned up.  Would this be 
treated differently under mod_python for some reason, if a database 
connection object had a destroy() method that included a disconnect?  I 
have to admit that I don't understand many of the intricacies, but it 
seems that if it can be done in perl under mod_perl, there is likely a 
way to do it under python and mod_python.

Sean
From grahamd at dscpl.com.au  Wed Sep 27 20:24:10 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Wed Sep 27 20:24:14 2006
Subject: [mod_python] Persist database conn,
	or pers. variables - whereI put them ?
Message-ID: <1159403050.26682@dscpl.user.openhosting.com>

Sean Davis wrote ..
> Richard Lewis wrote:
> > On Wednesday 27 September 2006 14:55, Sean Davis wrote:
> >   
> >> On Wednesday 27 September 2006 09:16, Fredrik Sandin wrote:
> >>     
> >>> I asked the same question some time ago:
> >>> http://modpython.org/pipermail/mod_python/2006-August/021924.html
> >>> Graham Dumpleton suggested to use XML-RPC.
> >>>
> >>> As far as I have understood mod_python, or actually Apache, was
> >>> not designed to allow for object persistency.
> >>>       
> >> Is this actually true (at least the Apache part)?  Under mod_perl (I'm
> a
> >> mod_python total newbie), object persistence can be accomplished in
> several
> >> ways including global variables that remain in shared memory (but this
> is
> >> only within a single child), a database, in an in-memory or on-disk
> cache,
> >> or in a session (just an interface to a cache or database).  Depends
> on
> >> your definition, but Apache, it seems to me, is absolutely suited to
> allow
> >> object persistence.
> >>
> >>     
> > Persistance is all right: you can use global variables as you suggested.
> >
> > The problem comes at tidying up time. Apache provides no method of performing
> > operations when the server shuts down. This is especially relevant with
> > things like open database connections 
> Richard,
> 
> Thanks for the clarification. 
> 
> Under mod_perl, there is Apache::DBI that overrides the connect() method
> of the DBI module to allow reuse of connections (maintaining a 
> persistent connection).  When the server process dies, the DESTROY() 
> method is called and the connections are cleaned up.  Would this be 
> treated differently under mod_python for some reason, if a database 
> connection object had a destroy() method that included a disconnect?  I
> have to admit that I don't understand many of the intricacies, but it 
> seems that if it can be done in perl under mod_perl, there is likely a
> way to do it under python and mod_python.

Whether one can reliably cause actions to be run on server shutdown in
mod_python is a contentious issue as the moment. I have been a bit lax in going
back and doing some further testing on the issue to settle it one way or the
other and no one else has stepped up to the plate to do the required analysis.

What I can say is the following.

1. Even where a mechanism is available for triggering actions to be called on
shutdown, there is no guarantee that the actions will be called purely because
the Apache parent process can make a decision that a child process isn't
shutting down properly by itself and it will send it a KILL signal to cause it
to immediately quit. Processes can always crash for no good reason as well.

Thus, one shouldn't write code that absolutely requires such clean shutdowns to
occur. Any startup code should always be written to deal with a prior unclean
shutdown and do any special cleanup first if required.

Also, sometimes a persons belief that cleanup code is required has been
based on a mistaken belief that if not done then resources would be leaked.
Certainly in the case of database connections, this shouldn't be the case as
the server side will detect that client connections have gone away and will
automatically cleanup on the server side even if a clean close of the connection
hadn't been done.

2. In mod_python 3.3, any Python interpreter instances will not be destroyed on
child process shutdown. The interpreter instances are being destroyed in
mod_python prior to 3.3, but doing so can cause the Apache child process to
hang, as this can get triggered from within a signal handler in certain
circumstances and if there is an active request handler for mod_python running
at the time. the signal handler will block due to not being able to acquire the
Python GIL. Thus, calling Py_Finalize() for interpreters is no longer being
done at this point.

The implications of this are that Python objects are not being destroyed on
child process shutdown, thus you cannot rely on the destructor of Python
objects doing anything to cleanup resources.

3. In mod_python, there are the functions apache.register_cleanup() and
req.server.register_cleanup() for registering actions to be done on server
cleanup. However, the trigger for these being called is the destruction of
the childs Apache memory pool. As with 2, this seems in some cases to be
triggered from a signal handler and thus can similarly result in the Apache
child process hanging on shutdown.

See:

  http://issues.apache.org/jira/browse/MODPYTHON-109

for more details.

Thus, the question has been whether if no guarantees can be given as to
whether cleanup actions will even be called and if an attempt is made to
call them, it still may result in them not being run because of the Apache
child process hanging due to locking problems, should the feature even
be provided.

Now it is possible that prior analysis of the Apache source code and how
these cleanup actions are triggered could be wrong, or based on old Apache
code where it worked a bit differently. As I said though, no one else has
stepped up to do a proper analysis of the Apache code and do testing in
respect of the issue and I haven't had a chance lately to look at it again.
The other core developers have also been quite busy of late. Without this
further analysis, we will not know if 2 and 3 are really problems or not.

Graham

From sdavis2 at mail.nih.gov  Thu Sep 28 08:40:27 2006
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Wed Sep 27 20:40:31 2006
Subject: [mod_python] Persist database conn,or pers. variables - whereI
	put them ?
In-Reply-To: <1159403050.26682@dscpl.user.openhosting.com>
References: <1159403050.26682@dscpl.user.openhosting.com>
Message-ID: <451BC2BB.7030805@mail.nih.gov>

Graham Dumpleton wrote:
> Sean Davis wrote ..
>   
>> Richard Lewis wrote:
>>     
>>> On Wednesday 27 September 2006 14:55, Sean Davis wrote:
>>>   
>>>       
>>>> On Wednesday 27 September 2006 09:16, Fredrik Sandin wrote:
>>>>     
>>>>         
>>>>> I asked the same question some time ago:
>>>>> http://modpython.org/pipermail/mod_python/2006-August/021924.html
>>>>> Graham Dumpleton suggested to use XML-RPC.
>>>>>
>>>>> As far as I have understood mod_python, or actually Apache, was
>>>>> not designed to allow for object persistency.
>>>>>       
>>>>>           
>>>> Is this actually true (at least the Apache part)?  Under mod_perl (I'm
>>>>         
>> a
>>     
>>>> mod_python total newbie), object persistence can be accomplished in
>>>>         
>> several
>>     
>>>> ways including global variables that remain in shared memory (but this
>>>>         
>> is
>>     
>>>> only within a single child), a database, in an in-memory or on-disk
>>>>         
>> cache,
>>     
>>>> or in a session (just an interface to a cache or database).  Depends
>>>>         
>> on
>>     
>>>> your definition, but Apache, it seems to me, is absolutely suited to
>>>>         
>> allow
>>     
>>>> object persistence.
>>>>
>>>>     
>>>>         
>>> Persistance is all right: you can use global variables as you suggested.
>>>
>>> The problem comes at tidying up time. Apache provides no method of performing
>>> operations when the server shuts down. This is especially relevant with
>>> things like open database connections 
>>>       
>> Richard,
>>
>> Thanks for the clarification. 
>>
>> Under mod_perl, there is Apache::DBI that overrides the connect() method
>> of the DBI module to allow reuse of connections (maintaining a 
>> persistent connection).  When the server process dies, the DESTROY() 
>> method is called and the connections are cleaned up.  Would this be 
>> treated differently under mod_python for some reason, if a database 
>> connection object had a destroy() method that included a disconnect?  I
>> have to admit that I don't understand many of the intricacies, but it 
>> seems that if it can be done in perl under mod_perl, there is likely a
>> way to do it under python and mod_python.
>>     
>
> Whether one can reliably cause actions to be run on server shutdown in
> mod_python is a contentious issue as the moment. I have been a bit lax in going
> back and doing some further testing on the issue to settle it one way or the
> other and no one else has stepped up to the plate to do the required analysis.
>
> What I can say is the following.
>
> 1. Even where a mechanism is available for triggering actions to be called on
> shutdown, there is no guarantee that the actions will be called purely because
> the Apache parent process can make a decision that a child process isn't
> shutting down properly by itself and it will send it a KILL signal to cause it
> to immediately quit. Processes can always crash for no good reason as well.
>
> Thus, one shouldn't write code that absolutely requires such clean shutdowns to
> occur. Any startup code should always be written to deal with a prior unclean
> shutdown and do any special cleanup first if required.
>
> Also, sometimes a persons belief that cleanup code is required has been
> based on a mistaken belief that if not done then resources would be leaked.
> Certainly in the case of database connections, this shouldn't be the case as
> the server side will detect that client connections have gone away and will
> automatically cleanup on the server side even if a clean close of the connection
> hadn't been done.
>
> 2. In mod_python 3.3, any Python interpreter instances will not be destroyed on
> child process shutdown. The interpreter instances are being destroyed in
> mod_python prior to 3.3, but doing so can cause the Apache child process to
> hang, as this can get triggered from within a signal handler in certain
> circumstances and if there is an active request handler for mod_python running
> at the time. the signal handler will block due to not being able to acquire the
> Python GIL. Thus, calling Py_Finalize() for interpreters is no longer being
> done at this point.
>
> The implications of this are that Python objects are not being destroyed on
> child process shutdown, thus you cannot rely on the destructor of Python
> objects doing anything to cleanup resources.
>
> 3. In mod_python, there are the functions apache.register_cleanup() and
> req.server.register_cleanup() for registering actions to be done on server
> cleanup. However, the trigger for these being called is the destruction of
> the childs Apache memory pool. As with 2, this seems in some cases to be
> triggered from a signal handler and thus can similarly result in the Apache
> child process hanging on shutdown.
>
> See:
>
>   http://issues.apache.org/jira/browse/MODPYTHON-109
>
> for more details.
>
> Thus, the question has been whether if no guarantees can be given as to
> whether cleanup actions will even be called and if an attempt is made to
> call them, it still may result in them not being run because of the Apache
> child process hanging due to locking problems, should the feature even
> be provided.
>
> Now it is possible that prior analysis of the Apache source code and how
> these cleanup actions are triggered could be wrong, or based on old Apache
> code where it worked a bit differently. As I said though, no one else has
> stepped up to do a proper analysis of the Apache code and do testing in
> respect of the issue and I haven't had a chance lately to look at it again.
> The other core developers have also been quite busy of late. Without this
> further analysis, we will not know if 2 and 3 are really problems or not.
>
>   
Graham,

Thanks for the awesome analysis!  I'm not much of a programmer, so I 
can't say I follow all of it, but I think I get the take-home messages.  
Thanks again for the explanation and for continuing to actively make 
improvements.

Sean
From durumdara at gmail.com  Thu Sep 28 03:20:02 2006
From: durumdara at gmail.com (durumdara)
Date: Thu Sep 28 03:20:08 2006
Subject: [mod_python] Perfect solution for split recordset by N number of
	records per page
Message-ID: <451B77A2.3020204@gmail.com>

Hi !

Basically the (db, web) server developers must limit the result(set).
They must filter data tables with queries, they must must the limit 
record count that they get back to clients.

In the most of the websites the usual way to descreasing the result page 
length to splitting the result to N pieces (r number of records), and to 
creating a "thumbnails" for the pages.
See google...

The Zope have an automatic and automagic built-in thing that can provide 
thumbnails to resultsets.

In mod_python I need to build it (If I see good).

The question is: Have you any idea, how to I create it ?

The my biggest problem: how to control the queries.
Some of the database servers support the "TOP" (or "START") "attribute" 
that can say to the server, where it starts the query (what is the first 
record in the total recordset).
Some of the databases also support the "LIMIT" "attribute" that can 
limit recordset (how many records I need).
With these parameters the db server can "cut" some records from the 
total query result.
FireBird can do it as I know.

If these functions are not presented in the server, the queries "recno" 
or "rowid" param can help to us.

But if none of these things are presented, what can I do ? (I have 
DBISAM connection through Windows ODBC).
I can fetch records while I not found the N. record, and I fetch until 
limit have been reach.
Example: I split recordset by 50 records. When I want to load page 5, I 
must jump to the record 5*50 = 250. record in the queries resultset, and 
must fetch 50 records - this is the content of the result page that I 
shall be create later.

It is working with little resultset, but when I have 2000-10000 records, 
this method is too slow.

The Zope is handle this by it's automagically way, I don't know how.

How you handle this thing in your website ?

Thanks for your help and for your idea !

    dd



From durumdara at gmail.com  Thu Sep 28 04:47:46 2006
From: durumdara at gmail.com (durumdara)
Date: Thu Sep 28 04:47:54 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <451A8C93.80506@natlab.research.philips.com>
References: <451A6C88.8000608@gmail.com>
	<451A8C93.80506@natlab.research.philips.com>
Message-ID: <451B8C32.7030308@gmail.com>

Hi !

Mike Looijmans ?rta:
> Start with "if it's not a problem, it's not a problem".
If it is not problem in your site, possible it is problem in another
site... :-(
>
> I benchmarked MySQL with mod_python years ago. There was no noticable 
> performance benefit whatsoever between re-using one connection for all 
> DB traffic, multiple global connections in a pool, versus opening and 
> closing a DB connection on every request.
> With connection pooling comes the risk that you keep too many 
> connections open for too long. If you serve both static and dynamic 
> content, a pre-fork apache mpm may have 20 open connections while 
> you're using only one...
Yes-yes !
With MySQL you can do it without problem !

But when you trying it with FireBird, PGSQL, ODBC, or with Remote
Server, you will get another experience...
Example: FireBird connect is very slow. When I not reuse the connection,
I get the page in 5-10 seconds. When I reuse, the generating is below 1
second.
This is not same !!!

dd

From nlv11281 at natlab.research.philips.com  Thu Sep 28 05:45:42 2006
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Thu Sep 28 05:45:49 2006
Subject: [mod_python] Persist database conn,	or pers. variables - where
	I put them ?
In-Reply-To: <451B8C0D.1090807@gmail.com>
References: <451A6C88.8000608@gmail.com>
	<451A8C93.80506@natlab.research.philips.com>
	<451B8C0D.1090807@gmail.com>
Message-ID: <451B99C6.6040202@natlab.research.philips.com>

> Example: FireBird connect is very slow. When I not reuse the connection, 
> I get the page in 5-10 seconds. When I reuse, the generating is below 1 
> second.

For this kind of problem, connection pooling is a good solution indeed. If you have control over the 
Apache server, force it to use a "mostly" threading worker mpm (on most unix systems, it defaults to 
prefork). This allows you to share the Python interpreter for many requests, and thus the 
namespaces. Then you can create a simple connection pool as a module where you grab and put back 
connection objects when you're done with it.

Cleanup is not a problem. If the apache child process dies, the connections will be closed by the OS 
and Firebird will cleanup the associated resources.

If you must use multi-processing apache, either use a proxy (can be HTTP or SQL proxy as suggested 
already) in a separate process, or make sure that firebird can handle things like 200 open idle 
connections efficiently.

Mike.

From sdavis2 at mail.nih.gov  Thu Sep 28 06:38:17 2006
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu Sep 28 06:38:21 2006
Subject: [mod_python] Perfect solution for split recordset by N number of
	records per page
In-Reply-To: <451B77A2.3020204@gmail.com>
References: <451B77A2.3020204@gmail.com>
Message-ID: <200609280638.17250.sdavis2@mail.nih.gov>

On Thursday 28 September 2006 03:20, durumdara wrote:
> Hi !
>
> Basically the (db, web) server developers must limit the result(set).
> They must filter data tables with queries, they must must the limit
> record count that they get back to clients.

You outlined the major methods to do this, I think.  Use some version of limit 
and offset in whatever SQL variant you are using.  

> It is working with little resultset, but when I have 2000-10000 records,
> this method is too slow.

You probably need to think about tuning your database a bit to see if you can 
speed things up.  Make sure that you have the correct indices in place and 
than you are using limit/offset as best you can.  This is really a database 
problem as much as a web app design issue.  In other words, if your SQL query 
to get a "page" of data takes 3 seconds, this is a database issue, which I 
suppose it is.

Sean
From nlv11281 at natlab.research.philips.com  Thu Sep 28 06:51:56 2006
From: nlv11281 at natlab.research.philips.com (Mike Looijmans)
Date: Thu Sep 28 06:52:06 2006
Subject: [mod_python] Perfect solution for split recordset by N number
	of	records per page
In-Reply-To: <200609280638.17250.sdavis2@mail.nih.gov>
References: <451B77A2.3020204@gmail.com>
	<200609280638.17250.sdavis2@mail.nih.gov>
Message-ID: <451BA94C.8060709@natlab.research.philips.com>

> You probably need to think about tuning your database a bit to see if you can 
> speed things up.  Make sure that you have the correct indices in place and 
> than you are using limit/offset as best you can.  This is really a database 
> problem as much as a web app design issue.  In other words, if your SQL query 
> to get a "page" of data takes 3 seconds, this is a database issue, which I 
> suppose it is.

It's also a UI issue. Who would want a user to browse through 10000 records in pages of 100 records? 
The UI should allow some method of limiting or summarizing the results.

From sdavis2 at mail.nih.gov  Thu Sep 28 07:16:23 2006
From: sdavis2 at mail.nih.gov (Sean Davis)
Date: Thu Sep 28 07:17:10 2006
Subject: [mod_python] Perfect solution for split recordset by N number
	=?iso-8859-2?q?of=09records_per?= page
In-Reply-To: <451BA94C.8060709@natlab.research.philips.com>
References: <451B77A2.3020204@gmail.com>
	<200609280638.17250.sdavis2@mail.nih.gov>
	<451BA94C.8060709@natlab.research.philips.com>
Message-ID: <200609280716.23798.sdavis2@mail.nih.gov>

On Thursday 28 September 2006 06:51, Mike Looijmans wrote:
> > You probably need to think about tuning your database a bit to see if you
> > can speed things up.  Make sure that you have the correct indices in
> > place and than you are using limit/offset as best you can.  This is
> > really a database problem as much as a web app design issue.  In other
> > words, if your SQL query to get a "page" of data takes 3 seconds, this is
> > a database issue, which I suppose it is.
>
> It's also a UI issue. Who would want a user to browse through 10000 records
> in pages of 100 records? The UI should allow some method of limiting or
> summarizing the results.

Good point, Mike.

Of course, but if it takes 10 seconds (for example) to pull up 100 records for 
the UI (to render one page of the 100 pages), that IS a database issue.  I 
(probably incorrectly) inferred that the OP was having problems with using 
the paging strategy with large resultsets.  That, to me, implies that the 
database needs to be tuned.  

As for the UI and user experience, I think that is often specific to the data 
being presented.  Sometimes an interactive graphical summary can be useful, 
sometimes simple text reports with links, and sometimes the best way IS to 
present 100 pages of 100 records each sorted in some clever way with 
appropriate links to move around (eg., Google).

Sean
From ppathiakis at eagleaccess.com  Thu Sep 28 08:41:03 2006
From: ppathiakis at eagleaccess.com (Paul J. Pathiakis)
Date: Thu Sep 28 08:45:18 2006
Subject: [mod_python] Can't get it to interpret
References: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C908@BIGMAIL.eagleinvsys.com>
	<EAED38651CF6BF46A8D2BCD9D4EEAA6D76C90A@BIGMAIL.eagleinvsys.com>
Message-ID: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C90E@BIGMAIL.eagleinvsys.com>

Hi,

as I discover more about this....

there's a .htaccess file in directory which contains this:

SetHandler python-program
PythonHander mod_python.publisher
PythonDebug On

PythonHeaderParserHandler nav.web

# In a running installation, PythonPath should be set her, adding all the 
# subdirectories containing Python modules.

PythonPath "sys.path+['/usr/local/nav/apache/webroot/.']"

Could someone please explain what the above means?  I haven't worked on web and/or mod_python in quite a while.  I could really use the help.  

Thank you,

Paul





-----Original Message-----
From: Paul J. Pathiakis
Sent: Wed 9/27/2006 2:27 PM
To: Paul J. Pathiakis; mod_python@modpython.org
Subject: RE: [mod_python] Can't get it to interpret
 
Interesting... I got it to work but it was due to the AllowOverrides allowing FileInfo only.... so...
Now I'm trying to get this to follow the link to nav (NAV) that is in the Document Root that goes to Nav's webroot (on FreeBSD - /usr/local/nav/apache/webroot)  After moving NAV's sudirectory to be under the document root, everything goes fine until I enter the python files:

Mod_python error: "PythonHeaderParserHandler nav.web"

Traceback (most recent call last):

  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py", line 287, in HandlerDispatch
    log=debug)

  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py", line 461, in import_module
    f, p, d = imp.find_module(parts[i], path)

ImportError: No module named nav


Thanks again,

Paul


-----Original Message-----
From: mod_python-bounces@modpython.org on behalf of Paul J. Pathiakis
Sent: Wed 9/27/2006 1:56 PM
To: mod_python@modpython.org
Subject: [mod_python] Can't get it to interpret
 
Hi,

I've been trying, according to the manual, to get things to work on the mptest.py example.  It doesn't go.  However, I did move onto the trouble shooting and I hope someone can help.  My problem is that the information comes up as just plain text.  I have tried AllowOverrides all and a few other things but this is not my forte'.  I'm trying to get NAV up and running for the network (I already have nagios, orca and several other tools but NAV with cricket would be a boon.)  However, I can't get mod_python to work.  I believe I had it working at COB Friday, but come Monday... well...

Give me what you can.  I can usually ramp fairly quickly.  I've been on this for 3 days and I'm starting to dislike it. :-(

Thank you all!

Paul


General information
Apache version	Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3
Apache threaded MPM	No (single thread MPM)
Apache forked MPM	Yes, maximum 256 processes
Apache server root	/usr/local
Apache document root	/usr/local/www/data
Apache error log	/var/log/httpd-error.log (view last 100 lines)
Python sys.version	2.4.3 (#1, Aug 9 2006, 09:05:59) [GCC 3.4.4 [FreeBSD] 20050518]
Python sys.path	

/mpinfo/
/usr/local/lib/python24.zip
/usr/local/lib/python2.4
/usr/local/lib/python2.4/plat-freebsd6
/usr/local/lib/python2.4/lib-tk
/usr/local/lib/python2.4/lib-dynload
/usr/local/lib/python2.4/site-packages

Python interpreter name	monitor.foo.com
mod_python.publisher available	Yes
mod_python.psp available	Yes
Request input headers
Key	Value
Host	10.170.1.241
User-Agent	Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.7) Gecko/20060927 Firefox/1.5.0.7
Accept	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
Accept-Language	en-us,en;q=0.5
Accept-Encoding	gzip,deflate
Accept-Charset	ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive	300
Connection	keep-alive
Cache-Control	max-age=0
Request environment
Key	Value
UNIQUE_ID	0xEf2n8AAAEAACmwBDcAAAAA
GATEWAY_INTERFACE	CGI/1.1
SERVER_PROTOCOL	HTTP/1.1
REQUEST_METHOD	GET
QUERY_STRING	
REQUEST_URI	/mpinfo
SCRIPT_NAME	/mpinfo
HTTP_HOST	10.10.10.10
HTTP_USER_AGENT	Mozilla/5.0 (X11; U; FreeBSD i386; en-US; rv:1.8.0.7) Gecko/20060927 Firefox/1.5.0.7
HTTP_ACCEPT	text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
HTTP_ACCEPT_LANGUAGE	en-us,en;q=0.5
HTTP_ACCEPT_ENCODING	gzip,deflate
HTTP_ACCEPT_CHARSET	ISO-8859-1,utf-8;q=0.7,*;q=0.7
HTTP_KEEP_ALIVE	300
HTTP_CONNECTION	keep-alive
HTTP_CACHE_CONTROL	max-age=0
PATH	/sbin:/bin:/usr/sbin:/usr/bin:/usr/games:/usr/local/sbin:/usr/local/bin:/usr/X11R6/bin:/root/bin
SERVER_SIGNATURE	
Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3 Server at 10.170.1.241 Port 80
SERVER_SOFTWARE	Apache/2.0.59 (FreeBSD) PHP/5.1.6 mod_python/3.2.10 Python/2.4.3
SERVER_NAME	10.10.10.10
SERVER_ADDR	10.10.10.10
SERVER_PORT	80
REMOTE_ADDR	10.100.11.47
DOCUMENT_ROOT	/usr/local/www/data
SERVER_ADMIN	root@monitor.foo.com
SCRIPT_FILENAME	/usr/local/www/data/mpinfo
REMOTE_PORT	55673
Request configuration
Key	Value
Request options
Key	Value
Request notes
Key	Value
python_init_ran	1
Server configuration
Key	Value
Server options
Key	Value
Server configuration tree

PidFile /var/run/httpd.pid
Timeout 300
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 15
StartServers 5
MinSpareServers 5
MaxSpareServers 10
MaxClients 150
MaxRequestsPerChild 0
Listen 80
User www
Group www
ServerAdmin root@monitor.foo.com
ServerName monitor.foo.com:80
UseCanonicalName Off
DocumentRoot "/usr/local/www/data"

    AllowOverride None
    Order Deny,Allow
    Deny from all

    Options Indexes FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all
UserDir public_html
UserDir disabled root toor daemon operator bin tty kmem games news man sshd bind proxy _pflogd _dhcp uucp pop www nobody mailnull smmsp

    AllowOverride FileInfo AuthConfig Limit Indexes
    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
    
        Order allow,deny
        Allow from all
    
        Order deny,allow
        Deny from all
DirectoryIndex index.html index.html.var
AccessFileName .htaccess

    Order allow,deny
    Deny from all
TypesConfig etc/apache2/mime.types
DefaultType text/plain
MIMEMagicFile etc/apache2/magic
HostnameLookups Off
ErrorLog /var/log/httpd-error.log
LogLevel warn
LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
LogFormat "%h %l %u %t \"%r\" %>s %b" common
LogFormat "%{Referer}i -> %U" referer
LogFormat "%{User-agent}i" agent
CustomLog /var/log/httpd-access.log combined
ServerTokens Full
ServerSignature On
Alias /icons/ "/usr/local/www/icons/"

    Options Indexes MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
AliasMatch ^/manual(?:/(?:de|en|es|fr|ja|ko|ru))?(/.*)?$ "/usr/local/share/doc/apache2$1"

    Options Indexes
    AllowOverride None
    Order allow,deny
    Allow from all
    
        SetHandler type-map
    SetEnvIf Request_URI ^/manual/(de|en|es|fr|ja|ko|ru)/ prefer-language=$1
    RedirectMatch 301 ^/manual(?:/(de|en|es|fr|ja|ko|ru)){2,}(/.*)?$ /manual/$1$2
ScriptAlias /nagios/cgi-bin/ /usr/local/www/nagios/cgi-bin/

    Options ExecCGI
    AllowOverride None
    Order allow,deny
    Allow from all
    AuthName "Nagios Access"
    AuthType Basic
    AuthUserFile /usr/local/etc/nagios/htpasswd.users
    Require valid-user
Alias /nagios/  "/usr/local/www/nagios/"

    Options None
    AllowOverride None
    Order allow,deny
    Allow from all
    AuthName "Nagios Access"
    AuthType Basic
    AuthUserFile /usr/local/etc/nagios/htpasswd.users
    Require valid-user

    Order allow,deny
    Allow from all

    Options ExecCGI
ScriptAlias /nessus/cgi-bin/ /usr/local/www/nessus/cgi-bin/
Alias /nessus/  /usr/local/www/nessus/

    Options Indexes FollowSymLinks ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
Alias /cricket/ /usr/local/cricket/cricket/doc/

    SetHandler mod_python
    PythonHandler mod_python.testhandler
ScriptAlias /nav/ /usr/local/nav/apache/webroot/

    Options Indexes FollowSymLinks ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
ScriptAlias /cgi-bin/ "/usr/local/www/cgi-bin/"

    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
IndexOptions FancyIndexing VersionSort
AddIconByEncoding (CMP,/icons/compressed.gif) x-compress x-gzip
AddIconByType (TXT,/icons/text.gif) text/*
AddIconByType (IMG,/icons/image2.gif) image/*
AddIconByType (SND,/icons/sound2.gif) audio/*
AddIconByType (VID,/icons/movie.gif) video/*
AddIcon /icons/binary.gif .bin .exe
AddIcon /icons/binhex.gif .hqx
AddIcon /icons/tar.gif .tar
AddIcon /icons/world2.gif .wrl .wrl.gz .vrml .vrm .iv
AddIcon /icons/compressed.gif .Z .z .tgz .gz .zip
AddIcon /icons/a.gif .ps .ai .eps
AddIcon /icons/layout.gif .html .shtml .htm .pdf
AddIcon /icons/text.gif .txt
AddIcon /icons/c.gif .c
AddIcon /icons/p.gif .pl .py
AddIcon /icons/f.gif .for
AddIcon /icons/dvi.gif .dvi
AddIcon /icons/uuencoded.gif .uu
AddIcon /icons/script.gif .conf .sh .shar .csh .ksh .tcl
AddIcon /icons/tex.gif .tex
AddIcon /icons/bomb.gif core
AddIcon /icons/back.gif ..
AddIcon /icons/hand.right.gif README
AddIcon /icons/folder.gif ^^DIRECTORY^^
AddIcon /icons/blank.gif ^^BLANKICON^^
DefaultIcon /icons/unknown.gif
ReadmeName README.html
HeaderName HEADER.html
IndexIgnore .??* *~ *# HEADER* README* RCS CVS *,v *,t
AddLanguage ca .ca
AddLanguage cs .cz .cs
AddLanguage da .dk
AddLanguage de .de
AddLanguage el .el
AddLanguage en .en
AddLanguage eo .eo
AddLanguage es .es
AddLanguage et .et
AddLanguage fr .fr
AddLanguage he .he
AddLanguage hr .hr
AddLanguage it .it
AddLanguage ja .ja
AddLanguage ko .ko
AddLanguage ltz .ltz
AddLanguage nl .nl
AddLanguage nn .nn
AddLanguage no .no
AddLanguage pl .po
AddLanguage pt .pt
AddLanguage pt-BR .pt-br
AddLanguage ru .ru
AddLanguage sv .sv
AddLanguage zh-CN .zh-cn
AddLanguage zh-TW .zh-tw
LanguagePriority en ca cs da de el eo es et fr he hr it ja ko ltz nl nn no pl pt pt-BR ru sv zh-CN zh-TW
ForceLanguagePriority Prefer Fallback
AddCharset ISO-8859-1  .iso8859-1  .latin1
AddCharset ISO-8859-2  .iso8859-2  .latin2 .cen
AddCharset ISO-8859-3  .iso8859-3  .latin3
AddCharset ISO-8859-4  .iso8859-4  .latin4
AddCharset ISO-8859-5  .iso8859-5  .latin5 .cyr .iso-ru
AddCharset ISO-8859-6  .iso8859-6  .latin6 .arb
AddCharset ISO-8859-7  .iso8859-7  .latin7 .grk
AddCharset ISO-8859-8  .iso8859-8  .latin8 .heb
AddCharset ISO-8859-9  .iso8859-9  .latin9 .trk
AddCharset ISO-2022-JP .iso2022-jp .jis
AddCharset ISO-2022-KR .iso2022-kr .kis
AddCharset ISO-2022-CN .iso2022-cn .cis
AddCharset Big5        .Big5       .big5
AddCharset WINDOWS-1251 .cp-1251   .win-1251
AddCharset CP866       .cp866
AddCharset KOI8-r      .koi8-r .koi8-ru
AddCharset KOI8-ru     .koi8-uk .ua
AddCharset ISO-10646-UCS-2 .ucs2
AddCharset ISO-10646-UCS-4 .ucs4
AddCharset UTF-8       .utf8
AddCharset GB2312      .gb2312 .gb
AddCharset utf-7       .utf7
AddCharset utf-8       .utf8
AddCharset big5        .big5 .b5
AddCharset EUC-TW      .euc-tw
AddCharset EUC-JP      .euc-jp
AddCharset EUC-KR      .euc-kr
AddCharset shift_jis   .sjis
AddType application/x-compress .Z
AddType application/x-gzip .gz .tgz
AddHandler type-map var
BrowserMatch "Mozilla/2" nokeepalive
BrowserMatch "MSIE 4\.0b2;" nokeepalive downgrade-1.0 force-response-1.0
BrowserMatch "RealPlayer 4\.0" force-response-1.0
BrowserMatch "Java/1\.0" force-response-1.0
BrowserMatch "JDK/1\.0" force-response-1.0
BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
BrowserMatch "MS FrontPage" redirect-carefully
BrowserMatch "^WebDrive" redirect-carefully
BrowserMatch "^WebDAVFS/1.[0123]" redirect-carefully
BrowserMatch "^gnome-vfs" redirect-carefully
BrowserMatch "^XML Spy" redirect-carefully
BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060928/2c5e02fb/attachment-0001.html
From mvanaswegen at gmail.com  Thu Sep 28 17:26:18 2006
From: mvanaswegen at gmail.com (marinus van aswegen)
Date: Thu Sep 28 17:26:25 2006
Subject: [mod_python] fedora vs ubuntu
Message-ID: <ffa39deb0609281426pbde1b85k9855e3698518ec63@mail.gmail.com>

Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
setup is very different. before i hit the docs i thought id check to
see if anyone can give me some pointers thanks
From jpg at jgassociates.ca  Thu Sep 28 19:14:19 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Thu Sep 28 19:12:50 2006
Subject: [mod_python] fedora vs ubuntu
In-Reply-To: <ffa39deb0609281426pbde1b85k9855e3698518ec63@mail.gmail.com>
References: <ffa39deb0609281426pbde1b85k9855e3698518ec63@mail.gmail.com>
Message-ID: <451C574B.9000509@jgassociates.ca>

marinus van aswegen wrote:
> Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
> setup is very different. before i hit the docs i thought id check to
> see if anyone can give me some pointers thanks

I'm not sure what you are asking here, but I'm going to assume you are 
confronted by the different layout for the apache configuration.

The apache configuration for Debian-derived systems makes use of lots of 
individual files and symbolic links.

Here are the steps, assuming you are compiling mod_python rather than 
grabbing it from the repository, and your mod_python version 3.2 or greater.

1. Untar the tarball
2. Do the configure/make/make install shuffle. Ubuntu (and debian) use 
apxs2, but configure will find it for you so you don't need to worry

$ ./configure; make; sudo make install


3. Create the module config file. (this statement should all be on one 
line.)

$ sudo echo "LoadModule python_module 
/usr/lib/apache2/modules/mod_python.so" > 
/etc/apache2/mods-available/mod_python.load

3b. I like to put my other module configuration directives in 
mod_python.load as well. This is good place for things like:

PythonOption mod_python.mutex_locks 8
PythonOption mod_python.mutex_directory /var/lock/mod_python
PythonOption mod_python.future.importer *

4. Enable the module. a2enmod creates a symbolic link in 
/etc/apache2/mods-enabled. That directory is included by apache2.conf

$ sudo /usr/sbin/a2enmod mod_python.load

5. restart apache

$ sudo /etc/init.d/apache2 restart

You are now good to go. Your virtual host config files go in 
/etc/apache2/sites-available and are enabled by

$ sudo /etc/sbin/a2ensite whatever

After a while any other configuration layout just seems wrong. ;)

Jim
From john.keyes at secantus.com  Fri Sep 29 06:09:53 2006
From: john.keyes at secantus.com (John Keyes)
Date: Fri Sep 29 06:09:56 2006
Subject: [mod_python] Raising Exceptions
Message-ID: <e37997d0609290309i295b8154j53229ac44e0fa501@mail.gmail.com>

Hi guys,

I've included some test code (see below) for some weird
behaviour I've noticed.

I have dispatcher.py set up as a handler which dynamically
imports another handler (testhandler.py) and then calls
it's handler function.

The handler function in testhandler throws a user defined
exception (see __init__.py) which the dispatcher is
explicity set up to catch (see except MyError).

If I import testhandler using apache.import_module I
get the following output:

  test
  testhandler - b4 raise
  exception - MyError - jk

Yet if I use __import__ and getattr I get the following
output:

  test
  testhandler - b4 raise
  myerror

As you can see using import_module the incorrect except
block is executed, but the class name of the exception
is correct.

Can anyone explain to me why this is the case?

I've the code included inline but if you want to run the
code I've attached a zip file as well.

Apache     - 2.0.58
mod_python - 3.2.8
Python     - 2.4.3

Cheers,
-John K

== test.__init__.py ==
class MyError(Exception):
    def __init__(self, msg):
        self.msg = msg

    def __str__(self):
        return self.msg

== test.dispatcher.py ==
from mod_python import apache

from test import MyError

def handler(req):
    req.write("\ntest")

    try:
        #test_handler = apache.import_module('test.handlers.testhandler')
        test_handler = my_import('test.handlers.testhandler')
        val = test_handler.handler(req)
    except MyError, me:
        req.write("\nmyerror")
    except Exception, e:
        req.write("\nexception - %s - %s" % (e.__class__.__name__, e))

    return apache.OK

def my_import(name):
    mod = __import__(name)
    components = name.split('.')
    for comp in components[1:]:
        mod = getattr(mod, comp)
    return mod

== test.handlers.testhandler.py ==
from mod_python import apache

from test import MyError

def handler(req):
    req.write("\ntesthandler - b4 raise")

    raise MyError('jk')

    req.write("\ntesthandler - af raise")
    return apache.OK
-------------- next part --------------
A non-text attachment was scrubbed...
Name: import_test.zip
Type: application/zip
Size: 1113 bytes
Desc: not available
Url : http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060929/3bba7e00/import_test.zip
From ppathiakis at eagleaccess.com  Fri Sep 29 11:25:49 2006
From: ppathiakis at eagleaccess.com (Paul J. Pathiakis)
Date: Fri Sep 29 11:25:37 2006
Subject: [mod_python] NAV mod_python.publisher errors
Message-ID: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C91E@BIGMAIL.eagleinvsys.com>

Hi,

would someone please respond to this?  I've posted twice to this list and no one responds.  I'm sorry if this is such a low level question but I'd really like to get it working.

I have index.py.  It seems to be found by the browser and an attempt is made by python to render it and display it.  However, I get the following:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py", line 299, in HandlerDispatch
    result = object(req)

  File "/usr/local/lib/python2.4/site-packages/mod_python/publisher.py", line 213, in handler
    published = publish_object(req, object)

  File "/usr/local/lib/python2.4/site-packages/mod_python/publisher.py", line 412, in publish_object
    return publish_object(req,util.apply_fs_data(object, req.form, req=req))

  File "/usr/local/lib/python2.4/site-packages/mod_python/util.py", line 439, in apply_fs_data
    return object(**args)

  File "/usr/local/www/data/nav/index.py", line 44, in index
    if req.session.has_key('user'):

AttributeError: 'mp_request' object has no attribute 'session'


Now, I can see on line 44 in index.py there is the exact line right under the last part of the error.  Why is the AttributeError being generated?  Why is mp_request (mod_python reqest object) missing the attribute session?  What is missing from httpd.conf file or other files that is not allowing this to continue?

Thank you,

Paul Pathiakis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060929/a369bada/attachment.html
From jpg at jgassociates.ca  Fri Sep 29 12:07:43 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep 29 12:06:43 2006
Subject: [mod_python] NAV mod_python.publisher errors
In-Reply-To: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C91E@BIGMAIL.eagleinvsys.com>
References: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C91E@BIGMAIL.eagleinvsys.com>
Message-ID: <451D44CF.5010200@jgassociates.ca>

Paul J. Pathiakis wrote:
> Hi,
> 
> would someone please respond to this?  I've posted twice to this list and no one responds. 

This is the first time I've seen this question appear on the list. I 
checked the archives and it's not there either.

> I'm sorry if this is such a low level question but I'd really like to get it working.

That's not the problem. We just can't respond to things we don't see. :)

> 
> I have index.py.  It seems to be found by the browser and an attempt is made by python to render it and display it.  However, I get the following:
> 
> Mod_python error: "PythonHandler mod_python.publisher"
> 
> Traceback (most recent call last):
> 
>   File "/usr/local/lib/python2.4/site-packages/mod_python/apache.py", line 299, in HandlerDispatch
>     result = object(req)
> 
>   File "/usr/local/lib/python2.4/site-packages/mod_python/publisher.py", line 213, in handler
>     published = publish_object(req, object)
> 
>   File "/usr/local/lib/python2.4/site-packages/mod_python/publisher.py", line 412, in publish_object
>     return publish_object(req,util.apply_fs_data(object, req.form, req=req))
> 
>   File "/usr/local/lib/python2.4/site-packages/mod_python/util.py", line 439, in apply_fs_data
>     return object(**args)
> 
>   File "/usr/local/www/data/nav/index.py", line 44, in index
>     if req.session.has_key('user'):
> 
> AttributeError: 'mp_request' object has no attribute 'session'
> 
> 
> Now, I can see on line 44 in index.py there is the exact line right under the last part of the error.  Why is the AttributeError being generated?  Why is mp_request (mod_python reqest object) missing the attribute session?  What is missing from httpd.conf file or other files that is not allowing this to continue?


Without seeing nav/index.py I can only guess, but I assume req.session 
is not there for the same reason req.foobar is missing...

Typical session usage looks like this:

from mod_python util import Session

def index(req):
     sess = Session.Session(req)
     if sess.is_new():
         sess['user'] = 'blah'


     # stick the session instance into the request object
     # so it can be referenced in other function calls
     req.session = session

     _do_stuff(req)

     sess.save()

def _do_stuff(req):
     req.write(req.session['user'])


Jim
From mvanaswegen at gmail.com  Fri Sep 29 15:34:56 2006
From: mvanaswegen at gmail.com (marinus van aswegen)
Date: Fri Sep 29 15:35:01 2006
Subject: [mod_python] fedora vs ubuntu
Message-ID: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>

Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
setup is very different. before i hit the docs i thought id check to
see if anyone can give me some pointers thanks
From jpg at jgassociates.ca  Fri Sep 29 15:53:06 2006
From: jpg at jgassociates.ca (Jim Gallacher)
Date: Fri Sep 29 15:53:10 2006
Subject: [mod_python] fedora vs ubuntu
In-Reply-To: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>
References: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>
Message-ID: <451D79A2.2010608@jgassociates.ca>

Please note as Marinus pointed out to me in a private email, my earlier 
response to a similar message was exactly backwards, so this is not a 
duplicate of that previous message.

Jim

marinus van aswegen wrote:
> Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
> setup is very different. before i hit the docs i thought id check to
> see if anyone can give me some pointers thanks
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From brunson at brunson.com  Fri Sep 29 16:27:26 2006
From: brunson at brunson.com (Eric Brunson)
Date: Fri Sep 29 16:27:18 2006
Subject: [mod_python] fedora vs ubuntu
In-Reply-To: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>
References: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>
Message-ID: <451D81AE.9040503@brunson.com>

marinus van aswegen wrote:
> Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
> setup is very different. before i hit the docs i thought id check to
> see if anyone can give me some pointers thanks
>
What's to understand?  fc5 has an httpd.conf with an Include directive 
for the conf.d directory, which the Apache documentation states, 
includes all files under it.  It seems pretty straight forward to me, 
but I don't know what a debian configuration looks like. 

Since Jim is obviously familiar with the debian derivatives and I have a 
pretty decent handle on Fedora, why don't you ask something specific and 
we can attempt to answer together.




From ccbean at gmail.com  Fri Sep 29 16:56:24 2006
From: ccbean at gmail.com (Colin Bean)
Date: Fri Sep 29 16:56:28 2006
Subject: [mod_python] fedora vs ubuntu
In-Reply-To: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>
References: <ffa39deb0609291234k78417427p34c075961bf27868@mail.gmail.com>
Message-ID: <29a6ca010609291356x62d8c54fpc71f047572ddd64d@mail.gmail.com>

Hi Marinus,

If you're talking about building mod_python from source on a stock
core 5 setup, all I had to do was to install the httpd-devel package
(I use yum for package management; it's pretty straightforward) then
just find where it put apxs (/usr/sbin/apxs for me).  After that, just
./configure --with-apxs=<whatever> , building and installing worked
fine for me.

-Colin

On 9/29/06, marinus van aswegen <mvanaswegen@gmail.com> wrote:
> Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
> setup is very different. before i hit the docs i thought id check to
> see if anyone can give me some pointers thanks
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From grahamd at dscpl.com.au  Fri Sep 29 21:15:05 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Fri Sep 29 21:15:16 2006
Subject: [mod_python] Can't get it to interpret
In-Reply-To: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C90E@BIGMAIL.eagleinvsys.com>
References: <EAED38651CF6BF46A8D2BCD9D4EEAA6D76C908@BIGMAIL.eagleinvsys.com>
	<EAED38651CF6BF46A8D2BCD9D4EEAA6D76C90A@BIGMAIL.eagleinvsys.com>
	<EAED38651CF6BF46A8D2BCD9D4EEAA6D76C90E@BIGMAIL.eagleinvsys.com>
Message-ID: <f1d37388f86a0c8f74ab0bcdce1fab39@dscpl.com.au>


On 28/09/2006, at 10:41 PM, Paul J. Pathiakis wrote:

> Hi,
>
>  as I discover more about this....
>
>  there's a .htaccess file in directory which contains this:
>
>  SetHandler python-program
>  PythonHander mod_python.publisher
>  PythonDebug On
>
>  PythonHeaderParserHandler nav.web
>
>  # In a running installation, PythonPath should be set her, adding all 
> the
>  # subdirectories containing Python modules.
>
>  PythonPath "sys.path+['/usr/local/nav/apache/webroot/.']"
>
>  Could someone please explain what the above means?? I haven't worked 
> on web and/or mod_python in quite a while.? I could really use the 
> help.?

If the PythonHeaderParserHandler wasn't there, I would say that the
PythonPath directive isn't required as mod_python.publisher doesn't
require it to be set as described.

The question is, what is 'nav.web' and what does the handler in it
do? Most people wouldn't have a need to be defining a handler for
the PythonHeaderParserHandler phase. What it does will dictate
whether or not PythonPath needs to be set as indicated or whether
the comment about what to do derives from a misunderstanding as to
how mod_python works.

Graham

From grahamd at dscpl.com.au  Sat Sep 30 03:13:38 2006
From: grahamd at dscpl.com.au (Graham Dumpleton)
Date: Sat Sep 30 03:13:48 2006
Subject: [mod_python] Raising Exceptions
In-Reply-To: <e37997d0609290309i295b8154j53229ac44e0fa501@mail.gmail.com>
References: <e37997d0609290309i295b8154j53229ac44e0fa501@mail.gmail.com>
Message-ID: <2F2E0E3D-D8A5-495A-A8F8-FE4744BF9546@dscpl.com.au>

What you have uncovered is a symptom of some of the problems that
exist in the module importer in mod_python. The main thing this example
touches on is that the module importer tries to support itself the  
loading
of Python packages. This causes various problems and for that reason,
mod_python will not do that in mod_python 3.3 and will always defer to
the standard Python importer for importing of packages.

The consequences of this change and other changes in mod_python 3.3
though are that the way you are trying to structure all of your code  
in the
document tree as one big package will not necessarily work by default in
mod_python 3.3. To get it to work you will need to override module  
search
paths with the PythonPath directive and will have to be very careful not
to mix Python packages and file based modules in the top directory where
your PythonHandler directive is used.

Finally, these changes in mod_python 3.3 will mean that there will be no
automatic module reloading on Python code structured as Python
packages. Thus, you will need to restart Apache every time you make a
change to your code due to the way you use packages. Automatic
module reloading still works with file based Python modules though,
but your code isn't configured that way.

Anyway, the key problem arises from the fact that you have put the
definition of the MyError exception class in test/__init__.py. This  
combines
with problems in the module importer whereby it performs redundant  
reloads
of __init__.py files within a package. Turns out that this is a  
particular
issue I haven't noted before and thus it isn't documented in the list of
importer problems described at:

   http://www.dscpl.com.au/wiki/ModPython/Articles/ 
ModuleImportingIsBroken

That you are mixing import and apache.import_module() could still have
resulted in redundant reloads at other times though and thus similar
problems. See ISSUE 9 and 10 in that document.

Stepping through this, the first thing that happens when the request  
arrives
is that mod_python uses apache.import_module() to load your top level
handler module test.dispatcher and executes the handler in it.  
Because it
is part of a package, it first loads test/__init__.py and then the  
sub module
test/dispatcher.py to simulate true package loading. In test/ 
dispatcher.py it
uses import to get the class MyError. This comes from the test/ 
__init__.py
just loaded and already stored in sys.modules.

The next thing is that apache.import_module() is asked to import the
module test.handlers.testhandler. The apache.import_module() detects  
that
the module hasn't been loaded before and so needs to load it. The  
problem
is the importer doesn't check whether it has already loaded the  
__init__.py
files already for that directory or any parent directories of the  
package and
thus proceeds to load the test/__init__.py file (a second time) and  
then the
test/handlers/__init__.py file.

That test/__init__.py is loaded a second time is now the trigger for the
problem. This is because in reloading the file the definition of  
MyError is
replaced with a new instances loaded from the file. At this point,  
because
you imported MyError as:

   from test import MyError

the test/dispatcher.py file holds a reference to the version of  
MyError from
before the reload. Ie., not the same as that now in test/__init__.py.  
Now
when test.handlers.testhandler gets loaded, it will find the newer  
version
of MyError in test/__init__.py. When the testhandler handler raises  
MyError
it is using the new MyError whereas as the top level handler is  
expecting
to see the old MyError. Because they are different they will not  
match and
so it will get caught as an Exception instead.

How do you solve this with the current module importer? The quick answer
is to never put anything in the __init__.py files of packages being  
imported
using apache.import_module().

Graham

On 29/09/2006, at 8:09 PM, John Keyes wrote:

> Hi guys,
>
> I've included some test code (see below) for some weird
> behaviour I've noticed.
>
> I have dispatcher.py set up as a handler which dynamically
> imports another handler (testhandler.py) and then calls
> it's handler function.
>
> The handler function in testhandler throws a user defined
> exception (see __init__.py) which the dispatcher is
> explicity set up to catch (see except MyError).
>
> If I import testhandler using apache.import_module I
> get the following output:
>
>  test
>  testhandler - b4 raise
>  exception - MyError - jk
>
> Yet if I use __import__ and getattr I get the following
> output:
>
>  test
>  testhandler - b4 raise
>  myerror
>
> As you can see using import_module the incorrect except
> block is executed, but the class name of the exception
> is correct.
>
> Can anyone explain to me why this is the case?
>
> I've the code included inline but if you want to run the
> code I've attached a zip file as well.
>
> Apache     - 2.0.58
> mod_python - 3.2.8
> Python     - 2.4.3
>
> Cheers,
> -John K
>
> == test.__init__.py ==
> class MyError(Exception):
>    def __init__(self, msg):
>        self.msg = msg
>
>    def __str__(self):
>        return self.msg
>
> == test.dispatcher.py ==
> from mod_python import apache
>
> from test import MyError
>
> def handler(req):
>    req.write("\ntest")
>
>    try:
>        #test_handler = apache.import_module 
> ('test.handlers.testhandler')
>        test_handler = my_import('test.handlers.testhandler')
>        val = test_handler.handler(req)
>    except MyError, me:
>        req.write("\nmyerror")
>    except Exception, e:
>        req.write("\nexception - %s - %s" % (e.__class__.__name__, e))
>
>    return apache.OK
>
> def my_import(name):
>    mod = __import__(name)
>    components = name.split('.')
>    for comp in components[1:]:
>        mod = getattr(mod, comp)
>    return mod
>
> == test.handlers.testhandler.py ==
> from mod_python import apache
>
> from test import MyError
>
> def handler(req):
>    req.write("\ntesthandler - b4 raise")
>
>    raise MyError('jk')
>
>    req.write("\ntesthandler - af raise")
>    return apache.OK
> <import_test.zip>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
From mvanaswegen at gmail.com  Sat Sep 30 07:01:52 2006
From: mvanaswegen at gmail.com (marinus van aswegen)
Date: Sat Sep 30 07:01:56 2006
Subject: [mod_python] fedora vs ubuntu
Message-ID: <ffa39deb0609300401m570bfa50uedb527f3f3d09a90@mail.gmail.com>

Hi, i recently upgraded from ubuntu to fc5 i noticed that the config
setup is very different. before i hit the docs i thought id check to
see if anyone can give me some pointers thanks
From john.keyes at secantus.com  Sat Sep 30 18:27:58 2006
From: john.keyes at secantus.com (John Keyes)
Date: Sat Sep 30 18:28:03 2006
Subject: [mod_python] Raising Exceptions
In-Reply-To: <2F2E0E3D-D8A5-495A-A8F8-FE4744BF9546@dscpl.com.au>
References: <e37997d0609290309i295b8154j53229ac44e0fa501@mail.gmail.com>
	<2F2E0E3D-D8A5-495A-A8F8-FE4744BF9546@dscpl.com.au>
Message-ID: <e37997d0609301527l16b273e2mfd3f527eb1433977@mail.gmail.com>

Jeez Graham that's a hefty response!

I moved the exceptions to a separate module and everything
works.

I'll have to re-read the entire response again to make sure
I understand what's going on here.

Thanks for your help,
-John K

On 9/30/06, Graham Dumpleton <grahamd@dscpl.com.au> wrote:
> What you have uncovered is a symptom of some of the problems that
> exist in the module importer in mod_python. The main thing this example
> touches on is that the module importer tries to support itself the
> loading
> of Python packages. This causes various problems and for that reason,
> mod_python will not do that in mod_python 3.3 and will always defer to
> the standard Python importer for importing of packages.
>
> The consequences of this change and other changes in mod_python 3.3
> though are that the way you are trying to structure all of your code
> in the
> document tree as one big package will not necessarily work by default in
> mod_python 3.3. To get it to work you will need to override module
> search
> paths with the PythonPath directive and will have to be very careful not
> to mix Python packages and file based modules in the top directory where
> your PythonHandler directive is used.
>
> Finally, these changes in mod_python 3.3 will mean that there will be no
> automatic module reloading on Python code structured as Python
> packages. Thus, you will need to restart Apache every time you make a
> change to your code due to the way you use packages. Automatic
> module reloading still works with file based Python modules though,
> but your code isn't configured that way.
>
> Anyway, the key problem arises from the fact that you have put the
> definition of the MyError exception class in test/__init__.py. This
> combines
> with problems in the module importer whereby it performs redundant
> reloads
> of __init__.py files within a package. Turns out that this is a
> particular
> issue I haven't noted before and thus it isn't documented in the list of
> importer problems described at:
>
>    http://www.dscpl.com.au/wiki/ModPython/Articles/
> ModuleImportingIsBroken
>
> That you are mixing import and apache.import_module() could still have
> resulted in redundant reloads at other times though and thus similar
> problems. See ISSUE 9 and 10 in that document.
>
> Stepping through this, the first thing that happens when the request
> arrives
> is that mod_python uses apache.import_module() to load your top level
> handler module test.dispatcher and executes the handler in it.
> Because it
> is part of a package, it first loads test/__init__.py and then the
> sub module
> test/dispatcher.py to simulate true package loading. In test/
> dispatcher.py it
> uses import to get the class MyError. This comes from the test/
> __init__.py
> just loaded and already stored in sys.modules.
>
> The next thing is that apache.import_module() is asked to import the
> module test.handlers.testhandler. The apache.import_module() detects
> that
> the module hasn't been loaded before and so needs to load it. The
> problem
> is the importer doesn't check whether it has already loaded the
> __init__.py
> files already for that directory or any parent directories of the
> package and
> thus proceeds to load the test/__init__.py file (a second time) and
> then the
> test/handlers/__init__.py file.
>
> That test/__init__.py is loaded a second time is now the trigger for the
> problem. This is because in reloading the file the definition of
> MyError is
> replaced with a new instances loaded from the file. At this point,
> because
> you imported MyError as:
>
>    from test import MyError
>
> the test/dispatcher.py file holds a reference to the version of
> MyError from
> before the reload. Ie., not the same as that now in test/__init__.py.
> Now
> when test.handlers.testhandler gets loaded, it will find the newer
> version
> of MyError in test/__init__.py. When the testhandler handler raises
> MyError
> it is using the new MyError whereas as the top level handler is
> expecting
> to see the old MyError. Because they are different they will not
> match and
> so it will get caught as an Exception instead.
>
> How do you solve this with the current module importer? The quick answer
> is to never put anything in the __init__.py files of packages being
> imported
> using apache.import_module().
>
> Graham
>
> On 29/09/2006, at 8:09 PM, John Keyes wrote:
>
> > Hi guys,
> >
> > I've included some test code (see below) for some weird
> > behaviour I've noticed.
> >
> > I have dispatcher.py set up as a handler which dynamically
> > imports another handler (testhandler.py) and then calls
> > it's handler function.
> >
> > The handler function in testhandler throws a user defined
> > exception (see __init__.py) which the dispatcher is
> > explicity set up to catch (see except MyError).
> >
> > If I import testhandler using apache.import_module I
> > get the following output:
> >
> >  test
> >  testhandler - b4 raise
> >  exception - MyError - jk
> >
> > Yet if I use __import__ and getattr I get the following
> > output:
> >
> >  test
> >  testhandler - b4 raise
> >  myerror
> >
> > As you can see using import_module the incorrect except
> > block is executed, but the class name of the exception
> > is correct.
> >
> > Can anyone explain to me why this is the case?
> >
> > I've the code included inline but if you want to run the
> > code I've attached a zip file as well.
> >
> > Apache     - 2.0.58
> > mod_python - 3.2.8
> > Python     - 2.4.3
> >
> > Cheers,
> > -John K
> >
> > == test.__init__.py ==
> > class MyError(Exception):
> >    def __init__(self, msg):
> >        self.msg = msg
> >
> >    def __str__(self):
> >        return self.msg
> >
> > == test.dispatcher.py ==
> > from mod_python import apache
> >
> > from test import MyError
> >
> > def handler(req):
> >    req.write("\ntest")
> >
> >    try:
> >        #test_handler = apache.import_module
> > ('test.handlers.testhandler')
> >        test_handler = my_import('test.handlers.testhandler')
> >        val = test_handler.handler(req)
> >    except MyError, me:
> >        req.write("\nmyerror")
> >    except Exception, e:
> >        req.write("\nexception - %s - %s" % (e.__class__.__name__, e))
> >
> >    return apache.OK
> >
> > def my_import(name):
> >    mod = __import__(name)
> >    components = name.split('.')
> >    for comp in components[1:]:
> >        mod = getattr(mod, comp)
> >    return mod
> >
> > == test.handlers.testhandler.py ==
> > from mod_python import apache
> >
> > from test import MyError
> >
> > def handler(req):
> >    req.write("\ntesthandler - b4 raise")
> >
> >    raise MyError('jk')
> >
> >    req.write("\ntesthandler - af raise")
> >    return apache.OK
> > <import_test.zip>
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
>
