<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
This&nbsp;is&nbsp;a&nbsp;bit&nbsp;to&nbsp;digest,&nbsp;thanks&nbsp;for&nbsp;being&nbsp;so&nbsp;thorough.&nbsp;In&nbsp;comment&nbsp;to<br>
your&nbsp;mentioned&nbsp;article,&nbsp;I&nbsp;could&nbsp;not&nbsp;rectify&nbsp;if&nbsp;the&nbsp;named&nbsp;args&nbsp;(host,<br>
sortBy,&nbsp;etc..)&nbsp;would&nbsp;be&nbsp;always&nbsp;required&nbsp;when&nbsp;passed&nbsp;to&nbsp;the&nbsp;__call__<br>
function.&nbsp;Or&nbsp;is&nbsp;that&nbsp;just&nbsp;when&nbsp;you&nbsp;are&nbsp;dealing&nbsp;with&nbsp;a&nbsp;standalone&nbsp;method<br>
in&nbsp;your&nbsp;example?&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;took&nbsp;to&nbsp;heart&nbsp;your&nbsp;suggestions&nbsp;and&nbsp;see&nbsp;how&nbsp;further&nbsp;that&nbsp;gets&nbsp;me.&lt;br&gt;<br>
&lt;br&gt;<br>
Graham&nbsp;Dumpleton&nbsp;wrote:<br>
&lt;blockquote&nbsp;cite=&quot;mid1163024460.25645@dscpl.user.openhosting.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;For&nbsp;starters,&nbsp;you&nbsp;are&nbsp;mixing&nbsp;up&nbsp;mod_python&nbsp;basic&nbsp;handlers&nbsp;and<br>
mod_python.publisher&nbsp;published&nbsp;functions.&nbsp;They&nbsp;are&nbsp;not&nbsp;the&nbsp;same<br>
thing.&nbsp;See&nbsp;my&nbsp;recent&nbsp;comment&nbsp;on&nbsp;mailing&nbsp;list&nbsp;about&nbsp;this:<br>
<br>
&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.modpython.org/pipermail/mod_python/2006-November/022529.html&quot;&gt;http://www.modpython.org/pipermail/mod_python/2006-November/022529.html&lt;/a&gt;<br>
<br>
BTW,&nbsp;which&nbsp;version&nbsp;of&nbsp;mod_python&nbsp;are&nbsp;you&nbsp;using?<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
Apache&nbsp;2.2.3/mod_python&nbsp;3.2.10/Python&nbsp;2.5&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;mid1163024460.25645@dscpl.user.openhosting.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;<br>
A&nbsp;few&nbsp;more&nbsp;things&nbsp;pointed&nbsp;out&nbsp;below.<br>
<br>
Martin&nbsp;Stoufer&nbsp;wrote&nbsp;..<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;I&nbsp;am&nbsp;moving&nbsp;a&nbsp;set&nbsp;of&nbsp;python&nbsp;classes&nbsp;out&nbsp;of&nbsp;the&nbsp;Apache&nbsp;CGI&nbsp;model&nbsp;and&nbsp;into<br>
mod_python.&nbsp;There&nbsp;is&nbsp;both&nbsp;inheritance&nbsp;and&nbsp;composition&nbsp;going&nbsp;on&nbsp;among&nbsp;<br>
these&nbsp;classes.&nbsp;A&nbsp;few&nbsp;factory&nbsp;classes&nbsp;as&nbsp;well.&nbsp;It&nbsp;seems&nbsp;that&nbsp;when&nbsp;it&nbsp;<br>
comes&nbsp;time&nbsp;to&nbsp;pull&nbsp;the&nbsp;generated&nbsp;content&nbsp;from&nbsp;the&nbsp;hierarchy&nbsp;of&nbsp;classes,<br>
the&nbsp;string&nbsp;object&nbsp;returned&nbsp;to&nbsp;the&nbsp;initial&nbsp;class&nbsp;end&nbsp;up&nbsp;'None'.<br>
<br>
I&nbsp;have&nbsp;stripped&nbsp;down&nbsp;my&nbsp;work&nbsp;as&nbsp;an&nbsp;example.&nbsp;If&nbsp;there&nbsp;is&nbsp;some&nbsp;larger&nbsp;<br>
example&nbsp;of&nbsp;how&nbsp;this&nbsp;class&nbsp;structure&nbsp;should&nbsp;work,&nbsp;I&nbsp;would&nbsp;love&nbsp;to&nbsp;see&nbsp;it.<br>
<br>
from&nbsp;mod_python&nbsp;import&nbsp;apache<br>
<br>
class&nbsp;Dom:<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__call__(self,&nbsp;req):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;DomProdLibOutput&nbsp;import&nbsp;Html<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.form&nbsp;=&nbsp;req.form<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.output&nbsp;=&nbsp;Html('modPython')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.host&nbsp;=&nbsp;self.form['host'].value<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sortBy&nbsp;=&nbsp;self.form['sortby'].value<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.mode&nbsp;=&nbsp;self.form['mode'].value<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.form.has_key('term'):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.term=self.form['term'].value<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.term&nbsp;=&nbsp;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.content_type&nbsp;=&nbsp;&quot;text/html&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.send_http_header()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Only&nbsp;need&nbsp;to&nbsp;call&nbsp;req.send_http_header()&nbsp;if&nbsp;using&nbsp;mod_python&nbsp;2.7.X.<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;self.generate()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.write(result)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;apache.OK<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
You&nbsp;shouldn't&nbsp;be&nbsp;returning&nbsp;an&nbsp;Apache&nbsp;status&nbsp;code&nbsp;like&nbsp;this&nbsp;when&nbsp;using<br>
publisher.&nbsp;Status&nbsp;codes&nbsp;are&nbsp;for&nbsp;mod_python&nbsp;basic&nbsp;handlers,&nbsp;not&nbsp;publisher.<br>
Publisher&nbsp;needs&nbsp;to&nbsp;return&nbsp;the&nbsp;content,&nbsp;or&nbsp;if&nbsp;you&nbsp;have&nbsp;used&nbsp;req.write()<br>
it&nbsp;should&nbsp;return&nbsp;None&nbsp;(if&nbsp;mod_python&nbsp;3.2&nbsp;or&nbsp;later),&nbsp;or&nbsp;a&nbsp;string&nbsp;consisting<br>
of&nbsp;a&nbsp;singe&nbsp;space&nbsp;(prior&nbsp;to&nbsp;mod_python&nbsp;3.2,&nbsp;to&nbsp;get&nbsp;around&nbsp;bug).<br>
<br>
Also,&nbsp;because&nbsp;publisher&nbsp;will&nbsp;automatically&nbsp;detect&nbsp;and&nbsp;set&nbsp;content&nbsp;type<br>
to&nbsp;'text/html'&nbsp;when&nbsp;appropriate&nbsp;if&nbsp;returning&nbsp;the&nbsp;content,&nbsp;you&nbsp;don't&nbsp;need&nbsp;to<br>
set&nbsp;it&nbsp;yourself.&nbsp;Thus&nbsp;you&nbsp;can&nbsp;just&nbsp;have:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self.generate()<br>
<br>
and&nbsp;not&nbsp;worry&nbsp;about&nbsp;setting&nbsp;content,&nbsp;flush&nbsp;headers&nbsp;or&nbsp;explicitly<br>
writing&nbsp;back&nbsp;content.<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;generate(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;self.output.generate()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br>
<br>
dom&nbsp;=&nbsp;Dom()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Although&nbsp;you&nbsp;have&nbsp;specified&nbsp;a&nbsp;__call__()&nbsp;method&nbsp;so&nbsp;URL&nbsp;can&nbsp;just&nbsp;be&nbsp;'/.../dom',<br>
you&nbsp;are&nbsp;also&nbsp;exposing&nbsp;all&nbsp;the&nbsp;member&nbsp;data&nbsp;and&nbsp;member&nbsp;functions&nbsp;of&nbsp;your<br>
object&nbsp;as&nbsp;well&nbsp;and&nbsp;they&nbsp;can&nbsp;be&nbsp;access&nbsp;directly,&nbsp;which&nbsp;is&nbsp;really&nbsp;bad&nbsp;for&nbsp;this<br>
example.&nbsp;To&nbsp;hide&nbsp;member&nbsp;functions&nbsp;and&nbsp;data&nbsp;you&nbsp;don't&nbsp;want&nbsp;automatically<br>
accessible&nbsp;via&nbsp;a&nbsp;URL&nbsp;request,&nbsp;precede&nbsp;them&nbsp;with&nbsp;an&nbsp;underscore.&nbsp;Ie.,&nbsp;use<br>
_generate()&nbsp;not&nbsp;generate()&nbsp;and&nbsp;store&nbsp;data&nbsp;like&nbsp;self._form&nbsp;and&nbsp;not&nbsp;self.form.<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;In&nbsp;the&nbsp;DomProdLibOutput&nbsp;file&nbsp;in&nbsp;the&nbsp;same&nbsp;dir:<br>
<br>
class&nbsp;Html:<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;destination='screen'):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.output&nbsp;=&nbsp;HtmlOutputFactory(destination).getOutput()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;generate(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#result&nbsp;=&nbsp;&quot;Foo&nbsp;in&nbsp;Html&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;self.output.generate()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;result<br>
<br>
class&nbsp;HtmlModPython:<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.content&nbsp;=&nbsp;&quot;&quot;&quot;Empty&nbsp;content&nbsp;in&nbsp;HtmlModPython&quot;&quot;&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;update(self,&nbsp;content):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.content&nbsp;+=&nbsp;content<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;generate(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&quot;Foo&nbsp;in&nbsp;HtmlModPython&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#return&nbsp;self.content<br>
<br>
class&nbsp;HtmlOutputFactory:<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;__init__(self,&nbsp;destination):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.dest&nbsp;=&nbsp;destination<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;def&nbsp;getOutput(self):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self.dest&nbsp;==&nbsp;'screen':&nbsp;return&nbsp;HtmlScreen()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.dest&nbsp;==&nbsp;'modPython':&nbsp;return&nbsp;HtmlModPython()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elif&nbsp;self.dest&nbsp;==&nbsp;'file':&nbsp;return&nbsp;HtmlFile()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raise&nbsp;InvalidHtmlOutputDest,&nbsp;\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;supported&nbsp;output&quot;&nbsp;%&nbsp;self.dest<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
<br>
As&nbsp;an&nbsp;interesting&nbsp;side&nbsp;note,&nbsp;if&nbsp;I&nbsp;have&nbsp;the&nbsp;generate()&nbsp;in&nbsp;Html&nbsp;return&nbsp;<br>
just&nbsp;the&nbsp;string,&nbsp;things&nbsp;work&nbsp;fine.&nbsp;Its&nbsp;when&nbsp;I&nbsp;try&nbsp;and&nbsp;resolve&nbsp;the&nbsp;string<br>
stored&nbsp;by&nbsp;the&nbsp;HtmlModPython&nbsp;class&nbsp;instance&nbsp;that&nbsp;the&nbsp;resulting&nbsp;string&nbsp;<br>
comes&nbsp;back&nbsp;'None'&nbsp;irregardless&nbsp;of&nbsp;what&nbsp;the&nbsp;deepest&nbsp;generate()&nbsp;returns.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
Lost&nbsp;me&nbsp;there.&nbsp;I&nbsp;would&nbsp;very&nbsp;much&nbsp;suggest&nbsp;to&nbsp;track&nbsp;through&nbsp;what&nbsp;is<br>
happening&nbsp;that&nbsp;you&nbsp;use&nbsp;req.log_error()&nbsp;to&nbsp;log&nbsp;progress&nbsp;messages&nbsp;to<br>
the&nbsp;Apache&nbsp;error&nbsp;log&nbsp;file.<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Do&nbsp;all&nbsp;these&nbsp;classes&nbsp;have&nbsp;to&nbsp;define&nbsp;__call__&nbsp;as&nbsp;well?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
The&nbsp;__call__()&nbsp;method&nbsp;is&nbsp;only&nbsp;required&nbsp;for&nbsp;the&nbsp;Dom&nbsp;instance&nbsp;if&nbsp;you&nbsp;want<br>
URL&nbsp;to&nbsp;use&nbsp;the&nbsp;instance&nbsp;variable&nbsp;name&nbsp;only.<br>
<br>
Graham<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
*&nbsp;Martin&nbsp;C.&nbsp;Stoufer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*&nbsp;DIDC/DSD/ITG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
*&nbsp;Lawrence&nbsp;Berkeley&nbsp;National&nbsp;Lab&nbsp;*<br>
*&nbsp;MS&nbsp;50B-2215&nbsp;510-486-8662&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
&lt;/pre&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
