<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.0.4630.0&quot;&gt;<br>
&lt;TITLE&gt;Bug&nbsp;in&nbsp;BaseSession.py&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/rtf&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;I&nbsp;posted&nbsp;a&nbsp;similar&nbsp;question&nbsp;about&nbsp;this&nbsp;a&nbsp;while&nbsp;ago&nbsp;but&nbsp;got&nbsp;no&nbsp;reply,&nbsp;so&nbsp;I've&nbsp;done&nbsp;some&nbsp;more&nbsp;investigation:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;In&nbsp;Session.py,&nbsp;the&nbsp;BaseSession&nbsp;class&nbsp;takes&nbsp;an&nbsp;optional&nbsp;secret&nbsp;parameter.&nbsp;However,&nbsp;when&nbsp;the&nbsp;cookie&nbsp;is&nbsp;created&nbsp;it's&nbsp;type&nbsp;is&nbsp;not&nbsp;checked&nbsp;to&nbsp;ensure&nbsp;it&nbsp;is&nbsp;of&nbsp;type&nbsp;&amp;quot;SignedCookie&amp;quot;&nbsp;instead&nbsp;of&nbsp;just&nbsp;&amp;quot;Cookie&amp;quot;.&nbsp;The&nbsp;documentation&nbsp;(&lt;/FONT&gt;&lt;A&nbsp;HREF=&quot;http://www.modpython.org/live/current/doc-html/pyapi-cookie-classes.html&quot;&gt;&lt;U&gt;&lt;FONT&nbsp;COLOR=&quot;#0000FF&quot;&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;http://www.modpython.org/live/current/doc-html/pyapi-cookie-classes.html&lt;/FONT&gt;&lt;/U&gt;&lt;/A&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;)&nbsp;says&nbsp;you&nbsp;must&nbsp;do&nbsp;this&nbsp;otherwise&nbsp;the&nbsp;secret&nbsp;parameter&nbsp;is&nbsp;essentially&nbsp;irrelevant.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;(I&nbsp;can't&nbsp;write&nbsp;my&nbsp;own&nbsp;subclass&nbsp;to&nbsp;fix&nbsp;this&nbsp;because&nbsp;the&nbsp;cookies&nbsp;variable&nbsp;is&nbsp;local&nbsp;and&nbsp;unavailable&nbsp;to&nbsp;subclasses)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;I'd&nbsp;suggest&nbsp;having&nbsp;an&nbsp;extra&nbsp;couple&nbsp;of&nbsp;lines&nbsp;at&nbsp;line&nbsp;117&nbsp;of&nbsp;Session.py&nbsp;saying&nbsp;something&nbsp;like:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;if&nbsp;secret&nbsp;and&nbsp;(type(cookies[COOKIE_NAME])&nbsp;is&nbsp;not&nbsp;Cookie.SignedCookie):&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;raise&nbsp;Exception(&amp;quot;Tampered&nbsp;Cookie&amp;quot;)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Or&nbsp;perhaps&nbsp;instead&nbsp;of&nbsp;raising&nbsp;an&nbsp;exception&nbsp;we&nbsp;should&nbsp;just&nbsp;not&nbsp;set&nbsp;self._sid&nbsp;which&nbsp;will&nbsp;mean&nbsp;the&nbsp;existing&nbsp;cookie&nbsp;will&nbsp;be&nbsp;ignored:&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;if&nbsp;cookies.has_key(COOKIE_NAME):&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;if&nbsp;secret&nbsp;and&nbsp;(type(cookies[COOKIE_NAME])&nbsp;is&nbsp;not&nbsp;Cookie.SignedCookie):&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;pass&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;else:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;self._sid&nbsp;=&nbsp;cookies[COOKIE_NAME].value&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Any&nbsp;comments?&nbsp;I&nbsp;need&nbsp;this&nbsp;fixing&nbsp;for&nbsp;the&nbsp;project&nbsp;I'm&nbsp;writing&nbsp;-&nbsp;if&nbsp;there&nbsp;are&nbsp;no&nbsp;better&nbsp;suggestions,&nbsp;how&nbsp;do&nbsp;I&nbsp;get&nbsp;this&nbsp;patched?&nbsp;I&nbsp;think&nbsp;the&nbsp;second&nbsp;solution&nbsp;is&nbsp;better&nbsp;(but&nbsp;only&nbsp;because&nbsp;it's&nbsp;more&nbsp;convenient&nbsp;for&nbsp;my&nbsp;particular&nbsp;project&nbsp;;-)&nbsp;so&nbsp;perhaps&nbsp;someone&nbsp;can&nbsp;think&nbsp;of&nbsp;a&nbsp;more&nbsp;generic&nbsp;solution?&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Thanks,&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Brian&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
