<tt>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7638.1&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[mod_python]&nbsp;mod_python&nbsp;or&nbsp;apache&nbsp;scalability?&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;DIV&nbsp;id=idOWAReplyText92895&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;color=#000000&nbsp;size=2&gt;Hmm&nbsp;it&nbsp;looks&nbsp;to&nbsp;me&nbsp;that&nbsp;you&nbsp;<br>
have&nbsp;an&nbsp;upload&nbsp;limit&nbsp;in&nbsp;your&nbsp;apache&nbsp;config.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;It&nbsp;might&nbsp;be&nbsp;the&nbsp;LimitRequestBody&nbsp;<br>
directive.&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;Another&nbsp;thing&nbsp;might&nbsp;be&nbsp;that&nbsp;your&nbsp;processing&nbsp;<br>
is&nbsp;faster&nbsp;than&nbsp;the&nbsp;data&nbsp;comes&nbsp;in,&nbsp;but&nbsp;I&nbsp;doubt&nbsp;that&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;Take&nbsp;a&nbsp;close&nbsp;look&nbsp;at&nbsp;you&nbsp;apache&nbsp;conf,&nbsp;and&nbsp;<br>
your&nbsp;apache&nbsp;error&nbsp;log&nbsp;(right&nbsp;after&nbsp;an&nbsp;upload&nbsp;or&nbsp;with&nbsp;tail&nbsp;-f&nbsp;<br>
/var/log/httpd/error_log&nbsp;(or&nbsp;where&nbsp;ever&nbsp;your&nbsp;logdir&nbsp;is)).&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;Martijn&lt;/FONT&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;FONT&nbsp;face=Arial&nbsp;size=2&gt;&lt;/FONT&gt;&amp;nbsp;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;&lt;BR&gt;<br>
&lt;HR&nbsp;tabIndex=-1&gt;<br>
&lt;FONT&nbsp;face=Tahoma&nbsp;size=2&gt;&lt;B&gt;Van:&lt;/B&gt;&nbsp;Alec&nbsp;Matusis&nbsp;<br>
[mailto:matusis@matusis.com]&lt;BR&gt;&lt;B&gt;Verzonden:&lt;/B&gt;&nbsp;zo&nbsp;04.11.2007&nbsp;<br>
21:46&lt;BR&gt;&lt;B&gt;Aan:&lt;/B&gt;&nbsp;Martijn&nbsp;Moeling&lt;BR&gt;&lt;B&gt;CC:&lt;/B&gt;&nbsp;<br>
mod_python@modpython.org&lt;BR&gt;&lt;B&gt;Onderwerp:&lt;/B&gt;&nbsp;RE:&nbsp;[mod_python]&nbsp;mod_python&nbsp;or&nbsp;<br>
apache&nbsp;scalability?&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;P&gt;&lt;FONT&nbsp;size=2&gt;&amp;gt;&nbsp;I&nbsp;had&nbsp;similair&nbsp;problems&nbsp;however,&nbsp;they&nbsp;turned&nbsp;out&nbsp;to&nbsp;be&nbsp;<br>
MySQLdb&lt;BR&gt;&amp;gt;&nbsp;related&nbsp;and&nbsp;not&nbsp;in&nbsp;a&nbsp;way&nbsp;you&nbsp;suspect&lt;BR&gt;&lt;BR&gt;Thanks!&nbsp;I&nbsp;will&nbsp;try&nbsp;<br>
separating&nbsp;MySQLdb&nbsp;connections.&nbsp;We&nbsp;do&nbsp;pass&nbsp;the&nbsp;connection&lt;BR&gt;around&nbsp;<br>
currently.&lt;BR&gt;&lt;BR&gt;However,&nbsp;how&nbsp;would&nbsp;you&nbsp;explain&nbsp;this&nbsp;PIL&nbsp;<br>
error:&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;File&nbsp;&quot;/path/publisher/publisher.py&quot;,&nbsp;line&nbsp;78,&nbsp;<br>
in&nbsp;handler&lt;BR&gt;&amp;nbsp;flow_instance.dispatch()&lt;BR&gt;&amp;nbsp;File&nbsp;<br>
&quot;/path/scripts/updateprofile.py&quot;,&nbsp;line&nbsp;92,&nbsp;in&nbsp;dispatch&lt;BR&gt;&amp;nbsp;im.save(full,&nbsp;<br>
self.im_format)&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
File&lt;BR&gt;&quot;/usr/local/encap/Python-2.4.1/lib/python2.4/site-packages/PIL/Image.py&quot;,&lt;BR&gt;line&nbsp;<br>
1272,&nbsp;in&nbsp;<br>
save&lt;BR&gt;&lt;BR&gt;&amp;nbsp;File&lt;BR&gt;&quot;/usr/local/encap/Python-2.4.1/lib/python2.4/site-packages/PIL/ImageFile.py&quot;&lt;BR&gt;,&nbsp;<br>
line&nbsp;192,&nbsp;in&nbsp;load&lt;BR&gt;&amp;nbsp;IOError:&nbsp;image&nbsp;file&nbsp;is&nbsp;truncated&nbsp;(14432&nbsp;bytes&nbsp;not&nbsp;<br>
processed)&lt;BR&gt;&lt;BR&gt;This&nbsp;only&nbsp;happened&nbsp;for&nbsp;large&nbsp;images,&nbsp;small&nbsp;ones&nbsp;uploaded&nbsp;<br>
fine.&lt;BR&gt;The&nbsp;code&nbsp;is&lt;BR&gt;&lt;BR&gt;def&nbsp;dispatch(self):&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;pix&nbsp;=&nbsp;<br>
self.form['Filedata']&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
try:&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;im&nbsp;=&nbsp;<br>
Image.open(pix.file)&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;except&nbsp;<br>
IOError:&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.req.status&nbsp;=&nbsp;<br>
apache.HTTP_NOT_ACCEPTABLE&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;im.save(full,&nbsp;<br>
self.im_format)&lt;BR&gt;&lt;BR&gt;The&nbsp;error&nbsp;is&nbsp;in&nbsp;the&nbsp;last&nbsp;line.&nbsp;It&nbsp;did&nbsp;not&nbsp;occur&nbsp;with&nbsp;<br>
prefork.&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&amp;gt;&nbsp;-----Original&nbsp;<br>
Message-----&lt;BR&gt;&amp;gt;&nbsp;From:&nbsp;mod_python-bounces@modpython.org&nbsp;[&lt;A&nbsp;<br>
href=&quot;mailto:mod_python-&quot;&gt;mailto:mod_python-&lt;/A&gt;&lt;BR&gt;&amp;gt;&nbsp;bounces@modpython.org]&nbsp;<br>
On&nbsp;Behalf&nbsp;Of&nbsp;Martijn&nbsp;Moeling&lt;BR&gt;&amp;gt;&nbsp;Sent:&nbsp;Sunday,&nbsp;November&nbsp;04,&nbsp;2007&nbsp;5:16&nbsp;<br>
AM&lt;BR&gt;&amp;gt;&nbsp;To:&nbsp;Graham&nbsp;Dumpleton&lt;BR&gt;&amp;gt;&nbsp;Cc:&nbsp;mod_python@modpython.org;&nbsp;Alec&nbsp;<br>
Matusis&lt;BR&gt;&amp;gt;&nbsp;Subject:&nbsp;Re:&nbsp;[mod_python]&nbsp;mod_python&nbsp;or&nbsp;apache&nbsp;<br>
scalability?&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;hi,&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;I&nbsp;use&nbsp;Pil&nbsp;without&nbsp;any&nbsp;problems,&nbsp;<br>
a&nbsp;I&nbsp;do&nbsp;with&nbsp;MySQLdb.&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;I&nbsp;had&nbsp;similair&nbsp;problems&nbsp;however,&nbsp;they&nbsp;<br>
turned&nbsp;out&nbsp;to&nbsp;be&nbsp;MySQLdb&lt;BR&gt;&amp;gt;&nbsp;related&nbsp;and&nbsp;not&nbsp;in&nbsp;a&nbsp;way&nbsp;you&nbsp;<br>
suspect&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;Never&nbsp;ever&nbsp;use&nbsp;a&nbsp;global&nbsp;database&nbsp;connection&nbsp;variable.&nbsp;<br>
Create&nbsp;the&lt;BR&gt;&amp;gt;&nbsp;database&nbsp;connection&nbsp;within&nbsp;your&nbsp;handler,&lt;BR&gt;&amp;gt;&nbsp;end&nbsp;register&nbsp;<br>
a&nbsp;cleanup&nbsp;for&nbsp;closing&nbsp;it.&nbsp;I&nbsp;fixed&nbsp;a&nbsp;lot&nbsp;of&nbsp;trouble&nbsp;by&lt;BR&gt;&amp;gt;&nbsp;altering&nbsp;my&nbsp;system&nbsp;<br>
by&nbsp;making&nbsp;all&nbsp;&quot;global&quot;&nbsp;stuff&nbsp;a&nbsp;method&nbsp;or&nbsp;property&lt;BR&gt;&amp;gt;&nbsp;of&nbsp;the&nbsp;req&nbsp;<br>
object.&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;The&nbsp;cleanup&nbsp;procedure&nbsp;cleans&nbsp;all&nbsp;objects&nbsp;which&nbsp;do&nbsp;<br>
anything&nbsp;to&nbsp;3rd&lt;BR&gt;&amp;gt;&nbsp;party&nbsp;external&nbsp;(net&nbsp;connected)&nbsp;stuff&nbsp;(like&nbsp;imap,&nbsp;<br>
MySQL)&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;think&nbsp;of&nbsp;something&nbsp;like&nbsp;<br>
this:&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;def&nbsp;handler_cleanup(req):&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.db.cursor.close()&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.db.close()&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;Def&nbsp;handler&nbsp;<br>
(req):&lt;BR&gt;&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
req.db=MySQLdb.connection(...........)&lt;BR&gt;&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
req.cursor=req.db.cursor(...)&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
....&lt;BR&gt;&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;....&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;....&lt;BR&gt;&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
req.register_cleanup(handler_cleanup,req)&lt;BR&gt;&amp;gt;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;<br>
return&nbsp;apache.OK&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;All&nbsp;my&nbsp;application&nbsp;specific&nbsp;code&nbsp;are&nbsp;classes,&nbsp;<br>
and&nbsp;instantated&nbsp;as&nbsp;a&lt;BR&gt;&amp;gt;&nbsp;req.something&nbsp;and&nbsp;req&nbsp;is&nbsp;passed&nbsp;to&nbsp;all&nbsp;functions,&nbsp;<br>
which&nbsp;is&nbsp;neat&nbsp;since&lt;BR&gt;&amp;gt;&nbsp;it&nbsp;is&nbsp;passed&nbsp;by&nbsp;reference&nbsp;meaning&nbsp;stacks&nbsp;stay&nbsp;small&nbsp;<br>
to&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;If&nbsp;you&nbsp;use&nbsp;MySQLdb&nbsp;with&nbsp;mod_python&nbsp;use&nbsp;the&nbsp;above&nbsp;method,&nbsp;<br>
my&lt;BR&gt;&amp;gt;&nbsp;production&nbsp;server&nbsp;is&nbsp;rock&nbsp;stable&nbsp;and&nbsp;handled&nbsp;over&nbsp;1mln&nbsp;requests&nbsp;<br>
since&lt;BR&gt;&amp;gt;&nbsp;last&nbsp;december&nbsp;without&nbsp;any&nbsp;reboots&nbsp;or&nbsp;problems.&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
Martijn&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;On&nbsp;Nov&nbsp;4,&nbsp;2007,&nbsp;at&nbsp;11:48&nbsp;AM,&nbsp;Graham&nbsp;Dumpleton&nbsp;<br>
wrote:&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Hmmm,&nbsp;I&nbsp;do&nbsp;remember&nbsp;vaguely&nbsp;hearing&nbsp;questions&nbsp;about&nbsp;<br>
PIL&nbsp;thread&nbsp;safety&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;before,&nbsp;so&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;issue.&nbsp;:-(&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Graham&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;On&nbsp;04/11/2007,&nbsp;Alec&nbsp;Matusis&nbsp;<br>
&amp;lt;matusis@matusis.com&amp;gt;&nbsp;wrote:&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;BTW,&nbsp;are&nbsp;you&nbsp;still&nbsp;using&nbsp;<br>
mod_python&nbsp;3.1.4?&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;No,&nbsp;we&nbsp;went&nbsp;to&nbsp;apache&nbsp;2.2.6/&nbsp;<br>
mod_python&nbsp;3.3.1&nbsp;combination.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;I&nbsp;will&nbsp;get&nbsp;<br>
MySQLdb&nbsp;to&nbsp;work&nbsp;thread-safely,&nbsp;but&nbsp;with&nbsp;PIL&nbsp;I&nbsp;am&nbsp;not&nbsp;so&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;<br>
optimistic...&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;-----Original&nbsp;<br>
Message-----&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;From:&nbsp;Graham&nbsp;Dumpleton&nbsp;[&lt;A&nbsp;<br>
href=&quot;mailto:graham.dumpleton@gmail.com&quot;&gt;mailto:graham.dumpleton@gmail.com&lt;/A&gt;]&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;Sent:&nbsp;Sunday,&nbsp;November&nbsp;04,&nbsp;2007&nbsp;2:33&nbsp;AM&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;To:&nbsp;<br>
Alec&nbsp;Matusis&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;Cc:&nbsp;mod_python@modpython.org&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;Subject:&nbsp;Re:&nbsp;[mod_python]&nbsp;mod_python&nbsp;or&nbsp;apache&nbsp;scalability?&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;BTW,&nbsp;are&nbsp;you&nbsp;still&nbsp;using&nbsp;mod_python&nbsp;3.1.4?&nbsp;<br>
Older&nbsp;mod_python&lt;BR&gt;&amp;gt;&nbsp;versions&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;have&nbsp;various&nbsp;bugs&nbsp;and&nbsp;you&nbsp;<br>
would&nbsp;be&nbsp;much&nbsp;better&nbsp;upgrading&nbsp;to&nbsp;3.3.1&lt;BR&gt;&amp;gt;&nbsp;if&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;you&nbsp;<br>
haven't&nbsp;already.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;Graham&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;04/11/2007,&nbsp;Alec&nbsp;Matusis&nbsp;<br>
&amp;lt;matusis@matusis.com&amp;gt;&nbsp;wrote:&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Which&nbsp;indicates&nbsp;<br>
that&nbsp;some&nbsp;third&nbsp;party&nbsp;package&nbsp;you&nbsp;are&nbsp;using&nbsp;is&lt;BR&gt;&amp;gt;&nbsp;not&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;thread&nbsp;safe.&nbsp;This&nbsp;can&nbsp;occur&nbsp;if&nbsp;you&nbsp;are&nbsp;also&nbsp;using&nbsp;PHP&nbsp;<br>
as&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;various&nbsp;of&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;its&nbsp;<br>
third&nbsp;party&nbsp;packages&nbsp;are&nbsp;not&nbsp;thread&nbsp;safe.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;We&nbsp;are&nbsp;not&nbsp;using&nbsp;PHP,&nbsp;only&nbsp;python&nbsp;with&nbsp;mod_python.&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;The&nbsp;only&nbsp;third&nbsp;party&nbsp;packages&nbsp;we&nbsp;use&nbsp;are&nbsp;MySQLdb&nbsp;adapter&nbsp;and&nbsp;<br>
PIL&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;image&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;library.&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;So&nbsp;I&nbsp;guess&nbsp;both&nbsp;PIL&nbsp;and&nbsp;MySQLdb&nbsp;have&nbsp;<br>
these&nbsp;problems.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;-----Original&nbsp;Message-----&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
From:&nbsp;Graham&nbsp;Dumpleton&nbsp;[&lt;A&nbsp;<br>
href=&quot;mailto:graham.dumpleton@gmail.com&quot;&gt;mailto:graham.dumpleton@gmail.com&lt;/A&gt;]&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Sent:&nbsp;Sunday,&nbsp;November&nbsp;04,&nbsp;2007&nbsp;2:15&nbsp;AM&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;To:&nbsp;Alec&nbsp;Matusis&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Cc:&nbsp;<br>
mod_python@modpython.org&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Subject:&nbsp;Re:&nbsp;[mod_python]&nbsp;<br>
mod_python&nbsp;or&nbsp;apache&nbsp;scalability?&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;04/11/2007,&nbsp;Alec&nbsp;Matusis&nbsp;&amp;lt;matusis@matusis.com&amp;gt;&nbsp;<br>
wrote:&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;FWIW,&nbsp;I&nbsp;personally&nbsp;would&nbsp;try&nbsp;and&nbsp;<br>
move&nbsp;from&nbsp;prefork&nbsp;to&nbsp;worker&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;MPM&nbsp;as&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;the&nbsp;number&nbsp;of&nbsp;Apache&nbsp;child&nbsp;processes&nbsp;you&nbsp;are&nbsp;<br>
running&nbsp;with&nbsp;is&nbsp;to&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;my&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
mind&nbsp;excessive.&nbsp;Using&nbsp;worker&nbsp;would&nbsp;certainly&nbsp;drop&nbsp;memory&nbsp;usage&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;for&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;a&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;start&nbsp;as&nbsp;you&nbsp;wouldn't&nbsp;need&nbsp;as&nbsp;many&nbsp;child&nbsp;processes&nbsp;<br>
to&nbsp;be&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;started.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;I&nbsp;am&nbsp;just&nbsp;following&nbsp;up&nbsp;on&nbsp;this,&nbsp;since&nbsp;we&nbsp;tried&nbsp;worker&nbsp;<br>
MPM&nbsp;this&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;weekend.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
On&nbsp;our&nbsp;dev/stage&nbsp;it&nbsp;worked&nbsp;perfectly.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;live,&nbsp;<br>
worker&nbsp;MPM&nbsp;freed&nbsp;up&nbsp;about&nbsp;2GB&nbsp;of&nbsp;memory&nbsp;compared&nbsp;to&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
prefork.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;However,&nbsp;on&nbsp;live,&nbsp;it&nbsp;turned&nbsp;out&nbsp;to&nbsp;be&nbsp;<br>
unstable.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;This&nbsp;is&nbsp;what&nbsp;we&nbsp;say&nbsp;in&nbsp;the&nbsp;main&nbsp;error&nbsp;<br>
log:&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;[Sun&nbsp;Nov&nbsp;<br>
04&nbsp;01:37:45&nbsp;2007]&nbsp;[notice]&nbsp;child&nbsp;pid&nbsp;20347&nbsp;exit&nbsp;signal&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Segmentation&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;fault&nbsp;<br>
(11)&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;[Sun&nbsp;Nov&nbsp;04&nbsp;01:37:45&nbsp;2007]&nbsp;[notice]&nbsp;child&nbsp;<br>
pid&nbsp;20460&nbsp;exit&nbsp;signal&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Aborted&nbsp;(6)&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;[Sun&nbsp;Nov&nbsp;04&nbsp;01:37:45&nbsp;2007]&nbsp;[notice]&nbsp;child&nbsp;pid&nbsp;20515&nbsp;<br>
exit&nbsp;signal&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Segmentation&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;fault&nbsp;(11)&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;***&nbsp;glibc&nbsp;<br>
detected&nbsp;***&nbsp;double&nbsp;free&nbsp;or&nbsp;corruption&nbsp;(!prev):&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
0x0000000000762c50&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;***&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;***&nbsp;glibc&nbsp;detected&nbsp;***&nbsp;double&nbsp;free&nbsp;or&nbsp;corruption&nbsp;<br>
(!prev):&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;0x000000000075d100&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;***&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;[Sun&nbsp;Nov&nbsp;04&nbsp;<br>
01:37:46&nbsp;2007]&nbsp;[notice]&nbsp;child&nbsp;pid&nbsp;20152&nbsp;exit&nbsp;signal&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
Segmentation&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;fault&nbsp;(11)&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;In&nbsp;the&nbsp;application&nbsp;<br>
log,&nbsp;we&nbsp;saw&nbsp;two&nbsp;types&nbsp;of&nbsp;errors:&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;MySQLError:&nbsp;Connection&nbsp;to&nbsp;database&nbsp;failed&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;OperationalError:&nbsp;(2006,&nbsp;'MySQL&nbsp;server&nbsp;has&nbsp;gone&nbsp;<br>
away')&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
and&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;IOError:&nbsp;<br>
image&nbsp;file&nbsp;is&nbsp;truncated&nbsp;(44&nbsp;bytes&nbsp;not&nbsp;processed)&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;The&nbsp;first&nbsp;type&nbsp;has&nbsp;to&nbsp;<br>
do&nbsp;with&nbsp;MySQLdb&nbsp;module,&nbsp;but&nbsp;the&nbsp;second&nbsp;one&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
occurred&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;when&nbsp;large&nbsp;images&nbsp;were&nbsp;<br>
uploaded.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Which&nbsp;<br>
indicates&nbsp;that&nbsp;some&nbsp;third&nbsp;party&nbsp;package&nbsp;you&nbsp;are&nbsp;using&nbsp;is&lt;BR&gt;&amp;gt;&nbsp;not&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;thread&nbsp;safe.&nbsp;This&nbsp;can&nbsp;occur&nbsp;if&nbsp;you&nbsp;are&nbsp;also&nbsp;using&nbsp;PHP&nbsp;<br>
as&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;various&nbsp;of&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;its&nbsp;<br>
third&nbsp;party&nbsp;packages&nbsp;are&nbsp;not&nbsp;thread&nbsp;safe.&nbsp;Also&nbsp;ensure&nbsp;that&lt;BR&gt;&amp;gt;&nbsp;you&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;are&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;using&nbsp;the&nbsp;latest&nbsp;available&nbsp;Python&nbsp;<br>
database&nbsp;adapters&nbsp;and&nbsp;that&nbsp;they&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;are&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;compiled&nbsp;against&nbsp;thread&nbsp;safe&nbsp;reentrant&nbsp;libraries.&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Graham&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;We&nbsp;had&nbsp;to&nbsp;revert&nbsp;to&nbsp;<br>
prefork&nbsp;as&nbsp;a&nbsp;result&nbsp;of&nbsp;this.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;another&nbsp;note,&nbsp;I&nbsp;managed&nbsp;to&nbsp;empirically&nbsp;find&nbsp;the&nbsp;<br>
maximum&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;ServerLimit&nbsp;for&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;prefork,&nbsp;before&nbsp;the&nbsp;machine&nbsp;dies&nbsp;from&nbsp;swapping.&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;It&nbsp;is&nbsp;380&nbsp;with&nbsp;4GB&nbsp;RAM.&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;-----Original&nbsp;<br>
Message-----&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;From:&nbsp;Graham&nbsp;Dumpleton&nbsp;[&lt;A&nbsp;<br>
href=&quot;mailto:graham.dumpleton@gmail.com&quot;&gt;mailto:graham.dumpleton@gmail.com&lt;/A&gt;]&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Sent:&nbsp;Monday,&nbsp;October&nbsp;01,&nbsp;2007&nbsp;6:47&nbsp;PM&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;To:&nbsp;Alec&nbsp;Matusis&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Cc:&nbsp;mod_python@modpython.org&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Subject:&nbsp;Re:&nbsp;[mod_python]&nbsp;mod_python&nbsp;or&nbsp;apache&nbsp;<br>
scalability?&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;01/10/2007,&nbsp;Alec&nbsp;Matusis&nbsp;<br>
&amp;lt;matusis@matusis.com&amp;gt;&nbsp;wrote:&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;in&nbsp;<br>
the&nbsp;apache&nbsp;error&nbsp;log.&nbsp;We&nbsp;also&nbsp;got&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
kernel:&nbsp;possible&nbsp;SYN&nbsp;flooding&nbsp;on&nbsp;port&nbsp;80.&nbsp;Sending&nbsp;cookies.&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;in&nbsp;<br>
/var/log/messages&nbsp;system&nbsp;log.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Have&nbsp;you&nbsp;determined&nbsp;for&nbsp;certain&nbsp;that&nbsp;you&nbsp;aren't&nbsp;the&nbsp;<br>
target&nbsp;of&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;an&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;external&nbsp;<br>
SYN&nbsp;Flood&nbsp;DOS&nbsp;attack?&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Do&nbsp;a&nbsp;Google&nbsp;search&nbsp;for&nbsp;'kernel:&nbsp;possible&nbsp;SYN&nbsp;<br>
flooding&nbsp;on&nbsp;port&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;80.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
Sending&nbsp;cookies'&nbsp;and&nbsp;you&nbsp;will&nbsp;find&nbsp;lots&nbsp;of&nbsp;stuff&nbsp;to&nbsp;read.&nbsp;Your&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;running&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;out&nbsp;of&nbsp;or&nbsp;<br>
having&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;socket&nbsp;connections&nbsp;may&nbsp;be&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;symptomatic&nbsp;of&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;half&nbsp;open&nbsp;<br>
connections&nbsp;being&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;created&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;and&nbsp;then&nbsp;being&nbsp;left&nbsp;in&nbsp;TIME_WAIT.&nbsp;Thus&nbsp;perhaps&nbsp;do&nbsp;<br>
some&nbsp;better&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;analysis&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;of&nbsp;socket&nbsp;connection&nbsp;states&nbsp;using&nbsp;netstat.&nbsp;If&nbsp;not&nbsp;a&nbsp;<br>
SYN&nbsp;Flood,&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;then&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
possibly&nbsp;follow&nbsp;some&nbsp;of&nbsp;the&nbsp;other&nbsp;suggestions&nbsp;in&nbsp;the&nbsp;pages&nbsp;you&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&nbsp;will&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;find&nbsp;when&nbsp;you&nbsp;do&nbsp;the&nbsp;<br>
search.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;FWIW,&nbsp;I&nbsp;personally&nbsp;would&nbsp;try&nbsp;and&nbsp;move&nbsp;from&nbsp;prefork&nbsp;<br>
to&nbsp;worker&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;MPM&nbsp;as&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;the&nbsp;<br>
number&nbsp;of&nbsp;Apache&nbsp;child&nbsp;processes&nbsp;you&nbsp;are&nbsp;running&nbsp;with&nbsp;is&nbsp;to&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;<br>
my&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;mind&nbsp;excessive.&nbsp;Using&nbsp;worker&nbsp;would&nbsp;<br>
certainly&nbsp;drop&nbsp;memory&nbsp;usage&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;for&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;a&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;start&nbsp;as&nbsp;you&nbsp;<br>
wouldn't&nbsp;need&nbsp;as&nbsp;many&nbsp;child&nbsp;processes&nbsp;to&nbsp;be&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;started.&nbsp;<br>
I&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;wouldn't&nbsp;be&nbsp;concerned&nbsp;about&nbsp;running&nbsp;out&nbsp;<br>
of&nbsp;threads&nbsp;as&nbsp;when&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;running&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;worker&nbsp;I&nbsp;wouldn't&nbsp;suggest&nbsp;more&nbsp;than&nbsp;25&nbsp;threads&nbsp;per&nbsp;<br>
process&nbsp;as&nbsp;a&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;starting&nbsp;point&nbsp;anyway.&nbsp;If&nbsp;your&nbsp;<br>
mod_python&nbsp;application&nbsp;was&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;creating&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;lots&nbsp;of&nbsp;threads,&nbsp;you&nbsp;are&nbsp;likely&nbsp;to&nbsp;hit&nbsp;the&nbsp;thread&nbsp;<br>
limit&nbsp;with&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;prefork&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;and&nbsp;not&nbsp;just&nbsp;worker&nbsp;so&nbsp;which&nbsp;MPM&nbsp;is&nbsp;used&nbsp;shouldn't&nbsp;<br>
be&nbsp;an&nbsp;issue&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;in&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;that&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;case.&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;BTW,&nbsp;what&nbsp;operating&nbsp;system&nbsp;are&nbsp;you&nbsp;using?&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Graham&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;_______________________________________________&lt;BR&gt;&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;Mod_python&nbsp;mailing&nbsp;list&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Mod_python@modpython.org&lt;BR&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;<br>
&lt;A&nbsp;<br>
href=&quot;http://mailman.modpython.org/mailman/listinfo/mod_python&quot;&gt;http://mailman.modpython.org/mailman/listinfo/mod_python&lt;/A&gt;&lt;BR&gt;&amp;gt;&lt;BR&gt;&amp;gt;&nbsp;<br>
_______________________________________________&lt;BR&gt;&amp;gt;&nbsp;Mod_python&nbsp;mailing&nbsp;<br>
list&lt;BR&gt;&amp;gt;&nbsp;Mod_python@modpython.org&lt;BR&gt;&amp;gt;&nbsp;&lt;A&nbsp;<br>
href=&quot;http://mailman.modpython.org/mailman/listinfo/mod_python&quot;&gt;http://mailman.modpython.org/mailman/listinfo/mod_python&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;/P&gt;&lt;/DIV&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
