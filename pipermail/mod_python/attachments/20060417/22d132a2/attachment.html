<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7036.0&quot;&gt;<br>
&lt;TITLE&gt;Output&nbsp;Filters&nbsp;Redeaux&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/rtf&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Greetings!&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Just&nbsp;for&nbsp;fun,&nbsp;here&nbsp;is&nbsp;a&nbsp;handy&nbsp;template&nbsp;for&nbsp;constructing&nbsp;Mod&nbsp;Python&nbsp;output&nbsp;filters:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;from&nbsp;mod_python&nbsp;import&nbsp;apache&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;from&nbsp;cStringIO&nbsp;import&nbsp;StringIO&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;def&nbsp;outputfilter&nbsp;(filter):&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;try:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;streambuffer&nbsp;=&nbsp;filter.req.streambuffer&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;except&nbsp;AttributeError:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;filter.req.streambuffer&nbsp;=&nbsp;StringIO()&nbsp;#&nbsp;See&nbsp;Note&nbsp;1&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;streambuffer&nbsp;=&nbsp;filter.req.streambuffer&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;See&nbsp;Note&nbsp;2&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;streamlet&nbsp;=&nbsp;filter.read()&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;while&nbsp;streamlet:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;See&nbsp;Note&nbsp;3&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;streambuffer.write(streamlet)&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;streamlet&nbsp;=&nbsp;filter.read()&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;streamlet&nbsp;is&nbsp;None:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;#&nbsp;See&nbsp;Note&nbsp;4&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;filter.write(streambuffer)&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;filter.close()&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;This&nbsp;is&nbsp;as&nbsp;stripped-down,&nbsp;bare-bones&nbsp;as&nbsp;a&nbsp;filter&nbsp;can&nbsp;get,&nbsp;IMHO.&amp;nbsp;&nbsp;Of&nbsp;course,&nbsp;this&nbsp;is&nbsp;just&nbsp;an&nbsp;echo&nbsp;filter&nbsp;until&nbsp;you&nbsp;add&nbsp;your&nbsp;own&nbsp;code&nbsp;to&nbsp;it.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Note&nbsp;1:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;When&nbsp;a&nbsp;filter&nbsp;is&nbsp;invoked&nbsp;once&nbsp;or&nbsp;only&nbsp;a&nbsp;few&nbsp;times,&nbsp;there&nbsp;is&nbsp;no&nbsp;real&nbsp;advantage&nbsp;in&nbsp;using&nbsp;a&nbsp;cStringIO&nbsp;buffer&nbsp;over&nbsp;a&nbsp;Python&nbsp;List&nbsp;buffer.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;As&nbsp;the&nbsp;number&nbsp;of&nbsp;re-invocations&nbsp;goes&nbsp;up,&nbsp;cStringIO&nbsp;starts&nbsp;to&nbsp;show&nbsp;a&nbsp;speed&nbsp;advantage.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Note&nbsp;2:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Anything&nbsp;else&nbsp;that&nbsp;you&nbsp;may&nbsp;want&nbsp;to&nbsp;initialize&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;a&nbsp;request&nbsp;should&nbsp;go&nbsp;here,&nbsp;ex:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;&amp;nbsp;&amp;nbsp;&lt;/FONT&gt;&amp;nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;&nbsp;filter.req.some_variable&nbsp;=&nbsp;some_value&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Note&nbsp;3:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Depending&nbsp;on&nbsp;your&nbsp;application,&nbsp;you&nbsp;may&nbsp;want&nbsp;to&nbsp;hack&nbsp;at&nbsp;the&nbsp;raw&nbsp;stream&nbsp;before&nbsp;putting&nbsp;it&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;ex:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/FONT&gt;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;streambuffer.write(streamlet.replace('\r\n',&nbsp;'\n'))&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Note&nbsp;4:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;At&nbsp;this&nbsp;point,&nbsp;streambuffer&nbsp;contains&nbsp;the&nbsp;entire&nbsp;request&nbsp;response&nbsp;and&nbsp;you&nbsp;may&nbsp;go&nbsp;ahead&nbsp;and&nbsp;do&nbsp;whatever&nbsp;it&nbsp;is&nbsp;you&nbsp;wanted&nbsp;to&nbsp;accomplish,&nbsp;ex:&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/FONT&gt;&nbsp;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Courier&nbsp;New&quot;&gt;filter.write(my_tranform_function(streambuffer))&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Best&nbsp;Regards,&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Lee&nbsp;E.&nbsp;Brown&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;(leebrown@leebrown.org)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
