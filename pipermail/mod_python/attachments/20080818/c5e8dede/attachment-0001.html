<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7652.24&quot;&gt;<br>
&lt;TITLE&gt;Mod_Python&nbsp;not&nbsp;releasing&nbsp;memory?&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/rtf&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;I&nbsp;have&nbsp;Apache/2.2.8&nbsp;(Unix)&nbsp;mod_python/3.3.1&nbsp;Python/2.4.5&nbsp;on&nbsp;Red&nbsp;Hat&nbsp;Enterprise&nbsp;Linux&nbsp;AS&nbsp;release&nbsp;4&nbsp;(Nahant&nbsp;Update&nbsp;6).&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Apache&nbsp;compiled:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;./configure&nbsp;--with-mpm=prefork&nbsp;--enable-mods-shared=&amp;quot;most&nbsp;proxy&nbsp;charset_lite&amp;quot;&nbsp;--with-expat=system&nbsp;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Mod&nbsp;Python:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;./configure&nbsp;--with-apxs=/usr/local/apache2/bin/apxs&nbsp;--with-python=/usr/local/bin/python2.4&nbsp;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Python:&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;./configure&nbsp;--enable-shared&nbsp;&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;My&nbsp;application&nbsp;is&nbsp;using&nbsp;Cheetah&nbsp;to&nbsp;generate&nbsp;a&nbsp;very&nbsp;large&nbsp;HTML&nbsp;table&nbsp;and&nbsp;sending&nbsp;it&nbsp;back&nbsp;to&nbsp;the&nbsp;client,&nbsp;after&nbsp;retrieving&nbsp;a&nbsp;bunch&nbsp;of&nbsp;database&nbsp;rows.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;One&nbsp;hit&nbsp;to&nbsp;Apache&nbsp;to&nbsp;generate&nbsp;one&nbsp;of&nbsp;these&nbsp;big&nbsp;tables&nbsp;runs&nbsp;memory&nbsp;usage&nbsp;up&nbsp;to&nbsp;30.6%&nbsp;of&nbsp;system&nbsp;RAM:&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;$&nbsp;ps&nbsp;aux&nbsp;|&nbsp;grep&nbsp;30316&nbsp;|&nbsp;grep&nbsp;-v&nbsp;grep&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;USER&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;PID&nbsp;%CPU&nbsp;%MEM&amp;nbsp;&amp;nbsp;&nbsp;VSZ&amp;nbsp;&nbsp;RSS&nbsp;TTY&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;STAT&nbsp;START&amp;nbsp;&amp;nbsp;&nbsp;TIME&nbsp;COMMAND&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;web&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;30316&amp;nbsp;&nbsp;2.7&nbsp;27.7&nbsp;1559948&nbsp;1122772&nbsp;?&amp;nbsp;&amp;nbsp;&nbsp;Rl&amp;nbsp;&amp;nbsp;&nbsp;12:48&amp;nbsp;&amp;nbsp;&nbsp;1:21&nbsp;/usr/local/apache2/bin/httpd&nbsp;-k&nbsp;start&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;$&nbsp;ps&nbsp;aux&nbsp;|&nbsp;grep&nbsp;30316&nbsp;|&nbsp;grep&nbsp;-v&nbsp;grep&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;USER&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;PID&nbsp;%CPU&nbsp;%MEM&amp;nbsp;&amp;nbsp;&nbsp;VSZ&amp;nbsp;&nbsp;RSS&nbsp;TTY&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;STAT&nbsp;START&amp;nbsp;&amp;nbsp;&nbsp;TIME&nbsp;COMMAND&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;web&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;30316&amp;nbsp;&nbsp;2.7&nbsp;30.6&nbsp;1559948&nbsp;1237948&nbsp;?&amp;nbsp;&amp;nbsp;&nbsp;Rl&amp;nbsp;&amp;nbsp;&nbsp;12:48&amp;nbsp;&amp;nbsp;&nbsp;1:21&nbsp;/usr/local/apache2/bin/httpd&nbsp;-k&nbsp;start&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;After&nbsp;the&nbsp;query&nbsp;is&nbsp;done&nbsp;and&nbsp;the&nbsp;results&nbsp;delivered&nbsp;to&nbsp;the&nbsp;browser,&nbsp;the&nbsp;Apache&nbsp;process&nbsp;is&nbsp;still&nbsp;holding&nbsp;about&nbsp;25%&nbsp;of&nbsp;system&nbsp;memory.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;I&nbsp;don't&nbsp;see&nbsp;any&nbsp;way&nbsp;to&nbsp;free&nbsp;that&nbsp;memory.&amp;nbsp;&nbsp;&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Once&nbsp;I&nbsp;&amp;quot;return&nbsp;result&amp;quot;&nbsp;to&nbsp;the&nbsp;browser,&nbsp;I&nbsp;can't&nbsp;do&nbsp;&amp;quot;result=None&amp;quot;&nbsp;so&nbsp;I'm&nbsp;relying&nbsp;on&nbsp;Python&nbsp;to&nbsp;release&nbsp;the&nbsp;memory&nbsp;and&nbsp;it&nbsp;is&nbsp;taking&nbsp;way&nbsp;too&nbsp;long&nbsp;for&nbsp;that&nbsp;to&nbsp;happen.&amp;nbsp;&nbsp;I&nbsp;do&nbsp;set&nbsp;the&nbsp;database&nbsp;result&nbsp;set&nbsp;to&nbsp;None&nbsp;as&nbsp;soon&nbsp;as&nbsp;I&nbsp;can&nbsp;and&nbsp;that&nbsp;helps&nbsp;some.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;If&nbsp;I&nbsp;get&nbsp;a&nbsp;number&nbsp;of&nbsp;these&nbsp;big&nbsp;hits,&nbsp;OOM&nbsp;starts&nbsp;killing&nbsp;PIDs&nbsp;which&nbsp;is&nbsp;a&nbsp;&amp;quot;Bad&nbsp;Thing&amp;quot;.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Any&nbsp;clues&nbsp;on&nbsp;how&nbsp;to&nbsp;make&nbsp;that&nbsp;memory&nbsp;release&nbsp;sooner?&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Thanks,&lt;/FONT&gt;<br>
<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&nbsp;FACE=&quot;Arial&quot;&gt;Scott&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;pre&gt;<br>
<br>
The&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;message&nbsp;and&nbsp;any&nbsp;attachment&nbsp;may&nbsp;be<br>
proprietary,&nbsp;confidential,&nbsp;and&nbsp;privileged&nbsp;or&nbsp;subject&nbsp;to&nbsp;the&nbsp;work<br>
product&nbsp;doctrine&nbsp;and&nbsp;thus&nbsp;protected&nbsp;from&nbsp;disclosure.&nbsp;&nbsp;If&nbsp;the&nbsp;reader<br>
of&nbsp;this&nbsp;message&nbsp;is&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;or&nbsp;an&nbsp;employee&nbsp;or<br>
agent&nbsp;responsible&nbsp;for&nbsp;delivering&nbsp;this&nbsp;message&nbsp;to&nbsp;the&nbsp;intended<br>
recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;dissemination,<br>
distribution&nbsp;or&nbsp;copying&nbsp;of&nbsp;this&nbsp;communication&nbsp;is&nbsp;strictly&nbsp;prohibited.<br>
If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;communication&nbsp;in&nbsp;error,&nbsp;please&nbsp;notify&nbsp;me<br>
immediately&nbsp;by&nbsp;replying&nbsp;to&nbsp;this&nbsp;message&nbsp;and&nbsp;deleting&nbsp;it&nbsp;and&nbsp;all<br>
copies&nbsp;and&nbsp;backups&nbsp;thereof.&nbsp;&nbsp;Thank&nbsp;you.<br>
<br>
&lt;/pre&gt;&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
