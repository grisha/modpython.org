<tt>
&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;5/6/05,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Graham&nbsp;Dumpleton&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:grahamd@dscpl.com.au&quot;&gt;grahamd@dscpl.com.au&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
jarrod&nbsp;roberson&nbsp;wrote&nbsp;..&lt;br&gt;&amp;gt;&nbsp;On&nbsp;5/5/05,&nbsp;Graham&nbsp;Dumpleton&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:grahamd@dscpl.com.au&quot;&gt;grahamd@dscpl.com.au&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;Question&nbsp;to&nbsp;the&nbsp;original&nbsp;poster.&nbsp;Have&nbsp;you&nbsp;added&nbsp;sufficient&nbsp;debug&nbsp;into<br>
&lt;br&gt;&amp;gt;&nbsp;each&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;step&nbsp;of&nbsp;the&nbsp;internals&nbsp;of&nbsp;that&nbsp;call&nbsp;so&nbsp;as&nbsp;to&nbsp;know&nbsp;precisely&nbsp;when&nbsp;the&nbsp;code&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;seems&nbsp;to&nbsp;block?&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;that&nbsp;call&nbsp;basically&nbsp;walks&nbsp;a&nbsp;list&nbsp;filters&nbsp;out&nbsp;some&nbsp;items&nbsp;and&nbsp;builds&nbsp;another<br>
&lt;br&gt;&amp;gt;&nbsp;list&nbsp;to&nbsp;return&lt;br&gt;&amp;gt;&nbsp;I&nbsp;have&nbsp;done&nbsp;alot&nbsp;of&nbsp;basic&nbsp;debugging&nbsp;and&nbsp;the&nbsp;problem&nbsp;is&nbsp;it&nbsp;just&nbsp;hangs&nbsp;apache&lt;br&gt;&amp;gt;&nbsp;and&nbsp;I&nbsp;have&nbsp;to&nbsp;kill&nbsp;it.&lt;br&gt;&amp;gt;&nbsp;Thus&nbsp;it&nbsp;doesn't&nbsp;print&nbsp;anything&nbsp;out&nbsp;because&nbsp;it&nbsp;doesn't&nbsp;shut&nbsp;down&nbsp;correctly.<br>
&lt;br&gt;&lt;br&gt;Is&nbsp;your&nbsp;debug&nbsp;using&nbsp;&amp;quot;print&amp;quot;&nbsp;or&nbsp;&amp;quot;apache.log_error()&amp;quot;&nbsp;from&nbsp;mod_python.&nbsp;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;<br>
it&nbsp;is&nbsp;apache.log_error()&lt;br&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;If&nbsp;the&lt;br&gt;latter,&nbsp;it&nbsp;should&nbsp;be&nbsp;logged&nbsp;to&nbsp;Apache&nbsp;log&nbsp;straight&nbsp;away&nbsp;and&nbsp;adding&nbsp;sufficient<br>
&lt;br&gt;debugging&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;identify&nbsp;place&nbsp;it&nbsp;stops&nbsp;if&nbsp;it&nbsp;reliably&nbsp;stops&nbsp;in&nbsp;the&lt;br&gt;same&nbsp;place.&nbsp;Is&nbsp;there&nbsp;any&nbsp;evidence&nbsp;it&nbsp;stops&nbsp;at&nbsp;the&nbsp;same&nbsp;place?&nbsp;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;<br>
yep&nbsp;same&nbsp;place&nbsp;req.write()&nbsp;&lt;br&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Does&nbsp;Apache&lt;br&gt;process&nbsp;go&nbsp;to&nbsp;idle,&nbsp;or&nbsp;does&nbsp;it&nbsp;look&nbsp;to&nbsp;be&nbsp;stuck&nbsp;in&nbsp;a&nbsp;tight&nbsp;loop&nbsp;and&nbsp;hogging<br>
&lt;br&gt;all&nbsp;the&nbsp;CPU?&nbsp;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;<br>
seems&nbsp;that&nbsp;only&nbsp;that&nbsp;req&nbsp;hangs,&nbsp;I&nbsp;enabled&nbsp;the&nbsp;apache&nbsp;server-status&nbsp;mod&nbsp;and&nbsp;it&nbsp;seems&nbsp;that&lt;br&gt;<br>
all&nbsp;the&nbsp;req&nbsp;threads&nbsp;go&nbsp;into&nbsp;a&nbsp;(W)ait&nbsp;mode&nbsp;when&nbsp;that&nbsp;call&nbsp;happens&nbsp;and&nbsp;never&nbsp;return&nbsp;:-(&lt;br&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;Depending&nbsp;on&nbsp;what&nbsp;platform&nbsp;you&nbsp;are&nbsp;using,&nbsp;does&nbsp;use&nbsp;of&nbsp;ktrace,&lt;br&gt;ptrace,&nbsp;strace&nbsp;or&nbsp;truss,&nbsp;indicate&nbsp;that&nbsp;Apache&nbsp;process&nbsp;is&nbsp;stuck&nbsp;within&nbsp;certain<br>
&lt;br&gt;system&nbsp;calls?&nbsp;These&nbsp;tools&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;pointed&nbsp;at&nbsp;the&nbsp;process&nbsp;using&nbsp;its&lt;br&gt;pid.&nbsp;Tools&nbsp;on&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;are&nbsp;good&nbsp;for&nbsp;this&nbsp;sort&nbsp;of&nbsp;debugging&nbsp;as&nbsp;can&nbsp;show&nbsp;where&lt;br&gt;different&nbsp;threads&nbsp;are&nbsp;and&nbsp;whether&nbsp;they&nbsp;are&nbsp;waiting&nbsp;on&nbsp;locks&nbsp;etc.<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;<br>
I&nbsp;am&nbsp;using&nbsp;OSX&nbsp;10.4&nbsp;so&nbsp;I&nbsp;will&nbsp;look&nbsp;into&nbsp;what&nbsp;it&nbsp;can&nbsp;do,&nbsp;I&nbsp;just&nbsp;got&nbsp;my&nbsp;PowerBook&nbsp;in&nbsp;March&nbsp;so&nbsp;that&nbsp;is&nbsp;still&nbsp;a&nbsp;learning&nbsp;curve.&lt;br&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&amp;gt;&nbsp;Do&nbsp;you&nbsp;know&nbsp;that&nbsp;a&nbsp;separate&nbsp;thread&nbsp;can't&nbsp;call&nbsp;into&nbsp;Twisted&lt;br&gt;&amp;gt;&nbsp;&amp;gt;&nbsp;unless&nbsp;it&nbsp;uses&nbsp;appropriate&nbsp;mechanisms?<br>
&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;I&nbsp;do&nbsp;now,&nbsp;what&nbsp;I&nbsp;don't&nbsp;know&nbsp;is&nbsp;what&nbsp;&amp;quot;appropriate&nbsp;mechanisms&amp;quot;&nbsp;is&nbsp;specifically&lt;br&gt;&lt;br&gt;I&nbsp;don't&nbsp;use&nbsp;Twisted,&nbsp;but&nbsp;based&nbsp;on&nbsp;recent&nbsp;comp.lang.python&nbsp;post,&nbsp;there&nbsp;is&nbsp;a&lt;br&gt;call&nbsp;&amp;quot;callFromThread&amp;quot;.&nbsp;Example&nbsp;on&nbsp;the&nbsp;new&nbsp;group&nbsp;was:<br>
&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;import&nbsp;time&lt;br&gt;&amp;nbsp;&amp;nbsp;from&nbsp;twisted.internet&nbsp;import&nbsp;reactor&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;def&nbsp;shutdown():&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;time.sleep(3)&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;print&nbsp;&amp;quot;stopping&amp;quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&nbsp;reactor.callFromThread(reactor&nbsp;.stop)&lt;br&gt;&lt;br&gt;&amp;nbsp;&amp;nbsp;reactor.callInThread(shutdown)<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;reactor.run()&lt;br&gt;&lt;br&gt;Don't&nbsp;know&nbsp;much&nbsp;more&nbsp;than&nbsp;that.&lt;br&gt;&lt;br&gt;Graham&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Awesome,&nbsp;thanks&nbsp;for&nbsp;the&nbsp;advice&nbsp;I&amp;nbsp;&nbsp;will&nbsp;go&nbsp;and&amp;nbsp;&nbsp;try&nbsp;all&nbsp;that&nbsp;stuff!&lt;br&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
