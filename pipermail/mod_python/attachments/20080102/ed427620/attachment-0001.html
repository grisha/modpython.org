<tt>
On&nbsp;1/2/08,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Graham&nbsp;Dumpleton&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:graham.dumpleton@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;graham.dumpleton@gmail.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;div&gt;<br>
&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
On&nbsp;03/01/2008,&nbsp;Matthew&nbsp;Dennis&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:mdennis@merfer.net&quot;&nbsp;target=&quot;_blank&quot;&nbsp;onclick=&quot;return&nbsp;top.js.OpenExtLink(window,event,this)&quot;&gt;mdennis@merfer.net&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;I&nbsp;have&nbsp;a&nbsp;handler&nbsp;that&nbsp;streams&nbsp;large&nbsp;amounts&nbsp;of&nbsp;data.&amp;nbsp;&amp;nbsp;Using&nbsp;chunked&nbsp;encoding<br>
&lt;br&gt;&amp;gt;&nbsp;in&nbsp;necessary&nbsp;as&nbsp;the&nbsp;total&nbsp;size&nbsp;is&nbsp;not&nbsp;known&nbsp;upfront.&amp;nbsp;&amp;nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;error<br>
&lt;br&gt;&amp;gt;&nbsp;during&nbsp;the&nbsp;generation,&nbsp;I&nbsp;raise&nbsp;a&nbsp;apache.SERVER_RETURN&nbsp;(with&lt;br&gt;&amp;gt;&nbsp;HTTP_PARTIAL_RESPONSE&nbsp;I&nbsp;believe).&amp;nbsp;&amp;nbsp;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;it&nbsp;looks&nbsp;like&lt;br&gt;&amp;gt;&nbsp;mod_python&nbsp;and/or&nbsp;apache&nbsp;just&nbsp;appends&nbsp;some&nbsp;error&nbsp;html&nbsp;to&nbsp;the&nbsp;output&nbsp;stream<br>
&lt;br&gt;&amp;gt;&nbsp;and&nbsp;continues&nbsp;with&nbsp;the&nbsp;chunked&nbsp;encoding&nbsp;like&nbsp;there&nbsp;was&nbsp;no&nbsp;error.&amp;nbsp;&amp;nbsp;In&nbsp;other&lt;br&gt;&amp;gt;&nbsp;words,&nbsp;some&nbsp;data&nbsp;chunks&nbsp;come&nbsp;from&nbsp;the&nbsp;server,&nbsp;then&nbsp;a&nbsp;chunk&nbsp;with&nbsp;the&nbsp;error&lt;br&gt;&amp;gt;&nbsp;html&nbsp;in&nbsp;it,&nbsp;then&nbsp;the&nbsp;last&nbsp;chunk.&amp;nbsp;&amp;nbsp;Thus,&nbsp;the&nbsp;client&nbsp;has&nbsp;no&nbsp;way&nbsp;of&nbsp;knowing<br>
&lt;br&gt;&amp;gt;&nbsp;that&nbsp;the&nbsp;data&nbsp;is&nbsp;incomplete&nbsp;(not&nbsp;all&nbsp;of&nbsp;it&nbsp;was&nbsp;generated)&nbsp;and&nbsp;corrupt&lt;br&gt;&amp;gt;&nbsp;(random&nbsp;html&nbsp;appended&nbsp;onto&nbsp;the&nbsp;end).&amp;nbsp;&amp;nbsp;Am&nbsp;I&nbsp;just&nbsp;missing&nbsp;something,&nbsp;or&nbsp;is&lt;br&gt;&amp;gt;&nbsp;this&nbsp;a&nbsp;bug?&lt;br&gt;&lt;br&gt;A&nbsp;HTTP&nbsp;status&nbsp;code&nbsp;can&nbsp;only&nbsp;be&nbsp;returned/raised&nbsp;before&nbsp;any&nbsp;data&nbsp;has<br>
&lt;br&gt;been&nbsp;sent&nbsp;as&nbsp;that&nbsp;information&nbsp;is&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;the&nbsp;response.&nbsp;If&lt;br&gt;you&nbsp;are&nbsp;trying&nbsp;to&nbsp;raise&nbsp;the&nbsp;HTTP&nbsp;response&nbsp;status&nbsp;after&nbsp;data&nbsp;has&nbsp;been&lt;br&gt;sent&nbsp;then&nbsp;your&nbsp;code&nbsp;is&nbsp;wrong.&lt;br&gt;&lt;br&gt;What&nbsp;do&nbsp;you&nbsp;think&nbsp;HTTP_PARTIAL_RESPONSE&nbsp;is&nbsp;meant&nbsp;to&nbsp;be&nbsp;used&nbsp;for?&nbsp;Maybe<br>
&lt;br&gt;you&nbsp;understanding&nbsp;is&nbsp;not&nbsp;complete,&nbsp;or&nbsp;you&nbsp;don&amp;#39;t&nbsp;understand&nbsp;how&nbsp;HTTP&lt;br&gt;responses&nbsp;are&nbsp;put&nbsp;together.&lt;br&gt;&lt;br&gt;Graham&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;Sorry,&nbsp;it&nbsp;was&nbsp;INTERNAL_SERVER_ERROR.&amp;nbsp;&nbsp;I&nbsp;don&amp;#39;t&nbsp;know&nbsp;where&nbsp;I&nbsp;got&nbsp;PARTIAL_RESPONSE&nbsp;from,&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing.&amp;nbsp;&nbsp;There&nbsp;is&nbsp;a&nbsp;PARTIAL_CONTENT&nbsp;status,&nbsp;but&nbsp;it&amp;#39;s&nbsp;not&nbsp;even&nbsp;an&nbsp;error&nbsp;(it&amp;#39;s&nbsp;a&nbsp;200&nbsp;status&nbsp;for&nbsp;range&nbsp;requests)&amp;nbsp;&nbsp;In&nbsp;any&nbsp;case,&nbsp;I&nbsp;would&nbsp;not&nbsp;expect&nbsp;that&nbsp;raising&nbsp;<br>
apache.SERVER_RETURN&nbsp;to&nbsp;continue&nbsp;processing&nbsp;the&nbsp;request&nbsp;as&nbsp;if&nbsp;nothing&nbsp;happened.&amp;nbsp;&nbsp;SERVER_RETURN&nbsp;requires&nbsp;a&nbsp;status/error&nbsp;code&nbsp;to&nbsp;be&nbsp;passed&nbsp;in,&nbsp;but&nbsp;I&nbsp;wasn&amp;#39;t&nbsp;actually&nbsp;expecting&nbsp;the&nbsp;status&nbsp;code&nbsp;to&nbsp;be&nbsp;sent&nbsp;to&nbsp;the&nbsp;client.&amp;nbsp;&nbsp;I&nbsp;was&nbsp;trying&nbsp;to&nbsp;have&nbsp;apache/mod_python&nbsp;signal&nbsp;the&nbsp;client&nbsp;that&nbsp;the&nbsp;generation&nbsp;failed.&amp;nbsp;&nbsp;<br>
&lt;br&gt;&lt;br&gt;Let&nbsp;me&nbsp;approach&nbsp;this&nbsp;from&nbsp;a&nbsp;different&nbsp;direction,&nbsp;as&nbsp;it&nbsp;sounds&nbsp;like&nbsp;my&nbsp;understanding&nbsp;of&nbsp;raising&nbsp;SERVER_RETURN&nbsp;is&nbsp;wrong.&amp;nbsp;&nbsp;I&nbsp;thought&nbsp;raising&nbsp;SERVER_RETURN&nbsp;was&nbsp;the&nbsp;correct&nbsp;way&nbsp;to&nbsp;inform&nbsp;apache&nbsp;and/or&nbsp;mod_python&nbsp;that&nbsp;an&nbsp;error&nbsp;occurred&nbsp;and&nbsp;that&nbsp;the&nbsp;handler&nbsp;can&nbsp;not&nbsp;continue&nbsp;-&nbsp;is&nbsp;that&nbsp;incorrect?&amp;nbsp;&nbsp;I&amp;#39;m&nbsp;starting&nbsp;to&nbsp;assume&nbsp;from&nbsp;the&nbsp;name&nbsp;that&nbsp;my&nbsp;understanding&nbsp;is&nbsp;wrong...<br>
&lt;br&gt;&lt;br&gt;The&nbsp;real&nbsp;question&nbsp;is&nbsp;if&nbsp;a&nbsp;handler&nbsp;is&nbsp;in&nbsp;the&nbsp;middle&nbsp;of&nbsp;sending&nbsp;a&nbsp;chunked&nbsp;response,&nbsp;how&nbsp;does&nbsp;it&nbsp;inform&nbsp;apache&nbsp;and/or&nbsp;mod_python&nbsp;that&nbsp;it&nbsp;can&nbsp;not&nbsp;continue?&lt;br&gt;<br>

</tt>
