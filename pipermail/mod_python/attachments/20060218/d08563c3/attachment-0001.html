<tt>
Well&nbsp;mostly&nbsp;it's&nbsp;just&nbsp;my&nbsp;C++&nbsp;days&nbsp;coming&nbsp;back&nbsp;to&nbsp;haunt&nbsp;me,&nbsp;can't&nbsp;stand&nbsp;the&nbsp;thought&nbsp;of&nbsp;buffering&nbsp;large&nbsp;amounts&nbsp;of&nbsp;data&nbsp;for&nbsp;no&nbsp;reason&nbsp;at&nbsp;all.&nbsp;But&nbsp;it's&nbsp;just&nbsp;a&nbsp;minor&nbsp;concern,&nbsp;and&nbsp;for&nbsp;now&nbsp;performance&nbsp;is&nbsp;a&nbsp;non-issue,&nbsp;I'll&nbsp;cross&nbsp;that&nbsp;bridge&nbsp;when&nbsp;I&nbsp;get&nbsp;there.&nbsp;I&nbsp;was&nbsp;just&nbsp;wondering&nbsp;if&nbsp;there&nbsp;was&nbsp;a&nbsp;easy&nbsp;way&nbsp;to&nbsp;write&nbsp;data&nbsp;from&nbsp;my&nbsp;string&nbsp;to&nbsp;the&nbsp;browser,&nbsp;but&nbsp;that&nbsp;may&nbsp;not&nbsp;even&nbsp;be&nbsp;possible&nbsp;for&nbsp;all&nbsp;I&nbsp;know.&nbsp;<br>
&lt;br&gt;&lt;br&gt;Thanks&nbsp;Graham.&lt;br&gt;-Dan&lt;br&gt;&lt;br&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;2/18/06,&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Graham&nbsp;Dumpleton&lt;/b&gt;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:grahamd@dscpl.com.au&quot;&gt;grahamd@dscpl.com.au&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;/span&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;br&gt;On&nbsp;19/02/2006,&nbsp;at&nbsp;9:14&nbsp;AM,&nbsp;Dan&nbsp;Eloff&nbsp;wrote:&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;I'm&nbsp;curious&nbsp;about&nbsp;this&nbsp;&amp;quot;chunked&nbsp;encoding&amp;quot;&nbsp;what&nbsp;does&nbsp;that&nbsp;mean?&nbsp;I&lt;br&gt;&amp;gt;&nbsp;output&nbsp;all&nbsp;my&nbsp;pages&nbsp;in&nbsp;my&nbsp;handler&nbsp;as&nbsp;a&nbsp;single&nbsp;string,&nbsp;so&nbsp;I&nbsp;have&nbsp;a&lt;br&gt;&amp;gt;&nbsp;sort&nbsp;of&nbsp;interest&nbsp;in&nbsp;understanding&nbsp;what&nbsp;the&nbsp;write&nbsp;method&nbsp;does.&nbsp;If<br>
&lt;br&gt;&amp;gt;&nbsp;I'm&nbsp;to&nbsp;take&nbsp;a&nbsp;wild&nbsp;guess&nbsp;at&nbsp;how&nbsp;the&nbsp;below&nbsp;works,&nbsp;you&nbsp;set&nbsp;the&lt;br&gt;&amp;gt;&nbsp;content&nbsp;length&nbsp;so&nbsp;that&nbsp;mod_python&nbsp;realizes&nbsp;when&nbsp;it&nbsp;recieves&nbsp;your&lt;br&gt;&amp;gt;&nbsp;data&nbsp;string&nbsp;that&nbsp;no&nbsp;more&nbsp;is&nbsp;coming&nbsp;and&nbsp;it&nbsp;doesn't&nbsp;need&nbsp;to&nbsp;copy&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;string&nbsp;into&nbsp;a&nbsp;buffer,&nbsp;it&nbsp;can&nbsp;just&nbsp;keep&nbsp;a&nbsp;reference&nbsp;to&nbsp;it?&nbsp;And&lt;br&gt;&amp;gt;&nbsp;somehow&nbsp;the&nbsp;act&nbsp;of&nbsp;buffering&nbsp;the&nbsp;data&nbsp;as&nbsp;opposed&nbsp;to&nbsp;writing&nbsp;it&lt;br&gt;&amp;gt;&nbsp;immediately&nbsp;causes&nbsp;mod_python&nbsp;not&nbsp;to&nbsp;emply&nbsp;this&nbsp;&amp;quot;chunked&nbsp;encoding&amp;quot;?<br>
&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;It'd&nbsp;be&nbsp;great&nbsp;if&nbsp;someone&nbsp;explained&nbsp;this&nbsp;to&nbsp;me&nbsp;:)&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Thanks,&lt;br&gt;&amp;gt;&nbsp;-Dan&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;On&nbsp;2/15/06,&nbsp;Lars&nbsp;Eriksen&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:downgrade@gmx.org&quot;&gt;downgrade@gmx.org&lt;/a&gt;&nbsp;&amp;gt;&nbsp;wrote:Yes,&nbsp;there<br>
&lt;br&gt;&amp;gt;&nbsp;is&nbsp;:-)&nbsp;RTFM,&nbsp;I&nbsp;guess&nbsp;...&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;from&nbsp;mod_python.util&nbsp;import&nbsp;*&lt;br&gt;&amp;gt;&nbsp;from&nbsp;mod_python&nbsp;import&nbsp;apache&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;def&nbsp;handle(req):&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;data&nbsp;=&nbsp;'No&nbsp;chunking&nbsp;involved.'&nbsp;*&nbsp;1024&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.set_content_length<br>
(len(data))&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write(data,&nbsp;0)&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.flush()&lt;br&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;apache.OK&lt;br&gt;&lt;br&gt;As&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;tell,&nbsp;there&nbsp;is&nbsp;no&nbsp;difference&nbsp;between&nbsp;that&nbsp;and:&lt;br&gt;&lt;br&gt;def&nbsp;handler(req):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;data&nbsp;=&nbsp;'No&nbsp;chunking&nbsp;involved.'&nbsp;*&nbsp;1024<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.set_content_length(len(data))&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write(data)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;apache.OK&lt;br&gt;&lt;br&gt;When&nbsp;no&nbsp;second&nbsp;argument&nbsp;is&nbsp;supplied&nbsp;to&nbsp;req.write(),&nbsp;it&nbsp;automatically&lt;br&gt;flushes.&lt;br&gt;&lt;br&gt;In&nbsp;this&nbsp;particular&nbsp;case,&nbsp;since&nbsp;there&nbsp;is&nbsp;only&nbsp;one&nbsp;call&nbsp;to&nbsp;<br>
req.write(),&lt;br&gt;it&nbsp;is&nbsp;also&lt;br&gt;probably&nbsp;equivalent&nbsp;to:&lt;br&gt;&lt;br&gt;def&nbsp;handler(req):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;data&nbsp;=&nbsp;'No&nbsp;chunking&nbsp;involved.'&nbsp;*&nbsp;1024&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.set_content_length(len(data))&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write(data,0)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;apache.OK&lt;br&gt;<br>
&lt;br&gt;That&nbsp;is,&nbsp;returning&nbsp;apache.OK&nbsp;is&nbsp;going&nbsp;to&nbsp;have&nbsp;the&nbsp;same&nbsp;effect&nbsp;of&lt;br&gt;flushing&nbsp;the&lt;br&gt;buffered&nbsp;data&nbsp;if&nbsp;there&nbsp;is&nbsp;any.&lt;br&gt;&lt;br&gt;FWIW,&nbsp;chunked&nbsp;encoding&nbsp;is&nbsp;only&nbsp;of&nbsp;relevance&nbsp;to&nbsp;HTTP/1.1&nbsp;clients.&nbsp;You&lt;br&gt;as&nbsp;the&lt;br&gt;provider&nbsp;of&nbsp;the&nbsp;handler&nbsp;does&nbsp;not&nbsp;really&nbsp;have&nbsp;to&nbsp;care&nbsp;about&nbsp;it&nbsp;as<br>
&lt;br&gt;Apache&nbsp;will&lt;br&gt;worry&nbsp;about&nbsp;it&nbsp;and&nbsp;use&nbsp;it&nbsp;if&nbsp;the&nbsp;client&nbsp;is&nbsp;capable&nbsp;of&nbsp;handling&nbsp;HTTP/&lt;br&gt;1.1.&nbsp;That&nbsp;is,&lt;br&gt;mod_python&nbsp;doesn't&nbsp;do&nbsp;anything&nbsp;about&nbsp;chunked&nbsp;encoding&nbsp;either.&lt;br&gt;&lt;br&gt;As&nbsp;to&nbsp;the&nbsp;connection&nbsp;between&nbsp;req.set_content_length<br>
()&nbsp;and&nbsp;how&nbsp;much&nbsp;data&lt;br&gt;you&nbsp;write,&nbsp;there&nbsp;isn't&nbsp;really&nbsp;any.&nbsp;Calling&nbsp;req.set_content_length()&lt;br&gt;only&nbsp;has&nbsp;the&lt;br&gt;effect&nbsp;of&nbsp;setting&nbsp;the&nbsp;&amp;quot;Content-Length&amp;quot;&nbsp;response&nbsp;header.&nbsp;You&nbsp;could&nbsp;set&lt;br&gt;the&lt;br&gt;content&nbsp;length&nbsp;to&nbsp;a&nbsp;small&nbsp;value&nbsp;and&nbsp;write&nbsp;more&nbsp;data&nbsp;that&nbsp;you&nbsp;say<br>
&lt;br&gt;there&nbsp;will&nbsp;be&lt;br&gt;and&nbsp;mod_python/Apache&nbsp;will&nbsp;quite&nbsp;happily&nbsp;let&nbsp;you&nbsp;do&nbsp;it.&nbsp;A&nbsp;remote&lt;br&gt;client&nbsp;on&lt;br&gt;the&nbsp;other&nbsp;handle&nbsp;may&nbsp;well&nbsp;probably&nbsp;discard&nbsp;any&nbsp;extra&nbsp;content&nbsp;if&nbsp;it&lt;br&gt;honours&nbsp;the&lt;br&gt;content&nbsp;length&nbsp;header.&lt;br&gt;&lt;br&gt;For&nbsp;most&nbsp;people,&nbsp;how&nbsp;many&nbsp;times&nbsp;you&nbsp;call&nbsp;<br>
req.write()&nbsp;and&nbsp;whether&nbsp;you&nbsp;use&lt;br&gt;buffering&nbsp;isn't&nbsp;going&nbsp;to&nbsp;matter&nbsp;one&nbsp;bit.&nbsp;Some&nbsp;may&nbsp;want&nbsp;to&nbsp;minimise&lt;br&gt;the&nbsp;number&lt;br&gt;of&nbsp;calls&nbsp;to&nbsp;req.write()&nbsp;or&nbsp;use&nbsp;buffering&nbsp;for&nbsp;perceived&nbsp;performance&lt;br&gt;reasons&nbsp;(right&lt;br&gt;or&nbsp;wrong).&lt;br&gt;<br>
&lt;br&gt;One&nbsp;valid&nbsp;reason&nbsp;for&nbsp;not&nbsp;having&nbsp;req.write()&nbsp;flush&nbsp;data&nbsp;automatically&lt;br&gt;though&nbsp;is&lt;br&gt;if&nbsp;you&nbsp;are&nbsp;using&nbsp;an&nbsp;output&nbsp;filter&nbsp;that&nbsp;wants&nbsp;to&nbsp;see&nbsp;the&nbsp;whole&nbsp;data&nbsp;in&lt;br&gt;one&nbsp;go.&nbsp;An&lt;br&gt;example&nbsp;is&nbsp;the&nbsp;&amp;quot;CONTENT_LENGTH&amp;quot;&nbsp;filter.&nbsp;If&nbsp;you&nbsp;had&nbsp;configured&nbsp;your<br>
&lt;br&gt;handler&lt;br&gt;output&nbsp;to&nbsp;go&nbsp;through&nbsp;this&nbsp;filter,&nbsp;you&nbsp;could&nbsp;just&nbsp;say:&lt;br&gt;&lt;br&gt;def&nbsp;handler(req):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;data&nbsp;=&nbsp;'No&nbsp;chunking&nbsp;involved.'&nbsp;*&nbsp;1024&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write(data,0)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write(data,0)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;....&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;apache.OK<br>
&lt;br&gt;&lt;br&gt;and&nbsp;the&nbsp;output&nbsp;filter&nbsp;would&nbsp;add&nbsp;the&nbsp;content&nbsp;length&nbsp;header&nbsp;for&nbsp;you&lt;br&gt;automatically.&lt;br&gt;For&nbsp;this&nbsp;to&nbsp;work,&nbsp;you&nbsp;have&nbsp;to&nbsp;ensure&nbsp;that&nbsp;flush&nbsp;isn't&nbsp;called&lt;br&gt;explicitly&nbsp;or&nbsp;implicitly.&lt;br&gt;&lt;br&gt;What&nbsp;are&nbsp;the&nbsp;underlying&nbsp;concerns&nbsp;that&nbsp;make&nbsp;you&nbsp;think&nbsp;you&nbsp;need&nbsp;to<br>
&lt;br&gt;understand&lt;br&gt;this&nbsp;better?&lt;br&gt;&lt;br&gt;Graham&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
