<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-8859-1&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Nicolas&nbsp;Lehuen&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;cite=&quot;midc298f2d705090810456ca40b00@mail.gmail.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;2005/9/8,&nbsp;Graham&nbsp;Dumpleton&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:grahamd@dscpl.com.au&quot;&gt;&amp;lt;grahamd@dscpl.com.au&amp;gt;&lt;/a&gt;:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;09/09/2005,&nbsp;at&nbsp;2:23&nbsp;AM,&nbsp;John&nbsp;Simeone&nbsp;wrote:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hello&nbsp;to&nbsp;everyone.<br>
<br>
I&nbsp;am&nbsp;responsible&nbsp;for&nbsp;a&nbsp;project&nbsp;using&nbsp;Apache&nbsp;2.0&nbsp;with&nbsp;mod_python&nbsp;in&nbsp;a<br>
Win2k&nbsp;environment,&nbsp;the&nbsp;choice&nbsp;of&nbsp;OS&nbsp;being&nbsp;dictated&nbsp;by&nbsp;the&nbsp;fact&nbsp;that<br>
the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;server&nbsp;is&nbsp;to&nbsp;supply&nbsp;access&nbsp;to&nbsp;a&nbsp;proprietary,<br>
supplier&nbsp;written&nbsp;Windows&nbsp;program&nbsp;to&nbsp;our&nbsp;user&nbsp;base&nbsp;via&nbsp;the&nbsp;web.<br>
<br>
That&nbsp;program&nbsp;is&nbsp;single&nbsp;threaded&nbsp;and&nbsp;provides&nbsp;for&nbsp;only&nbsp;1&nbsp;user&nbsp;at&nbsp;a<br>
time.&nbsp;Access&nbsp;to&nbsp;the&nbsp;program&nbsp;in&nbsp;Python&nbsp;is&nbsp;through&nbsp;&nbsp;win32com.<br>
<br>
I&nbsp;am&nbsp;using&nbsp;a&nbsp;mod_python.publisher&nbsp;handler.<br>
<br>
All&nbsp;the&nbsp;http&nbsp;requests&nbsp;come&nbsp;through&nbsp;a&nbsp;single&nbsp;proxy&nbsp;server&nbsp;with&nbsp;a&nbsp;static<br>
address&nbsp;but&nbsp;not&nbsp;all&nbsp;are&nbsp;from&nbsp;browser&nbsp;clients.&nbsp;Some&nbsp;are&nbsp;originating<br>
from&nbsp;perl&nbsp;programs&nbsp;but&nbsp;all&nbsp;requests&nbsp;are&nbsp;directed&nbsp;to&nbsp;a&nbsp;single&nbsp;request<br>
handler.<br>
<br>
Can&nbsp;anyone&nbsp;suggest&nbsp;a&nbsp;method&nbsp;to&nbsp;control&nbsp;access&nbsp;to&nbsp;this&nbsp;single&nbsp;user<br>
resource.&nbsp;In&nbsp;a&nbsp;non-web&nbsp;programming&nbsp;environment,&nbsp;I'd&nbsp;just&nbsp;use&nbsp;a&nbsp;mutex<br>
semaphore&nbsp;to&nbsp;co-ordinate&nbsp;access&nbsp;among&nbsp;the&nbsp;threads&nbsp;but&nbsp;I&nbsp;am&nbsp;too&nbsp;much&nbsp;of<br>
newbie&nbsp;with&nbsp;mod_python&nbsp;and&nbsp;Apache&nbsp;to&nbsp;implement&nbsp;a&nbsp;workable&nbsp;solution&nbsp;so<br>
far.<br>
<br>
What&nbsp;mechanism&nbsp;can&nbsp;I&nbsp;use&nbsp;to&nbsp;create&nbsp;a&nbsp;shared&nbsp;resource&nbsp;that&nbsp;I&nbsp;can&nbsp;lock<br>
and&nbsp;have&nbsp;other&nbsp;requests&nbsp;wait&nbsp;until&nbsp;the&nbsp;resource&nbsp;is&nbsp;unlocked?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;When&nbsp;using&nbsp;mod_python&nbsp;under&nbsp;Win32&nbsp;platform,&nbsp;there&nbsp;is&nbsp;effectively&nbsp;only<br>
one&nbsp;process&nbsp;and&nbsp;requests&nbsp;are&nbsp;handled&nbsp;in&nbsp;separate&nbsp;threads.&nbsp;Because&nbsp;of<br>
this,&nbsp;you&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;mediate&nbsp;access&nbsp;to&nbsp;the&nbsp;shared&nbsp;resource<br>
through&nbsp;a&nbsp;normal&nbsp;thread&nbsp;mutual&nbsp;exclusion&nbsp;locking&nbsp;mechanism&nbsp;just&nbsp;as<br>
easily&nbsp;as&nbsp;you&nbsp;would&nbsp;in&nbsp;a&nbsp;non&nbsp;web&nbsp;environment.<br>
<br>
Graham<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
That&nbsp;is&nbsp;to&nbsp;say&nbsp;:<br>
<br>
import&nbsp;threading<br>
<br>
#&nbsp;&quot;R&quot;&nbsp;stand&nbsp;for&nbsp;Re-entrant,&nbsp;i.e.&nbsp;a&nbsp;thread&nbsp;can&nbsp;acquire&nbsp;the&nbsp;lock&nbsp;multiple&nbsp;times<br>
#&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;lock&nbsp;is&nbsp;instantiated&nbsp;only&nbsp;once,&nbsp;for&nbsp;example&nbsp;by<br>
putting&nbsp;it&nbsp;in<br>
#&nbsp;a&nbsp;module&nbsp;which&nbsp;your&nbsp;published&nbsp;code&nbsp;imports.<br>
lock&nbsp;=&nbsp;threading.RLock()&nbsp;<br>
<br>
lock.acquire()<br>
try:<br>
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;access&nbsp;the&nbsp;shared&nbsp;resource<br>
finally:<br>
&nbsp;&nbsp;&nbsp;&nbsp;lock.release()<br>
<br>
See&nbsp;the&nbsp;documentation&nbsp;of&nbsp;the&nbsp;threading&nbsp;module&nbsp;for&nbsp;more&nbsp;information.<br>
<br>
Regards,<br>
Nicolas<br>
<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
Thanks&nbsp;to&nbsp;Graham&nbsp;and&nbsp;Nicolas&nbsp;for&nbsp;their&nbsp;prompt&nbsp;responses.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;followed&nbsp;Nicolas'&nbsp;counsel&nbsp;and&nbsp;created&nbsp;a&nbsp;file&nbsp;'tconstants.py'&nbsp;:&lt;br&gt;<br>
&lt;br&gt;<br>
import&nbsp;threading&lt;br&gt;<br>
mutex&nbsp;=&nbsp;threading.RLock()&lt;br&gt;<br>
&lt;br&gt;<br>
included&nbsp;an&nbsp;'import'&nbsp;into&nbsp;my&nbsp;publisher&nbsp;handler&nbsp;and&nbsp;wrapped&nbsp;the&nbsp;access<br>
to&nbsp;the&nbsp;single&nbsp;resource&nbsp;with&nbsp;'mutex.acquire()'&nbsp;and&nbsp;mutex.release().&nbsp;When<br>
I&nbsp;got&nbsp;an&nbsp;error&nbsp;regarding&nbsp;the&nbsp;unavailability&nbsp;of&nbsp;the&nbsp;mutex&nbsp;global,&nbsp;I&nbsp;ran<br>
the&nbsp;following&nbsp;test&nbsp;in&nbsp;IDLE:&lt;br&gt;<br>
&lt;br&gt;<br>
import&nbsp;threading&lt;br&gt;<br>
import&nbsp;tconstants&lt;br&gt;<br>
def&nbsp;setmutex():&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;mutex.acquire()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&lt;br&gt;<br>
setmutex()&lt;br&gt;<br>
&lt;br&gt;<br>
and&nbsp;received&nbsp;the&nbsp;same&nbsp;error:&amp;nbsp;&nbsp;&quot;global&nbsp;name&nbsp;'mutex'&nbsp;is&nbsp;not&nbsp;defined.&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;ran&nbsp;the&nbsp;threading&nbsp;demo&nbsp;to&nbsp;verify&nbsp;there&nbsp;wasn't&nbsp;a&nbsp;problem&nbsp;with&nbsp;the<br>
thread&nbsp;module&nbsp;in&nbsp;my&nbsp;copy&nbsp;of&nbsp;Python&nbsp;2.3.&nbsp;It&nbsp;ran&nbsp;fine.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;only&nbsp;way&nbsp;I&nbsp;could&nbsp;get&nbsp;this&nbsp;test&nbsp;to&nbsp;work&nbsp;was&nbsp;to&nbsp;alter&nbsp;the&nbsp;code&nbsp;to<br>
define&nbsp;the&nbsp;mutex&nbsp;not&nbsp;in&nbsp;the&nbsp;imported&nbsp;tconstants&nbsp;but&nbsp;in&nbsp;the&nbsp;code<br>
directly:&lt;br&gt;<br>
&lt;br&gt;<br>
import&nbsp;threading&lt;br&gt;<br>
mutex&nbsp;=&nbsp;threading.RLock()&lt;br&gt;<br>
def&nbsp;setmutex():&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;mutex.acquire()&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&lt;br&gt;<br>
setmutex()&lt;br&gt;<br>
mutex.release()&lt;br&gt;<br>
&lt;br&gt;<br>
Will&nbsp;defining&nbsp;the&nbsp;mutex&nbsp;this&nbsp;way&nbsp;cause&nbsp;problems&nbsp;in&nbsp;proper&nbsp;threading<br>
control&nbsp;for&nbsp;mod_python&nbsp;in&nbsp;its&nbsp;interaction&nbsp;with&nbsp;Apache?&lt;br&gt;<br>
&lt;br&gt;<br>
Regards,&lt;br&gt;<br>
&lt;br&gt;<br>
John&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
