<tt>
Hi&nbsp;I'm&nbsp;experiencing&nbsp;some&nbsp;mod_python&nbsp;weirdness.&nbsp;I&nbsp;write&nbsp;a&nbsp;log&nbsp;in&nbsp;function&nbsp;that&nbsp;manages&nbsp;the&nbsp;user&nbsp;log&nbsp;in&nbsp;and&nbsp;session.&nbsp;The&nbsp;problem&nbsp;is&nbsp;that&nbsp;this&nbsp;function&nbsp;just&nbsp;manages&nbsp;the&nbsp;session&nbsp;and&nbsp;doesn't&nbsp;need&nbsp;to&nbsp;send&nbsp;anything&nbsp;to&nbsp;the&nbsp;browser.&nbsp;I&nbsp;read&nbsp;in&nbsp;the&nbsp;FAQ&nbsp;about&nbsp;the&nbsp;compulsive&nbsp;need&nbsp;by&nbsp;the&nbsp;handler&nbsp;to&nbsp;return&nbsp;something.&amp;nbsp;&nbsp;I&nbsp;followed&nbsp;the&nbsp;recommendation&nbsp;in&nbsp;the&nbsp;FAQ&nbsp;but&nbsp;it's&nbsp;like&nbsp;the&nbsp;browser&nbsp;just&nbsp;goes&nbsp;into&nbsp;limbo&nbsp;....&nbsp;it's&nbsp;like&nbsp;it&nbsp;just&nbsp;gets&nbsp;stuck&nbsp;...&nbsp;reading&nbsp;data,&nbsp;I&nbsp;don't&nbsp;get&nbsp;any&nbsp;errors&nbsp;through,&nbsp;nothing&nbsp;in&nbsp;the&nbsp;logs&nbsp;either.&nbsp;I&nbsp;wrote&nbsp;a&nbsp;small&nbsp;test&nbsp;function&nbsp;to&nbsp;see&nbsp;whats&nbsp;up.<br>
&lt;br&gt;&lt;br&gt;Marinus&lt;br&gt;&lt;br&gt;Code&nbsp;example&nbsp;below:&lt;br&gt;&lt;br&gt;def&nbsp;validate_session(req):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;&amp;quot;&amp;quot;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;this&nbsp;function&nbsp;must&nbsp;be&nbsp;called&nbsp;prior&nbsp;to&nbsp;all&nbsp;function&nbsp;to&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ensure&nbsp;that&nbsp;the&nbsp;user&nbsp;is&nbsp;autenticated&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;&amp;quot;&amp;quot;<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;get&nbsp;the&nbsp;session&nbsp;for&nbsp;this&nbsp;request&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session&nbsp;=&nbsp;Session.Session(req,&nbsp;secret&nbsp;=&nbsp;config.cookie_passwd)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;is&nbsp;this&nbsp;req&nbsp;from&nbsp;a&nbsp;new&nbsp;session&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;session.is_new():&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;util.redirect&nbsp;(req,&nbsp;<br>
config.base_url&nbsp;+&nbsp;'login.html')&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;session.has_key('auth'):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;session['auth']&nbsp;!=&nbsp;True:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;util.redirect&nbsp;(req,&nbsp;config.base_url&nbsp;+&nbsp;'login.html')&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;1&lt;br&gt;&lt;br&gt;def&nbsp;login&nbsp;(req,&nbsp;uid&nbsp;=&nbsp;None,&nbsp;passwd&nbsp;=&nbsp;None):<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;connect&nbsp;to&nbsp;the&nbsp;database&nbsp;an&nbsp;authenticate&nbsp;the&nbsp;user&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;quot;&amp;quot;&amp;quot;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session&nbsp;=&nbsp;Session.Session(req,&nbsp;secret&nbsp;=&nbsp;config.cookie_passwd)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;does&nbsp;this&nbsp;session&nbsp;have&nbsp;counter?&nbsp;Maby&nbsp;a&nbsp;new&nbsp;client<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;not&nbsp;session.has_key&nbsp;('count'):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session['count']&nbsp;=&nbsp;0&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session.save()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#db_uid,db_passwd&nbsp;=&nbsp;mplib.db_query_one&nbsp;('select&nbsp;uid,passwd&nbsp;from&nbsp;security')&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;db_uid&nbsp;=&nbsp;'test'&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;db_passwd&nbsp;=&nbsp;'test'<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;db_uid&nbsp;==&nbsp;uid&nbsp;and&nbsp;db_passwd&nbsp;==&nbsp;passwd:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session['uid']&nbsp;=&nbsp;db_uid&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session['count']&nbsp;=&nbsp;0&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session['auth']&nbsp;=&nbsp;True&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session.save()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#&nbsp;the&nbsp;handler&nbsp;is&nbsp;obsessed&nbsp;with&nbsp;returning&nbsp;something,&nbsp;give&nbsp;it&nbsp;something<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.content_type&nbsp;=&nbsp;'text/plain'&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;apache.OK&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#raise&nbsp;apache.SERVER_RETURN,&nbsp;apache.OK&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;else:&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session['count']&nbsp;+=&nbsp;1&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;if&nbsp;session['count']&nbsp;&amp;gt;=&nbsp;config.pass_fail:<br>
&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;#session.invalidate()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session.delete()&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;util.redirect(req,&nbsp;config.base_url&nbsp;+&nbsp;'logon_fail.html')&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session.save()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;util.redirect&nbsp;(req,&nbsp;config.base_url<br>
&nbsp;+&nbsp;'login.html')&lt;br&gt;&lt;br&gt;&lt;br&gt;def&nbsp;test(req):&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;validate_session(req)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;session&nbsp;=&nbsp;Session.Session(req,&nbsp;secret&nbsp;=&nbsp;config.cookie_passwd)&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.content_type&nbsp;=&nbsp;'text/plain'&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write<br>
('hello&nbsp;world\n')&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;req.write(&nbsp;'welcome&nbsp;%d\n'&nbsp;%&nbsp;(session['uid']&nbsp;))&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;return&nbsp;apache.OK&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;br&gt;<br>

</tt>
