<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;6.5.7233.28&quot;&gt;<br>
&lt;TITLE&gt;RE:&nbsp;[mod_python]&nbsp;Re:&nbsp;forks,&nbsp;daemons&nbsp;and&nbsp;other&nbsp;beasts&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Daniel&nbsp;Nogradi&nbsp;wrote:&lt;BR&gt;<br>
&amp;gt;&nbsp;users&nbsp;upload&nbsp;a&nbsp;zip&nbsp;file&nbsp;and&nbsp;should&nbsp;get&nbsp;an&nbsp;acknowledgement&lt;BR&gt;<br>
&amp;gt;&nbsp;that&nbsp;the&nbsp;upload&nbsp;was&nbsp;successful.&nbsp;The&nbsp;server&nbsp;should&nbsp;start&lt;BR&gt;<br>
&amp;gt;&nbsp;unpacking&nbsp;the&nbsp;archive,&nbsp;check&nbsp;if&nbsp;the&nbsp;files&nbsp;are&nbsp;okay&nbsp;and&lt;BR&gt;<br>
&amp;gt;&nbsp;move&nbsp;them&nbsp;to&nbsp;a&nbsp;directory.&nbsp;All&nbsp;of&nbsp;this&nbsp;can&nbsp;take&nbsp;quite&nbsp;long,&lt;BR&gt;<br>
&amp;gt;&nbsp;so&nbsp;the&nbsp;acknowledgement&nbsp;should&nbsp;be&nbsp;sent&nbsp;before&nbsp;this&lt;BR&gt;<br>
&amp;gt;&nbsp;unpacking/checking/moving&nbsp;finishes.&lt;BR&gt;<br>
&lt;BR&gt;<br>
and&nbsp;Graham&nbsp;Dumpleton&nbsp;replied:&lt;BR&gt;<br>
&amp;gt;&nbsp;The&nbsp;suggestion&nbsp;I&nbsp;gave&nbsp;wouldn't&nbsp;preclude&nbsp;an&nbsp;acknowledgement&lt;BR&gt;<br>
&amp;gt;&nbsp;being&nbsp;sent&nbsp;before&nbsp;the&nbsp;unpacking&nbsp;begins.&lt;BR&gt;<br>
&amp;gt;&lt;BR&gt;<br>
&amp;gt;&nbsp;Have&nbsp;you&nbsp;simply&nbsp;considered&nbsp;using&nbsp;a&nbsp;separate&nbsp;thread&nbsp;to&nbsp;do&nbsp;the&lt;BR&gt;<br>
&amp;gt;&nbsp;unpacking?&lt;BR&gt;<br>
&amp;gt;&nbsp;...&lt;BR&gt;<br>
&amp;gt;&nbsp;Using&nbsp;threads&nbsp;you&nbsp;wouldn't&nbsp;need&nbsp;to&nbsp;do&nbsp;an&nbsp;os.fork().&nbsp;Simply&lt;BR&gt;<br>
&amp;gt;&nbsp;create&nbsp;a&nbsp;new&nbsp;thread&nbsp;using&nbsp;the&nbsp;Python&nbsp;&amp;quot;threading&amp;quot;&nbsp;module&lt;BR&gt;<br>
&amp;gt;&nbsp;inside&nbsp;the&nbsp;Apache&nbsp;process&nbsp;to&nbsp;do&nbsp;the&nbsp;unpacking.&nbsp;You&nbsp;probably&lt;BR&gt;<br>
&amp;gt;&nbsp;just&nbsp;need&nbsp;to&nbsp;detach&nbsp;the&nbsp;thread&nbsp;so&nbsp;it&nbsp;finishes&nbsp;up&nbsp;properly&lt;BR&gt;<br>
&amp;gt;&nbsp;and&nbsp;doesn't&nbsp;need&nbsp;another&nbsp;thread&nbsp;to&nbsp;wait&nbsp;on&nbsp;it&nbsp;to&nbsp;finish.&lt;BR&gt;<br>
&lt;BR&gt;<br>
If&nbsp;you're&nbsp;using&nbsp;a&nbsp;multi-threaded&nbsp;MPM,&nbsp;you&nbsp;might&nbsp;not&nbsp;even&nbsp;want&nbsp;to&nbsp;detach&nbsp;it.&nbsp;It&nbsp;can&nbsp;be&nbsp;useful&nbsp;to&nbsp;let&nbsp;Apache&nbsp;return&nbsp;a&nbsp;&amp;quot;server&nbsp;unavailable&amp;quot;&nbsp;(503)&nbsp;response&nbsp;if&nbsp;all&nbsp;of&nbsp;your&nbsp;threads&nbsp;are&nbsp;busy&nbsp;unzipping&nbsp;files.&nbsp;If&nbsp;you're&nbsp;using&nbsp;a&nbsp;multi-process&nbsp;MPM,&nbsp;you&nbsp;might&nbsp;just&nbsp;do&nbsp;it&nbsp;in&nbsp;the&nbsp;same&nbsp;process&nbsp;to&nbsp;achieve&nbsp;the&nbsp;same&nbsp;effect.&lt;BR&gt;<br>
&lt;BR&gt;<br>
The&nbsp;thread&nbsp;or&nbsp;process&nbsp;won't&nbsp;die&nbsp;just&nbsp;because&nbsp;the&nbsp;client&nbsp;closes&nbsp;the&nbsp;connection.&nbsp;Right&nbsp;away,&nbsp;I'd&nbsp;give&nbsp;them&nbsp;the&nbsp;option:&nbsp;&amp;quot;Thanks&nbsp;for&nbsp;the&nbsp;file!&nbsp;It's&nbsp;being&nbsp;unzipped&nbsp;and&nbsp;processed&nbsp;now.&nbsp;You&nbsp;can&nbsp;trust&nbsp;me&nbsp;and&nbsp;close&nbsp;your&nbsp;browser,&nbsp;or&nbsp;wait&nbsp;for&nbsp;a&nbsp;final&nbsp;confirmation&nbsp;message&nbsp;when&nbsp;I'm&nbsp;done.&amp;quot;&nbsp;Then,&nbsp;when&nbsp;the&nbsp;long&nbsp;process&nbsp;is&nbsp;done,&nbsp;write&nbsp;out&nbsp;the&nbsp;&amp;quot;final&nbsp;confirmation&nbsp;message&amp;quot;&nbsp;whether&nbsp;they're&nbsp;connected&nbsp;or&nbsp;not--Apache&nbsp;won't&nbsp;choke&nbsp;on&nbsp;that&nbsp;if&nbsp;they've&nbsp;left.&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
Robert&nbsp;Brewer&lt;BR&gt;<br>
System&nbsp;Architect&lt;BR&gt;<br>
Amor&nbsp;Ministries&lt;BR&gt;<br>
fumanchu@amor.org&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
