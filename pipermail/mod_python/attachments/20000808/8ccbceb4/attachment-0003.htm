<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;3.2//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;META&nbsp;NAME=&quot;Generator&quot;&nbsp;CONTENT=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version&nbsp;5.5.2651.75&quot;&gt;<br>
&lt;TITLE&gt;mod_python&nbsp;/&nbsp;win32all&nbsp;and&nbsp;COM&lt;/TITLE&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Hi,&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Is&nbsp;there&nbsp;an&nbsp;FAQ&nbsp;on&nbsp;using&nbsp;mod_python&nbsp;with&nbsp;COM?&nbsp;It&nbsp;seems&nbsp;that&nbsp;I&nbsp;am&nbsp;having&nbsp;problems&nbsp;due&nbsp;to&nbsp;the&nbsp;threaded&nbsp;nature&nbsp;of&nbsp;Apache&nbsp;on&nbsp;win32&nbsp;and&nbsp;it's&nbsp;interaction&nbsp;with&nbsp;COM.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;I&nbsp;have&nbsp;created&nbsp;an&nbsp;interface&nbsp;to&nbsp;some&nbsp;COM&nbsp;objects&nbsp;using&nbsp;the&nbsp;&amp;quot;makepy.py&amp;quot;&nbsp;program&nbsp;which&nbsp;comes&nbsp;with&nbsp;win32all.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;When&nbsp;I&nbsp;run&nbsp;Apache&nbsp;with&nbsp;ThreadsPerChild&nbsp;set&nbsp;to&nbsp;1,&nbsp;everything&nbsp;runs&nbsp;fine&nbsp;(albeit&nbsp;with&nbsp;only&nbsp;one&nbsp;client),&nbsp;but&nbsp;when&nbsp;I&nbsp;set&nbsp;this&nbsp;to&nbsp;something&nbsp;higher,&nbsp;I&nbsp;get&nbsp;errors&nbsp;saying&nbsp;&amp;quot;CoInitialise()&nbsp;has&nbsp;not&nbsp;been&nbsp;called&amp;quot;,&nbsp;which&nbsp;I&nbsp;assume&nbsp;are&nbsp;related&nbsp;to&nbsp;Apache&nbsp;spawning&nbsp;multiple&nbsp;threads.&nbsp;I've&nbsp;attached&nbsp;the&nbsp;output&nbsp;below.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Mod_python&nbsp;error:&nbsp;&amp;quot;PythonHandler&nbsp;pytest&amp;quot;Traceback&nbsp;(innermost&nbsp;last):&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;h:\website\python\mod_python\apache.py&amp;quot;,&nbsp;line&nbsp;119,&nbsp;in&nbsp;Dispatch&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;result&nbsp;=&nbsp;object(req)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;h:/website/htdocs/test\pytest.py&amp;quot;,&nbsp;line&nbsp;8,&nbsp;in&nbsp;handler&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;d&nbsp;=&nbsp;Snakey.Database.RiskReporterDatabase()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;H:\WebSite\Python\Snakey\Database.py&amp;quot;,&nbsp;line&nbsp;32,&nbsp;in&nbsp;__init__&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.openConnection(&amp;quot;DSN=RISK_REPORTER&amp;quot;)&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;H:\WebSite\Python\Snakey\Database.py&amp;quot;,&nbsp;line&nbsp;20,&nbsp;in&nbsp;openConnection&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;self.connection&nbsp;=&nbsp;msado21.Connection()&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;&amp;nbsp;&nbsp;File&nbsp;&amp;quot;H:\PythonDev\Snakey\msado21.py&amp;quot;,&nbsp;line&nbsp;1607,&nbsp;in&nbsp;__init__&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;com_error:&nbsp;(-2147221008,&nbsp;'CoInitialize&nbsp;has&nbsp;not&nbsp;been&nbsp;called.',&nbsp;None,&nbsp;None)&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;If&nbsp;anyone&nbsp;has&nbsp;a&nbsp;suggestion&nbsp;on&nbsp;what&nbsp;is&nbsp;happening,&nbsp;or&nbsp;pointers&nbsp;to&nbsp;some&nbsp;information&nbsp;on&nbsp;using&nbsp;mod_python&nbsp;and&nbsp;COM,&nbsp;it&nbsp;would&nbsp;be&nbsp;appreciated.&lt;/FONT&gt;&lt;/P&gt;<br>
<br>
&lt;P&gt;&lt;FONT&nbsp;SIZE=2&gt;Thanks,&lt;/FONT&gt;<br>
&lt;BR&gt;&lt;FONT&nbsp;SIZE=2&gt;Rob.&lt;/FONT&gt;<br>
&lt;/P&gt;<br>
<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;
</tt>
