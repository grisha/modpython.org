<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Windows performance problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Windows%20performance%20problem&In-Reply-To=6543521a0805311050n75794f45x46711e82226136c8%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="025327.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Windows performance problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Windows%20performance%20problem&In-Reply-To=6543521a0805311050n75794f45x46711e82226136c8%40mail.gmail.com"
       TITLE="[mod_python] Windows performance problem">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Jun  1 21:49:25 EDT 2008</I>
    <P><UL>
        
        <LI>Next message: <A HREF="025327.html">[mod_python] Windows performance problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25325">[ date ]</a>
              <a href="thread.html#25325">[ thread ]</a>
              <a href="subject.html#25325">[ subject ]</a>
              <a href="author.html#25325">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2008/6/1 William Chapman &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jeddahbill at gmail.com</A>&gt;:
&gt;<i> I'm new to this list, but have been using mod_python successfully for three
</I>&gt;<i> years in a web app served by both Linux (Ubuntu) and Windows (XP sp2 32bit
</I>&gt;<i> AND 64bit).  I use two hosts to serve: one for testing (semi-public); one
</I>&gt;<i> for development.  Both hosts are dual-boot (Linux/Windows) and will serve
</I>&gt;<i> the identical web app installation from the same (NTFS file system)
</I>&gt;<i> directories.
</I>&gt;<i>
</I>&gt;<i> My problems started when the development host went belly-up and I rebuilt
</I>&gt;<i> the computer.  The Windows installation was upgraded (?) from 32bit to 64bit
</I>&gt;<i> XP sp2.  (I don't know if going to x64 Windows is part of the problem; I
</I>&gt;<i> doubt it.)  Upon bringing up the new development host, all went well with
</I>&gt;<i> the Linux side, but under Windows, the web app is perfroming poorly.  The
</I>&gt;<i> application accesses take much too long.  Historically, the Windows &amp; Linux
</I>&gt;<i> installations were comparable, and I never had performance complaints.  Now,
</I>&gt;<i> the new Windows installation is 5x to 10x slower than previously.  To
</I>&gt;<i> emphasize, the mod_python is &quot;working,&quot; but very slowly, and comletely
</I>&gt;<i> unlike my previous experience with Windows/Apache/mod_python, not to mention
</I>&gt;<i> my current testing host which is fine.
</I>
Have you tested speed of serving static files? That is, is it a
mod_python specific problem or a problem with Apache as a whole?

&gt;<i> The setup (all installed from binaries):
</I>&gt;<i> Windows XP x64 sp2
</I>&gt;<i> apache 2.2.8
</I>&gt;<i> mod_python 3.3.1
</I>&gt;<i> Python 2.5.2 (installed separately)
</I>&gt;<i>
</I>&gt;<i> Note:  I am not exactly sure of the order in which I installed
</I>&gt;<i> Apache/mod_python &amp; Python 2.5.  Could this matter?
</I>&gt;<i> I did uninstall and reinstall mod_python but performance/symptoms didn't
</I>&gt;<i> seem to change.
</I>&gt;<i>
</I>&gt;<i> The only clues:
</I>&gt;<i> Three lines together from apache error.log (long lines - STRETCH BROWSER)
</I>&gt;<i> (file also attached) (also see Graham's email here.):
</I>&gt;<i> [Fri May 30 17:38:57 2008] [error] python_init: Python version mismatch,
</I>&gt;<i> expected '2.5', found '2.5.2'.
</I>&gt;<i> [Fri May 30 17:38:58 2008] [error] python_init: Python executable found
</I>&gt;<i> 'C:\\Program Files (x86)\\Apache Software
</I>&gt;<i> Foundation\\Apache2.2\\bin\\httpd.exe'.
</I>&gt;<i> [Fri May 30 17:38:58 2008] [error] python_init: Python path being used
</I>&gt;<i> 'C:\\WINDOWS\\system32\\python25.zip;C:\\Python25\\Lib;C:\\Python25\\DLLs;C:\\Python25\\Lib\\lib-tk;;C:\\Program
</I>&gt;<i> Files (x86)\\Apache Software Foundation\\Apache2.2\\bin'.
</I>&gt;<i>
</I>&gt;<i> I have read several of the threads from the list on this subject and am
</I>&gt;<i> confused about the following points:
</I>&gt;<i> (1) In the &quot;Python version mismatch&quot; error, the &quot;found&quot; version matches the
</I>&gt;<i> version of Python I installed on the Windows machine.  mod_python &quot;expected
</I>&gt;<i> 2.5&quot;.  Where is that supposed to come from?  I could not find Python 2.5 at
</I>&gt;<i> <A HREF="http://python.org.">http://python.org.</A>
</I>
You obviously used a prebuilt version of mod_python for Windows. That
prebuilt version used Python 2.5 when compiled. That is what it means.

&gt;<i> (2) Apparently the &quot;Python version mismatch&quot; error message is not enough to
</I>&gt;<i> stop mod_python from working, because it is &quot;working.&quot;
</I>
On Windows, because Python is obtained via a DLL, the warning can be
ignored as APIs will be compatible. In other words, doesn't matter
that mod_python was originally compiled for older patch revision.

&gt;<i> (3) The &quot;Python executable found&quot; error message points to
</I>&gt;<i> &quot;...\\Apache2.2\\bin\\httpd.exe&quot;  This does not look like a &quot;Python
</I>&gt;<i> executable.&quot;  (?)
</I>
Outputing this was thought to be a good idea, but not actually of much
use. What it is simply showing is that Python is running embedded
inside of Apache httpd executable. In other words, not standalone
python.exe.

&gt;<i> (4) The &quot;Python path being used&quot; error message specifies a series of paths.
</I>&gt;<i> Where do those paths come from?  Can I affect those values?
</I>
To a degree. See PythonPath directive, although changes may with this
may not show up in startup messages as they are applied later. You can
also change it by fiddling Windows registry, but you shouldn't do that
if you can help it.

&gt;<i> Taken as a
</I>&gt;<i> whole it doesn't match the system path environment variable I'm able to set
</I>&gt;<i> as a Windows user.
</I>
This is not the PATH variable, it is related to Python module search path.

&gt;<i> Random thought: I always thought that mod_python included an embedded Python
</I>&gt;<i> interpreter, but reading suggests mod_python links to Python libraries.
</I>
Both observations are true. Python is used in embedded mode, but code
comes from DLL.

&gt;<i> My analysis:  I suspect that the principle benefit of a mod_python
</I>&gt;<i> installation is not being realized.  It seems that the interpreter is having
</I>&gt;<i> to be restarted for each access.  Is there another explanation for the poor
</I>&gt;<i> performance?
</I>
Your understanding is wrong. A new interpreter is not created on each request.

There is obviously still something wrong with your configuration or
perhaps with the web application which only manifests with this
configuration.

Start out by seeing if Apache as a whole is working okay by testing
static file serving.

Graham


&gt;<i> At any rate I would greatly appreciate any suggestions or insights you might
</I>&gt;<i> have!!
</I>&gt;<i>
</I>&gt;<i> With many thanks,
</I>&gt;<i> -- Bill Chapman
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="025327.html">[mod_python] Windows performance problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25325">[ date ]</a>
              <a href="thread.html#25325">[ thread ]</a>
              <a href="subject.html#25325">[ subject ]</a>
              <a href="author.html#25325">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
