<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Trouble importing files through mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20importing%20files%20through%20mod_python&In-Reply-To=a89a6a430806021258u52cc6ceeu5458a92998f025c%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="025331.html">
   <LINK REL="Next"  HREF="025334.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Trouble importing files through mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Dominique.Holzwarth at ch.delarue.com</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20importing%20files%20through%20mod_python&In-Reply-To=a89a6a430806021258u52cc6ceeu5458a92998f025c%40mail.gmail.com"
       TITLE="[mod_python] Trouble importing files through mod_python">Dominique.Holzwarth at ch.delarue.com
       </A><BR>
    <I>Tue Jun  3 02:39:08 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="025331.html">[mod_python] Trouble importing files through mod_python
</A></li>
        <LI>Next message: <A HREF="025334.html">[mod_python] Trouble importing files through mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25333">[ date ]</a>
              <a href="thread.html#25333">[ thread ]</a>
              <a href="subject.html#25333">[ subject ]</a>
              <a href="author.html#25333">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Importing packaged/modules under mod_python is a little bit complicated (imo) cause mod_python tries to make a difference between then standard system python search path and a own, mod_python specific search path for modules.
For full reference of the problem see: <A HREF="http://www.modpython.org/pipermail/mod_python/2006-November/022726.html">http://www.modpython.org/pipermail/mod_python/2006-November/022726.html</A>

As a quick (but not complete) summary here's what I've used so far:

1. put your packages as &quot;normal&quot; python packages under &lt;python-dir&gt;/Lib/site-packages, then you can import them the same way as you would do with the console. However, if anything changes, you need to restart apache (takes like 1 sec ;-))

2. put your packages under the apache (python-) document root. If you configured apache to search for *.py files under ../htdocs/python and your packages are inside that directory then you can import them like this:

from mod_python import apache
someName = apache.import_module(~/package-name/module-name.py)

Note that &quot;someName&quot; can be choosen whatever you want. The &quot;~&quot; points to the python document root.
Using that method you don't need a __init__.py file to reflect the package structure btw. Also, using this method changes inside the packages are reloaded on-the-fly by apache without the need to restart it. It is however possible to access the *.py files through the web if apache is not properly configured (not sure if you can hide them fully tbh).

3. put your packages ANYWHERE outside the apache document root AND outside of site-packages.
In this case you need to set the mod_python importer path. Packages/modules in this path aren't automaticly reloaded, so after a change, you need to restart apache:

PythonOption mod_python.importer.path &quot;['some/path/to/my/Module.py', 'some/other/path/to/a/directory/with/modules']&quot;

This statement goes into apache configuration file (httpd.conf or .htsomething ;-))
Importing these packages/modules should work the same as you do from within the console. I'm not totally sure about that tho as I used this method only to import modules - never packages (so I'm not sure wether &quot;import package.subpackage.module&quot; works...)

Greetings
dominique

&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">hungrybackspace at gmail.com</A> [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">hungrybackspace at gmail.com</A>]
</I>&gt;<i> Sent: Montag, 2. Juni 2008 21:59
</I>&gt;<i> To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> Subject: [mod_python] Trouble importing files through mod_python
</I>&gt;<i>
</I>&gt;<i> Greetings,
</I>&gt;<i>
</I>&gt;<i> We're having a bit of a time importing modules that aren't in
</I>&gt;<i> the standard library while using mod_python on this
</I>&gt;<i> particular server.  We have had, however, success with other
</I>&gt;<i> servers.  We're trying to run a tiny application that looks like this:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> on the console side:
</I>&gt;<i> ~/scratch/
</I>&gt;<i>           RunImportTest.py
</I>&gt;<i>           __init__.py
</I>&gt;<i>           ImportTest/
</I>&gt;<i>                      ImportTest.py
</I>&gt;<i>                      __init__.py
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ...and the web side:
</I>&gt;<i> /home/httpd/html/beta/
</I>&gt;<i>                       RunImportTestModPython.py
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Below, the contents of the three files:
</I>&gt;<i>
</I>&gt;<i> RunImportTest.py:
</I>&gt;<i> =================
</I>&gt;<i> from ImportTest.ImportTest import TEST_CONSTANT
</I>&gt;<i>
</I>&gt;<i> print TEST_CONSTANT
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> RunImportTestModPython.py:
</I>&gt;<i> ==========================
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> from ImportTest.ImportTest import TEST_CONSTANT
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i>     req.content_type = 'text/plain'
</I>&gt;<i>     req.write(TEST_CONSTANT)
</I>&gt;<i>     return apache.OK
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ImportTest/ImportTest.py:
</I>&gt;<i> =========================
</I>&gt;<i> TEST_CONSTANT = &quot;success&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Output from the import test from command line:
</I>&gt;<i> ~/scratch&gt; python RunImportTest.py
</I>&gt;<i> success
</I>&gt;<i>
</I>&gt;<i> So we know the little program does indeed work.  Here is the
</I>&gt;<i> output from Apache via mod_python:
</I>&gt;<i>
</I>&gt;<i> ========================
</I>&gt;<i> MOD_PYTHON ERROR
</I>&gt;<i>
</I>&gt;<i> ProcessId:      18704
</I>&gt;<i> Interpreter:    'beta.company.com'
</I>&gt;<i>
</I>&gt;<i> ServerName:     'beta.company.com'
</I>&gt;<i> DocumentRoot:   '/home/httpd/html/beta'
</I>&gt;<i>
</I>&gt;<i> URI:            '/RunImportTestModPython.py'
</I>&gt;<i> Location:       None
</I>&gt;<i> Directory:      '/home/httpd/html/beta/'
</I>&gt;<i> Filename:       '/home/httpd/html/beta/RunImportTestModPython.py'
</I>&gt;<i> PathInfo:       ''
</I>&gt;<i>
</I>&gt;<i> Phase:          'PythonHandler'
</I>&gt;<i> Handler:        'RunImportTestModPython'
</I>&gt;<i>
</I>&gt;<i> Traceback (most recent call last):
</I>&gt;<i>
</I>&gt;<i>   File
</I>&gt;<i> &quot;/usr/local/lib/python2.5/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 1537, in HandlerDispatch
</I>&gt;<i>     default=default_handler, arg=req, silent=hlist.silent)
</I>&gt;<i>
</I>&gt;<i>   File
</I>&gt;<i> &quot;/usr/local/lib/python2.5/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 1202, in _process_target
</I>&gt;<i>     module = import_module(module_name, path=path)
</I>&gt;<i>
</I>&gt;<i>   File
</I>&gt;<i> &quot;/usr/local/lib/python2.5/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 296, in import_module
</I>&gt;<i>     log, import_path)
</I>&gt;<i>
</I>&gt;<i>   File
</I>&gt;<i> &quot;/usr/local/lib/python2.5/site-packages/mod_python/importer.py&quot;,
</I>&gt;<i> line 680, in import_module
</I>&gt;<i>     execfile(file, module.__dict__)
</I>&gt;<i>
</I>&gt;<i>   File &quot;/home/httpd/html/beta/RunImportTestModPython.py&quot;,
</I>&gt;<i> line 2, in &lt;module&gt;
</I>&gt;<i>     from ImportTest.ImportTest import TEST_CONSTANT
</I>&gt;<i>
</I>&gt;<i> ImportError: No module named ImportTest.ImportTest
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> MODULE CACHE DETAILS
</I>&gt;<i>
</I>&gt;<i> Accessed:       Mon Jun  2 14:21:49 2008
</I>&gt;<i> Generation:     0
</I>&gt;<i>
</I>&gt;<i> _mp_df6c4429391f4fb65dc56704a2c1e0e2 {
</I>&gt;<i>   FileName:     '/home/httpd/html/beta/RunImportTestModPython.py'
</I>&gt;<i>   Instance:     1 [IMPORT]
</I>&gt;<i>   Generation:   0 [ERROR]
</I>&gt;<i>   Modified:     Mon Jun  2 11:49:11 2008
</I>&gt;<i> }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ...and here's an .htaccess file we're using in the directory
</I>&gt;<i> /home/httpd/html/beta, the directory that RunImportTestModPython.py is
</I>&gt;<i> in:
</I>&gt;<i> =========================
</I>&gt;<i> Options Indexes FollowSymLinks MultiViews AddHandler
</I>&gt;<i> mod_python .py PythonDebug On PythonHandler
</I>&gt;<i> RunImportTestModPython PythonAutoReload On PythonPath
</I>&gt;<i> &quot;['/home/me/scratch', '/home/me/scratch/ImportTest',
</I>&gt;<i> '/usr/lib/python2.5/', '/usr/lib/python2.5/lib-dynload/',
</I>&gt;<i> '/usr/lib/python2.5/site-packages/']&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ...where /home/me is the user directory referenced at the top
</I>&gt;<i> of the message.
</I>&gt;<i>
</I>&gt;<i> It's quite likely we're overlooking something very
</I>&gt;<i> simple--but this same setup works without hitch on another
</I>&gt;<i> system (granted, versions of OS, Apache, mod_python and
</I>&gt;<i> Python are slightly different...).  This non-functioning setup is:
</I>&gt;<i>
</I>&gt;<i> * CentOS 5
</I>&gt;<i> * Apache 2.2.8
</I>&gt;<i> * PHP 5.2.6
</I>&gt;<i> * Python 2.5.2
</I>&gt;<i> * mod_python 3.3.1
</I>&gt;<i> * cx_oracle 4.3.3
</I>&gt;<i>
</I>&gt;<i> some of those are kind of irrelevant for the specific
</I>&gt;<i> application here, but there might be hidden conflicts that
</I>&gt;<i> I'm not aware of. I have read some stuff about using
</I>&gt;<i> mod_python's native import methods, and I'd very much like to
</I>&gt;<i> use the standard python import method instead, as it
</I>&gt;<i> preserves command-line execution without having to add a lot
</I>&gt;<i> of overhead.  And in fact, I shouldn't have to because this
</I>&gt;<i> setup works on another server.  Unfortunately, I can't simply
</I>&gt;<i> use the other server...
</I>&gt;<i>
</I>&gt;<i> Hope this isn't all too much information--I'm very grateful
</I>&gt;<i> for any help anyone may provide.
</I>&gt;<i>
</I>&gt;<i> many thanks,
</I>&gt;<i> MC
</I>&gt;<i>
</I>&gt;<i>
</I>
*****************************************************************************
This e-mail and any files attached are strictly confidential, may be legally
privileged and are intended solely for the addressee. If you are not the
intended recipient please notify the sender immediately by return email and
then delete the e-mail and any attachments immediately.

The views and or opinions expressed in this e-mail are not necessarily the
views of De La Rue plc or any of its subsidiaries and the De La Rue Group
of companies, their directors, officers and employees make no representation
about and accept no liability for its accuracy or completeness.

You should ensure that you have adequate virus protection as the De La Rue
Group of companies do not accept liability for any viruses.

De La Rue plc Registered No.3834125, De La Rue Holdings plc Registered
No 58025 and De La Rue International Limited Registered No 720284 are all
registered in England with their registered office at:
De La Rue House, Jays Close, Viables, Hampshire RG22 4BS
*****************************************************************************


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="025331.html">[mod_python] Trouble importing files through mod_python
</A></li>
	<LI>Next message: <A HREF="025334.html">[mod_python] Trouble importing files through mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#25333">[ date ]</a>
              <a href="thread.html#25333">[ thread ]</a>
              <a href="subject.html#25333">[ subject ]</a>
              <a href="author.html#25333">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
