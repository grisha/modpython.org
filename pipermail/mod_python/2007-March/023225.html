<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP Templating
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20Templating&In-Reply-To=1EC86F27-05B6-403C-803F-760ECC88D708%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023224.html">
   <LINK REL="Next"  HREF="023226.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP Templating</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20Templating&In-Reply-To=1EC86F27-05B6-403C-803F-760ECC88D708%40gmail.com"
       TITLE="[mod_python] PSP Templating">jpg at jgassociates.ca
       </A><BR>
    <I>Thu Mar  1 11:49:26 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023224.html">[mod_python] PSP Templating
</A></li>
        <LI>Next message: <A HREF="023226.html">[mod_python] PSP Templating
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23225">[ date ]</a>
              <a href="thread.html#23225">[ thread ]</a>
              <a href="subject.html#23225">[ subject ]</a>
              <a href="author.html#23225">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>John Ruff wrote:
&gt;<i> Thanks Olaf.  Is this a new requirement?  It's not mentioned in the PSP 
</I>&gt;<i> 3.3 docs example for templating.  Also, I didn't see this issue when 
</I>&gt;<i> previously using 3.2.10.
</I>
Were you using *exactly* the same code? If so I'm surprised it worked 
before.

Some of what you are seeing is the result of the way you are using 
mod_python.publisher, rather than a psp issue. First, don't return 
apache.OK from your hello() function. Publisher looks after the apache 
return code for you internally. Publisher will convert whatever is 
returned by the function to a string and write it to the client. If 
req.content_type is not set publisher will examine whatever is returned 
and make a best effort to guess the correct content_type, and in this 
case guesses wrong. You real content is being written directly by the 
run() method of your PSP instance. In this case you must explicitly set 
the content type. Note that if you were using the mod_python.psp handler 
directly it would have guessed the correct content type and all would 
have well.

As for the extra html being written... I have no idea what is going on 
as I can't reproduce that result using the code snippet you've given. 
For me it just returns:

&lt;html&gt;
&lt;body&gt;
     &lt;h1&gt;Hello, there!&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
0

Jim


&gt;<i> Thanks.
</I>&gt;<i> ___________________
</I>&gt;<i> John Ruff
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jcruff at gmail.com</A>
</I>&gt;<i> GPG Key: 0x1F691195
</I>&gt;<i> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
</I>&gt;<i> 
</I>&gt;<i> &quot;No one can see past a choice they don't understand.&quot; --The Oracle
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mar 1, 2007, at 10:13 AM, Olaf Stein wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Add
</I>&gt;&gt;<i> req.content_type = 'text/html'
</I>&gt;&gt;<i> Before your tmpl.run(vars = {'greet':s})
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Olaf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 3/1/07 9:40 AM, &quot;John Ruff&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jcruff at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm trying to understand what I'm doing wrong.  I'm using mod_python
</I>&gt;&gt;&gt;<i> 3.3.1 with apache 2.2.4.  The situation is that while trying to use
</I>&gt;&gt;&gt;<i> PSP as a templating engine, none of the examples work.  Yet normal
</I>&gt;&gt;&gt;<i> 'SetHandler mod_python' with inline html works no problem.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I have the following:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &lt;Directory &quot;/home/&lt;user-dir&gt;/Sites/python&quot;&gt;
</I>&gt;&gt;&gt;<i>      SetHandler mod_python
</I>&gt;&gt;&gt;<i>      PythonHandler mod_python.publisher
</I>&gt;&gt;&gt;<i>      PythonOption mod_python.psp.cache_database_filename &quot;/tmp/
</I>&gt;&gt;&gt;<i> pspcache.dbm&quot;
</I>&gt;&gt;&gt;<i>      PythonDebug On
</I>&gt;&gt;&gt;<i> &lt;/Directory&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ====hello.py====
</I>&gt;&gt;&gt;<i> from mod_python import apache, psp
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> def hello(req):
</I>&gt;&gt;&gt;<i>      s = 'Hello, there!'
</I>&gt;&gt;&gt;<i>      tmpl = psp.PSP(req, filename = 'hello.tmpl')
</I>&gt;&gt;&gt;<i>      tmpl.run(vars = {'greet':s})
</I>&gt;&gt;&gt;<i>      return apache.OK
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ====hello.tmpl====
</I>&gt;&gt;&gt;<i> &lt;html&gt;
</I>&gt;&gt;&gt;<i> &lt;body&gt;
</I>&gt;&gt;&gt;<i>      &lt;h1&gt;&lt;%=greet%&gt;&lt;/h1&gt;
</I>&gt;&gt;&gt;<i> &lt;/body&gt;
</I>&gt;&gt;&gt;<i> &lt;/html&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Still, I'm presented with a webpage that's raw html of what would
</I>&gt;&gt;&gt;<i> have been generated.  When using firefox's Web Developer toolbar to
</I>&gt;&gt;&gt;<i> see the generated source I can see that my html has been surrounded
</I>&gt;&gt;&gt;<i> by an '&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;...&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;' block.
</I>&gt;&gt;&gt;<i> So it looks like this:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> [snip]
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;&amp;lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD
</I>&gt;&gt;&gt;<i> XHTML 1.0 Strict//EN&quot;
</I>&gt;&gt;&gt;<i>      &quot;<A HREF="http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&amp;gt;">http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&amp;gt;</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &amp;lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml&quot;">http://www.w3.org/1999/xhtml&quot;</A> xml:lang=&quot;en&quot;
</I>&gt;&gt;&gt;<i> lang=&quot;en&quot;&amp;gt;
</I>&gt;&gt;&gt;<i> &amp;lt;head&amp;gt;
</I>&gt;&gt;&gt;<i>      &amp;lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;
</I>&gt;&gt;&gt;<i> charset=utf-8&quot;/&amp;gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>      &amp;lt;title&amp;gt;hello&amp;lt;/title&amp;gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &amp;lt;/head&amp;gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &amp;lt;body&amp;gt;
</I>&gt;&gt;&gt;<i>      &amp;lt;h1&amp;gt;Hello, there!&amp;lt;/h1&amp;gt;
</I>&gt;&gt;&gt;<i> &amp;lt;/body&amp;gt;
</I>&gt;&gt;&gt;<i> &amp;lt;/html&amp;gt;
</I>&gt;&gt;&gt;<i> &lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> [/snip]
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Any ideas why this is happening?
</I>&gt;&gt;&gt;<i> ___________________
</I>&gt;&gt;&gt;<i> John Ruff
</I>&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jcruff at gmail.com</A>
</I>&gt;&gt;&gt;<i> GPG Key: 0x1F691195
</I>&gt;&gt;&gt;<i> FGPR: 6B50 37C9 10F9 6C4A D381  54B8 319D 7DD9 1F69 1195
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &quot;No one can see past a choice they don't understand.&quot; --The Oracle
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Mod_python mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -------------------------
</I>&gt;&gt;<i> Olaf Stein
</I>&gt;&gt;<i> DBA
</I>&gt;&gt;<i> Center for Quantitative and Computational Biology
</I>&gt;&gt;<i> Columbus Children's Research Institute
</I>&gt;&gt;<i> 700 Children's Drive
</I>&gt;&gt;<i> phone: 1-614-355-5685
</I>&gt;&gt;<i> cell: 1-614-843-0432
</I>&gt;&gt;<i> email: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">steino at ccri.net</A>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> 
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023224.html">[mod_python] PSP Templating
</A></li>
	<LI>Next message: <A HREF="023226.html">[mod_python] PSP Templating
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23225">[ date ]</a>
              <a href="thread.html#23225">[ thread ]</a>
              <a href="subject.html#23225">[ subject ]</a>
              <a href="author.html#23225">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
