<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Processing Dynamic Forms
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Processing%20Dynamic%20Forms&In-Reply-To=a595de7a0703210827u6744ca0fg83bd1f0c0613e674%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023316.html">
   <LINK REL="Next"  HREF="023317.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Processing Dynamic Forms</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Processing%20Dynamic%20Forms&In-Reply-To=a595de7a0703210827u6744ca0fg83bd1f0c0613e674%40mail.gmail.com"
       TITLE="[mod_python] Processing Dynamic Forms">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed Mar 21 16:09:58 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023316.html">[mod_python] Processing Dynamic Forms
</A></li>
        <LI>Next message: <A HREF="023317.html">[mod_python] XAMPP with mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23318">[ date ]</a>
              <a href="thread.html#23318">[ thread ]</a>
              <a href="subject.html#23318">[ subject ]</a>
              <a href="author.html#23318">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 22/03/07, Clodoaldo &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">clodoaldo.pinto.neto at gmail.com</A>&gt; wrote:
&gt;<i> 2007/3/21, Scott White &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">scott.w.white at gmail.com</A>&gt;:
</I>&gt;<i> &gt; I have my template &amp; request handler written &amp; working but I appear to only
</I>&gt;<i> &gt; be able to declare variables for my post method there are declared in my
</I>&gt;<i> &gt; form.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Example template:
</I>&gt;<i> &gt; &lt;form
</I>&gt;<i> &gt;   &lt;input id=&quot;custId&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Example handler:
</I>&gt;<i> &gt; def post(req, custId
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; However I have n number of custIds in a format: custId_01, 02, etc.
</I>&gt;<i> &gt; Therefore I'd like to be able to process all form variables so I can iterate
</I>&gt;<i> &gt; through them as there are too many to declare.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; How would I handle this?   I looked at the req object but didn't any form
</I>&gt;<i> &gt; related variables.
</I>&gt;<i>
</I>&gt;<i> If you had this HTML:
</I>&gt;<i>
</I>&gt;<i> &lt;html&gt;&lt;body&gt;
</I>&gt;<i> &lt;form action=&quot;multifield.py&quot; method=&quot;post&quot;&gt;
</I>&gt;<i> &lt;input name=&quot;cust_id&quot; type=&quot;text&quot;&gt;
</I>&gt;<i> &lt;input name=&quot;cust_id&quot; type=&quot;text&quot;&gt;
</I>&gt;<i> &lt;input name=&quot;cust_id&quot; type=&quot;text&quot;&gt;
</I>&gt;<i> &lt;input name=&quot;cust_id&quot; type=&quot;text&quot;&gt;
</I>&gt;<i> &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
</I>&gt;<i> &lt;/form&gt;
</I>&gt;<i> &lt;/body&gt;&lt;/html&gt;
</I>&gt;<i>
</I>&gt;<i> You could get all cust_id named fields with this publisher function:
</I>&gt;<i>
</I>&gt;<i> def index(req):
</I>&gt;<i>    cust_id = req.form.getlist('cust_id')
</I>&gt;<i>    return &quot;&quot;&quot;\
</I>&gt;<i>    &lt;html&gt;&lt;body&gt;
</I>&gt;<i>    &lt;p&gt;%s&lt;/p&gt;
</I>&gt;<i>    &lt;/body&gt;&lt;/html&gt;
</I>&gt;<i>    &quot;&quot;&quot; % ', '.join(cust_id)
</I>
Although accessing the form in that way always guarantees a list, one
could also just say:

  def index(req, cust_id):
    if type(cust_id) != type([]):
      cust_id = [cust_id]
    for id in cust_id:
      ...

This is because where a field is non repeating it is passed as single
value. If the field repeats, the values are passed as a list.

Because most people don't bother validating their input fields when
using publisher and always assume it will be a single value, it is
very easy to blow someones code up by passing in repeating fields
explicitly.

The other avenue you can look at is:

  def index(req, **kwargs):
    ...

Using this, any fields for which there are no corresponding parameter
still get passed in kwargs dictionary. The values can be single value
or list for repeating field as above. What one can also do is iterate
other the names of the fields in the dictionary and look for specific
fields. Thus you might have called your fields:

  &lt;html&gt;&lt;body&gt;
  &lt;form action=&quot;multifield.py&quot; method=&quot;post&quot;&gt;
  &lt;input name=&quot;cust_id-1&quot; type=&quot;text&quot;&gt;
  &lt;input name=&quot;cust_id-2&quot; type=&quot;text&quot;&gt;
  &lt;input name=&quot;cust_id-3&quot; type=&quot;text&quot;&gt;
  &lt;input name=&quot;cust_id-4&quot; type=&quot;text&quot;&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
  &lt;/form&gt;
  &lt;/body&gt;&lt;/html&gt;

You could extract all the fields starting with 'cust_id-' from kwargs
and process how you want.

For a more automated way of doing this, look at:

  <A HREF="http://svn.colorstudy.com/FormEncode/trunk/formencode/variabledecode.py">http://svn.colorstudy.com/FormEncode/trunk/formencode/variabledecode.py</A>

This variable_decode() function in that file can be used to
automatically decode certain conventions for expression arbitrary
lists and dictionaries from form parameters in dictionary.

For an explanation of how it can be used, see 'Structured Form
Parameters' section of:

  <A HREF="http://www.dscpl.com.au/projects/vampire/articles/vampire-003.html">http://www.dscpl.com.au/projects/vampire/articles/vampire-003.html</A>

Note that this page details a package that sits on top of mod_python,
so don't expect mod_python by itself to behave as documented.

Graham
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023316.html">[mod_python] Processing Dynamic Forms
</A></li>
	<LI>Next message: <A HREF="023317.html">[mod_python] XAMPP with mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23318">[ date ]</a>
              <a href="thread.html#23318">[ thread ]</a>
              <a href="subject.html#23318">[ subject ]</a>
              <a href="author.html#23318">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
