<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] connection to host server broken
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20connection%20to%20host%20server%20broken&In-Reply-To=829078.59411.qm%40web38715.mail.mud.yahoo.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023367.html">
   <LINK REL="Next"  HREF="023374.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] connection to host server broken</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20connection%20to%20host%20server%20broken&In-Reply-To=829078.59411.qm%40web38715.mail.mud.yahoo.com"
       TITLE="[mod_python] connection to host server broken">graham.dumpleton at gmail.com
       </A><BR>
    <I>Wed Mar 28 21:05:37 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023367.html">[mod_python] connection to host server broken
</A></li>
        <LI>Next message: <A HREF="023374.html">[mod_python] Textbooks on psp programming?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23371">[ date ]</a>
              <a href="thread.html#23371">[ thread ]</a>
              <a href="subject.html#23371">[ subject ]</a>
              <a href="author.html#23371">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 28/03/07, sikander hayat &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">hayat221 at yahoo.com</A>&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I tried the testhandler and then looked at the first 100 entries of the
</I>&gt;<i> error log and there it was...the segmentation fault.
</I>
Yes, but what did the first 100 entries say?

What are you actually saying here? Are you saying you triggered 100
requests of the handler and only then did your handler crash Apache,
or that there was simply 100 unrelated entries that preceded the crash
point, where the crash was the outcome of the very first request? I
would help that you actually posted from the log the entry for the
crash and anything just prior to that point that seems relevant.

It would also help that you post the snippet of your Apache
configuration so we can see how you have set it up to run mod_python
and what handler you might be triggering, whether it be your own or
one from mod_python such as publisher.

&gt;<i> The code that i tried
</I>&gt;<i> is as follows:
</I>&gt;<i>
</I>&gt;<i> from mod_python import apache
</I>&gt;<i>
</I>&gt;<i> import module2
</I>
But what is in module2. Did you put log statements in module2 so as to
see what was run in there when import was done and how far it got.?

&gt;<i> apache.log_error(__file__ + &quot; #3&quot;)
</I>&gt;<i>
</I>&gt;<i> def handler(req):
</I>&gt;<i>
</I>&gt;<i>         req.content_type = &quot;text/plain&quot;
</I>&gt;<i>         req.write(&quot;Hello World!&quot;)
</I>&gt;<i>
</I>&gt;<i>         return apache.OK
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> Sikander
</I>&gt;<i>
</I>&gt;<i> Jim Gallacher &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jpg at jgassociates.ca</A>&gt; wrote:
</I>&gt;<i>  sikander hayat wrote:
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks for your help. Just wanted to point out that, out of frustation, i
</I>&gt;<i> installed mod_python 3.2.10 and discarded mod_python 3.3.1 and magically it
</I>&gt;<i> all works fine !!!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What I would like to conclude from this is, that there might be some
</I>&gt;<i> dependency in 3.3.1 that caused havoc...(atleast for me). As pointed out
</I>&gt;<i> previously, 3.3.1 constantly kept on giving the following errors:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; child pid 28468 exit signal Segmentation fault (11)
</I>&gt;<i> &gt; [Tue Mar 27 17:26:14 2007] [notice] child pid 28469 exit signal
</I>&gt;<i> Segmentation fault (11)
</I>&gt;<i> &gt; [Tue Mar 27 17:26:40 2007] [error] [client 134.96.24.83] File does not
</I>&gt;<i> exist: /opt/lampp/htdocs/favicon.ico
</I>&gt;<i> &gt; [Tue Mar 27 17:29:21 2007] [error] [client 134.96.24.83] File does not
</I>&gt;<i> exist: /opt/lampp/htdocs/favicon.ico
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Why this segmentation error with 3.3.1
</I>&gt;<i>
</I>&gt;<i> Obviously we'd like to sort out why 3.3.1 is segfaulting. Did you try
</I>&gt;<i> Graham's suggestion of doing:
</I>&gt;<i>
</I>&gt;<i>  PythonHandler mod_python.testhandler
</I>&gt;<i>
</I>&gt;<i> and still get a segfault? If not, can you either try it, or share the
</I>&gt;<i> contents of you index.py file that caused the problem?
</I>&gt;<i>
</I>&gt;<i> &gt; and also, i had nothing to do with this favicon.ico. I do not have this
</I>&gt;<i> icon and
</I>&gt;<i>  &gt; do not intend to make one. Why and which process needs this icon...
</I>&gt;<i> *wondering*
</I>&gt;<i>
</I>&gt;<i> This has nothing to do with mod_python. It's your browser that is
</I>&gt;<i> requesting favicon.ico. You don't have one and apache logs that fact,
</I>&gt;<i> and is standard behaviour for a missing file. If you don't intend to
</I>&gt;<i> create one you better get used to having your error logs clogged with
</I>&gt;<i> this message, as I believe some (all?) modern browsers automatically
</I>&gt;<i> request it.
</I>&gt;<i>
</I>&gt;<i> Jim
</I>&gt;<i>
</I>&gt;<i> &gt; Thanks,
</I>&gt;<i> &gt; Sikander
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham Dumpleton wrote: On 26/03/07, sikander hayat wrote:
</I>&gt;<i> &gt;&gt; Hi,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I am using suse 10.1, Apache 2.2.4, python 2.5 and mod_python 3.3.1.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; The error log is as follows:
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate is a CA
</I>&gt;<i> certificate
</I>&gt;<i> &gt;&gt; (BasicConstraints: CA == TRUE !?)
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:16:48 2007] [warn] RSA server certificate CommonName (CN)
</I>&gt;<i> &gt;&gt; `localhost' does NOT match server name!?
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:16:48 2007] [notice] mod_python: Creating 8 session
</I>&gt;<i> mutexes
</I>&gt;<i> &gt;&gt; based on 256 max processes and 0 max threads.
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:16:48 2007] [notice] mod_python: using mutex_directory
</I>&gt;<i> /tmp
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:16:48 2007] [notice] Apache/2.2.4 (Unix) DAV/2
</I>&gt;<i> mod_ssl/2.2.4
</I>&gt;<i> &gt;&gt; OpenSSL/0.9.8d mod_python/3.3.1 Python/2.5 PHP/5.2.1
</I>&gt;<i> &gt;&gt; mod_apreq2-20051231/2.5.7 m
</I>&gt;<i> &gt;&gt; od_perl/2.0.2 Perl/v5.8.7 configured -- resuming normal operations
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:17:04 2007] [error] [client 134.96.24.83] File does not
</I>&gt;<i> &gt;&gt; exist: /opt/lampp/htdocs/favicon.ico
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3230,
</I>&gt;<i> &gt;&gt; interpreter='localhost'): Importing module
</I>&gt;<i> &gt;&gt; '/opt/lampp/htdocs/parkweb/index.py'
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:17:35 2007] [notice] mod_python (pid=3231,
</I>&gt;<i> &gt;&gt; interpreter='localhost'): Importing module
</I>&gt;<i> &gt;&gt; '/opt/lampp/htdocs/parkweb/index.py'
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:17:36 2007] [notice] child pid 3230 exit signal
</I>&gt;<i> Segmentation
</I>&gt;<i> &gt;&gt; fault (11)
</I>&gt;<i> &gt;&gt; [Mon Mar 26 10:17:36 2007] [notice] child pid 3231 exit signal
</I>&gt;<i> Segmentation
</I>&gt;<i> &gt;&gt; fault (11)
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; I have recently upgraded to python 2.5. So, to say, i have 2 versions of
</I>&gt;<i> &gt;&gt; python on my system. Will try to remove the older one and try again.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; To confirm whether that is necessary, set:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; PythonHandler mod_python.testhandler
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In the output from that just verify that the sys.path information is
</I>&gt;<i> &gt; correct for the version of Python you expect to use. From the above
</I>&gt;<i> &gt; log entries there probably isn't a problem with versions as mod_python
</I>&gt;<i> &gt; will actually log some warnings if it finds a different version of
</I>&gt;<i> &gt; Python than what it was compiled with and that isn't in the log
</I>&gt;<i> &gt; entries.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; ****Why is it loading the module twice ...is that normal ???
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Note how the 'pid' is different for each. This means that there were
</I>&gt;<i> &gt; two requests and that they so happened to be handled by different
</I>&gt;<i> &gt; Apache child processes.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Kindly let me know if something rings a bell.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Since you are using Python 2.5, it should not be the expat version
</I>&gt;<i> &gt; problem as Python 2.5 is supposed to change things to avoid that one.
</I>&gt;<i> &gt; I would though still suspect that it is some versioning problem with
</I>&gt;<i> &gt; shared libraries. For example, if your web application uses some sort
</I>&gt;<i> &gt; of database and you also have PHP loaded and it is using some
</I>&gt;<i> &gt; different version of the database client library. This sort of
</I>&gt;<i> &gt; mismatch can cause a crash as one library will take precedence over
</I>&gt;<i> &gt; the other and if they are not compatible it can crash.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; What you may need to do is start adding debug into your code and the
</I>&gt;<i> &gt; framework it uses such that you output a log message before and after
</I>&gt;<i> &gt; every module import. For example:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; from mod_python import apache
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; apache.log_error(__file__ + &quot; #1&quot;)
</I>&gt;<i> &gt; import pyexpat
</I>&gt;<i> &gt; apache.log_error(__file__ + &quot; #2&quot;)
</I>&gt;<i> &gt; import module2
</I>&gt;<i> &gt; apache.log_error(__file__ + &quot; #3&quot;)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; See how many of the messages come out in the Apache error log and slow
</I>&gt;<i> &gt; narrow it down to a specific module being importer causing the crash.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; If the module imports aren't the problem but something in handler
</I>&gt;<i> &gt; itself, do something similar, logging messages to the Apache log until
</I>&gt;<i> &gt; you find exactly what call causes it.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Graham
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Thanks,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Graham Dumpleton wrote:
</I>&gt;<i> &gt;&gt; On 24/03/07, Jim Gallacher wrote:
</I>&gt;<i> &gt;&gt;&gt; sikander hayat wrote:
</I>&gt;<i> &gt;&gt;&gt;&gt; Hi all,
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; My apache webserver on linux recently broke down, so i reinstalled it,
</I>&gt;<i> &gt;&gt; along with mod_python. Having made the necessary changes in the conf file
</I>&gt;<i> of
</I>&gt;<i> &gt;&gt; apache, i tried some of the simple tests, such as mptest, but i keep on
</I>&gt;<i> &gt;&gt; getting the following error.
</I>&gt;<i> &gt;&gt;&gt;&gt; Connection to host server ... lost.
</I>&gt;<i> &gt;&gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt; Why is that, is it because of python or some apache setting.
</I>&gt;<i> &gt;&gt;&gt; Or network problems?
</I>&gt;<i> &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt;&gt; What do you find in your apache logs?
</I>&gt;<i> &gt;&gt; The Apache error log would be a good start, as it looks to me like
</I>&gt;<i> &gt;&gt; your Apache child processes are crashing. You may find errors about
</I>&gt;<i> &gt;&gt; segmentation violations or similar in the logs. If you do, check that
</I>&gt;<i> &gt;&gt; the version of mod_python you are using is the correct one for the
</I>&gt;<i> &gt;&gt; version of Python and Apache you are using. Having multiple versions
</I>&gt;<i> &gt;&gt; of Python installed can also cause issues.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; BTW, are you using precompiled packages or compiling everything from
</I>&gt;<i> &gt;&gt; source code? What operating system are you using?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Graham
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; ________________________________
</I>&gt;<i> &gt;&gt; Sucker-punch spam with award-winning protection.
</I>&gt;<i> &gt;&gt; Try the free Yahoo! Mail Beta.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ---------------------------------
</I>&gt;<i> &gt; The fish are biting.
</I>&gt;<i> &gt; Get more visitors on your site using Yahoo! Search Marketing.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  ________________________________
</I>&gt;<i> Expecting? Get great news right away with email Auto-Check.
</I>&gt;<i> Try the Yahoo! Mail Beta.
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023367.html">[mod_python] connection to host server broken
</A></li>
	<LI>Next message: <A HREF="023374.html">[mod_python] Textbooks on psp programming?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23371">[ date ]</a>
              <a href="thread.html#23371">[ thread ]</a>
              <a href="subject.html#23371">[ subject ]</a>
              <a href="author.html#23371">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
