<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] session variable value (partially) dissapearing
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20session%20variable%20value%20%28partially%29%20dissapearing&In-Reply-To=88e286470703271623m356eaa43i804150a6f3c62e01%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023364.html">
   <LINK REL="Next"  HREF="023366.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] session variable value (partially) dissapearing</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Detmar Meurers</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20session%20variable%20value%20%28partially%29%20dissapearing&In-Reply-To=88e286470703271623m356eaa43i804150a6f3c62e01%40mail.gmail.com"
       TITLE="[mod_python] session variable value (partially) dissapearing">dm at ling.ohio-state.edu
       </A><BR>
    <I>Tue Mar 27 20:29:09 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023364.html">[mod_python] session variable value (partially) dissapearing
</A></li>
        <LI>Next message: <A HREF="023366.html">[mod_python] session variable value (partially) dissapearing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23365">[ date ]</a>
              <a href="thread.html#23365">[ thread ]</a>
              <a href="subject.html#23365">[ subject ]</a>
              <a href="author.html#23365">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Graham,

Thanks for the very quick reply.

The page showing the problem actually is using the publisher handler
(so no special exception handling etc.)

I tried the FileSession and the problem occurs there too - and I'm
not doing any calling of unlock().

I am calling req.session.save() - one question about that though:
Can it possibly cause problems when calling the save() several times
when handling one request?

I'll do some more thorough logging and will report if I find out
what's causing this.

Best,
Detmar



On Wed, Mar 28, 2007 at 09:23:03AM +1000, Graham Dumpleton wrote:
    Only suggestion is to doubly make sure that you are doing the required
    req.session.save() before the request actually returns. If you are
    using:
    
     raise apache.SERVER_RETURN, apache.OK
    
    or similar mechanisms whereby you are using exceptions to jump back up
    calling stack in non error conditions, ensure you have try/finally
    block where save is being done in finally block.
    
    You might log a message at every point you do a save to ensure it is
    always happening as you expect.
    
    You might also try FileSession instead of DBMSession. See
    documentation for PythonOption to override which storage mechanism is
    used. This will indicate whether it is just somehow DBM database or
    all storage mechanisms.
    
    BTW, you aren't every performing an unlock() of session at any point are 
    you?
    
    Graham
    
    On 28/03/07, Detmar Meurers &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dm at ling.ohio-state.edu</A>&gt; wrote:
    &gt;Hi,
    &gt;
    &gt;I'm experiencing some strange behavior with mod_python sessions
    &gt;(using the mod_python Session module, which in my setup seems to use
    &gt;dbm). I'm using Apache/2.2.0 (Unix) mod_ssl/2.2.0 OpenSSL/0.9.8b DAV/2
    &gt;mod_python/3.3.1 Python/2.4.2 on an Intel Mac (mpm-prefork).
    &gt;
    &gt;I can store information in the session variable, which I've stored
    &gt;under req.session, just fine, e.g.
    &gt;
    &gt;req.session['rememberme'] = 'foobar'
    &gt;
    &gt;but for some reason in situations I haven't been able to pin down
    &gt;yet, when I store more complex information, e.g. a dictionary such as
    &gt;
    &gt;req.session['rememberme'] = {'name' : 'john',
    &gt;                             'address': {'road': 'high st',
    &gt;                                         'nr': 22}}
    &gt;
    &gt;then often times part of that dictionary value has disappeared when
    &gt;I look it up again in a later page, e.g. I get a dictionary
    &gt;containing only the key 'name' instead of both keys. I unfortunately
    &gt;haven't been able to pin it down further yet (apart from observing
    &gt;that it seems to appear primarily (?) in situations involving AJAX
    &gt;POST calls).
    &gt;
    &gt;Has someone has seen something like this before? Any hints on what
    &gt;can cause the disappearance of part of a session variable value? Or
    &gt;perhaps it for some reason doesnn't read in the session variable
    &gt;properly in some of the mod_python processes running? Any hints
    &gt;would be much appreciated!
    &gt;
    &gt;Best,
    &gt;Detmar
    &gt;
    &gt;--
    &gt;Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
    &gt;201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
    &gt;<A HREF="http://ling.osu.edu/~dm/">http://ling.osu.edu/~dm/</A>                 GnuPG key on web page
    &gt;_______________________________________________
    &gt;Mod_python mailing list
    &gt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
    &gt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
    &gt;

-- 
--
Detmar Meurers, Associate Professor, Dept. of Linguistics, OSU
201a Oxley Hall, 1712 Neil Avenue, Columbus OH 43210-1298, USA
<A HREF="http://ling.osu.edu/~dm/">http://ling.osu.edu/~dm/</A>                 GnuPG key on web page
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023364.html">[mod_python] session variable value (partially) dissapearing
</A></li>
	<LI>Next message: <A HREF="023366.html">[mod_python] session variable value (partially) dissapearing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23365">[ date ]</a>
              <a href="thread.html#23365">[ thread ]</a>
              <a href="subject.html#23365">[ subject ]</a>
              <a href="author.html#23365">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
