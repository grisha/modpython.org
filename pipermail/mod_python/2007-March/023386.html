<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] how to use Mysql on mod_python+apache?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20how%20to%20use%20Mysql%20on%20mod_python%2Bapache%3F&In-Reply-To=B6C73A5E30565245BB6D32B5F5DF7A52120333%40sense.emmastraat.pijnacker">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023373.html">
   <LINK REL="Next"  HREF="023387.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] how to use Mysql on mod_python+apache?</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Mike Looijmans</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20how%20to%20use%20Mysql%20on%20mod_python%2Bapache%3F&In-Reply-To=B6C73A5E30565245BB6D32B5F5DF7A52120333%40sense.emmastraat.pijnacker"
       TITLE="[mod_python] how to use Mysql on mod_python+apache?">nlv11281 at natlab.research.philips.com
       </A><BR>
    <I>Fri Mar 30 01:55:57 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023373.html">[mod_python] how to use Mysql on mod_python+apache?
</A></li>
        <LI>Next message: <A HREF="023387.html">[mod_python] how to use Mysql on mod_python+apache?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23386">[ date ]</a>
              <a href="thread.html#23386">[ thread ]</a>
              <a href="subject.html#23386">[ subject ]</a>
              <a href="author.html#23386">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> &gt; ...
&gt;<i> with this method of using mysqldb, the database connection is closed
</I>&gt;<i> properly, even if the handler code runs into an error, if not and an
</I>&gt;<i> error occurs and the connection is kept by MySQL and at the end it will
</I>&gt;<i> run out of resources (and/or memory whatever comes first).
</I>
I did notice in the past that when a MySQLdb connection object goes out of scope, it was not 
immediately closed(), so there are probably cyclic dependencies inside. However, the garbage 
collector should pick them up soon enough.

In the past, i have often created something alike a publisher handler, but which allowed the 
callables to accept a &quot;db&quot; parameter. This would trigger the handler to setup a DB connection, and 
using a try..finally... block assured that the connection was being closed (or recycled to the pool) 
asap. Using a connection pool (to prevent re-connect time) turned out to be simple but useless on 
MySQL, I could not measure (and statistically prove) a performance improvement.

Another good tip:
If the MySQL database is running on the same host as the webserver, you can probably disable TCP/IP 
completely for the database server. The MySQLdb interface is using slightly more efficient UNIX 
sockets (or named pipes if on Windows) anyway for local connections, and disabling network 
connections greatly improves security, since you can only make connections from localhost. Putting 
the mysql username/password in a plaintext file is no problem then. I usually use SSH to manage the 
database remotely.


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023373.html">[mod_python] how to use Mysql on mod_python+apache?
</A></li>
	<LI>Next message: <A HREF="023387.html">[mod_python] how to use Mysql on mod_python+apache?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23386">[ date ]</a>
              <a href="thread.html#23386">[ thread ]</a>
              <a href="subject.html#23386">[ subject ]</a>
              <a href="author.html#23386">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
