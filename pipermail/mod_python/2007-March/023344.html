<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] null pointer to PyObject_CallMethod
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20null%20pointer%20to%20PyObject_CallMethod&In-Reply-To=46065846.9070904%40neuf.fr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023343.html">
   <LINK REL="Next"  HREF="023345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] null pointer to PyObject_CallMethod</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20null%20pointer%20to%20PyObject_CallMethod&In-Reply-To=46065846.9070904%40neuf.fr"
       TITLE="[mod_python] null pointer to PyObject_CallMethod">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sun Mar 25 07:00:55 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023343.html">[mod_python] null pointer to PyObject_CallMethod
</A></li>
        <LI>Next message: <A HREF="023345.html">[mod_python] null pointer to PyObject_CallMethod
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23344">[ date ]</a>
              <a href="thread.html#23344">[ thread ]</a>
              <a href="subject.html#23344">[ subject ]</a>
              <a href="author.html#23344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 25/03/07, Christian Boos &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">cboos at neuf.fr</A>&gt; wrote:
&gt;<i> Graham Dumpleton wrote:
</I>&gt;<i> &gt; ..... Confirm in your application that main interpreter is being used
</I>&gt;<i> &gt; by dumping out
</I>&gt;<i> &gt; 'apache.interpreter' or 'req.interpreter'.
</I>&gt;<i>
</I>&gt;<i> Interesting, I can see some use for that in Trac, as running in
</I>&gt;<i> sub-interpreters also proves to be problematic for us.
</I>
This comment suggested you might be involved with the development of
Trac. Is that the case or are you just a dedicated user?

&gt;<i> That's a known problem together with the Subversion bindings,
</I>
But which isn't as far I have been able to work out because mod_python
has bugs as some still occasionally suggest, but because of how the
Subversion bindings are implemented. :-(

&gt;<i> but seeing
</I>&gt;<i> now that weird error reported for cx_Oracle and your suggestion, I
</I>&gt;<i> wonder if some other, equally weird error involving mod_python and
</I>&gt;<i> mysql-python couldn't be explained by the same cause (see
</I>&gt;<i> <A HREF="http://trac.edgewall.org/ticket/5012">http://trac.edgewall.org/ticket/5012</A>).
</I>
Looking at MySQLdb module, the error in that ticket relating to
'connect' not being found within the module looks to me totally
unrelated to issues as to what sub interpreter an application may be
running under within mod_python. This is because MySQLdb is a Python
module and 'connect' is just an attribute of that and should be
unchanging. The actual C code component of MySQLdb is at a lower level
and shouldn't really come into it.

What I would be focusing more on with that ticket is the code in
trac/db/mysql_backend.py at:

    def __init__(self, path, user=None, password=None, host=None,
                 port=None, params={}):
        import MySQLdb

        ....

        if (self._mysqldb_gt_or_eq((1, 2, 1))):
            cnx = MySQLdb.connect(db=path, user=user, passwd=password,
                                  host=host, port=port, charset='utf8')
        else:
            cnx = MySQLdb.connect(db=path, user=user, passwd=password,
                                  host=host, port=port, use_unicode=True)

Given that the import of MySQLdb is done within the function scope, I
presume it is in some way evaluated each time the function is called
and reference obtained via import mechanism. That the error comes up
sometimes suggests that the import mechanism is throwing back an empty
module reference, or the wrong module altogether and thus why
'connect' cannot be found.

What I would have done would have been to move that import to global
scope and see if the problem goes away, or fiddle the code to add a
try/except block and when the error occurs dump out as much
information as possible about what module is bound to MySQLdb
reference to try and identify whether it truely is MySQLdb or
something totally different.

In short, applying some basic debugging techniques to the problem in
that ticket should help to track it down if the original reporter was
willing to look into it properly.  Unfortunately most people just want
a quick fix, preferably from some one else. ;-)

Graham
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023343.html">[mod_python] null pointer to PyObject_CallMethod
</A></li>
	<LI>Next message: <A HREF="023345.html">[mod_python] null pointer to PyObject_CallMethod
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23344">[ date ]</a>
              <a href="thread.html#23344">[ thread ]</a>
              <a href="subject.html#23344">[ subject ]</a>
              <a href="author.html#23344">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
