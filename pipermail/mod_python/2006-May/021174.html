<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Custom Login with redirection back to referer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Custom%20Login%20with%20redirection%20back%20to%20referer&In-Reply-To=BEECFD3D-33D3-4E12-B5AE-67239367300C%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021171.html">
   <LINK REL="Next"  HREF="021181.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Custom Login with redirection back to referer</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Custom%20Login%20with%20redirection%20back%20to%20referer&In-Reply-To=BEECFD3D-33D3-4E12-B5AE-67239367300C%40dscpl.com.au"
       TITLE="[mod_python] Custom Login with redirection back to referer">jpg at jgassociates.ca
       </A><BR>
    <I>Sat May 20 08:10:18 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021171.html">[mod_python] Custom Login with redirection back to referer
</A></li>
        <LI>Next message: <A HREF="021181.html">[mod_python] Custom Login with redirection back to referer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21174">[ date ]</a>
              <a href="thread.html#21174">[ thread ]</a>
              <a href="subject.html#21174">[ subject ]</a>
              <a href="author.html#21174">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Graham Dumpleton wrote:
&gt;<i> 
</I>&gt;<i> On 20/05/2006, at 4:38 PM, Deron Meranda wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> On 5/20/06, Graham Dumpleton &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">grahamd at dscpl.com.au</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> The HTTP specification actually says for 307 (Temporary Redirection),
</I>&gt;&gt;&gt;<i> which is what one would want to use:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, that works too and is quite common, although be aware that
</I>&gt;&gt;<i> most older browsers don't understand a 307.
</I>
But I suspect if browser is too old to understand a 307 redirect, most 
web pages that user visits are almost completely unreadable anyway. :) 
It's up to the designer to decide if supporting stone-age browsers is 
worth the effort.

&gt;<i>  So put a link
</I>&gt;&gt;<i> on the redirecting HTML page as well.  I'd stay away from a
</I>&gt;&gt;<i> 302 though because it's semantics are more ambiguous.
</I>&gt;<i>
</I>&gt;<i> Arrggh, I actually meant to say 302 and not 307, as util.redirect()
</I>&gt;<i> uses a 302. The specification still says much the same thing.
</I>&gt;<i> 
</I>&gt;<i>   The requested resource resides temporarily under a different URI. Since
</I>&gt;<i>   the redirection might be altered on occasion, the client SHOULD continue
</I>&gt;<i>   to use the Request-URI for future requests. This response is only 
</I>&gt;<i> cacheable
</I>&gt;<i>   if indicated by a Cache-Control or Expires header field.
</I>&gt;<i> 
</I>&gt;<i> Thus same argument should apply unless browser/cache is truly old.
</I>&gt;<i> 
</I>&gt;&gt;<i> I still prefer to send back a 401 or 403 as the semantics are
</I>&gt;&gt;<i> much more explicit as to what is happening (the user
</I>&gt;&gt;<i> doesn't have permissions to view the page).  This may be
</I>&gt;&gt;<i> important if you want to adhere to a REST design.  Also,
</I>&gt;&gt;<i> unlike redirects of various flavors, a 40x won't confuse any
</I>&gt;&gt;<i> spiders crawling your site (whether a public search engine,
</I>&gt;&gt;<i> or your own indexer, or perhaps even a site mirror-er).
</I>&gt;&gt;<i> Other rare edge cases could also occur with redirects, such
</I>&gt;&gt;<i> as a user doing a &quot;save target as&quot; where the link is to a URL
</I>&gt;&gt;<i> requiring login first.  Rather than seeing an error message, the
</I>&gt;&gt;<i> user may later find that the file they saved was actually the
</I>&gt;&gt;<i> HTML source to your login page.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is mostly academic of course, but the intended purpose of
</I>&gt;&gt;<i> a 30x redirect is to say that the resource (or equivalent) which was
</I>&gt;&gt;<i> supposed to be at URL A can instead be found at URL B.  But in
</I>&gt;&gt;<i> this scenario that's not what you're doing.  URL A is simply not
</I>&gt;&gt;<i> accessible because of permissions, and URL B is a completely
</I>&gt;&gt;<i> different resource---the login page.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But do what you want.  Many/most sites use 30x.  The main
</I>&gt;&gt;<i> disadvantages of the 40x codes is that there is no auto
</I>&gt;&gt;<i> reloading; and that can often be more important than having
</I>&gt;&gt;<i> the precisely correct semantics.  With a 40x, the user will have
</I>&gt;&gt;<i> to click on a link on the error page to get to the login page.
</I>&gt;<i> 
</I>&gt;<i> Can't one use JavaScript or HTTP-EQUIV header in 40x error response
</I>&gt;<i> to get browser to redirect automatically?
</I>&gt;<i> 
</I>&gt;&gt;<i> But then again, depending on your usability philosophy, that
</I>&gt;&gt;<i> may be more desirable.  Seeing an error page saying you
</I>&gt;&gt;<i> need to login before your can view the page may be less of
</I>&gt;&gt;<i> a surprise then just seeing a login form when you expected
</I>&gt;&gt;<i> something else, with no explanation why.
</I>&gt;<i> 
</I>&gt;<i> What is you attitude on having the login form in the 40x error page itself?
</I>&gt;<i> 
</I>&gt;<i> Anyway, see where you are going now. What I'll do is post up my session
</I>&gt;<i> login stuff using 302 redirects, and then if I have time, will try and 
</I>&gt;<i> modify
</I>&gt;<i> it to use ideas you are talking about and see if we can't come up with code
</I>&gt;<i> for each which people can compare. Someone will just have to convert
</I>&gt;<i> my code to work with mod_python 3.2.8. :-)
</I>
Not completely on topic, but since we are talking about 30x redirects, I 
thought I'd mention that I've modified util.redirect to support any of 
the 30x codes. It's a pretty simple change, where util.redirect becomes

def redirect(req, location, permanent=0, status=None, text=None)

If status is not None it overrides the permanent parameter. I want this 
so I use util.redirect with a 303 HTTP_SEE_OTHER response after creating 
a resource with a POST. (for the POST-REDIRECT-GET pattern used in 
RESTful applications).

I haven't created a JIRA issue or checked in the code just yet. I figure 
if I'm are going to change redirect I may as well do it right and make 
sure we comply with RFC-2616, which may be a bit more work.

The 304 HTTP_NOT_MODIFIED redirect looks interesting in particular, but 
has some specific requirements for a couple of headers. I'm not sure if 
we should be doing any error checking in the util.redirect(), or just 
assume that if the user wants do this they know what they doing and have 
set the response headers accordingly.

If anyone has a couple of spare minutes perhaps they could peruse 
<A HREF="http://rfc.net/rfc2616.html#s10.3">http://rfc.net/rfc2616.html#s10.3</A> and let me know what they think.

Jim


</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021171.html">[mod_python] Custom Login with redirection back to referer
</A></li>
	<LI>Next message: <A HREF="021181.html">[mod_python] Custom Login with redirection back to referer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21174">[ date ]</a>
              <a href="thread.html#21174">[ thread ]</a>
              <a href="subject.html#21174">[ subject ]</a>
              <a href="author.html#21174">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
