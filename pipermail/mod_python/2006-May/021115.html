<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Re: sending headers directly to the client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20sending%20headers%20directly%20to%20the%20client&In-Reply-To=53B1D390-686E-4216-BA64-4AFAAD6C3A7D%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021114.html">
   <LINK REL="Next"  HREF="021110.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Re: sending headers directly to the client</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Mike Looijmans</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Re%3A%20sending%20headers%20directly%20to%20the%20client&In-Reply-To=53B1D390-686E-4216-BA64-4AFAAD6C3A7D%40dscpl.com.au"
       TITLE="[mod_python] Re: sending headers directly to the client">nlv11281 at natlab.research.philips.com
       </A><BR>
    <I>Mon May 15 07:50:23 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021114.html">[mod_python] Re: sending headers directly to the client
</A></li>
        <LI>Next message: <A HREF="021110.html">[mod_python] sending headers directly to the client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21115">[ date ]</a>
              <a href="thread.html#21115">[ thread ]</a>
              <a href="subject.html#21115">[ subject ]</a>
              <a href="author.html#21115">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;&gt;<i> When the user submits the request, immediately return a page that  
</I>&gt;&gt;<i> says something like &quot;processing your request, please wait...&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The simplest thing to do is to just output that on the result page,  
</I>&gt;&gt;<i> and flush() the request output. Then do as you normally do.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The &quot;please wait&quot; could be removed with javascript or so.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Another option is to first return a &quot;please wait&quot; HTML page. This  
</I>&gt;&gt;<i> page has a redirect header, that loads the actual result page. The  
</I>&gt;&gt;<i> user gets to see the redirecting page until the result page is done.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Noting though that you may need a caching system for the result of  
</I>&gt;<i> database
</I>&gt;<i> query which is accessible from multiple processes. This is because if  
</I>&gt;<i> Apache
</I>&gt;<i> prefork MPM being used, or even worker with multiple processes, the
</I>&gt;<i> subsequent request to get the results of the query will not  necessarily 
</I>&gt;<i> end
</I>&gt;<i> up at the same Apache child process. Thus, you can't rely on caching  
</I>&gt;<i> within
</I>&gt;<i> an Apache child process.
</I>
One way to avoid that issue is by making sure the intermediate page does 
not do anything useful. Simple example (untested code, probably loaded 
with bugs but it might illustrate what i mean):

&lt;form action=search.psp&gt;
   Search: &lt;input name=s type=text&gt;
   &lt;input type=submit value=&quot;Go&quot;&gt;
&lt;/form&gt;


in search.psp:


&lt;%
req.headers_out.put('refresh', '1;url=dosearch.psp?s=%s' % 
urlencode(form['s']))
%&gt;
&lt;H1&gt;Please wait&lt;/H1&gt;
...


in dosearch.psp:


&lt;H1&gt;Result&lt;/H1&gt;
&lt;%=VeryBigImpressivelySlowQueryResult%&gt;


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021114.html">[mod_python] Re: sending headers directly to the client
</A></li>
	<LI>Next message: <A HREF="021110.html">[mod_python] sending headers directly to the client
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21115">[ date ]</a>
              <a href="thread.html#21115">[ thread ]</a>
              <a href="subject.html#21115">[ subject ]</a>
              <a href="author.html#21115">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
