<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] sending headers directly to the client
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sending%20headers%20directly%20to%20the%20client&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021115.html">
   <LINK REL="Next"  HREF="021117.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] sending headers directly to the client</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20sending%20headers%20directly%20to%20the%20client&In-Reply-To="
       TITLE="[mod_python] sending headers directly to the client">grahamd at dscpl.com.au
       </A><BR>
    <I>Sun May 14 21:56:03 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021115.html">[mod_python] Re: sending headers directly to the client
</A></li>
        <LI>Next message: <A HREF="021117.html">[mod_python] Session Management, Straight Answer?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21110">[ date ]</a>
              <a href="thread.html#21110">[ thread ]</a>
              <a href="subject.html#21110">[ subject ]</a>
              <a href="author.html#21110">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What you are wanting to do, detect client connection being closed
and aborting content generation, is generally seen as being bad
practice. Even if there were some way of doing it in the way you
are contemplating, you could run into problems with intermediate
proxies or firewalls stopping your scheme working because of
header buffering or other issues. You could also run into problems
with too much headers causing a client or intermediary to exceed
some size limit and simply aborting the whole request.

Why do you think what you want to do is a good idea? What
problem do you think you are trying to solve?

Graham

Stefan Wehr wrote ..
&gt;<i> Hi all,
</I>&gt;<i> 
</I>&gt;<i> I need to send headers directly to the client; that is, before
</I>&gt;<i> mod_python sends its headers (I know that I have to handle the status
</I>&gt;<i> line specially).
</I>&gt;<i> 
</I>&gt;<i> Background: I need to detect when the user hits the 'Cancel' button of
</I>&gt;<i> the browser. The only reliable way to do this seems to send something
</I>&gt;<i> periodically to the client. My idea is now to send dummy headers to
</I>&gt;<i> the client until the possibly long running HTML code generating
</I>&gt;<i> function is finished. Then I stop sending dummy headers and send the
</I>&gt;<i> HTML code to the client. If the client hits 'Cancel' while the
</I>&gt;<i> HTML code generating function is running, I'm able to detect this
</I>&gt;<i> because I get some kind of error when sending a dummy header.
</I>&gt;<i> 
</I>&gt;<i> The problem is now: how can I send the dummy headers?
</I>&gt;<i> 
</I>&gt;<i> I cannot use 'req.write' because this flushes all headers (note that
</I>&gt;<i> some headers can be set only *after* HTML has been generated).  My
</I>&gt;<i> idea was then to use 'req.connection.write'. The problem with this
</I>&gt;<i> approach is that this function does *not* trigger an error if the
</I>&gt;<i> connection is closed. I also fiddled around with the
</I>&gt;<i> 'req.connection.aborted' field without success.
</I>&gt;<i> 
</I>&gt;<i> Any help would be greatly appreciated.
</I>&gt;<i> 
</I>&gt;<i> Cheers, Stefan
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021115.html">[mod_python] Re: sending headers directly to the client
</A></li>
	<LI>Next message: <A HREF="021117.html">[mod_python] Session Management, Straight Answer?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21110">[ date ]</a>
              <a href="thread.html#21110">[ thread ]</a>
              <a href="subject.html#21110">[ subject ]</a>
              <a href="author.html#21110">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
