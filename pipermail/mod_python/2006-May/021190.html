<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Servlet Loading problem 1 year later
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Servlet%20Loading%20problem%201%20year%20later&In-Reply-To=BC53C974C3B9E542BC0A9BD4C5B1168AE1C94F%40NEWMAIL.manord.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021189.html">
   <LINK REL="Next"  HREF="021191.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Servlet Loading problem 1 year later</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Daniel J. Popowich</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Servlet%20Loading%20problem%201%20year%20later&In-Reply-To=BC53C974C3B9E542BC0A9BD4C5B1168AE1C94F%40NEWMAIL.manord.com"
       TITLE="[mod_python] Servlet Loading problem 1 year later">dpopowich at comcast.net
       </A><BR>
    <I>Mon May 22 08:30:04 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021189.html">[mod_python] Servlet Loading problem 1 year later
</A></li>
        <LI>Next message: <A HREF="021191.html">[mod_python] Language selection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21190">[ date ]</a>
              <a href="thread.html#21190">[ thread ]</a>
              <a href="subject.html#21190">[ subject ]</a>
              <a href="author.html#21190">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Manera, Villiam writes:
&gt;<i> This problem happened rarely, but now it raises many times a day.
</I>&gt;<i> I modified the servlet.py in order to do some debugging and it seems
</I>&gt;<i> that  the statement:
</I>&gt;<i> if not issubclass(klass, Servlet): sometimes works and sometimes not.
</I>&gt;<i> 
</I>
Here's a modification of an explanation I gave someone else last June
(<A HREF="http://www.modpython.org/pipermail/mod_python/2005-June/018463.html">http://www.modpython.org/pipermail/mod_python/2005-June/018463.html</A>):

If modifying servlet.py and PythonAutoReload is &quot;on&quot; then servlet.py
is being reloaded by mod_python which will create a new Servlet class
in the python interpreter.  Servlets instantiated *after* the change
will not have a problem, but cached instances created *before* the
modifications to servlet.py will be referencing the wrong class (the
reloaded Servlet is not the same class as the one when the cached
objects were instantiated).  This can create quite unpredictable
results when using the prefork MPM because different processes may or
may not have had a cached instance, so sometimes it works and
sometimes it doesn't depending on which process handles your request.
Restarting apache fixes your problem: you get fresh copies of
everything in new python interpreters.

To avoid this:

  1. You really shouldn't change servlet.py.  Put
     modifications/extensions in subclasses...the power of OO and
     all...

  2. In development mode, I configure my prefork apache with:

        MaxRequestsPerChild  1

     Sure, it's a performance hit, but you NEVER have to deal with
     stale python module importing issues and you don't have to
     litter your code with special-case importing code, etc.

Cheers,

Daniel Popowich
---------------
<A HREF="http://home.comcast.net/~d.popowich/mpservlets/">http://home.comcast.net/~d.popowich/mpservlets/</A>
</PRE>



















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021189.html">[mod_python] Servlet Loading problem 1 year later
</A></li>
	<LI>Next message: <A HREF="021191.html">[mod_python] Language selection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21190">[ date ]</a>
              <a href="thread.html#21190">[ thread ]</a>
              <a href="subject.html#21190">[ subject ]</a>
              <a href="author.html#21190">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
