<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] newbie question - using multiple handlers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20newbie%20question%20-%20using%20multiple%20handlers&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021673.html">
   <LINK REL="Next"  HREF="021675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] newbie question - using multiple handlers</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20newbie%20question%20-%20using%20multiple%20handlers&In-Reply-To="
       TITLE="[mod_python] newbie question - using multiple handlers">grahamd at dscpl.com.au
       </A><BR>
    <I>Tue Jul 25 21:22:10 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021673.html">[mod_python] newbie question - using multiple handlers
</A></li>
        <LI>Next message: <A HREF="021675.html">[mod_python] PSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21674">[ date ]</a>
              <a href="thread.html#21674">[ thread ]</a>
              <a href="subject.html#21674">[ subject ]</a>
              <a href="author.html#21674">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Martijn Moeling wrote ..
&gt;<i> 
</I>&gt;<i> I would do it different
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I would do something like this:
</I>&gt;<i> 
</I>&gt;<i> One handler in the apache config
</I>&gt;<i> 
</I>&gt;<i> Def handler(req):
</I>&gt;<i> 	If req.unparsed_uri == &quot;/page1.html&quot;:
</I>&gt;<i> 		#Do something for page1
</I>&gt;<i> 		Page=1
</I>&gt;<i> 	elif req.unparsed.uri == &quot;/page2.html&quot;:
</I>&gt;<i> 	      #Do something for page2
</I>&gt;<i> 		Page=2
</I>&gt;<i> 	Send_page(req,Page)
</I>&gt;<i> 	Return Apache.Ok
</I>&gt;<i> 
</I>&gt;<i> Def Send_page(req,Page):
</I>&gt;<i> 	req.write(&quot;this is page : &quot;+str(Page))
</I>&gt;<i> 
</I>&gt;<i> (My outlook messes up the use of small and capital letters, you get the
</I>&gt;<i> point though
</I>
Which just like Vampire is just another switch or dispatch handler which is
what they wanted to avoid. At least with Vampire it is a generic dispatch
handler whereas the above would require modification every time a new
page is added.

A few other comments on your example above.

First is that it will only work if the handler is located at the root of the URL
namespace. A dispatch handler should base decisions on the relative URL
which is situated below the point in the URL hierarchy at which the handler
is anchored. This is not necessarily what req.path_info is set to and needs
to be calculated properly as a separate step.

Second is that because the handler runs as the response handler and you
always return apache.OK for everything, it isn't possible to let Apache fall
back to serving up a static file with the same extension as any request being
processed through the handler.

It is possible to return apache.DECLINED when the handler doesn't handle
the URL and then Apache will return either NOT FOUND or serve up any
matching static file. This will only work for static files though and it isn't
possible to defer to a completely different Apache module to deliver up a
dynamic response using a handler of its own.

For it to work with non static output, would require a fixuphandler to be
used to make the decision rather than SetHandler or AddHandler and for
enabling of mod_python to be dynamic. This though also requires
mod_python 3.3 as prior versions of mod_python don't allow req.handler
to be set by handlers.

In short, in this case I also believe one is better off using a dispatch handler,
but I would highly recommend an existing generic solution rather than a
hand rolled solution as there are lots of gotcha to doing it right. I would
also say that Apache does have a lot of configurability which can also be
used, and just because we are Python fanatics here doesn't mean we should
throw away all the goodness Apache has to offer and try to do everything
in a Python response handler. ;-)

Graham

&gt;<i> -----Oorspronkelijk bericht-----
</I>&gt;<i> Van: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>
</I>&gt;<i> [mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>] Namens Graham Dumpleton
</I>&gt;<i> Verzonden: Wednesday, July 26, 2006 00:12
</I>&gt;<i> Aan: Thomas J. Schirripa
</I>&gt;<i> CC: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
</I>&gt;<i> Onderwerp: Re: [mod_python] newbie question - using multiple handlers
</I>&gt;<i> 
</I>&gt;<i> Thomas J. Schirripa wrote ..
</I>&gt;<i> &gt; I'm pretty new to both mod_python and apache. I have just written
</I>&gt;<i> multiple
</I>&gt;<i> &gt; handlers to deal with different webpages I have written. My problem is
</I>&gt;<i> &gt; that if I use PythonHandler for each of my handlers in the conf. file,
</I>&gt;<i> &gt; whenever I run a webpage, it tries to use ALL my handlers. Basically,
</I>&gt;<i> I
</I>&gt;<i> &gt; want only one handler to be used per webpage. The &quot;action&quot; in my forms
</I>&gt;<i> &gt; only specify one handler, but based on the errors I am getting, it is
</I>&gt;<i> also
</I>&gt;<i> &gt; running the other handlers. Is there a way that I can set directives
</I>&gt;<i> such
</I>&gt;<i> &gt; as PythonHandler for particular html files? Or do I need to separate
</I>&gt;<i> my
</I>&gt;<i> &gt; files into different directories? I would hate to have to make a
</I>&gt;<i> switch
</I>&gt;<i> &gt; handler that determined what methods to call from my handler files so
</I>&gt;<i> that
</I>&gt;<i> &gt; the conf file only had one handler in it.
</I>&gt;<i> 
</I>&gt;<i> Post what Apache configuration you are using for your PythonHandler
</I>&gt;<i> and SetHandler/AddHandler directives related to mod_python. Is this
</I>&gt;<i> being set in a .htaccess file or in main Apache configuration within a
</I>&gt;<i> Directory/Location directive?
</I>&gt;<i> 
</I>&gt;<i> If the PythonHandler directives at present refer sto your own handlers,
</I>&gt;<i> use
</I>&gt;<i> of a switch or dispatch handler may be your only choice when using
</I>&gt;<i> mod_python
</I>&gt;<i> 3.2.X or earlier versions. This is because the logical thing to do of:
</I>&gt;<i> 
</I>&gt;<i>   &lt;Files page1.html&gt;
</I>&gt;<i>   PythonHandler handlers::page1_html
</I>&gt;<i>   &lt;/Files&gt;
</I>&gt;<i> 
</I>&gt;<i>   &lt;Files page2.html&gt;
</I>&gt;<i>   PythonHandler handlers::page2_html
</I>&gt;<i>   &lt;/Files&gt;
</I>&gt;<i> 
</I>&gt;<i> doesn't necessarily work, although it is fixed in development version of
</I>&gt;<i> mod_python 3.3.
</I>&gt;<i> 
</I>&gt;<i> The problem with using &lt;Files&gt; is that mod_python sets up Python path
</I>&gt;<i> wrongly and if handlers.py is in the directory for the .htaccess or
</I>&gt;<i> Directory
</I>&gt;<i> directive it will not find it. Will be okay if handler.py is elsewhere
</I>&gt;<i> and the
</I>&gt;<i> PythonPath directive is used to refer to the directory where it is
</I>&gt;<i> located.
</I>&gt;<i> 
</I>&gt;<i> Rather than try and hack up a solution you may want to look at Vampire
</I>&gt;<i> which already provides a basic switch or dispatch handler which maps
</I>&gt;<i> to basic mod_python handlers. This way you can have separate handler
</I>&gt;<i> files for each resource and if necessary distinct handlers for different
</I>&gt;<i> views of a resource as well. See:
</I>&gt;<i> 
</I>&gt;<i>   <A HREF="http://www.dscpl.com.au/projects/vampire/articles/vampire-001.html">http://www.dscpl.com.au/projects/vampire/articles/vampire-001.html</A>
</I>&gt;<i> 
</I>&gt;<i> for a quick overview of Vampire.
</I>&gt;<i> 
</I>&gt;<i> Graham
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>   
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021673.html">[mod_python] newbie question - using multiple handlers
</A></li>
	<LI>Next message: <A HREF="021675.html">[mod_python] PSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21674">[ date ]</a>
              <a href="thread.html#21674">[ thread ]</a>
              <a href="subject.html#21674">[ subject ]</a>
              <a href="author.html#21674">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
