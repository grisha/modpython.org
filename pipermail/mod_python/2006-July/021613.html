<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Subclassing Session
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Subclassing%20Session&In-Reply-To=27776574.128901153244144731.JavaMail.tomcat%40roadmaster">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021612.html">
   <LINK REL="Next"  HREF="021614.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Subclassing Session</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Subclassing%20Session&In-Reply-To=27776574.128901153244144731.JavaMail.tomcat%40roadmaster"
       TITLE="[mod_python] Subclassing Session">jpg at jgassociates.ca
       </A><BR>
    <I>Tue Jul 18 14:08:50 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021612.html">[mod_python] Subclassing Session
</A></li>
        <LI>Next message: <A HREF="021614.html">[mod_python] need modpython developer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21613">[ date ]</a>
              <a href="thread.html#21613">[ thread ]</a>
              <a href="subject.html#21613">[ subject ]</a>
              <a href="author.html#21613">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thomas J. Schirripa wrote:
&gt;<i> Thanks for the help Jim. I just wanted to add that I am not really sure about the implementation of those 4 methods you suggested because they aren't in the docs, but I am going to take a look at the source code and figure out what they're doing.
</I>&gt;<i> Thanks again,
</I>&gt;<i> Tom
</I>
They are just hooks that do the actual work for load(), save(), delete()
and cleanup(), all of which are documented. These documented methods do
some generic processing, and then call the respective do_* methods to
handle the lower level work specific to a particular session data store.

MemorySession is the simplest BaseSession subclass, so you might find it
helpful to examine its code first and use that as your template.

Jim

&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> 
</I>&gt;&gt;<i> Date: Tue Jul 18 13:12:58 EDT 2006
</I>&gt;&gt;<i> From: &quot;Jim Gallacher&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">jpg at jgassociates.ca</A>&gt;
</I>&gt;&gt;<i> Subject: Re: [mod_python] Subclassing Session
</I>&gt;&gt;<i> To: &quot;Thomas J. Schirripa&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">tommys at eden.rutgers.edu</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thomas J. Schirripa wrote:
</I>&gt;&gt;&gt;<i> Before stating my problem, let me say that I am running apache version 2.0.52, mod_python 3.2.8, python 2.3, all on Redhat Enterprise Linux WS release 4.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I am making some basic web utilities that require that I create sessions. Essentially, I want to use session ids created by mod_python to create a session folder where I can temporarily dump files  and manipulate stuff so I can generate some output for the client. Since I would be using this feature a lot, I thought it would be a good idea to make a subclass of BaseSession that added this functionality of making a folder with the session name. I made a file located somewhere else on my machine called SessDirectory.py, and it defines the class SessionDirectory. The file looks like this:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> from Session import BaseSession
</I>&gt;&gt;&gt;<i> import os
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> class SessionDirectory(BaseSession):
</I>&gt;&gt;&gt;<i> 	def __init__(self, req, path=None, sid=None, secret=None, lock=1, timeout=0):
</I>&gt;&gt;&gt;<i> 		BaseSession.__init__(self, req, sid, secret, lock, timeout)
</I>&gt;&gt;&gt;<i> 		if path == None:
</I>&gt;&gt;&gt;<i> 			self.absPath = os.path.join(os.getcwd(), sid)
</I>&gt;&gt;&gt;<i> 		else:
</I>&gt;&gt;&gt;<i> 			self.absPath = os.path.join(path, sid)
</I>&gt;&gt;&gt;<i> 		os.mkdir(self.absPath, mode=0755)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It can take an absolute path to create the session directory, or it can take no path, in which case it creates the session directory in the current directory. When I try to instantiate the SessionDirectory object, the following exception is raised:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> AttributeError: 'SessionDirectory' object has no attribute 'do_load'
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I did some fishing around and looked at the source code of the session module. Apparently, BaseSession has a method called &quot;load()&quot; that makes a call to &quot;do_load()&quot;. BaseSession does not define &quot;do_load()&quot;, HOWEVER, it seems that the built in sublcasses of BaseSession (ie- FileSession, DbmSession, etc) all define a &quot;do_load()&quot; method.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> My background is really in Java, and to me, it seems like BaseSession is an abstract class, but it has no signature for &quot;do_load()&quot; and I believe the exception would have been NotImplemented or something like that if there was a required implementation missing. 
</I>&gt;&gt;<i> This is a good suggestion, and it would make it easier to subclass
</I>&gt;&gt;<i> BaseSession if the following methods existed and raised NotImplemented.
</I>&gt;&gt;<i>  I suppose this info should be included in the docs as well and since I
</I>&gt;&gt;<i> have the magic powers required I shall make it so. :)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Offhand I'd say the 4 methods you'll need to implement are:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> do_load()
</I>&gt;&gt;<i> do_save()
</I>&gt;&gt;<i> do_delete()
</I>&gt;&gt;<i> do_cleanup()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> For your application do_delete and do_cleanup may be noop, as I'm sure
</I>&gt;&gt;<i> you'll want to preserve your data.
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Also, why does BaseSession inherit from &quot;dict&quot; and not &quot;UserDict&quot;. I wanted to see if &quot;dict&quot; had a &quot;do_load()&quot; method, but if it did, then the instantiation of SessionDirectory should have called the &quot;do_load()&quot; from dict. 
</I>&gt;&gt;<i> I'm not sure I get your point about the superiority of UserDict.
</I>&gt;&gt;<i> According to the python docs, inheriting from dict is preferred:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;&quot;&quot;
</I>&gt;&gt;<i> UserDict -- Class wrapper for dictionary objects
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Note: This module is available for backward compatibility only. If you
</I>&gt;&gt;<i> are writing code that does not need to work with versions of Python
</I>&gt;&gt;<i> earlier than Python 2.2, please consider subclassing directly from the
</I>&gt;&gt;<i> built-in dict type.
</I>&gt;&gt;<i> &quot;&quot;&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jim
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Mod_python mailing list
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> 
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021612.html">[mod_python] Subclassing Session
</A></li>
	<LI>Next message: <A HREF="021614.html">[mod_python] need modpython developer
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21613">[ date ]</a>
              <a href="thread.html#21613">[ thread ]</a>
              <a href="subject.html#21613">[ subject ]</a>
              <a href="author.html#21613">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
