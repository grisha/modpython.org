<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Pipes and security
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Pipes%20and%20security&In-Reply-To=c298f2d70607250335qf892fdcj8a32f9a4771bcd4b%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021670.html">
   <LINK REL="Next"  HREF="021669.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Pipes and security</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Nicolas Lehuen</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Pipes%20and%20security&In-Reply-To=c298f2d70607250335qf892fdcj8a32f9a4771bcd4b%40mail.gmail.com"
       TITLE="[mod_python] Pipes and security">nicolas at lehuen.com
       </A><BR>
    <I>Tue Jul 25 06:46:47 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021670.html">[mod_python] Pipes and security
</A></li>
        <LI>Next message: <A HREF="021669.html">[mod_python] Pipes and security
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21668">[ date ]</a>
              <a href="thread.html#21668">[ thread ]</a>
              <a href="subject.html#21668">[ subject ]</a>
              <a href="author.html#21668">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As an example in your context, imagine a stupid way of serving files (the
code is obviously false but I just want to show you the problem) :

def serve_file(req,filename):
    i, o = os.popen(&quot;sh&quot;)
    i.write(&quot;cat %s&quot;%filename)
    i.close()
    req.write(o.read())
    o.close()

then calling <A HREF="http://myserver/stupid.py/serve_file?filename=foobar.txt">http://myserver/stupid.py/serve_file?filename=foobar.txt</A> would
work correctly.

Now if someone calls
<A HREF="http://myserver/stupid.py/serve_file?filename=foobar.txt%3Brm+-Rf+%2F">http://myserver/stupid.py/serve_file?filename=foobar.txt%3Brm+-Rf+%2F</A> ,
you've got a big problem because the command will be &quot;cat foobar.txt;rm -Rf
/&quot;, displaying the content of foobar.txt THEN erasing all your server's main
partition...

Therefore, you must transform the input string, escaping it to make sure
that this cannot happen. It turns out doing it properly and securely is
quite difficult, so you'd better find another way of doing what you need.
For example, SQL injection is most easily fought by using prepared statement
with placeholders. As for your problem, well, it depends on what you want to
do.

Regards,
Nicolas

2006/7/25, Nicolas Lehuen &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">nicolas at lehuen.com</A>&gt;:
&gt;<i>
</I>&gt;<i> The problem is not related to the choice of technology. It is about
</I>&gt;<i> accepting data from the web and using it in an executable context.
</I>&gt;<i>
</I>&gt;<i> If the command you pass are built from data sent over the web, there is a
</I>&gt;<i> chance that some malicious data can execute dangerous code. Therefore, you
</I>&gt;<i> have to make sure that any data sent over the web (in forms or query
</I>&gt;<i> parameters) is properly escaped when included in executable code (command
</I>&gt;<i> line parameters, SQL requests, etc.).
</I>&gt;<i>
</I>&gt;<i> For more information, see the classical &quot;SQL Injection&quot; problem.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://en.wikipedia.org/wiki/SQL_injection">http://en.wikipedia.org/wiki/SQL_injection</A>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Nicolas
</I>&gt;<i>
</I>&gt;<i> 2006/7/25, Richard Lewis &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">richardlewis at fastmail.co.uk</A>&gt;:
</I>&gt;<i>
</I>&gt;<i> &gt; Hi there,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Just investigating some possible implementation methods.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Does it pose a security risk in mod_python to do this sort of thing:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; def handler(req):
</I>&gt;<i> &gt;   # code is from memory so may not be correct
</I>&gt;<i> &gt;   # but its the idea thats important ;-)
</I>&gt;<i> &gt;   i, o = os.popen2(&quot;cmd&quot;)
</I>&gt;<i> &gt;   i.write(&quot;some data&quot;)
</I>&gt;<i> &gt;   i.close()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   req.write(o.read())
</I>&gt;<i> &gt;   o.close()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I don't really understand it properly, but I've read before now that
</I>&gt;<i> &gt; using
</I>&gt;<i> &gt; pipes to execute shell commands from CGI scripts can be insecure. Does
</I>&gt;<i> &gt; the
</I>&gt;<i> &gt; same apply with Apache modules like mod_python?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Cheers,
</I>&gt;<i> &gt; Richard
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
</I>&gt;<i> &gt; Richard Lewis
</I>&gt;<i> &gt; Sonic Arts Research Archive
</I>&gt;<i> &gt; <A HREF="http://www.sara.uea.ac.uk/">http://www.sara.uea.ac.uk/</A>
</I>&gt;<i> &gt; JID: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">ironchicken at jabber.earth.li</A>
</I>&gt;<i> &gt; -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Mod_python mailing list
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">Mod_python at modpython.org</A>
</I>&gt;<i> &gt; <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">http://mailman.modpython.org/mailman/listinfo/mod_python</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060725/d6e1b296/attachment.html">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20060725/d6e1b296/attachment.html</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021670.html">[mod_python] Pipes and security
</A></li>
	<LI>Next message: <A HREF="021669.html">[mod_python] Pipes and security
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21668">[ date ]</a>
              <a href="thread.html#21668">[ thread ]</a>
              <a href="subject.html#21668">[ subject ]</a>
              <a href="author.html#21668">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
