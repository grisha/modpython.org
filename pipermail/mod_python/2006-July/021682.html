<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Background threads in mod_python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Background%20threads%20in%20mod_python&In-Reply-To=44CB5FBA.8050502%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021681.html">
   <LINK REL="Next"  HREF="021689.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Background threads in mod_python</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Background%20threads%20in%20mod_python&In-Reply-To=44CB5FBA.8050502%40gmail.com"
       TITLE="[mod_python] Background threads in mod_python">grahamd at dscpl.com.au
       </A><BR>
    <I>Sat Jul 29 20:44:21 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021681.html">[mod_python] Background threads in mod_python
</A></li>
        <LI>Next message: <A HREF="021689.html">[mod_python] Background threads in mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21682">[ date ]</a>
              <a href="thread.html#21682">[ thread ]</a>
              <a href="subject.html#21682">[ subject ]</a>
              <a href="author.html#21682">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 29/07/2006, at 11:16 PM, Christian Gross wrote:
&gt;&gt;<i> Alternatively, if the Apache child process doesn't crash, you  
</I>&gt;&gt;<i> might at least
</I>&gt;&gt;<i> cause a Python exception to occur because the state of something  
</I>&gt;&gt;<i> in the
</I>&gt;&gt;<i> request object isn't as expected. This exception would effectively  
</I>&gt;&gt;<i> cause the
</I>&gt;&gt;<i> thread to exit unless the context in which the access was made to  
</I>&gt;&gt;<i> the request
</I>&gt;&gt;<i> object was protected by a try/except block.
</I>&gt;&gt;<i>
</I>&gt;<i> I copied specific items from the request object to a Python object.  
</I>&gt;<i> Though this raises a question. If for example I assign the req.uri  
</I>&gt;<i> to a class instance data member is this ok? Will at the end of the  
</I>&gt;<i> request the data referenced by req.uri be released, or is req.uri a  
</I>&gt;<i> buffer managed by Python?
</I>
Accessing a member of the request object and storing it is okay, as  
the data
is effectively copied in order to turn it into a Python object.

&gt;&gt;<i> In the above I talk about a Python exception occurring due to  
</I>&gt;&gt;<i> access to a
</I>&gt;&gt;<i> no longer valid request object, but even an uncaught exception in  
</I>&gt;&gt;<i> your code
</I>&gt;&gt;<i> will cause the same thing, with the thread appearing to exit but  
</I>&gt;&gt;<i> with nothing
</I>&gt;&gt;<i> necessarily being logged anywhere. What you want to do is to put a  
</I>&gt;&gt;<i> try/except
</I>&gt;&gt;<i> block around everything the thread does and if an exception  
</I>&gt;&gt;<i> occurs, then
</I>&gt;&gt;<i> use apache.log_error() to log something to the Apache error log  
</I>&gt;&gt;<i> indicating
</I>&gt;&gt;<i> that the exception occurs and the details of the exception.
</I>&gt;&gt;<i>
</I>&gt;<i> Would you consider doing this as a general rule in mod_python? I  
</I>&gt;<i> can see the advantages, but am wondering if that could be  
</I>&gt;<i> considered a good programming practice?
</I>
For a separate thread, you would certainly have to deal with unexpected
exceptions in some way. If you get an unexpected exception in the  
request
handler however,  then it is caught by mod_python and turned into a 500
error response, with details if PythonDebug is set to On. Thus, only the
separate thread where you would have to be particularly mindful of it.

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021681.html">[mod_python] Background threads in mod_python
</A></li>
	<LI>Next message: <A HREF="021689.html">[mod_python] Background threads in mod_python
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21682">[ date ]</a>
              <a href="thread.html#21682">[ thread ]</a>
              <a href="subject.html#21682">[ subject ]</a>
              <a href="author.html#21682">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
