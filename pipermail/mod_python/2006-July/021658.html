<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] concurrent connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20concurrent%20connections&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021657.html">
   <LINK REL="Next"  HREF="021659.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] concurrent connections</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20concurrent%20connections&In-Reply-To="
       TITLE="[mod_python] concurrent connections">grahamd at dscpl.com.au
       </A><BR>
    <I>Mon Jul 24 19:33:24 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021657.html">[mod_python] concurrent connections
</A></li>
        <LI>Next message: <A HREF="021659.html">[mod_python] concurrent connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21658">[ date ]</a>
              <a href="thread.html#21658">[ thread ]</a>
              <a href="subject.html#21658">[ subject ]</a>
              <a href="author.html#21658">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Jay Knight wrote ..
&gt;<i> If you take the hello world example, and add a time.sleep(5) at the
</I>&gt;<i> beginning... like this:
</I>&gt;<i> 
</I>&gt;<i> -----
</I>&gt;<i> import time
</I>&gt;<i> from mod_python import apache
</I>&gt;<i> 
</I>&gt;<i> def handler(req):
</I>&gt;<i>     time.sleep(5)
</I>&gt;<i>     req.content_type = &quot;text/plain&quot;
</I>&gt;<i>     req.write(&quot;Hello World!&quot;)
</I>&gt;<i>     return apache.OK
</I>&gt;<i> -----
</I>&gt;<i> 
</I>&gt;<i> Then request that URL twice, it seems that the second one doesn't
</I>&gt;<i> start until the first one is completely finished, that is, I can't
</I>&gt;<i> make them run at the same time.  (And therefore, if I started 20 at
</I>&gt;<i> about the same time, the last one would not complete until about 100
</I>&gt;<i> seconds later, etc)  How would I go about making them run at the same
</I>&gt;<i> time?
</I>&gt;<i> 
</I>&gt;<i> I've got a pretty standard mod_python install on gentoo.  The
</I>&gt;<i> .htaccess for this directory is
</I>&gt;<i> 
</I>&gt;<i> -----
</I>&gt;<i> AddHandler mod_python .py
</I>&gt;<i> PythonHandler mptest
</I>&gt;<i> PythonDebug On
</I>&gt;<i> -----
</I>&gt;<i> 
</I>&gt;<i> I know this must be possible.  But I don't know if it is a
</I>&gt;<i> configuration issue (.htaccess) or something within the code itself
</I>&gt;<i> (manually forking stuff off to handle multiple connections? bleh).
</I>
Apache should handle everything for you so as to allow concurrent
connections.

Some questions for you.

1. What client are you using to create the connections and test this?
Are you sure it isn't the client that is serialising the requests?

One would normally use 'ab&quot; to do such a test. For example:

  ab -n 10 -c 5 <A HREF="http://localhost/some/path">http://localhost/some/path</A>

The '-n' option says 10 requests, with '-c' saying run 5 concurrently.

2. What version of Apache are you using?

3. If Apache 2.X, what MPM is compiled in to it, worker or prefork?

You can determine this by going:

  httpd -l

and then looking for either 'worker.c' or 'prefork.c' file being compiled in.

4. How is Apache configured in respect of number of child processes
to create etc.

For example:

&lt;IfModule mpm_prefork_module&gt;
    StartServers          5
    MinSpareServers       5
    MaxSpareServers      10
    MaxClients          150
    MaxRequestsPerChild   0
&lt;/IfModule&gt;

or:

&lt;IfModule mpm_worker_module&gt;
    StartServers          2
    MaxClients          150
    MinSpareThreads      25
    MaxSpareThreads      75
    ThreadsPerChild      25
    MaxRequestsPerChild   0
&lt;/IfModule&gt;

5. What version of mod_python are you using?

Graham
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021657.html">[mod_python] concurrent connections
</A></li>
	<LI>Next message: <A HREF="021659.html">[mod_python] concurrent connections
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21658">[ date ]</a>
              <a href="thread.html#21658">[ thread ]</a>
              <a href="subject.html#21658">[ subject ]</a>
              <a href="author.html#21658">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
