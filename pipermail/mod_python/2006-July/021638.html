<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] modpython, mysqldb best paractice
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20modpython%2C%20mysqldb%20best%20paractice&In-Reply-To=B6C73A5E30565245BB6D32B5F5DF7A520BEC8C%40sense.emmastraat.pijnacker">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="021636.html">
   <LINK REL="Next"  HREF="021639.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] modpython, mysqldb best paractice</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20modpython%2C%20mysqldb%20best%20paractice&In-Reply-To=B6C73A5E30565245BB6D32B5F5DF7A520BEC8C%40sense.emmastraat.pijnacker"
       TITLE="[mod_python] modpython, mysqldb best paractice">jpg at jgassociates.ca
       </A><BR>
    <I>Wed Jul 19 17:32:31 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="021636.html">[mod_python] modpython, mysqldb best paractice
</A></li>
        <LI>Next message: <A HREF="021639.html">[mod_python] Hosting Advice?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21638">[ date ]</a>
              <a href="thread.html#21638">[ thread ]</a>
              <a href="subject.html#21638">[ subject ]</a>
              <a href="author.html#21638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Martijn Moeling wrote:
&gt;<i> Deron Meranda wrote:
</I>&gt;&gt;<i> Perhaps you've got some suboptimal SQL.  For instance are you
</I>&gt;&gt;<i> doing a lot of sorts, or very large joins?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also what MySQL storage engine are you using?  InnoDB, or
</I>&gt;&gt;<i> MyISAM, etc?
</I>&gt;<i> 
</I>&gt;<i> Also, I'm not sure if you told us anything about your OS, apache version
</I>&gt;<i> and mpm (prefork or worker) or mod_python version.
</I>&gt;<i> 
</I>&gt;<i> The fact is the mod_python has memory leaks. We are tracking them down -
</I>&gt;<i> 3.2.8 is better than 3.1.4, and the next stable release will be better
</I>&gt;<i> yet. (Fixed a leak util.parse_qsl used in FieldStorage). Having
</I>&gt;<i> mod_python leak memory could impact mysql, causing heavy swapping when
</I>&gt;<i> trying to build a query result. Just a WAG and another thing to
</I>&gt;<i> consider.
</I>&gt;<i> 
</I>&gt;<i> Jim
</I>&gt;<i> 
</I>&gt;<i> -----------------------------
</I>&gt;<i> 
</I>&gt;<i> Thanx Jim, I did not know about the memory leaks, But you have a point
</I>&gt;<i> on the mysql behaviour, one of the implications of my system is lots of
</I>&gt;<i> queries
</I>&gt;<i> so the memory hunger of mysql seems justified.
</I>&gt;<i> 
</I>&gt;<i> I think I have mod_python 3.2.8, I will have a look
</I>&gt;<i> 
</I>&gt;<i> Considering memory leaks, do you think, altering the minserver,
</I>&gt;<i> maxserver, spare and alike parameters configuring apache, If there are
</I>&gt;<i> memory leaks killing the app in some automatic way does not clog up log
</I>&gt;<i> files etc. I rather have the overhead of process creation than then a
</I>&gt;<i> down server when I am windsurfing.  
</I>

I don't want to give the wrong impression. I'm not certain that you
*are* experiencing mod_python memory leaks, just that it is one
possibility. You may not experience any leaks at all - it just depends
on whether your code uses any of the leaky bits (and of course your
mod_python version). However in the interest of helping you relax and
enjoy your windsurfing, I'd set a value for MaxRequestsPerChild.
Something like 10000 might be a good starting point.

If you are otherwise happy with your performance then I'd leave the
other parameters as is.

Of course you are not managing it if you aren't measuring it, so you
should actually check and see if Apache / mod_python *is* leaking. I
find top in batch mode handy for this sort of thing.

top -b -u www-data -n 1 | grep apache2 &gt;&gt; mem.log

Stick this in a cron job and see if there is an upward trend in memory
consumption.

Jim
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="021636.html">[mod_python] modpython, mysqldb best paractice
</A></li>
	<LI>Next message: <A HREF="021639.html">[mod_python] Hosting Advice?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#21638">[ date ]</a>
              <a href="thread.html#21638">[ thread ]</a>
              <a href="subject.html#21638">[ subject ]</a>
              <a href="author.html#21638">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
