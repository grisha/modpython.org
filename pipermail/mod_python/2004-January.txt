From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:45:59 2004
Subject: No subject
Message-ID: <mailman.0.1073702759.54747.mod_python@modpython.org>

    Internal Server Error

    The server encountered an internal error or misconfiguration and was     
    unable to complete your request.

Other normal web request seem to work fine. 
This is what the error logs show...

    [Wed Aug  2 20:58:57 2000] [notice] caught SIGTERM, shutting down
    [Wed Aug  2 20:59:02 2000] [notice] Apache/1.3.12 (Unix) configured
-- resuming
        normal operations
    'import site' failed; use -v for traceback
    make_obcallback(): could not import mod_python.apache.
    make_obcallback(): could not call init.
    [Wed Aug  2 20:59:45 2000] [error] [client 202.77.245.126] python_handler:
        make_obcallback returned no obCallBack!


The mod_python module sits in 

        /usr/local/lib/python1.5/mod_python

    (along with other .pc. .pyc modules)


In my httpd.conf (everything is there, no srm.conf, access.conf), I have 

    AddHandler python-program .py
    PythonHandler pytest.py
    PythonDebug on
    PythonPath "sys.path+['/usr/local/lib/python1.5/mod_python']

this is within the <Directory..> directives for ~/apache/htdocs.
pytest.py is same as the "Hello World" example in the tutorial in
mod_python...


Also when in the Python interpreter, I try to load stuff manually, 
ie:

    >>> from mod_python import apache
    Traceback (innermost last):
    File "<stdin>", line 1, in ?
    File "/usr/local/lib/python1.5/mod_python/apache.py", line 18, in ?
        import _apache
    ImportError: No module named _apache
    >>>

and apache.py does indeed have the line "import _apache"

Loading other standard python modules like "sys" works OK, hence I think
PYTHONPATH seems OK.


config_info
------------------
Apache - 1.3.12
Python 1.5, compiled from source, standard
    (both are installed in /usr/local)
system Linux Mandrake 7.0, 2.2.12 kernel 
Compaq box, P3.


Any help from anyone will be appreciated.

Hope I can get this working. Would love to use Python for a few things here.



----------------------------------------------------------
Boh-heong Yap
Project Manager, eCommerce
				bohheong@asiacontent.com				

Asiacontent.com a leading pan-Asian Internet company,
with focus on: content, advertising and e-commerce.
-----------------------------------------------------------


From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:46:04 2004
Subject: No subject
Message-ID: <mailman.1.1073702764.54747.mod_python@modpython.org>

req.headers_out['Set-Cookie']='key=value'
req.headers_out['location'] = 'http://localhost/index.html'
return apache.HTTP_MOVED_TEMPORARILY

The problem seems to be that if I don't do req.send_http_header() the
Set-Cookie doesn't get sent so the cookie doesn't get set.  If I do call
req.send_http_header() the cookie does get set but it seems as though
two sets of headers are sent and the response code is 200.  Any ideas?

Geoff Cadien
geoff@infostreet.com

From rassilkapoemail at yahoo.com  Fri Jan  9 21:45:53 2004
From: rassilkapoemail at yahoo.com (rassilkapoemail@yahoo.com)
Date: Fri Jan  9 21:46:22 2004
Subject: [mod_python] Массовая рассылка вашей рекламы по 350.000 е-майлов.
Message-ID: <200106242108.f5OL8E296083@eden.ispol.com>

Массовая рассылка вашей рекламы по 350.000 е-майлов.
Стоимость 1$ - 1000 писем. Минимальный заказ 100$.

Разошлем Вашу рекламу по 42.000 организациям Москвы - 50$.

Пишите: rassilkapoemail@yahoo.com или email_reklama@yahoo.com
 
 
 
 
 
 
 
 

From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:46:23 2004
Subject: No subject
Message-ID: <mailman.2.1073702783.54747.mod_python@modpython.org>

is posible that is a problem in the debian package libpapache-mod-python.




-- 


From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:46:45 2004
Subject: No subject
Message-ID: <mailman.3.1073702805.54747.mod_python@modpython.org>

add_handler (htype, handler[, dir])
    Allows dynamic handler registration. htype is a string containing the
    name of any of the apache Python*Handler directives, e.g.
    "PythonHandler". handler is a string containing the name of the module
    and the handler function. Optional dir is a string containing the name of
    the directory to be added to the pythonpath. If no directory is
    specified, then, if there is already a handler of the same type
    specified, its directory is inherited, otherwise the directory of the
    presently executing handler is used.

However, if a PythonPath directive is in force, the third argument seems to
be ignored (from my reading of apache.py).  Two solutions present themselves:
(a) fix the documentation or (b) change the code to suit the documentation.

For the record, I'd prefer the latter.  It allows me to dynamically import
handlers directly instead of traversing long strings of Python packages.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:46:45 2004
Subject: No subject
Message-ID: <mailman.4.1073702805.54747.mod_python@modpython.org>

[Wed May 15 15:46:25 2002] [error] [client 127.0.0.1] Invalid method in
request
agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1

...and from the access log:

127.0.0.1 - - [15/May/2002:16:07:42 +0200] "POST /cgi/login.py HTTP/1.1" 200
1396
127.0.0.1 - - [15/May/2002:16:07:42 +0200]
"agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1" 501 459

So, it seems as the GET for the stylesheet is 'colliding' with the login
POST operation...?

This is not a problem when we keep the module cleanup loop. However, the
application is too slow when we have many simultaneous users, actually
slower than the old cgi, so we are trying to speed up everywhere we can.

The lock in cgihandler.py will prevent multiple simultaneous users? It seems
like it is. The server load is reduced, because there are no python
processes starting for each access, but the users perceive the application
as _slower_ than it was as a classic cgi, and I think it is because of the
lock in cgihandler.py beeing a bottleneck, slipping through only one user at
the time... is this the way mod_python is supposed to work?

win2k, SP2, 5.00.2195
apache 1.3.24
mod_python 2.7.4
python 2.1.3 (214)

--
Roger


From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:46:53 2004
Subject: No subject
Message-ID: <mailman.5.1073702813.54747.mod_python@modpython.org>

LoadModule python_module modules/mod_python276.dll
AddModule mod_python.c

ScriptAlias /python/ "C:/Program Files/Apache Group/Apache/htdocs/python/"

<Directory "C:/Program Files/Apache Group/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on
</Directory>

mod_python is located in C:\Python21\Lib\mod_python.  The folder has been
stripped of version numbers to just mod_python.  The following files are found
in the mod_python folder:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

When I try to start the Apache service, I get the error
"Could not start the Apache service on Local Computer.  The service did not
return an error.  This could be an internal Windows error or an internal service
error"
If I comment out the mod_python directives, it runs just fine.

Any help would be greatly appreciated and it will give the bruises on my head a
chance to heal ;-)

TIA,

Mark



From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:46:54 2004
Subject: No subject
Message-ID: <mailman.6.1073702814.54747.mod_python@modpython.org>

This routine gives allows for an opportunity to translate the URI into
an actual filename, before the server's default rules (Alias directives
and the like) are followed. 

Again, how do I do this?

I am implimenting a specialized web cache server and I need to resolve
an url to a path on my server - the logic to resolve the url to path is
the main part of my program.

I can easily enough just resove the url in my main handler and then
manually feed the client form the static file, but im ny oppionion
apache should be doing this itself.  I just need to tell it what file to
use.

My problem is that the request object members such as filename and the
like are read-only, so how do I pass the new filename back to apache?

Alex

From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:47:02 2004
Subject: No subject
Message-ID: <mailman.7.1073702822.54747.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From bogus@does.not.exist.com  Fri Jan  9 21:45:53 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:47:02 2004
Subject: No subject
Message-ID: <mailman.8.1073702822.54747.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From redconectabilbao at telefonica.net  Fri Jan  2 09:34:52 2004
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <20031231143016.GB10034@stellar.eradman.com>
References: <3FF29D8B.6030208@telefonica.net>
	<20031231143016.GB10034@stellar.eradman.com>
Message-ID: <3FF52D2C.70809@telefonica.net>

theman@stellar.eradman.com escribi?:

>One thing to watch out for is that when you're calling pages using the http://domain/script/function relative paths do not work corrrectly. So instead of href="estilo.css" it probably needs to be href="/estilo.css".
>
>Eric Radman
>theman@eradman.com
>
>Wed, Dec 31, 2003 at 10:57:31AM +0100, Red Conecta wrote:
>  
>
>>I'm trying to use css with the publisherhandler; here is the code:
>>
>>   def _inicio():
>>       ini= '''<head><title>nombredelsitio</title>
>>                 <link rel="stylesheet" href="estilo.css"
>>   Type="text/css"></head>
>>                 <body leftmargin=0 rightmargin=0 topmargin=0
>>   bottommargin=0>'''
>>      
>>       return ini
>>
>>   def _final():
>>       return '</body></html>'
>>
>>   def mostrar(req,direccion='/'):
>>       req.content_type = "text/html"
>>       html=_inicio()
>>       obj=leerobjeto(direccion)
>>       if obj!=None:
>>           for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>>       else:html+='error'
>>       html+=_final()
>>       return html
>>
>>the output doesn't use the estilo.css archive but if I save the page in 
>>'mostrar.html' all is ok.
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>    
>>
>
>  
>
I've tryed /estilo.css, ./estilo.css, ../estilo.css and 
/var/www/html/portal/estilo.css, but it still doesn't work

From stian at soiland.no  Fri Jan  2 10:42:49 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <20040102094249.GC11946@itea.ntnu.no>

On 2003-12-31 10:57:31, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:

You've probably used SetHandler instead of AddHandler. SetHandler eats
ALL requests for the directory and passes them on to mod_python.
Effectually static files like your css-file is therefore unavailable.

Solutions:
   
   a) Create one or more static-directories with SetHandler none
      (these could be called "css", "images", etc.)

   b) Place static files somewhere outside the directory structure
      handled by SetHandler python-program
   
   c) Use AddHandler python-program .py instead
      (requires a .py-ending for all mod-python requests)     

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From grisha at modpython.org  Fri Jan  2 16:43:46 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <20040102094249.GC11946@itea.ntnu.no>
References: <3FF29D8B.6030208@telefonica.net>
	<20040102094249.GC11946@itea.ntnu.no>
Message-ID: <20040102164112.Q70689@onyx.ispol.com>


There also:

   d) SetHandler None
      To reverse any previous SetHandler directives to default Apache
      behaviour. Handy for those images/ or styles/ directories.

Grisha

On Fri, 2 Jan 2004, Stian [iso-8859-1] S?iland wrote:

> On 2003-12-31 10:57:31, Red Conecta wrote:
>
> > I'm trying to use css with the publisherhandler; here is the code:
>
> You've probably used SetHandler instead of AddHandler. SetHandler eats
> ALL requests for the directory and passes them on to mod_python.
> Effectually static files like your css-file is therefore unavailable.
>
> Solutions:
>
>    a) Create one or more static-directories with SetHandler none
>       (these could be called "css", "images", etc.)
>
>    b) Place static files somewhere outside the directory structure
>       handled by SetHandler python-program
>
>    c) Use AddHandler python-program .py instead
>       (requires a .py-ending for all mod-python requests)
>
> --
> Stian S?iland               Work toward win-win situation. Win-lose
> Trondheim, Norway           is where you win and the other lose.
> http://www.soiland.no/      Lose-lose and lose-win are left as an
>                             exercise to the reader.  [Limoncelli/Hogan]
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:23:33 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
Message-ID: <000101c3d248$3c485f00$6400a8c0@infoserve.net>

How do you get a second frame to refresh a grid on a first frame? I have a
wxGrid on my main frame that is populated from a database. Double clicking a
row in that grid brings up a second frame where an individual record is
displayed. When the user clicks a submit button on the second form, it
updates the database, then closes the second form. I then want the grid on
the first frame to refresh. I know that I can access the grid from the
second frame because if I code:
 
frame.grid.Destroy()
 
it destroys the grid on the first frame. But this has no effect:
 
frame.grid.ForceRefresh()
 
Any suggestions?
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/d50365e9/attachment.htm
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:32:42 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] CANNOT FIND mod_python
Message-ID: <000b01c3d249$83b0e640$6400a8c0@infoserve.net>

I have Apache 2.0.48(Win32), mod_python 3.0.4 and Python 2.3.2. When I set
up the PythonHandler as mptest.py as indicated in the documention for
mod_python, the browser can find mypython.py. However, when I switch the
handler in httpd.conf as suggested to:
 
PythonHandler mod_python.publisher
 
I get a 404, cannot find mypython.py
 
I know that it is finding the modules/mod_python.so file because Apache
gives me an error if I hide it.
 
Any suggestions?
 
Thanks
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/66dd2090/attachment.htm
From eurleif at ecritters.biz  Sun Jan  4 02:49:15 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
Message-ID: <3FF7C57A.2090002@ecritters.biz>

Sorry for the newbie question, but how do I parse query strings, handle 
POST data, and such? Is there a library I should be using?

From manfred.stienstra at dwerg.net  Sun Jan  4 12:55:40 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
In-Reply-To: <3FF7C57A.2090002@ecritters.biz>
References: <3FF7C57A.2090002@ecritters.biz>
Message-ID: <1073217340.10014.3.camel@ack.dwerg.net>

On Sun, 2004-01-04 at 08:49, Leif K-Brooks wrote:
> Sorry for the newbie question, but how do I parse query strings, handle 
> POST data, and such? Is there a library I should be using?

In the util module, there is a FieldStorage object.

fs = util.FieldStorage(request, True)

http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html

If you don't like it, you free to do it some other way (:

Manfred

From rmangaliag at slu.edu.ph  Mon Jan  5 15:19:29 2004
From: rmangaliag at slu.edu.ph (ali)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] a newbie on sessions and psp
Message-ID: <003301c3d35c$41e53c20$da19a8c0@slu.edu.ph>

hi.. am a modpyton newbie...

can someone please give me an example of sessions applied in psp...

thanks...

ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040105/e3c5c90f/attachment.htm
From dwmp at opti.cgi.net  Mon Jan  5 01:41:02 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] OutputFilter example
Message-ID: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>


In the example of the output filter in the 3.1.2b documentation the last 
lines seem to indicate that filter.close() should only be called if 
filter.read() returns None.  I paired up an output filter this evening with 
the mod_python.psp handler and I was getting an empty string on the last 
filter.read() for every request.  The example code only calls 
filter.close() if the last read result is None.  Not calling filter.close() 
on the first call caused the output filter handler to be called a second 
time.  The second time around, it tried to read from filter.read() and got 
None, therefore calling filter.close() and ending the cycle.  Should this 
be normal behavior or should I be calling filter.close() when filter.read() 
returns empty string as well?

My server config:

     AddHandler mod_python .psp
     PythonHandler mod_python.psp | .psp
     PythonOutputFilter mypackage.mymodule TESTFILTER
     AddOutputFilter TESTFILTER .psp


-Dan

From eurleif at ecritters.biz  Mon Jan  5 02:40:33 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Are there any good examples?
Message-ID: <3FF914F1.50609@ecritters.biz>

I'm trying to learn to use mod_python well, and I can't find too many 
examples to learn from. Is there a site with examples somewhere?

From davidf at sjsoft.com  Mon Jan  5 10:15:34 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
In-Reply-To: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
References: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
Message-ID: <3FF91D26.2090109@sjsoft.com>

Jim OLeary wrote:

>How do you get a second frame to refresh a grid on a first frame? I have a
>wxGrid on my main frame that is populated from a database.
>  
>
Why are you asking about wxGrid on a mailing list that is about a python 
application server???

>Double clicking a row in that grid brings up a second frame where an individual record is
>displayed. When the user clicks a submit button on the second form, it
>updates the database, then closes the second form. I then want the grid on
>the first frame to refresh. I know that I can access the grid from the
>second frame because if I code:
> 
>frame.grid.Destroy()
> 
>it destroys the grid on the first frame. But this has no effect:
> 
>frame.grid.ForceRefresh()
> 
>Any suggestions?
>  
>
You probably are asking these questions on the wrong list. If not please 
confirm and clarify, as this is not a wxWindows mailing list...

David
From fowlertrainer at anonym.hu  Mon Jan  5 09:46:10 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <84772282.20040105094610@anonym.hu>

Hi !

I want to control my website with only one py file: the main.py.
But I got experience with one ugly thing in mod_python.

In mod_php, the main.php file is can include many files, and all of
them can include many other files.
When I modify some or one of these files, the website is refreshed.

But in mod_python, I cannot use the include, I have only one way to share/split my sources: the import.
It is ok, but when I modify some of these imported files, the website is not refreshed !!!

My solution in this time to I use only one file.
It is not too good, because it is growing too much, and I cannot
separate it to units.

Have any solution to this problem ????

Thanx for any advance !!!

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Mon Jan  5 09:47:34 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Zope Access Rule in mod_py
Message-ID: <754856212.20040105094734@anonym.hu>

Hi !

My problem is that.
I want to use only one main.py file in my mod_python site.
But I want to handle some virtual paths.

So the structure is:
- root+
------+main.py

I want to this:

When the user type this path:
http://root/users/files/work1
then the Apache don't raise an error, only call a py file's procedure with this path.

I can take this path, and do anything what I needed. If the path is wrong, I can show error message, if not, 
I can show the result. In the example the path is don't exists, but I redirect the process to the my UserFileHandler method,
and I do get this user file named "Work1".

This is just like Access Rule in Zope.

Can I do that in mod_python ?

Thanx:
 KK



From fowlertrainer at anonym.hu  Mon Jan  5 09:50:28 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] Session handling: example needed
Message-ID: <1835030833.20040105095028@anonym.hu>

Hi !

My problem is that: I want to create a site with session handling.
But: the mod_python Cookie or Session handling is not working in my
machine, or I have some wrong trying with this.

Anyone has an working example, what I can try ?

{
My idea is that: I set an special named cookie in browser.
The cookie's value is the session id.
When it is setted, the req is get the sid, and get the session data
from session dictionary with sid.
It is wrong way ?
}


Thanx for any advance !
KK


From fowlertrainer at anonym.hu  Mon Jan  5 09:55:17 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:03 2004
Subject: [mod_python] One file controlled site: howto
Message-ID: <1245319669.20040105095517@anonym.hu>

Hello !

I want to control my website with one file, the main.py.
I want that:
 - the index, or index.html, or the empty request is redirected to
   main.py
   http://rootdir/index
   http://rootdir/index.html
   http://rootdir/index.htm
   http://rootdir/main
   http://rootdir/

   is let same thing, everyone is let load the main.py.
   
 - the main.py is let hidden in request !
   or if it is not possible, the .py is let hidden !
   So the site is let used with this:
   http://rootdir/
   or
   http://rootdir/main
   and not
   http://rootdir/main.py


Can anyone help me with this tricks ?

Thanx:
 KK


From ograf at rz-online.net  Mon Jan  5 12:19:12 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
Message-ID: <20040105111912.GJ25566@rz-online.net>

[already send this to python-dev@httpd.apache.org, but got nothing
back...]

Hi!

The resolve_object method does not work with class instances.

The error is simple: in line 551 there is a if

        if silent and not hasattr(module, obj_str):
            return None

this checks always module for obj_str. But it should check the current
obj in traversal!

So correct would be:

        if silent and not hasattr(obj, obj_str):
            return None

Regards,
  Oliver.

-------------- next part --------------
--- mod_python-3.1.2b/lib/python/mod_python/apache.py.orig	2004-01-05 11:16:44.000000000 +0100
+++ mod_python-3.1.2b/lib/python/mod_python/apache.py	2004-01-05 11:16:53.000000000 +0100
@@ -552,7 +552,7 @@
             return None
 
         # this adds a little clarity if we have an attriute error
-        if obj == module and not hasattr(module, obj_str):
+        if obj == module and not hasattr(obj, obj_str):
             if hasattr(module, "__file__"):
                 s = "module '%s' contains no '%s'" % (module.__file__, obj_str)
                 raise AttributeError, s
From ograf at rz-online.net  Mon Jan  5 12:26:28 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
In-Reply-To: <20040105111912.GJ25566@rz-online.net>
References: <20040105111912.GJ25566@rz-online.net>
Message-ID: <20040105112628.GK25566@rz-online.net>

On Mon, Jan 05, 2004 at 12:19:12PM +0100, Oliver Graf wrote:
> [already send this to python-dev@httpd.apache.org, but got nothing
> back...]
> 
> Hi!
> 
> The resolve_object method does not work with class instances.

actually this should read 'does not work with object subpaths'...

So any module::obj.subobj.method handler should not work without the
patch...

Oliver.

From kevin at sb.org  Mon Jan  5 07:38:27 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <84772282.20040105094610@anonym.hu>
References: <84772282.20040105094610@anonym.hu>
Message-ID: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>

There's an easy solution:

Keep a table of the modification dates of the relevant modules. In your 
handler function, compare the modification dates you stored with the 
current ones, and if any differ call reload() on that module.

If you want an example, ask me and I can make one. But it shouldn't be 
too hard to do on your own.

HTH,
Kevin

On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:

> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
>
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
>
> But in mod_python, I cannot use the include, I have only one way to 
> share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the website 
> is not refreshed !!!
>
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
>
> Have any solution to this problem ????

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:46:01 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <754856212.20040105094734@anonym.hu>
References: <754856212.20040105094734@anonym.hu>
Message-ID: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Well, that URL isn't valid. I assume you mean something like

http://my.domain.com/root/users/files/work1

right?

That's not hard. There's a few variations on the solution:

1) If you want it to only work for valid directory trees (i.e. 
/root/users/files/work1 is valid but /root/foo/bar wouldn't be, 
assuming /root/foo doesn't exist) then you can use a <Directory> 
directive. Stick a SetHandler python-program and PythonHandler main in 
there (assuming the directory with main.py will be in the Python path, 
i.e. if the main.py is in the directory specified in the <Directory> 
directive. If it's not there, use the PythonPath directive to tell it 
where to look).

2) If you want it to work for all paths that match a pattern (say, all 
paths starting with /root/) then use a <Files> directive and set the 
same handlers as #1. Same caveats with the python include path.

3) If you want it to apply to every single request to your site, add 
the handlers from #1 in the root level of your httpd.conf file. Same 
caveats apply to the include path for main.py (although since this 
isn't nested, it's just the default Python path so you'll need to add 
the directory for main.py, such as sys.path+['/foo'])

HTH,
Kevin

On Jan 5, 2004, at 3:47 AM, fowlertrainer@anonym.hu wrote:

> I want to this:
>
> When the user type this path:
> http://root/users/files/work1
> then the Apache don't raise an error, only call a py file's procedure 
> with this path.
>
> I can take this path, and do anything what I needed. If the path is 
> wrong, I can show error message, if not,
> I can show the result. In the example the path is don't exists, but I 
> redirect the process to the my UserFileHandler method,
> and I do get this user file named "Work1".
>
> This is just like Access Rule in Zope.
>
> Can I do that in mod_python ?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:49:29 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
References: <754856212.20040105094734@anonym.hu>
	<1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <9A4F92CA-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Erm, I mean a <Location> directive.

On Jan 5, 2004, at 7:46 AM, Kevin Ballard wrote:

> 2) If you want it to work for all paths that match a pattern (say, all 
> paths starting with /root/) then use a <Files> directive and set the 
> same handlers as #1. Same caveats with the python include path.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From vincent_delft at yahoo.com  Mon Jan  5 09:55:57 2004
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <20040105175557.63346.qmail@web11501.mail.yahoo.com>

Draco does what Kevin explain.
Among other, allows you to use the "inclide" like in
PHP.

(check the "links" page).



--- Kevin Ballard <kevin@sb.org> wrote:
> There's an easy solution:
> 
> Keep a table of the modification dates of the
> relevant modules. In your 
> handler function, compare the modification dates you
> stored with the 
> current ones, and if any differ call reload() on
> that module.
> 
> If you want an example, ask me and I can make one.
> But it shouldn't be 
> too hard to do on your own.
> 
> HTH,
> Kevin
> 
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu
> wrote:
> 
> > I want to control my website with only one py
> file: the main.py.
> > But I got experience with one ugly thing in
> mod_python.
> >
> > In mod_php, the main.php file is can include many
> files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the
> website is refreshed.
> >
> > But in mod_python, I cannot use the include, I
> have only one way to 
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported
> files, the website 
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too
> much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
> 
> -- 
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From brianh at exelixis.com  Mon Jan  5 11:31:56 2004
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <Pine.GSO.4.44.0401051125160.28612-100000@timeless.exelixis.com>

be careful though; there are some hidden gotchas lurking in this solution.
for example, if you reload a module defining some base class, but don't
reload all modules defining subclasses of that base, then the base class
object will no longer be the same as the corresponding base class object
in the __bases__ list for subclasses, and isinstance(sub, base) will fail
(leading to other failures, like the new builtin 'super' won't work
properly).

i did a lot of head scratching before i figured this out; but if all
you're reloading are static configuration modules exporting simple things
like constant immutable string or numeric variables, you should be ok.

cheers,
brian


On Mon, 5 Jan 2004, Kevin Ballard wrote:

> There's an easy solution:
>
> Keep a table of the modification dates of the relevant modules. In your
> handler function, compare the modification dates you stored with the
> current ones, and if any differ call reload() on that module.
>
> If you want an example, ask me and I can make one. But it shouldn't be
> too hard to do on your own.
>
> HTH,
> Kevin
>
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:
>
> > I want to control my website with only one py file: the main.py.
> > But I got experience with one ugly thing in mod_python.
> >
> > In mod_php, the main.php file is can include many files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the website is refreshed.
> >
> > But in mod_python, I cannot use the include, I have only one way to
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported files, the website
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From neel at mediapulse.com  Mon Jan  5 14:33:55 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <C0FC22C08B82074A88B500617641577787A7FD@johnson.mediapulse.net>

We use the reload method here, if PythonDebug is set to on, basically:

    debug = req.get_config().has_key('PythonDebug')

    if debug:
        reload(www_forms)
        reload(globals)

See the python docs on reload before using, it doesn't work in all
cases.  I also think there was a mention on the list of an apache.import
method to use so this wouldn't be needed, so you may want to do some
searching on the archives; not sure if it was a mod_python thing or a
patch someone did.

Mike

> -----Original Message-----
> From: fowlertrainer@anonym.hu [mailto:fowlertrainer@anonym.hu] 
> Sent: Monday, January 05, 2004 3:46 AM
> To: mod_python@modpython.org
> Subject: [mod_python] mod_php vs mod_py - include vs. import
> 
> 
> Hi !
> 
> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
> 
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
> 
> But in mod_python, I cannot use the include, I have only one 
> way to share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the 
> website is not refreshed !!!
> 
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
> 
> Have any solution to this problem ????
> 
> Thanx for any advance !!!
> 
> -- 
> Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From kevin at sb.org  Mon Jan  5 15:30:37 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Internal Server Errors on restart
Message-ID: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>

I've found some odd problems with mod_python. The big one is that if I 
ever do a restart of my apache server (graceful or not), the next time 
I access a python script, I get an internal server error, and this 
persists until I shut down the server, wait for all the processes to 
die off, and then start it back up. Also, nothing is put in the error 
log for the Internal Server Error, which is also strange.

Does anybody have any information on this?

Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS 
X Panther Server without actually running it by hand (i.e. replacing 
all the standard access to Apache 1.3 through things like Server Admin 
with access to Apache 2). Yes, Apache 2 comes on Panther Server, but 
it's hidden in /opt/apache2/ and there's no GUI way to access it.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Jan  5 12:46:23 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <3FF9CD1F.5010304@dynamine.net>

Kevin Ballard wrote:
> I've found some odd problems with mod_python. The big one is that if I 
> ever do a restart of my apache server (graceful or not), the next time I 
> access a python script, I get an internal server error, and this 
> persists until I shut down the server, wait for all the processes to die 
> off, and then start it back up. Also, nothing is put in the error log 
> for the Internal Server Error, which is also strange.
> 
> Does anybody have any information on this?

I don't know, but I have the same problem (running Panther as well).

> Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS X 
> Panther Server without actually running it by hand (i.e. replacing all 
> the standard access to Apache 1.3 through things like Server Admin with 
> access to Apache 2). Yes, Apache 2 comes on Panther Server, but it's 
> hidden in /opt/apache2/ and there's no GUI way to access it.

If there is a way, I'm unaware of it.  The documentation says the 
installation in /opt/apache2 is "for experimental purposes."  Don't try 
to use it for mod_python though, because the apxs configuration is wrong 
and it won't compile properly.  (I did my own Apache 2 installation in 
/usr/local/apache2.)

I use mod_proxy on the front-end Apache 1.3 server to pass through 
mod_python requests to the back-end Apache 2.0 server.

--Michael
From grisha at modpython.org  Mon Jan  5 21:58:24 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <20040105215701.M19958@onyx.ispol.com>


I think this is the way it's supposed to work.

On Mon, 5 Jan 2004, Dan W. wrote:

>
> In the example of the output filter in the 3.1.2b documentation the last
> lines seem to indicate that filter.close() should only be called if
> filter.read() returns None.  I paired up an output filter this evening with
> the mod_python.psp handler and I was getting an empty string on the last
> filter.read() for every request.  The example code only calls
> filter.close() if the last read result is None.  Not calling filter.close()
> on the first call caused the output filter handler to be called a second
> time.  The second time around, it tried to read from filter.read() and got
> None, therefore calling filter.close() and ending the cycle.  Should this
> be normal behavior or should I be calling filter.close() when filter.read()
> returns empty string as well?
>
> My server config:
>
>      AddHandler mod_python .psp
>      PythonHandler mod_python.psp | .psp
>      PythonOutputFilter mypackage.mymodule TESTFILTER
>      AddOutputFilter TESTFILTER .psp
>
>
> -Dan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Mon Jan  5 22:57:41 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <3FF9CD1F.5010304@dynamine.net>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
	<3FF9CD1F.5010304@dynamine.net>
Message-ID: <79B6A1A3-3FFC-11D8-9AD2-000A95A072FC@sb.org>

Well, *that's* silly. I simply edited the .mk files in 
/opt/apache2/build to remove the -arch i386 strings from a few lines 
and it compiled just fine!

On Jan 5, 2004, at 3:46 PM, Michael S. Fischer wrote:

> If there is a way, I'm unaware of it.  The documentation says the 
> installation in /opt/apache2 is "for experimental purposes."  Don't 
> try to use it for mod_python though, because the apxs configuration is 
> wrong and it won't compile properly.  (I did my own Apache 2 
> installation in /usr/local/apache2.)
>
> I use mod_proxy on the front-end Apache 1.3 server to pass through 
> mod_python requests to the back-end Apache 2.0 server.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From dwmp at opti.cgi.net  Mon Jan  5 22:50:57 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <20040105215701.M19958@onyx.ispol.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
 <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040105224658.01196ec8@mail.pyxos.com>


I don't see why two calls would make sense.  On the second call the headers 
have already been sent, so I can't modify those and the body has already 
been sent as well and the very first call to filter.read() returns 
None.  On the other hand, if I do filter.close() when I receive empty 
string from filter.read() then I only end up with one call to my output 
filter and everything works normally.

-Dan



At 09:58 PM 1/5/2004 -0500, you wrote:

>I think this is the way it's supposed to work.
>
>On Mon, 5 Jan 2004, Dan W. wrote:
>
> >
> > In the example of the output filter in the 3.1.2b documentation the last
> > lines seem to indicate that filter.close() should only be called if
> > filter.read() returns None.  I paired up an output filter this evening with
> > the mod_python.psp handler and I was getting an empty string on the last
> > filter.read() for every request.  The example code only calls
> > filter.close() if the last read result is None.  Not calling filter.close()
> > on the first call caused the output filter handler to be called a second
> > time.  The second time around, it tried to read from filter.read() and got
> > None, therefore calling filter.close() and ending the cycle.  Should this
> > be normal behavior or should I be calling filter.close() when filter.read()
> > returns empty string as well?
> >
> > My server config:
> >
> >      AddHandler mod_python .psp
> >      PythonHandler mod_python.psp | .psp
> >      PythonOutputFilter mypackage.mymodule TESTFILTER
> >      AddOutputFilter TESTFILTER .psp
> >
> >
> > -Dan
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From dwmp at opti.cgi.net  Mon Jan  5 23:44:34 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] PythonOption and PythonImport
Message-ID: <5.2.1.1.2.20040105234211.0394ad68@mail.pyxos.com>


Is there any way to get to PythonOptions from the PythonImport startup 
script?  From the documentation it appears as though I can only get to 
PythonOptions from the request object.

-Dan

From jay at jaydorsey.com  Tue Jan  6 09:39:44 2004
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] One file controlled site: howto
In-Reply-To: <1245319669.20040105095517@anonym.hu>
References: <1245319669.20040105095517@anonym.hu>
Message-ID: <20040106153944.GA3462@gentoo.Earthlink.net>

On Mon, Jan 05, 2004 at 09:55:17AM +0100, fowlertrainer@anonym.hu wrote:
> Hello !
> 
> I want to control my website with one file, the main.py.
> I want that:
<snip>    
>  - the main.py is let hidden in request !
You can do this with mod_python by adding a request handler 
in your httpd.conf file, similar to this:

<Directory /path/to/webroot>
AddHandler python-program
PythonHandler main
</Directory>

The main.py script will be executed each time a document is 
requested in the /path/to/webroot folder.


hth


-- 
Jay Dorsey
jay at jaydorsey dot com
From jalil at securia.com  Tue Jan  6 17:40:20 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Params submitted using utf-8
Message-ID: <3FFB6384.2010408@securia.com>

    I have a form that submits some text using utf-8 encoding and I 
process the form using  mod_python on Apache.

- When I read in a parameter value and print the type of the string, it 
is "str" and not "unicode". I know unicode is not "utf-8" and I think 
this is fine

- When I try to decode the value into "utf-8" and turn it into unicode 
in python, I get an exception (decoding error - invalid data). Why is 
that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
so why I get invalid data?

- The reason I decided doing above is that I have a table in MySQL which 
is using
utf-8 character sets. Everything works fine if I put the received data 
directly into my table and read it back and send it to browser but two 
problems happen if I do this. First, some characters don't display 
right. Second, althought I set the charset in my returned data to utf-8, 
the browser doesn't select utf-8 as encoding. So, I thought maybe I 
should try to convert into unicode b/f putting the data into my table. 
Is this right? Should I  do anything b/f storing and/or sending the data?

I appriciate any help.

-Jalil


From robert at leftwich.info  Wed Jan  7 15:09:07 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150406.01b14d70@192.168.0.1>

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt)
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From dwmp at opti.cgi.net  Tue Jan  6 22:18:27 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] AddOutputFilterByType
Message-ID: <5.2.1.1.2.20040106213833.03ad4420@mail.pyxos.com>


I'm running a PSP script which outputs a PNG image.  The PSP script sets 
the req.content_type to image/png but its still going through a mod_python 
filter I have setup with AddOutputFilterByType.  The AddOutputFilterByType 
is setup for two types, text/html and text/plain.  Does changing 
req.content_type not update the Apache info before it gets to the filtering 
stage?  Can this be fixed?

-Dan
mod_python: 3.1.2b
apache: 2.0.48
python: 2.3.2
linux: 2.4


From robert at leftwich.info  Wed Jan  7 15:23:26 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>

Sorry - finger trouble on the first attempt:

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt) and the second serves up some xml after first 
filtering it (again via libxslt). The problem I have is when I ask the 
first service to run some xsl on an xml file where the xsl uses the 
document() function to access the second service, the second service is 
never accessed and there is nothing in any of the logs to suggest otherwise.
I tried setting mod_python to use different child interpreters but it made 
no difference. Some googling turned up 
(http://www.modpython.org/pipermail/mod_python/2003-June/003307.html) 
where Grisha says in answer to Paul Robinson:

"> For example, on a Windows platform where there is a single
 > multi-threaded Apache process (mpm_wint
 > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
 > say that mod_python would not be able to take advantage of a
 > multi-processor machine due to the GIL?

The answer, unfortunately, is yes. Here is a google search that has some
info on the subject: http://www.google.com/search?q=python+free-threading

AFAIK the state of things has not changed with respect to SMP and GIL."

So it appears that I am running into this limitation. Is there any 
alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
useable?

Robert
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From manfred.stienstra at dwerg.net  Wed Jan  7 07:32:31 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <1073457151.15608.15.camel@ack.dwerg.net>

On Wed, 2004-01-07 at 02:40, jalil@securia.com wrote:
> - When I read in a parameter value and print the type of the string, it 
> is "str" and not "unicode". I know unicode is not "utf-8" and I think 
> this is fine

Yes, this should be a utf-8 encoded string. Personally I think no
application should convert this data to a unicode object because you
always want to know the encoding it came from. For example utf-8 ->
unicode object -> iso8859-15 could mean loss of characters.

> - When I try to decode the value into "utf-8" and turn it into unicode 
> in python, I get an exception (decoding error - invalid data). Why is 
> that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
> so why I get invalid data?

Are you using the unicode constructor or an decode method? Also, a bad
browser could send something that is not unicode, you should always
expect unicode errors here.

Here is a nice introduction to the whole encode/decode confusion:

http://www.vandervossen.net/2003/07/unicode_in_python

> Second, althought I set the charset in my returned data to utf-8, 
> the browser doesn't select utf-8 as encoding.

If the document isn't utf-8 encoded and the headers claim it is, the
browser could try to correct it and show the proper encoding.

> So, I thought maybe I 
> should try to convert into unicode b/f putting the data into my table. 
> Is this right? Should I  do anything b/f storing and/or sending the data?

Yes, you should check the input. You don't have to do this by converting
the string into a unicode object, but you can do it by checking the byte
ordering (see the utf-8 specifications for more information).

Manfred

From ograf at rz-online.net  Wed Jan  7 08:22:01 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040107072201.GD3045@rz-online.net>

On Wed, Jan 07, 2004 at 03:23:26PM +1100, Robert Leftwich wrote:
> "> For example, on a Windows platform where there is a single
> > multi-threaded Apache process (mpm_wint
> > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
> > say that mod_python would not be able to take advantage of a
> > multi-processor machine due to the GIL?
> 
> The answer, unfortunately, is yes. Here is a google search that has some
> info on the subject: http://www.google.com/search?q=python+free-threading
> 
> AFAIK the state of things has not changed with respect to SMP and GIL."
> 
> So it appears that I am running into this limitation. Is there any 
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
> useable?

Out of my stomach I would answer: this is an apache topic, mod_python
will do whatever apache can do. So If there is a mpm for apache under
win32 that does forks (no mpm_prefork for win32? can't believe this,
but I never used this win32 platform...) mod_python should behave well
with SMP...

Oliver.

P.S.: If I am wrong, I'm really interested why. :)

From blazek at firma.seznam.cz  Wed Jan  7 09:59:54 2004
From: blazek at firma.seznam.cz (Vaclav Blazek)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040107072201.GD3045@rz-online.net>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
	<20040107072201.GD3045@rz-online.net>
Message-ID: <200401070959.54180.blazek@firma.seznam.cz>

Dne st 7. ledna 2004 08:22 Oliver Graf napsal(a):
> Out of my stomach I would answer: this is an apache topic, mod_python
> will do whatever apache can do. So If there is a mpm for apache under
> win32 that does forks (no mpm_prefork for win32? can't believe this,
> but I never used this win32 platform...) mod_python should behave well
> with SMP...
>
> Oliver.
>
> P.S.: If I am wrong, I'm really interested why. :)

Hallo,

fork() (process duplication) is unix specific feature, no other kind of system 
has it. On non-unix platforms you have to use threading instead. But as you 
know, threads are evil :-). You can be sure you propperly synchronize 
everything but... just try to close one file descriptor twice and disaster is 
near at hand...

Vasek

PS I've heard the new version of OpenVMS will have fork().

From fowlertrainer at anonym.hu  Wed Jan  7 10:09:27 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Have the mod_python an example store on web... ?
Message-ID: <306091519.20040107100927@anonym.hu>

Hello mod,

  ... or other site, what have online FAQ, or other ?
  I have some modules, and I send these modules, if needed.
  (A persistent DB connection pool, and a session manager tool)

  I want to send it/share it, because I use win32 mod_py, and I want to remove
  bugs (by found another users), and to help the mod_python to staying
  alive/growing/advancing.

  I want to learn the mod_py, get more and more knowledge, and I
  possible, share these informations with anothers.

  Thanx.

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From kevin at sb.org  Wed Jan  7 11:02:42 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <ECE51A3C-412A-11D8-9AD2-000A95A072FC@sb.org>

To make the browser display as UTF-8, you need to tell it to do that 
either in the headers or in a <meta> tag in the source.

On Jan 6, 2004, at 8:40 PM, jalil@securia.com wrote:

> - The reason I decided doing above is that I have a table in MySQL 
> which is using
> utf-8 character sets. Everything works fine if I put the received data 
> directly into my table and read it back and send it to browser but two 
> problems happen if I do this. First, some characters don't display 
> right. Second, althought I set the charset in my returned data to 
> utf-8, the browser doesn't select utf-8 as encoding. So, I thought 
> maybe I should try to convert into unicode b/f putting the data into 
> my table. Is this right? Should I  do anything b/f storing and/or 
> sending the data?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From spoerri at duke.edu  Thu Jan  8 10:33:40 2004
From: spoerri at duke.edu (Christoph Spoerri)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] RE: Session handling: example needed
Message-ID: <200401081033.40738.spoerri@duke.edu>

Hi list users,

I saw that recently somebody added for an example of using the session 
handler. I was looking for the same with out any luck, but was able to get 
things working (love the trial-and-error stuff ;) ).

I have attached a short script that uses two counters (int and object) to 
count the number of visits by the users during a session.

Notes:
- use is_new() to check if you have a new session or not before you use it (as 
mentioned in the manual)
- you need to save the session object at the end otherwise, the ID and any 
other stuff won't be saved (!), and you'll be wondering what happend to the 
session (as I did).

cheers,
Christoph

PS: I'm new to python, so forgive me any strange python coding.

***************** session_sample.py ***********************

from mod_python import apache

class simpelCountClass:
	count = 0
	def __init__(self,c):
		self.count = c
	def increment(self):
		self.count = self.count+1
	def asString(self):
		return str(self.count)


def sessionTest(req):
	req.content_type = "text/html"
	s = "<html><body>testing<br>"

	t = Session.DbmSession(req)
	if (t.is_new()):
		s += "new session id: "+str(t.id())+"<br>"
		t['count']=1
		t['countObj']=simpelCountClass(1)

	else:
		s += "session id: "+str(t.id())+"<br>"
		t['count']=t['count']+1
		t['countObj'].increment()

	s += "count: "+str(t['count'])+"<br>"
	s += "countObj: "+t['countObj'].asString()+"<br>"
	s += "timeout: "+str(t.timeout())+"<br>"
	s += "created: "+str(t.created())+"<br>"
	s += "last_accessed: "+str(t.last_accessed())+"<br>"
	s += "</body></html>"
	t.save() # DON'T FORGET THIS ONE!!!
	return s

From dg at sponsera.com  Thu Jan  8 14:30:26 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFDAFD2.1010708@sponsera.com>

Help!

I have the weirdest problem - I am using the following:

redhat9
mysql 4.0.13
mod_python 3.0.4
python 2.2.3
MySQL-python 0.9.2 (python interface to the mysql libraries)
apache 2.0.47

When I run ordinary python programs to access the mysql database, things 
seem to work fine. (i can connect to the database, so selects, updates, etc)

When I run identical queries under mod_python via request to apache, 
apache tends to core dump on database accesses - or sometimes, doesn't 
core dump but I get very strange,inconsistant results.

Any ideas? Are "threads" an issue? I am almost positive the python 
enviornment that apache is getting is the same as the "normal" environment.

I just have no idea why this is happening - I have used mod_python w/ 
mysql before, with generally very good results.

Thanks a lot!

David





From chip at force-elite.com  Thu Jan  8 11:44:24 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDAFD2.1010708@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com>
Message-ID: <3FFDB318.2090401@force-elite.com>

Are you running mod_auth_mysql or any other apache modules that use 
MySQL Client Connections?

Make sure they are all compiled with the exact same client lib versions..

Also, did you build from source, or are you using someones RPMs?

-Paul Querna

David Geller wrote:
> Help!
> 
> I have the weirdest problem - I am using the following:
> 
> redhat9
> mysql 4.0.13
> mod_python 3.0.4
> python 2.2.3
> MySQL-python 0.9.2 (python interface to the mysql libraries)
> apache 2.0.47
> 
> When I run ordinary python programs to access the mysql database, things 
> seem to work fine. (i can connect to the database, so selects, updates, 
> etc)
> 
> When I run identical queries under mod_python via request to apache, 
> apache tends to core dump on database accesses - or sometimes, doesn't 
> core dump but I get very strange,inconsistant results.
> 
> Any ideas? Are "threads" an issue? I am almost positive the python 
> enviornment that apache is getting is the same as the "normal" environment.
> 
> I just have no idea why this is happening - I have used mod_python w/ 
> mysql before, with generally very good results.
> 
> Thanks a lot!
> 
> David
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From pkeshishian at yahoo.com  Thu Jan  8 12:05:53 2004
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] Re: mysqldb / mod_python problem
In-Reply-To: <3FFDB598.1050608@sponsera.com>
Message-ID: <20040108200553.58614.qmail@web40015.mail.yahoo.com>

Hi David:
 
I did not really find any solution for my problem. The main problem I had was that mod_python was working when I was trying to select a single column, but it was failing in case of 2 or more columns. Since the database I am running is very small I just wrote a python function that queries each column separately than puts them together and returns the result. Since my database is very small the slowdown is insignificant. But it won't be recommended for large databases, and it is not really a solution. I believe this problem deserves a more serious consideration.
 
Cheers,
Petros
 

David Geller <dg@sponsera.com> wrote:
Hi Petros -

I read your posting in the [mod_python] list Dec 30, 2003 regarding 
problems you were having with Mysql not working under mod_python 
correctly (while "regular" console python progrems seemed to work fine).

Well, I am running into exactly the same, frustrating problem!!! What is 
going on? I can't figure it out, and am about to abandon mod_python.

Did you ever get your problem resolved? I'd be most interested in hearing.

Thanks a lot!

Regards,
David
dg@sponsera.com



---------------------------------
Do you Yahoo!?
Yahoo! Hotjobs: Enter the "Signing Bonus" Sweepstakes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040108/612a754e/attachment.htm
From dg at sponsera.com  Thu Jan  8 15:54:56 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDB318.2090401@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
Message-ID: <3FFDC3A0.8010900@sponsera.com>

1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot 
seem to find any references anywhere to such modules....)

2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.

Also, everything (my entire mod_python application, including all mysql 
accessing), seems to run *fine* on my home machine (redhat8-based). It 
is when I have tried running on our redhat-9-based server where these 
problems start to appear....(note that I reuilt all the sources on the 
redhat9 machine...)


Paul Querna wrote:

> Are you running mod_auth_mysql or any other apache modules that use 
> MySQL Client Connections?
>
> Make sure they are all compiled with the exact same client lib versions..
>
> Also, did you build from source, or are you using someones RPMs?
>
> -Paul Querna
>
> David Geller wrote:
>
>> Help!
>>
>> I have the weirdest problem - I am using the following:
>>
>> redhat9
>> mysql 4.0.13
>> mod_python 3.0.4
>> python 2.2.3
>> MySQL-python 0.9.2 (python interface to the mysql libraries)
>> apache 2.0.47
>>
>> When I run ordinary python programs to access the mysql database, 
>> things seem to work fine. (i can connect to the database, so selects, 
>> updates, etc)
>>
>> When I run identical queries under mod_python via request to apache, 
>> apache tends to core dump on database accesses - or sometimes, 
>> doesn't core dump but I get very strange,inconsistant results.
>>
>> Any ideas? Are "threads" an issue? I am almost positive the python 
>> enviornment that apache is getting is the same as the "normal" 
>> environment.
>>
>> I just have no idea why this is happening - I have used mod_python w/ 
>> mysql before, with generally very good results.
>>
>> Thanks a lot!
>>
>> David
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

-- 
David Geller
Sponsera, LLC
dg@sponsera.com
www.sponsera.com
Phone: 703.532.6812
Fax: 703.532.6058



From chip at force-elite.com  Thu Jan  8 13:17:40 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC3A0.8010900@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com>
Message-ID: <3FFDC8F4.7000607@force-elite.com>

David Geller wrote:
> 1. As far as I know, I am not running any other apache modules using 
> MySQL ( I am not sure how to check this out definitely, but I cannot 
> seem to find any references anywhere to such modules....)
> 
> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.
> 
> Also, everything (my entire mod_python application, including all mysql 
> accessing), seems to run *fine* on my home machine (redhat8-based). It 
> is when I have tried running on our redhat-9-based server where these 
> problems start to appear....(note that I reuilt all the sources on the 
> redhat9 machine...)

Could you try to get a Backtrace in GDB from the Apache Core Files?
From grisha at modpython.org  Thu Jan  8 18:33:01 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040108183117.S67407@onyx.ispol.com>



On Wed, 7 Jan 2004, Robert Leftwich wrote:

> So it appears that I am running into this limitation. Is there any
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> useable?

s/Windows/Unix ? ;-)

Grisha
From neel at mediapulse.com  Thu Jan  8 18:58:40 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:04 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <C0FC22C08B82074A88B50061764157776B996D@johnson.mediapulse.net>

> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of 
> Windows/Apache2.xx/mod_python/SMP not
> > useable?
> 
> s/Windows/Unix ? ;-)
> 
%s/Windows/Unix/g =)

From khalid_kary at hotmail.com  Fri Jan  9 00:12:48 2004
From: khalid_kary at hotmail.com (Khalid El-Kary)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <BAY8-F965rrgJGERxKF000142da@hotmail.com>

> > s/Windows/Unix ? ;-)
> >
>%s/Windows/Unix/g =)

Execuse my ignorance, but what do both of them mean ? :-)

Khalid

_________________________________________________________________
MSN 8 with e-mail virus protection service: 2 months FREE* 
http://join.msn.com/?page=features/virus

From dg at sponsera.com  Thu Jan  8 19:26:54 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC8F4.7000607@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com> <3FFDC8F4.7000607@force-elite.com>
Message-ID: <3FFDF54E.4000403@sponsera.com>

I am not quite sure how to do this.

Presumably, I would have to rebuild apache with -g enabled.  Is this 
correct? How do I actually get the core files? (the actual error I have 
been getting is "Segmentation fault")

Thanks!


Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
>> MySQL ( I am not sure how to check this out definitely, but I cannot 
>> seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
>> source.
>>
>> Also, everything (my entire mod_python application, including all 
>> mysql accessing), seems to run *fine* on my home machine 
>> (redhat8-based). It is when I have tried running on our 
>> redhat-9-based server where these problems start to appear....(note 
>> that I reuilt all the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>



From robert at leftwich.info  Fri Jan  9 14:25:43 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040108183117.S67407@onyx.ispol.com>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
 <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <5.2.0.9.0.20040109140327.01b15748@192.168.0.1>

At 10:33 AM 9/01/2004, Gregory (Grisha) Trubetskoy wrote:

>On Wed, 7 Jan 2004, Robert Leftwich wrote:
>
> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> > useable?
>
>s/Windows/Unix ? ;-)

Unfortunately the people I'm doing this project for are committed to 
Windows and cannot switch their production boxen (all SMP) to *nix :-((

After looking at a few options it's back to Java/servlets I go .... (at 
least for this project).

Robert

PS Can I suggest that this limitation be highlighted on the website/readme 
as it might save anyone else in the same situation from a lot of wasted 
time/effort. 
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From davidf at sjsoft.com  Fri Jan  9 06:44:24 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
References: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
Message-ID: <3FFE31A8.2000103@sjsoft.com>

Khalid El-Kary wrote:

>> > s/Windows/Unix ? ;-)
>> >
>> %s/Windows/Unix/g =)
>
>
> Execuse my ignorance, but what do both of them mean ? :-)
>
> Khalid

They are instructions that mean "replace 'Windows' with 'Unix' from sed 
(a command line search and replace tool) and used in other tools such as 
vim (text editor).

David

From dg at sponsera.com  Fri Jan  9 00:12:42 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <000b01c3d66a$d282f0e0$0600a8c0@santana>
References: <000b01c3d66a$d282f0e0$0600a8c0@santana>
Message-ID: <3FFE384A.8010805@sponsera.com>

Thanks, Mike.

While I am not following what you do *exactly*, it is similar.
And as I said, everything runs fine on one machine. (and has for a few 
years with multiple apps). It was an incredible suprise to all of a 
sudden find such difficulty on a new machine.

What *we* do is:
1. Get sources from relevent places as tarballs  - (apache, python, 
msql, MySQLdb, mod_python,....)
2. place sources in /usr/local/src
3. build and compile them there
4. install them in /usr/local

Soooo, python is in /usr/local/lib/python2.2... (execuatable in 
/usr/local/bin as /usr/local/bin/python)
apache is in /usr/local/apache2/...
mysql is in /usr/local/mysql...

And I have confirmed that mod_python is picking up the correct python.

D.

Michael Neel wrote:

>I see a lot of posts about trouble with MySQL and mod_python.  I use
>both in almost every project I do, and have yet to have any of these
>problems.  So here is how we configure a box:
>
>Redhat is used, versions 6x to 9 have been in use.
>We do not install the RPMs of MySQL that come with redhat, but do use
>the RPMs from MySQL's website.
>Apache's have been both compiled from source and RehHat RPMs.  When
>going from source, we use apache toolbox.  We've used both 1.3 and 2.0
>apaches.
>Python is compiled from source, and replaces the redhat version 
>(--prefix=/usr)
>Mod python is compiled from source as well.  This after python is
>installed to make sure it gets set to the same paths as the command
>line.  I never remember what to pass to configure, so I have to edit the
>src/Makefile and add -DEAPI to the opts.
>MySQLdb is installed with a simple python setup.py install
>
>If this helps or not I'm not sure, but I though I'd post it.
>Mike
>
>
>
>  
>



From dg at sponsera.com  Fri Jan  9 00:30:03 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFE3C5B.9090901@sponsera.com>

Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot
seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
source.
>>
>> Also, everything (my entire mod_python application, including all 
mysql accessing), seems to run *fine* on my home machine
(redhat8-based). It is when I have tried running on our redhat-9-based
server where these problems start to appear....(note that I reuilt all
the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?




Stack trace from wierd mod_python/mysql bug obtained!

================== basic program (outline) being run
from mod_python import util
from mod_python import apache
import MySQLdb

def hander(req):

db = MySQLdb.connect(db="quest1",
                          host="localhost",
                          user="dg",
                          passwd="pass")

     c = db.cursor(MySQLdb.cursors.DictCursor)
    sql = """select * from subject"""

     c.execute(sql)
==================================
Note that we get Seg fault on the c.execute().
And note also: with certain sql statements, does not crash but obtain
inconsistant results.


=====================GDB Stack ========================================

(gdb) r
Starting program: /usr/local/apache2/sbin/httpd -DONE_PROCESS
[New Thread 16384 (LWP 17860)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 17860)]
0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa) at Python/modsupport.c:334

(gdb) where
#0  0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa)
     at Python/modsupport.c:334
#1  0x402f8f9a in do_mktuple (p_format=0xbfffe790, p_va=0xbfffe794,
     endchar=41, n=7) at Python/modsupport.c:223
#2  0x402f88cf in do_mkvalue (p_format=0xbfffe790, p_va=0xbfffe794)
     at Python/modsupport.c:247
#3  0x402f8b4c in Py_VaBuildValue (format=0x0, va=0x0)
     at Python/modsupport.c:428
#4  0x402f8aea in Py_BuildValue (format=0x406ceb95 "(siiiiii)")
     at Python/modsupport.c:399
#5  0x406cce33 in _mysql_ResultObject_describe (self=0x828f160, args=0x0)
     at _mysql.c:737
#6  0x402d6988 in fast_cfunction (func=0x0, pp_stack=0xbfffe8c4, na=-1)
     at Python/ceval.c:3132
#7  0x402d51d5 in eval_frame (f=0x822baec) at Python/ceval.c:2017
#8  0x402d5be3 in PyEval_EvalCodeEx (co=0x81fa500, globals=0x0, locals=0x0,
     args=0x822b73c, argcount=2, kws=0x822b744, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#9  0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#10 0x402d514f in eval_frame (f=0x822b5e4) at Python/ceval.c:2034
#11 0x402d5be3 in PyEval_EvalCodeEx (co=0x8285908, globals=0x0, locals=0x0,
     args=0x82491dc, argcount=2, kws=0x82491e4, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#12 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#13 0x402d514f in eval_frame (f=0x8249064) at Python/ceval.c:2034
#14 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f95d0, globals=0x0, locals=0x0,
     args=0x817341c, argcount=3, kws=0x8173428, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#15 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=3, nk=0)
     at Python/ceval.c:3170
#16 0x402d514f in eval_frame (f=0x81732c4) at Python/ceval.c:2034
#17 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f8df8, globals=0x0, locals=0x0,
     args=0x8173410, argcount=2, kws=0x823b4a0, kwcount=0, defs=0x8289a80,
     defcount=1, closure=0x0) at Python/ceval.c:2595
#18 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#19 0x402d514f in eval_frame (f=0x823b32c) at Python/ceval.c:2034
#20 0x402d5be3 in PyEval_EvalCodeEx (co=0x823ef80, globals=0x0, locals=0x0,
     args=0x8233280, argcount=1, kws=0x8233284, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#21 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=1, nk=0)
     at Python/ceval.c:3170
#22 0x402d514f in eval_frame (f=0x82330d4) at Python/ceval.c:2034
#23 0x402d5be3 in PyEval_EvalCodeEx (co=0x81e6b18, globals=0x0, locals=0x0,
     args=0x81d0640, argcount=2, kws=0x0, kwcount=0, defs=0x0, defcount=0,
     closure=0x0) at Python/ceval.c:2595
#24 0x4031a729 in function_call (func=0x822f7d4, arg=0x81d0634, kw=0x0)
     at Objects/funcobject.c:476
#25 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81d0634, kw=0x0)
     at Objects/abstract.c:1688
#26 0x402a3148 in instancemethod_call (func=0x822f7d4, arg=0x81d0634,
kw=0x0)
     at Objects/classobject.c:2315
#27 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81e99d4, kw=0x0)
     at Objects/abstract.c:1688
#28 0x402d6847 in PyEval_CallObjectWithKeywords (func=0x81cc8b4,
     arg=0x81e99d4, kw=0x0) at Python/ceval.c:3058
#29 0x4029aa8d in PyObject_CallMethod (o=0x0, name=0x81e99d4 "\002",
     format=0x81e99d4 "\002") at Objects/abstract.c:1679
#30 0x402985fc in python_handler (req=0x81bb018,
     phase=0x4031ee18 "PythonHandler") at mod_python.c:899
#31 0x4029973e in PythonHandler (req=0x81bb018) at mod_python.c:1699
#32 0x0807baca in ap_run_handler (r=0x81bb018) at config.c:195
#33 0x0807bfe2 in ap_invoke_handler (r=0x81bb018) at config.c:401
#34 0x0806bd8b in ap_process_request (r=0x81bb018) at http_request.c:288
#35 0x08067f25 in ap_process_http_connection (c=0x81b6fe8) at
http_core.c:293
#36 0x0808493a in ap_run_process_connection (c=0x81b6fe8) at connection.c:85
#37 0x0807a67f in child_main (child_num_arg=0) at prefork.c:694
#38 0x0807a82a in make_child (s=0x80b7118, slot=0) at prefork.c:734
#39 0x0807a883 in startup_children (number_to_start=5) at prefork.c:806
#40 0x0807af75 in ap_mpm_run (_pconf=0x8079f68, plog=0x80ecaf0, s=0x80b7118)
     at prefork.c:1022
#41 0x0807fd02 in main (argc=2, argv=0xbffff404) at main.c:660
#42 0x401415cd in __libc_start_main () from /lib/libc.so.6
(gdb)





From dwmp at opti.cgi.net  Fri Jan  9 00:15:40 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] get_options() problem
Message-ID: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>


According to the 3.1.2b documentation there should be a get_options() 
method on the server object.  When trying to access it I get a traceback.

code (under psp):

req.log_error('options: %s' % `req.server.get_options()`)

error:

AttributeError: 'mp_server' object has no attribute 'get_options'


Does the server.get_options() method no longer exist and is the 
documentation (section 4.5.6.1) just out of date?

I'm trying to get to the DocumentRoot value for the virtual server handling 
the current request and was hoping I might find it in there.

-Dan

From dwmp at opti.cgi.net  Fri Jan  9 00:23:11 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] get_options() problem
In-Reply-To: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109002211.03797eb8@mail.pyxos.com>


I found the DocumentRoot value I was after.  Duh.  req.document_root().

However, that server.get_options() probably needs some looking into.

-Dan



At 12:15 AM 1/9/2004 -0600, you wrote:

>According to the 3.1.2b documentation there should be a get_options() 
>method on the server object.  When trying to access it I get a traceback.
>
>code (under psp):
>
>req.log_error('options: %s' % `req.server.get_options()`)
>
>error:
>
>AttributeError: 'mp_server' object has no attribute 'get_options'
>
>
>Does the server.get_options() method no longer exist and is the 
>documentation (section 4.5.6.1) just out of date?
>
>I'm trying to get to the DocumentRoot value for the virtual server 
>handling the current request and was hoping I might find it in there.
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From a.w at quirxi.com  Fri Jan  9 14:12:31 2004
From: a.w at quirxi.com (Arno Wilhelm)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] 
	Newbie question: Fieldstorage is empty in the second handler
Message-ID: <3FFEA8BF.2060408@quirxi.com>

Hello,

I have just started using mod_pyhon and have come to a problem I cannot find an 
solution for:

In my html file there is a hidden input named PATH:

<FORM method="post" action="/qwer/eval.py">
<INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
...
</FORM>

When the form is submitted the PATH variable reaches the authenhandler(req) 
which I can give out to a file:

PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24

but after that it does not reach the following handler(req) function. It always 
raises an KeyError since the PATH variable does not exist in this function anymore !
Can anyone point me to the right direction ?



cheers,

Arno





	

From fowlertrainer at anonym.hu  Fri Jan  9 16:19:41 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] How to globalize vars ???
Message-ID: <17328262299.20040109161941@anonym.hu>

Hello !

I have get a strange problem in mod_python site.
More modules I have, and think, to I initialize my Session handler
from main module.

Like this:

-- main --

import BHASession

# Session info
BHASessionDir="C:/bhaweb/sessions"
#f=open("c:/now.txt","a");f.write(" 1");f.close();
BHASession.SSInit(BHASessionDir)
#f=open("c:/now.txt","a");f.write(" 2");f.close();

-- Session --
f=open("c:/now.txt","a");f.write(" 01");f.close();
#global SSDefaultDir
SSDefaultDir="c:/bhaweb/sessions"
f=open("c:/now.txt","a");f.write(" 02");f.close();
SSLockObj=threading.Lock()

def SSLock():
    SSLockObj.acquire()

def SSUnlock():
    SSLockObj.release()

def SSInit(SessionDir):
    #f=open("c:/now.txt","a");f.write(" 03");f.close();
    SSLock()
    try:
      #global SSDefaultDir
      #r.append(str(SSDefaultDir))
      #f=open("c:/now.txt","a")
      #f.write(" "+SSDefaultDir)
      #f.close()
      #r.append(str(SSInitialized))
      if SSDefaultDir.strip()=="":
#       <-
# UnboundLocalError: local variable 'SSDefaultDir' referenced before assignment
         r.append(str(SSDefaultDir))
         SSDefaultDir=SessionDir
         f=open("c:/now.txt","a")
         f.write(" "+SSDefaultDir)
         f.close()
    finally:
      SSUnlock()

--------------
      
When I not use SSInit, only I write the global variable in BHASession
module like this:

SSDefaultDir="c:/bhaweb/sessions"

then it is working good !!!

Why ? How to force python to module see his variable ?

Thanx for any advance  !

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From dwmp at opti.cgi.net  Fri Jan  9 10:08:28 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in
  the second handler
In-Reply-To: <3FFEA8BF.2060408@quirxi.com>
Message-ID: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>


You're probably creating a FieldStorage in authenhandler() and then 
recreating the FieldStorage in your handler().  You're using a POST request 
so the when FieldStorage is created it reads the fields from the body of 
the request (GET requests put the variables in the header) via the 
req.read() method. Once you've read the body of the of a request, it cannot 
be read again.  So when your second FieldStorage is created, there is no 
body request data left to be read.

As it turns out, the req object you get in authenhandler() and handler() is 
the same object.  So when you create your first FieldStorage in 
authenhandler(), assign it to the req object and it will be available in 
your handler() function without having to recreate it again.

-Dan




At 02:12 PM 1/9/2004 +0100, you wrote:
>Hello,
>
>I have just started using mod_pyhon and have come to a problem I cannot 
>find an solution for:
>
>In my html file there is a hidden input named PATH:
>
><FORM method="post" action="/qwer/eval.py">
><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>...
></FORM>
>
>When the form is submitted the PATH variable reaches the 
>authenhandler(req) which I can give out to a file:
>
>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>
>but after that it does not reach the following handler(req) function. It 
>always raises an KeyError since the PATH variable does not exist in this 
>function anymore !
>Can anyone point me to the right direction ?
>
>
>
>cheers,
>
>Arno

From dwmp at opti.cgi.net  Fri Jan  9 10:12:57 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] How to globalize vars ???
In-Reply-To: <17328262299.20040109161941@anonym.hu>
Message-ID: <5.2.1.1.2.20040109101042.042fa6f0@mail.pyxos.com>


Try assigning global SSDefaultDir at the top of your SSInit function like this:

def SSInit(SessionDir):
     global SSDefaultDir
     SSLock()
     ...

-Dan




At 04:19 PM 1/9/2004 +0100, you wrote:
>Hello !
>
>I have get a strange problem in mod_python site.
>More modules I have, and think, to I initialize my Session handler
>from main module.
>
>Like this:
>
>-- main --
>
>import BHASession
>
># Session info
>BHASessionDir="C:/bhaweb/sessions"
>#f=open("c:/now.txt","a");f.write(" 1");f.close();
>BHASession.SSInit(BHASessionDir)
>#f=open("c:/now.txt","a");f.write(" 2");f.close();
>
>-- Session --
>f=open("c:/now.txt","a");f.write(" 01");f.close();
>#global SSDefaultDir
>SSDefaultDir="c:/bhaweb/sessions"
>f=open("c:/now.txt","a");f.write(" 02");f.close();
>SSLockObj=threading.Lock()
>
>def SSLock():
>     SSLockObj.acquire()
>
>def SSUnlock():
>     SSLockObj.release()
>
>def SSInit(SessionDir):
>     #f=open("c:/now.txt","a");f.write(" 03");f.close();
>     SSLock()
>     try:
>       #global SSDefaultDir
>       #r.append(str(SSDefaultDir))
>       #f=open("c:/now.txt","a")
>       #f.write(" "+SSDefaultDir)
>       #f.close()
>       #r.append(str(SSInitialized))
>       if SSDefaultDir.strip()=="":
>#       <-
># UnboundLocalError: local variable 'SSDefaultDir' referenced before 
>assignment
>          r.append(str(SSDefaultDir))
>          SSDefaultDir=SessionDir
>          f=open("c:/now.txt","a")
>          f.write(" "+SSDefaultDir)
>          f.close()
>     finally:
>       SSUnlock()
>
>--------------
>
>When I not use SSInit, only I write the global variable in BHASession
>module like this:
>
>SSDefaultDir="c:/bhaweb/sessions"
>
>then it is working good !!!
>
>Why ? How to force python to module see his variable ?
>
>Thanx for any advance  !
>
>--
>Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From jalil at securia.com  Fri Jan  9 08:22:22 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] How to set connection parameters?
Message-ID: <3FFED53E.20402@securia.com>

When using JDBC,  one can pass the following parameters in the 
connection string:

useUnicode=true&characterEncoding=UTF-8

How do we do this in Python?

Thanks,

-Jalil



From dwmp at opti.cgi.net  Fri Jan  9 10:41:18 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in 
  the second handler
In-Reply-To: <3FFED6FE.8000702@quirxi.com>
References: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
 <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109103843.036e4ce0@mail.pyxos.com>


The req object is just a python object.  You can assign any new members you 
want to it and they will remain throughout Apache's request handling 
process.   So in your authenhandler() do this:

req.form = FieldStorage(req)

Then when you need to get your variables in handler() just do this:

path = req.form['PATH'].value


-Dan



At 05:29 PM 1/9/2004 +0100, you wrote:
>Hello Daniel,
>
>
>>You're probably creating a FieldStorage in authenhandler() and then 
>>recreating the FieldStorage in your handler().  You're using a POST 
>>request so the when FieldStorage is created it reads the fields from the 
>>body of the request (GET requests put the variables in the header) via 
>>the req.read() method. Once you've read the body of the of a request, it 
>>cannot be read again.  So when your second FieldStorage is created, there 
>>is no body request data left to be read.
>>As it turns out, the req object you get in authenhandler() and handler() 
>>is the same object.
>
>
>It is just as you said: I used a POST request and called FieldStorage in 
>authenhandler() and handler().
>
>>So when you create your first FieldStorage in authenhandler(), assign it 
>>to the req object and it will be available in your handler() function 
>>without having to recreate it again.
>
>How can you assign the FieldStorage to a req object ? I could not find any 
>variable it could be assigned to in the docu.
>
>
>
>Arno
>
>
>
>>-Dan
>>
>>
>>At 02:12 PM 1/9/2004 +0100, you wrote:
>>
>>>Hello,
>>>
>>>I have just started using mod_pyhon and have come to a problem I cannot 
>>>find an solution for:
>>>
>>>In my html file there is a hidden input named PATH:
>>>
>>><FORM method="post" action="/qwer/eval.py">
>>><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>>>...
>>></FORM>
>>>
>>>When the form is submitted the PATH variable reaches the 
>>>authenhandler(req) which I can give out to a file:
>>>
>>>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>>>
>>>but after that it does not reach the following handler(req) function. It 
>>>always raises an KeyError since the PATH variable does not exist in this 
>>>function anymore !
>>>Can anyone point me to the right direction ?
>>>
>>>
>>>
>>>cheers,
>>>
>>>Arno
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From neel at mediapulse.com  Fri Jan  9 12:15:16 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] get_options() problem
Message-ID: <C0FC22C08B82074A88B50061764157776B9971@johnson.mediapulse.net>

I use req.get_options(), this is 2.x - and it should be the same (at
least I hope it is) for 3.x

Mike

> -----Original Message-----
> From: Daniel West [mailto:dwmp@opti.cgi.net] 
> Sent: Friday, January 09, 2004 1:23 AM
> To: mod_python@modpython.org
> Subject: Re: [mod_python] get_options() problem
> 
> 
> 
> I found the DocumentRoot value I was after.  Duh.  
> req.document_root().
> 
> However, that server.get_options() probably needs some looking into.
> 
> -Dan
> 
> 
> 
> At 12:15 AM 1/9/2004 -0600, you wrote:
> 
> >According to the 3.1.2b documentation there should be a 
> get_options() 
> >method on the server object.  When trying to access it I get 
> a traceback.
> >
> >code (under psp):
> >
> >req.log_error('options: %s' % `req.server.get_options()`)
> >
> >error:
> >
> >AttributeError: 'mp_server' object has no attribute 'get_options'
> >
> >
> >Does the server.get_options() method no longer exist and is the 
> >documentation (section 4.5.6.1) just out of date?
> >
> >I'm trying to get to the DocumentRoot value for the virtual server 
> >handling the current request and was hoping I might find it in there.
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From jalil at securia.com  Fri Jan  9 11:33:27 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Cannot load templates using PSP class
Message-ID: <3FFF0207.3000003@securia.com>

 
In my python default handler, I am trying to load an html file in my 
code using the example below:

template = psp.PSP(req, filename='template.html')

The html file is located in the same directory as my .py file but this call 
fails unless I pass the full path of the html file in the call!

Any way to change this behaviour?

Thanks,

-Jalil



From grisha at modpython.org  Fri Jan  9 17:05:53 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <3FFF0207.3000003@securia.com>
References: <3FFF0207.3000003@securia.com>
Message-ID: <20040109165951.K82783@onyx.ispol.com>


It's impossible to answer this without the details of your configuration.

Take a look at your req.filename. PSP tries to figure out the "current
directory" by looking at req.filename. Under certain configs this won't
work.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

>
> In my python default handler, I am trying to load an html file in my
> code using the example below:
>
> template = psp.PSP(req, filename='template.html')
>
> The html file is located in the same directory as my .py file but this call
> fails unless I pass the full path of the html file in the call!
>
> Any way to change this behaviour?
>
> Thanks,
>
> -Jalil
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From jalil at securia.com  Fri Jan  9 14:27:32 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <20040109165951.K82783@onyx.ispol.com>
References: <3FFF0207.3000003@securia.com>
	<20040109165951.K82783@onyx.ispol.com>
Message-ID: <3FFF2AD4.5090909@securia.com>

Grisha,

req.filename is the the full path of the resource on my filesystem and 
looks fine.
Please let me know what info you need regarding my configuration or what 
config parameters make this fail.

Thanks,

-Jalil

Gregory (Grisha) Trubetskoy wrote:

>It's impossible to answer this without the details of your configuration.
>
>Take a look at your req.filename. PSP tries to figure out the "current
>directory" by looking at req.filename. Under certain configs this won't
>work.
>
>Grisha
>
>On Fri, 9 Jan 2004, jalil wrote:
>
>  
>
>>In my python default handler, I am trying to load an html file in my
>>code using the example below:
>>
>>template = psp.PSP(req, filename='template.html')
>>
>>The html file is located in the same directory as my .py file but this call
>>fails unless I pass the full path of the html file in the call!
>>
>>Any way to change this behaviour?
>>
>>Thanks,
>>
>>-Jalil
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>

From jalil at securia.com  Fri Jan  9 15:41:23 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Error using Session
Message-ID: <3FFF3C23.8060301@securia.com>

Today I upgraded to Python 2.3.3 and mod_python 3.1.2b fine. I am trying to use the Session
class now and when in my request handler I do something simple like:

sess = Session.Session(req)
req.write (sess.id())

I get the following error. Any idea why this happens and why python2.2 is still being 
used in mod_python? The 2.3.3 is installed in /usr/local/lib which comes first in my PATH.
I am using Redhad which seems to depend on 2.2!


Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)

  File "/development/webnotes/src/pylib/dispatch.py", line 54, in handler
    ses = Session.Session(req)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)

ValueError: Failed to acquire global mutex lock

Thanks,

-Jalil


From egrubbs at rackspace.com  Fri Jan  9 17:53:19 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] SetEnv and add_common_vars()
Message-ID: <20040109235319.GJ5495@rackspace.com>

When I use SetEnv in my apache conf file, it causes a lot of the
environment variables (such as DOCUMENT_ROOT) to disappear that
add_common_vars() normally would set.

The only workaround I have is to put the SetEnv statements in a
different <Directory> block than the directory with the files served by
mod_python.

Is this a bug in mod_env or mod_python? Is there a better way to fix
this?

-Edwin
From grisha at modpython.org  Fri Jan  9 19:48:39 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040109235319.GJ5495@rackspace.com>
References: <20040109235319.GJ5495@rackspace.com>
Message-ID: <20040109194651.V82783@onyx.ispol.com>


On Fri, 9 Jan 2004, Edwin Grubbs wrote:

> When I use SetEnv in my apache conf file, it causes a lot of the
> environment variables (such as DOCUMENT_ROOT) to disappear that
> add_common_vars() normally would set.

When you say "dissapear" - what are you using to look them up?

> The only workaround I have is to put the SetEnv statements in a
> different <Directory> block than the directory with the files served by
> mod_python.

What is the objective here? If you are you trying to pass information to
mod_python from the config, a better way is to use PythonOption.

Grisha
From jalil at securia.com  Fri Jan  9 17:01:19 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
Message-ID: <3FFF4EDF.2050401@securia.com>

I have built and updated my Python and mod_python to the latest version 
and the new mod_python.so is now in the modules directory. However, my 
mod_python still picks up the old version of Python. Does anybody know 
how to fix this?

Thanks,

From grisha at modpython.org  Fri Jan  9 20:38:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <20040109203726.L85266@onyx.ispol.com>


Just a guess - before re-running ./configure, make sure to remove
config.cache file.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

> I have built and updated my Python and mod_python to the latest version
> and the new mod_python.so is now in the modules directory. However, my
> mod_python still picks up the old version of Python. Does anybody know
> how to fix this?
>
> Thanks,
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Fri Jan  9 20:41:08 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:48:05 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <0FE6C376-430E-11D8-9AD2-000A95A072FC@sb.org>

You could remove the old version?

Alternately, there's an option to ./configure for building mod_python 
that lets you specify the exact path to python in case you have 
multiple copies. That might be what you're looking for.

On Jan 9, 2004, at 8:01 PM, jalil wrote:

> I have built and updated my Python and mod_python to the latest 
> version and the new mod_python.so is now in the modules directory. 
> However, my mod_python still picks up the old version of Python. Does 
> anybody know how to fix this?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:52:03 2004
Subject: No subject
Message-ID: <mailman.0.1073703123.54763.mod_python@modpython.org>

    Internal Server Error

    The server encountered an internal error or misconfiguration and was     
    unable to complete your request.

Other normal web request seem to work fine. 
This is what the error logs show...

    [Wed Aug  2 20:58:57 2000] [notice] caught SIGTERM, shutting down
    [Wed Aug  2 20:59:02 2000] [notice] Apache/1.3.12 (Unix) configured
-- resuming
        normal operations
    'import site' failed; use -v for traceback
    make_obcallback(): could not import mod_python.apache.
    make_obcallback(): could not call init.
    [Wed Aug  2 20:59:45 2000] [error] [client 202.77.245.126] python_handler:
        make_obcallback returned no obCallBack!


The mod_python module sits in 

        /usr/local/lib/python1.5/mod_python

    (along with other .pc. .pyc modules)


In my httpd.conf (everything is there, no srm.conf, access.conf), I have 

    AddHandler python-program .py
    PythonHandler pytest.py
    PythonDebug on
    PythonPath "sys.path+['/usr/local/lib/python1.5/mod_python']

this is within the <Directory..> directives for ~/apache/htdocs.
pytest.py is same as the "Hello World" example in the tutorial in
mod_python...


Also when in the Python interpreter, I try to load stuff manually, 
ie:

    >>> from mod_python import apache
    Traceback (innermost last):
    File "<stdin>", line 1, in ?
    File "/usr/local/lib/python1.5/mod_python/apache.py", line 18, in ?
        import _apache
    ImportError: No module named _apache
    >>>

and apache.py does indeed have the line "import _apache"

Loading other standard python modules like "sys" works OK, hence I think
PYTHONPATH seems OK.


config_info
------------------
Apache - 1.3.12
Python 1.5, compiled from source, standard
    (both are installed in /usr/local)
system Linux Mandrake 7.0, 2.2.12 kernel 
Compaq box, P3.


Any help from anyone will be appreciated.

Hope I can get this working. Would love to use Python for a few things here.



----------------------------------------------------------
Boh-heong Yap
Project Manager, eCommerce
				bohheong@asiacontent.com				

Asiacontent.com a leading pan-Asian Internet company,
with focus on: content, advertising and e-commerce.
-----------------------------------------------------------


From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:52:08 2004
Subject: No subject
Message-ID: <mailman.1.1073703128.54763.mod_python@modpython.org>

req.headers_out['Set-Cookie']='key=value'
req.headers_out['location'] = 'http://localhost/index.html'
return apache.HTTP_MOVED_TEMPORARILY

The problem seems to be that if I don't do req.send_http_header() the
Set-Cookie doesn't get sent so the cookie doesn't get set.  If I do call
req.send_http_header() the cookie does get set but it seems as though
two sets of headers are sent and the response code is 200.  Any ideas?

Geoff Cadien
geoff@infostreet.com

From rassilkapoemail at yahoo.com  Fri Jan  9 21:51:57 2004
From: rassilkapoemail at yahoo.com (rassilkapoemail@yahoo.com)
Date: Fri Jan  9 21:52:27 2004
Subject: [mod_python] Массовая рассылка вашей рекламы по 350.000 е-майлов.
Message-ID: <200106242108.f5OL8E296083@eden.ispol.com>

Массовая рассылка вашей рекламы по 350.000 е-майлов.
Стоимость 1$ - 1000 писем. Минимальный заказ 100$.

Разошлем Вашу рекламу по 42.000 организациям Москвы - 50$.

Пишите: rassilkapoemail@yahoo.com или email_reklama@yahoo.com
 
 
 
 
 
 
 
 

From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:52:27 2004
Subject: No subject
Message-ID: <mailman.2.1073703147.54763.mod_python@modpython.org>

is posible that is a problem in the debian package libpapache-mod-python.




-- 


From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:52:49 2004
Subject: No subject
Message-ID: <mailman.3.1073703169.54763.mod_python@modpython.org>

add_handler (htype, handler[, dir])
    Allows dynamic handler registration. htype is a string containing the
    name of any of the apache Python*Handler directives, e.g.
    "PythonHandler". handler is a string containing the name of the module
    and the handler function. Optional dir is a string containing the name of
    the directory to be added to the pythonpath. If no directory is
    specified, then, if there is already a handler of the same type
    specified, its directory is inherited, otherwise the directory of the
    presently executing handler is used.

However, if a PythonPath directive is in force, the third argument seems to
be ignored (from my reading of apache.py).  Two solutions present themselves:
(a) fix the documentation or (b) change the code to suit the documentation.

For the record, I'd prefer the latter.  It allows me to dynamically import
handlers directly instead of traversing long strings of Python packages.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:52:50 2004
Subject: No subject
Message-ID: <mailman.4.1073703170.54763.mod_python@modpython.org>

[Wed May 15 15:46:25 2002] [error] [client 127.0.0.1] Invalid method in
request
agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1

...and from the access log:

127.0.0.1 - - [15/May/2002:16:07:42 +0200] "POST /cgi/login.py HTTP/1.1" 200
1396
127.0.0.1 - - [15/May/2002:16:07:42 +0200]
"agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1" 501 459

So, it seems as the GET for the stylesheet is 'colliding' with the login
POST operation...?

This is not a problem when we keep the module cleanup loop. However, the
application is too slow when we have many simultaneous users, actually
slower than the old cgi, so we are trying to speed up everywhere we can.

The lock in cgihandler.py will prevent multiple simultaneous users? It seems
like it is. The server load is reduced, because there are no python
processes starting for each access, but the users perceive the application
as _slower_ than it was as a classic cgi, and I think it is because of the
lock in cgihandler.py beeing a bottleneck, slipping through only one user at
the time... is this the way mod_python is supposed to work?

win2k, SP2, 5.00.2195
apache 1.3.24
mod_python 2.7.4
python 2.1.3 (214)

--
Roger


From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:52:59 2004
Subject: No subject
Message-ID: <mailman.5.1073703179.54763.mod_python@modpython.org>

LoadModule python_module modules/mod_python276.dll
AddModule mod_python.c

ScriptAlias /python/ "C:/Program Files/Apache Group/Apache/htdocs/python/"

<Directory "C:/Program Files/Apache Group/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on
</Directory>

mod_python is located in C:\Python21\Lib\mod_python.  The folder has been
stripped of version numbers to just mod_python.  The following files are found
in the mod_python folder:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

When I try to start the Apache service, I get the error
"Could not start the Apache service on Local Computer.  The service did not
return an error.  This could be an internal Windows error or an internal service
error"
If I comment out the mod_python directives, it runs just fine.

Any help would be greatly appreciated and it will give the bruises on my head a
chance to heal ;-)

TIA,

Mark



From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:53:00 2004
Subject: No subject
Message-ID: <mailman.6.1073703180.54763.mod_python@modpython.org>

This routine gives allows for an opportunity to translate the URI into
an actual filename, before the server's default rules (Alias directives
and the like) are followed. 

Again, how do I do this?

I am implimenting a specialized web cache server and I need to resolve
an url to a path on my server - the logic to resolve the url to path is
the main part of my program.

I can easily enough just resove the url in my main handler and then
manually feed the client form the static file, but im ny oppionion
apache should be doing this itself.  I just need to tell it what file to
use.

My problem is that the request object members such as filename and the
like are read-only, so how do I pass the new filename back to apache?

Alex

From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:53:09 2004
Subject: No subject
Message-ID: <mailman.7.1073703189.54763.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From bogus@does.not.exist.com  Fri Jan  9 21:51:57 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:53:09 2004
Subject: No subject
Message-ID: <mailman.8.1073703189.54763.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From redconectabilbao at telefonica.net  Fri Jan  2 09:34:52 2004
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <20031231143016.GB10034@stellar.eradman.com>
References: <3FF29D8B.6030208@telefonica.net>
	<20031231143016.GB10034@stellar.eradman.com>
Message-ID: <3FF52D2C.70809@telefonica.net>

theman@stellar.eradman.com escribi?:

>One thing to watch out for is that when you're calling pages using the http://domain/script/function relative paths do not work corrrectly. So instead of href="estilo.css" it probably needs to be href="/estilo.css".
>
>Eric Radman
>theman@eradman.com
>
>Wed, Dec 31, 2003 at 10:57:31AM +0100, Red Conecta wrote:
>  
>
>>I'm trying to use css with the publisherhandler; here is the code:
>>
>>   def _inicio():
>>       ini= '''<head><title>nombredelsitio</title>
>>                 <link rel="stylesheet" href="estilo.css"
>>   Type="text/css"></head>
>>                 <body leftmargin=0 rightmargin=0 topmargin=0
>>   bottommargin=0>'''
>>      
>>       return ini
>>
>>   def _final():
>>       return '</body></html>'
>>
>>   def mostrar(req,direccion='/'):
>>       req.content_type = "text/html"
>>       html=_inicio()
>>       obj=leerobjeto(direccion)
>>       if obj!=None:
>>           for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>>       else:html+='error'
>>       html+=_final()
>>       return html
>>
>>the output doesn't use the estilo.css archive but if I save the page in 
>>'mostrar.html' all is ok.
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>    
>>
>
>  
>
I've tryed /estilo.css, ./estilo.css, ../estilo.css and 
/var/www/html/portal/estilo.css, but it still doesn't work

From stian at soiland.no  Fri Jan  2 10:42:49 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <20040102094249.GC11946@itea.ntnu.no>

On 2003-12-31 10:57:31, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:

You've probably used SetHandler instead of AddHandler. SetHandler eats
ALL requests for the directory and passes them on to mod_python.
Effectually static files like your css-file is therefore unavailable.

Solutions:
   
   a) Create one or more static-directories with SetHandler none
      (these could be called "css", "images", etc.)

   b) Place static files somewhere outside the directory structure
      handled by SetHandler python-program
   
   c) Use AddHandler python-program .py instead
      (requires a .py-ending for all mod-python requests)     

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From grisha at modpython.org  Fri Jan  2 16:43:46 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <20040102094249.GC11946@itea.ntnu.no>
References: <3FF29D8B.6030208@telefonica.net>
	<20040102094249.GC11946@itea.ntnu.no>
Message-ID: <20040102164112.Q70689@onyx.ispol.com>


There also:

   d) SetHandler None
      To reverse any previous SetHandler directives to default Apache
      behaviour. Handy for those images/ or styles/ directories.

Grisha

On Fri, 2 Jan 2004, Stian [iso-8859-1] S?iland wrote:

> On 2003-12-31 10:57:31, Red Conecta wrote:
>
> > I'm trying to use css with the publisherhandler; here is the code:
>
> You've probably used SetHandler instead of AddHandler. SetHandler eats
> ALL requests for the directory and passes them on to mod_python.
> Effectually static files like your css-file is therefore unavailable.
>
> Solutions:
>
>    a) Create one or more static-directories with SetHandler none
>       (these could be called "css", "images", etc.)
>
>    b) Place static files somewhere outside the directory structure
>       handled by SetHandler python-program
>
>    c) Use AddHandler python-program .py instead
>       (requires a .py-ending for all mod-python requests)
>
> --
> Stian S?iland               Work toward win-win situation. Win-lose
> Trondheim, Norway           is where you win and the other lose.
> http://www.soiland.no/      Lose-lose and lose-win are left as an
>                             exercise to the reader.  [Limoncelli/Hogan]
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:23:33 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 21:54:10 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
Message-ID: <000101c3d248$3c485f00$6400a8c0@infoserve.net>

How do you get a second frame to refresh a grid on a first frame? I have a
wxGrid on my main frame that is populated from a database. Double clicking a
row in that grid brings up a second frame where an individual record is
displayed. When the user clicks a submit button on the second form, it
updates the database, then closes the second form. I then want the grid on
the first frame to refresh. I know that I can access the grid from the
second frame because if I code:
 
frame.grid.Destroy()
 
it destroys the grid on the first frame. But this has no effect:
 
frame.grid.ForceRefresh()
 
Any suggestions?
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/d50365e9/attachment-0001.htm
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:32:42 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] CANNOT FIND mod_python
Message-ID: <000b01c3d249$83b0e640$6400a8c0@infoserve.net>

I have Apache 2.0.48(Win32), mod_python 3.0.4 and Python 2.3.2. When I set
up the PythonHandler as mptest.py as indicated in the documention for
mod_python, the browser can find mypython.py. However, when I switch the
handler in httpd.conf as suggested to:
 
PythonHandler mod_python.publisher
 
I get a 404, cannot find mypython.py
 
I know that it is finding the modules/mod_python.so file because Apache
gives me an error if I hide it.
 
Any suggestions?
 
Thanks
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/66dd2090/attachment-0001.htm
From eurleif at ecritters.biz  Sun Jan  4 02:49:15 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
Message-ID: <3FF7C57A.2090002@ecritters.biz>

Sorry for the newbie question, but how do I parse query strings, handle 
POST data, and such? Is there a library I should be using?

From manfred.stienstra at dwerg.net  Sun Jan  4 12:55:40 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
In-Reply-To: <3FF7C57A.2090002@ecritters.biz>
References: <3FF7C57A.2090002@ecritters.biz>
Message-ID: <1073217340.10014.3.camel@ack.dwerg.net>

On Sun, 2004-01-04 at 08:49, Leif K-Brooks wrote:
> Sorry for the newbie question, but how do I parse query strings, handle 
> POST data, and such? Is there a library I should be using?

In the util module, there is a FieldStorage object.

fs = util.FieldStorage(request, True)

http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html

If you don't like it, you free to do it some other way (:

Manfred

From rmangaliag at slu.edu.ph  Mon Jan  5 15:19:29 2004
From: rmangaliag at slu.edu.ph (ali)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] a newbie on sessions and psp
Message-ID: <003301c3d35c$41e53c20$da19a8c0@slu.edu.ph>

hi.. am a modpyton newbie...

can someone please give me an example of sessions applied in psp...

thanks...

ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040105/e3c5c90f/attachment-0001.htm
From dwmp at opti.cgi.net  Mon Jan  5 01:41:02 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] OutputFilter example
Message-ID: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>


In the example of the output filter in the 3.1.2b documentation the last 
lines seem to indicate that filter.close() should only be called if 
filter.read() returns None.  I paired up an output filter this evening with 
the mod_python.psp handler and I was getting an empty string on the last 
filter.read() for every request.  The example code only calls 
filter.close() if the last read result is None.  Not calling filter.close() 
on the first call caused the output filter handler to be called a second 
time.  The second time around, it tried to read from filter.read() and got 
None, therefore calling filter.close() and ending the cycle.  Should this 
be normal behavior or should I be calling filter.close() when filter.read() 
returns empty string as well?

My server config:

     AddHandler mod_python .psp
     PythonHandler mod_python.psp | .psp
     PythonOutputFilter mypackage.mymodule TESTFILTER
     AddOutputFilter TESTFILTER .psp


-Dan

From eurleif at ecritters.biz  Mon Jan  5 02:40:33 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Are there any good examples?
Message-ID: <3FF914F1.50609@ecritters.biz>

I'm trying to learn to use mod_python well, and I can't find too many 
examples to learn from. Is there a site with examples somewhere?

From davidf at sjsoft.com  Mon Jan  5 10:15:34 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
In-Reply-To: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
References: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
Message-ID: <3FF91D26.2090109@sjsoft.com>

Jim OLeary wrote:

>How do you get a second frame to refresh a grid on a first frame? I have a
>wxGrid on my main frame that is populated from a database.
>  
>
Why are you asking about wxGrid on a mailing list that is about a python 
application server???

>Double clicking a row in that grid brings up a second frame where an individual record is
>displayed. When the user clicks a submit button on the second form, it
>updates the database, then closes the second form. I then want the grid on
>the first frame to refresh. I know that I can access the grid from the
>second frame because if I code:
> 
>frame.grid.Destroy()
> 
>it destroys the grid on the first frame. But this has no effect:
> 
>frame.grid.ForceRefresh()
> 
>Any suggestions?
>  
>
You probably are asking these questions on the wrong list. If not please 
confirm and clarify, as this is not a wxWindows mailing list...

David
From fowlertrainer at anonym.hu  Mon Jan  5 09:46:10 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <84772282.20040105094610@anonym.hu>

Hi !

I want to control my website with only one py file: the main.py.
But I got experience with one ugly thing in mod_python.

In mod_php, the main.php file is can include many files, and all of
them can include many other files.
When I modify some or one of these files, the website is refreshed.

But in mod_python, I cannot use the include, I have only one way to share/split my sources: the import.
It is ok, but when I modify some of these imported files, the website is not refreshed !!!

My solution in this time to I use only one file.
It is not too good, because it is growing too much, and I cannot
separate it to units.

Have any solution to this problem ????

Thanx for any advance !!!

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Mon Jan  5 09:47:34 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Zope Access Rule in mod_py
Message-ID: <754856212.20040105094734@anonym.hu>

Hi !

My problem is that.
I want to use only one main.py file in my mod_python site.
But I want to handle some virtual paths.

So the structure is:
- root+
------+main.py

I want to this:

When the user type this path:
http://root/users/files/work1
then the Apache don't raise an error, only call a py file's procedure with this path.

I can take this path, and do anything what I needed. If the path is wrong, I can show error message, if not, 
I can show the result. In the example the path is don't exists, but I redirect the process to the my UserFileHandler method,
and I do get this user file named "Work1".

This is just like Access Rule in Zope.

Can I do that in mod_python ?

Thanx:
 KK



From fowlertrainer at anonym.hu  Mon Jan  5 09:50:28 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Session handling: example needed
Message-ID: <1835030833.20040105095028@anonym.hu>

Hi !

My problem is that: I want to create a site with session handling.
But: the mod_python Cookie or Session handling is not working in my
machine, or I have some wrong trying with this.

Anyone has an working example, what I can try ?

{
My idea is that: I set an special named cookie in browser.
The cookie's value is the session id.
When it is setted, the req is get the sid, and get the session data
from session dictionary with sid.
It is wrong way ?
}


Thanx for any advance !
KK


From fowlertrainer at anonym.hu  Mon Jan  5 09:55:17 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] One file controlled site: howto
Message-ID: <1245319669.20040105095517@anonym.hu>

Hello !

I want to control my website with one file, the main.py.
I want that:
 - the index, or index.html, or the empty request is redirected to
   main.py
   http://rootdir/index
   http://rootdir/index.html
   http://rootdir/index.htm
   http://rootdir/main
   http://rootdir/

   is let same thing, everyone is let load the main.py.
   
 - the main.py is let hidden in request !
   or if it is not possible, the .py is let hidden !
   So the site is let used with this:
   http://rootdir/
   or
   http://rootdir/main
   and not
   http://rootdir/main.py


Can anyone help me with this tricks ?

Thanx:
 KK


From ograf at rz-online.net  Mon Jan  5 12:19:12 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
Message-ID: <20040105111912.GJ25566@rz-online.net>

[already send this to python-dev@httpd.apache.org, but got nothing
back...]

Hi!

The resolve_object method does not work with class instances.

The error is simple: in line 551 there is a if

        if silent and not hasattr(module, obj_str):
            return None

this checks always module for obj_str. But it should check the current
obj in traversal!

So correct would be:

        if silent and not hasattr(obj, obj_str):
            return None

Regards,
  Oliver.

-------------- next part --------------
--- mod_python-3.1.2b/lib/python/mod_python/apache.py.orig	2004-01-05 11:16:44.000000000 +0100
+++ mod_python-3.1.2b/lib/python/mod_python/apache.py	2004-01-05 11:16:53.000000000 +0100
@@ -552,7 +552,7 @@
             return None
 
         # this adds a little clarity if we have an attriute error
-        if obj == module and not hasattr(module, obj_str):
+        if obj == module and not hasattr(obj, obj_str):
             if hasattr(module, "__file__"):
                 s = "module '%s' contains no '%s'" % (module.__file__, obj_str)
                 raise AttributeError, s
From ograf at rz-online.net  Mon Jan  5 12:26:28 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
In-Reply-To: <20040105111912.GJ25566@rz-online.net>
References: <20040105111912.GJ25566@rz-online.net>
Message-ID: <20040105112628.GK25566@rz-online.net>

On Mon, Jan 05, 2004 at 12:19:12PM +0100, Oliver Graf wrote:
> [already send this to python-dev@httpd.apache.org, but got nothing
> back...]
> 
> Hi!
> 
> The resolve_object method does not work with class instances.

actually this should read 'does not work with object subpaths'...

So any module::obj.subobj.method handler should not work without the
patch...

Oliver.

From kevin at sb.org  Mon Jan  5 07:38:27 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <84772282.20040105094610@anonym.hu>
References: <84772282.20040105094610@anonym.hu>
Message-ID: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>

There's an easy solution:

Keep a table of the modification dates of the relevant modules. In your 
handler function, compare the modification dates you stored with the 
current ones, and if any differ call reload() on that module.

If you want an example, ask me and I can make one. But it shouldn't be 
too hard to do on your own.

HTH,
Kevin

On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:

> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
>
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
>
> But in mod_python, I cannot use the include, I have only one way to 
> share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the website 
> is not refreshed !!!
>
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
>
> Have any solution to this problem ????

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:46:01 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <754856212.20040105094734@anonym.hu>
References: <754856212.20040105094734@anonym.hu>
Message-ID: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Well, that URL isn't valid. I assume you mean something like

http://my.domain.com/root/users/files/work1

right?

That's not hard. There's a few variations on the solution:

1) If you want it to only work for valid directory trees (i.e. 
/root/users/files/work1 is valid but /root/foo/bar wouldn't be, 
assuming /root/foo doesn't exist) then you can use a <Directory> 
directive. Stick a SetHandler python-program and PythonHandler main in 
there (assuming the directory with main.py will be in the Python path, 
i.e. if the main.py is in the directory specified in the <Directory> 
directive. If it's not there, use the PythonPath directive to tell it 
where to look).

2) If you want it to work for all paths that match a pattern (say, all 
paths starting with /root/) then use a <Files> directive and set the 
same handlers as #1. Same caveats with the python include path.

3) If you want it to apply to every single request to your site, add 
the handlers from #1 in the root level of your httpd.conf file. Same 
caveats apply to the include path for main.py (although since this 
isn't nested, it's just the default Python path so you'll need to add 
the directory for main.py, such as sys.path+['/foo'])

HTH,
Kevin

On Jan 5, 2004, at 3:47 AM, fowlertrainer@anonym.hu wrote:

> I want to this:
>
> When the user type this path:
> http://root/users/files/work1
> then the Apache don't raise an error, only call a py file's procedure 
> with this path.
>
> I can take this path, and do anything what I needed. If the path is 
> wrong, I can show error message, if not,
> I can show the result. In the example the path is don't exists, but I 
> redirect the process to the my UserFileHandler method,
> and I do get this user file named "Work1".
>
> This is just like Access Rule in Zope.
>
> Can I do that in mod_python ?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:49:29 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
References: <754856212.20040105094734@anonym.hu>
	<1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <9A4F92CA-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Erm, I mean a <Location> directive.

On Jan 5, 2004, at 7:46 AM, Kevin Ballard wrote:

> 2) If you want it to work for all paths that match a pattern (say, all 
> paths starting with /root/) then use a <Files> directive and set the 
> same handlers as #1. Same caveats with the python include path.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From vincent_delft at yahoo.com  Mon Jan  5 09:55:57 2004
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <20040105175557.63346.qmail@web11501.mail.yahoo.com>

Draco does what Kevin explain.
Among other, allows you to use the "inclide" like in
PHP.

(check the "links" page).



--- Kevin Ballard <kevin@sb.org> wrote:
> There's an easy solution:
> 
> Keep a table of the modification dates of the
> relevant modules. In your 
> handler function, compare the modification dates you
> stored with the 
> current ones, and if any differ call reload() on
> that module.
> 
> If you want an example, ask me and I can make one.
> But it shouldn't be 
> too hard to do on your own.
> 
> HTH,
> Kevin
> 
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu
> wrote:
> 
> > I want to control my website with only one py
> file: the main.py.
> > But I got experience with one ugly thing in
> mod_python.
> >
> > In mod_php, the main.php file is can include many
> files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the
> website is refreshed.
> >
> > But in mod_python, I cannot use the include, I
> have only one way to 
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported
> files, the website 
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too
> much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
> 
> -- 
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From brianh at exelixis.com  Mon Jan  5 11:31:56 2004
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <Pine.GSO.4.44.0401051125160.28612-100000@timeless.exelixis.com>

be careful though; there are some hidden gotchas lurking in this solution.
for example, if you reload a module defining some base class, but don't
reload all modules defining subclasses of that base, then the base class
object will no longer be the same as the corresponding base class object
in the __bases__ list for subclasses, and isinstance(sub, base) will fail
(leading to other failures, like the new builtin 'super' won't work
properly).

i did a lot of head scratching before i figured this out; but if all
you're reloading are static configuration modules exporting simple things
like constant immutable string or numeric variables, you should be ok.

cheers,
brian


On Mon, 5 Jan 2004, Kevin Ballard wrote:

> There's an easy solution:
>
> Keep a table of the modification dates of the relevant modules. In your
> handler function, compare the modification dates you stored with the
> current ones, and if any differ call reload() on that module.
>
> If you want an example, ask me and I can make one. But it shouldn't be
> too hard to do on your own.
>
> HTH,
> Kevin
>
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:
>
> > I want to control my website with only one py file: the main.py.
> > But I got experience with one ugly thing in mod_python.
> >
> > In mod_php, the main.php file is can include many files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the website is refreshed.
> >
> > But in mod_python, I cannot use the include, I have only one way to
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported files, the website
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From neel at mediapulse.com  Mon Jan  5 14:33:55 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <C0FC22C08B82074A88B500617641577787A7FD@johnson.mediapulse.net>

We use the reload method here, if PythonDebug is set to on, basically:

    debug = req.get_config().has_key('PythonDebug')

    if debug:
        reload(www_forms)
        reload(globals)

See the python docs on reload before using, it doesn't work in all
cases.  I also think there was a mention on the list of an apache.import
method to use so this wouldn't be needed, so you may want to do some
searching on the archives; not sure if it was a mod_python thing or a
patch someone did.

Mike

> -----Original Message-----
> From: fowlertrainer@anonym.hu [mailto:fowlertrainer@anonym.hu] 
> Sent: Monday, January 05, 2004 3:46 AM
> To: mod_python@modpython.org
> Subject: [mod_python] mod_php vs mod_py - include vs. import
> 
> 
> Hi !
> 
> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
> 
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
> 
> But in mod_python, I cannot use the include, I have only one 
> way to share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the 
> website is not refreshed !!!
> 
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
> 
> Have any solution to this problem ????
> 
> Thanx for any advance !!!
> 
> -- 
> Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From kevin at sb.org  Mon Jan  5 15:30:37 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Internal Server Errors on restart
Message-ID: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>

I've found some odd problems with mod_python. The big one is that if I 
ever do a restart of my apache server (graceful or not), the next time 
I access a python script, I get an internal server error, and this 
persists until I shut down the server, wait for all the processes to 
die off, and then start it back up. Also, nothing is put in the error 
log for the Internal Server Error, which is also strange.

Does anybody have any information on this?

Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS 
X Panther Server without actually running it by hand (i.e. replacing 
all the standard access to Apache 1.3 through things like Server Admin 
with access to Apache 2). Yes, Apache 2 comes on Panther Server, but 
it's hidden in /opt/apache2/ and there's no GUI way to access it.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Jan  5 12:46:23 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <3FF9CD1F.5010304@dynamine.net>

Kevin Ballard wrote:
> I've found some odd problems with mod_python. The big one is that if I 
> ever do a restart of my apache server (graceful or not), the next time I 
> access a python script, I get an internal server error, and this 
> persists until I shut down the server, wait for all the processes to die 
> off, and then start it back up. Also, nothing is put in the error log 
> for the Internal Server Error, which is also strange.
> 
> Does anybody have any information on this?

I don't know, but I have the same problem (running Panther as well).

> Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS X 
> Panther Server without actually running it by hand (i.e. replacing all 
> the standard access to Apache 1.3 through things like Server Admin with 
> access to Apache 2). Yes, Apache 2 comes on Panther Server, but it's 
> hidden in /opt/apache2/ and there's no GUI way to access it.

If there is a way, I'm unaware of it.  The documentation says the 
installation in /opt/apache2 is "for experimental purposes."  Don't try 
to use it for mod_python though, because the apxs configuration is wrong 
and it won't compile properly.  (I did my own Apache 2 installation in 
/usr/local/apache2.)

I use mod_proxy on the front-end Apache 1.3 server to pass through 
mod_python requests to the back-end Apache 2.0 server.

--Michael
From grisha at modpython.org  Mon Jan  5 21:58:24 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <20040105215701.M19958@onyx.ispol.com>


I think this is the way it's supposed to work.

On Mon, 5 Jan 2004, Dan W. wrote:

>
> In the example of the output filter in the 3.1.2b documentation the last
> lines seem to indicate that filter.close() should only be called if
> filter.read() returns None.  I paired up an output filter this evening with
> the mod_python.psp handler and I was getting an empty string on the last
> filter.read() for every request.  The example code only calls
> filter.close() if the last read result is None.  Not calling filter.close()
> on the first call caused the output filter handler to be called a second
> time.  The second time around, it tried to read from filter.read() and got
> None, therefore calling filter.close() and ending the cycle.  Should this
> be normal behavior or should I be calling filter.close() when filter.read()
> returns empty string as well?
>
> My server config:
>
>      AddHandler mod_python .psp
>      PythonHandler mod_python.psp | .psp
>      PythonOutputFilter mypackage.mymodule TESTFILTER
>      AddOutputFilter TESTFILTER .psp
>
>
> -Dan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Mon Jan  5 22:57:41 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <3FF9CD1F.5010304@dynamine.net>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
	<3FF9CD1F.5010304@dynamine.net>
Message-ID: <79B6A1A3-3FFC-11D8-9AD2-000A95A072FC@sb.org>

Well, *that's* silly. I simply edited the .mk files in 
/opt/apache2/build to remove the -arch i386 strings from a few lines 
and it compiled just fine!

On Jan 5, 2004, at 3:46 PM, Michael S. Fischer wrote:

> If there is a way, I'm unaware of it.  The documentation says the 
> installation in /opt/apache2 is "for experimental purposes."  Don't 
> try to use it for mod_python though, because the apxs configuration is 
> wrong and it won't compile properly.  (I did my own Apache 2 
> installation in /usr/local/apache2.)
>
> I use mod_proxy on the front-end Apache 1.3 server to pass through 
> mod_python requests to the back-end Apache 2.0 server.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From dwmp at opti.cgi.net  Mon Jan  5 22:50:57 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <20040105215701.M19958@onyx.ispol.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
 <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040105224658.01196ec8@mail.pyxos.com>


I don't see why two calls would make sense.  On the second call the headers 
have already been sent, so I can't modify those and the body has already 
been sent as well and the very first call to filter.read() returns 
None.  On the other hand, if I do filter.close() when I receive empty 
string from filter.read() then I only end up with one call to my output 
filter and everything works normally.

-Dan



At 09:58 PM 1/5/2004 -0500, you wrote:

>I think this is the way it's supposed to work.
>
>On Mon, 5 Jan 2004, Dan W. wrote:
>
> >
> > In the example of the output filter in the 3.1.2b documentation the last
> > lines seem to indicate that filter.close() should only be called if
> > filter.read() returns None.  I paired up an output filter this evening with
> > the mod_python.psp handler and I was getting an empty string on the last
> > filter.read() for every request.  The example code only calls
> > filter.close() if the last read result is None.  Not calling filter.close()
> > on the first call caused the output filter handler to be called a second
> > time.  The second time around, it tried to read from filter.read() and got
> > None, therefore calling filter.close() and ending the cycle.  Should this
> > be normal behavior or should I be calling filter.close() when filter.read()
> > returns empty string as well?
> >
> > My server config:
> >
> >      AddHandler mod_python .psp
> >      PythonHandler mod_python.psp | .psp
> >      PythonOutputFilter mypackage.mymodule TESTFILTER
> >      AddOutputFilter TESTFILTER .psp
> >
> >
> > -Dan
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From dwmp at opti.cgi.net  Mon Jan  5 23:44:34 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] PythonOption and PythonImport
Message-ID: <5.2.1.1.2.20040105234211.0394ad68@mail.pyxos.com>


Is there any way to get to PythonOptions from the PythonImport startup 
script?  From the documentation it appears as though I can only get to 
PythonOptions from the request object.

-Dan

From jay at jaydorsey.com  Tue Jan  6 09:39:44 2004
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] One file controlled site: howto
In-Reply-To: <1245319669.20040105095517@anonym.hu>
References: <1245319669.20040105095517@anonym.hu>
Message-ID: <20040106153944.GA3462@gentoo.Earthlink.net>

On Mon, Jan 05, 2004 at 09:55:17AM +0100, fowlertrainer@anonym.hu wrote:
> Hello !
> 
> I want to control my website with one file, the main.py.
> I want that:
<snip>    
>  - the main.py is let hidden in request !
You can do this with mod_python by adding a request handler 
in your httpd.conf file, similar to this:

<Directory /path/to/webroot>
AddHandler python-program
PythonHandler main
</Directory>

The main.py script will be executed each time a document is 
requested in the /path/to/webroot folder.


hth


-- 
Jay Dorsey
jay at jaydorsey dot com
From jalil at securia.com  Tue Jan  6 17:40:20 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Params submitted using utf-8
Message-ID: <3FFB6384.2010408@securia.com>

    I have a form that submits some text using utf-8 encoding and I 
process the form using  mod_python on Apache.

- When I read in a parameter value and print the type of the string, it 
is "str" and not "unicode". I know unicode is not "utf-8" and I think 
this is fine

- When I try to decode the value into "utf-8" and turn it into unicode 
in python, I get an exception (decoding error - invalid data). Why is 
that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
so why I get invalid data?

- The reason I decided doing above is that I have a table in MySQL which 
is using
utf-8 character sets. Everything works fine if I put the received data 
directly into my table and read it back and send it to browser but two 
problems happen if I do this. First, some characters don't display 
right. Second, althought I set the charset in my returned data to utf-8, 
the browser doesn't select utf-8 as encoding. So, I thought maybe I 
should try to convert into unicode b/f putting the data into my table. 
Is this right? Should I  do anything b/f storing and/or sending the data?

I appriciate any help.

-Jalil


From robert at leftwich.info  Wed Jan  7 15:09:07 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150406.01b14d70@192.168.0.1>

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt)
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From dwmp at opti.cgi.net  Tue Jan  6 22:18:27 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] AddOutputFilterByType
Message-ID: <5.2.1.1.2.20040106213833.03ad4420@mail.pyxos.com>


I'm running a PSP script which outputs a PNG image.  The PSP script sets 
the req.content_type to image/png but its still going through a mod_python 
filter I have setup with AddOutputFilterByType.  The AddOutputFilterByType 
is setup for two types, text/html and text/plain.  Does changing 
req.content_type not update the Apache info before it gets to the filtering 
stage?  Can this be fixed?

-Dan
mod_python: 3.1.2b
apache: 2.0.48
python: 2.3.2
linux: 2.4


From robert at leftwich.info  Wed Jan  7 15:23:26 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>

Sorry - finger trouble on the first attempt:

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt) and the second serves up some xml after first 
filtering it (again via libxslt). The problem I have is when I ask the 
first service to run some xsl on an xml file where the xsl uses the 
document() function to access the second service, the second service is 
never accessed and there is nothing in any of the logs to suggest otherwise.
I tried setting mod_python to use different child interpreters but it made 
no difference. Some googling turned up 
(http://www.modpython.org/pipermail/mod_python/2003-June/003307.html) 
where Grisha says in answer to Paul Robinson:

"> For example, on a Windows platform where there is a single
 > multi-threaded Apache process (mpm_wint
 > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
 > say that mod_python would not be able to take advantage of a
 > multi-processor machine due to the GIL?

The answer, unfortunately, is yes. Here is a google search that has some
info on the subject: http://www.google.com/search?q=python+free-threading

AFAIK the state of things has not changed with respect to SMP and GIL."

So it appears that I am running into this limitation. Is there any 
alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
useable?

Robert
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From manfred.stienstra at dwerg.net  Wed Jan  7 07:32:31 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <1073457151.15608.15.camel@ack.dwerg.net>

On Wed, 2004-01-07 at 02:40, jalil@securia.com wrote:
> - When I read in a parameter value and print the type of the string, it 
> is "str" and not "unicode". I know unicode is not "utf-8" and I think 
> this is fine

Yes, this should be a utf-8 encoded string. Personally I think no
application should convert this data to a unicode object because you
always want to know the encoding it came from. For example utf-8 ->
unicode object -> iso8859-15 could mean loss of characters.

> - When I try to decode the value into "utf-8" and turn it into unicode 
> in python, I get an exception (decoding error - invalid data). Why is 
> that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
> so why I get invalid data?

Are you using the unicode constructor or an decode method? Also, a bad
browser could send something that is not unicode, you should always
expect unicode errors here.

Here is a nice introduction to the whole encode/decode confusion:

http://www.vandervossen.net/2003/07/unicode_in_python

> Second, althought I set the charset in my returned data to utf-8, 
> the browser doesn't select utf-8 as encoding.

If the document isn't utf-8 encoded and the headers claim it is, the
browser could try to correct it and show the proper encoding.

> So, I thought maybe I 
> should try to convert into unicode b/f putting the data into my table. 
> Is this right? Should I  do anything b/f storing and/or sending the data?

Yes, you should check the input. You don't have to do this by converting
the string into a unicode object, but you can do it by checking the byte
ordering (see the utf-8 specifications for more information).

Manfred

From ograf at rz-online.net  Wed Jan  7 08:22:01 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 21:54:11 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040107072201.GD3045@rz-online.net>

On Wed, Jan 07, 2004 at 03:23:26PM +1100, Robert Leftwich wrote:
> "> For example, on a Windows platform where there is a single
> > multi-threaded Apache process (mpm_wint
> > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
> > say that mod_python would not be able to take advantage of a
> > multi-processor machine due to the GIL?
> 
> The answer, unfortunately, is yes. Here is a google search that has some
> info on the subject: http://www.google.com/search?q=python+free-threading
> 
> AFAIK the state of things has not changed with respect to SMP and GIL."
> 
> So it appears that I am running into this limitation. Is there any 
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
> useable?

Out of my stomach I would answer: this is an apache topic, mod_python
will do whatever apache can do. So If there is a mpm for apache under
win32 that does forks (no mpm_prefork for win32? can't believe this,
but I never used this win32 platform...) mod_python should behave well
with SMP...

Oliver.

P.S.: If I am wrong, I'm really interested why. :)

From blazek at firma.seznam.cz  Wed Jan  7 09:59:54 2004
From: blazek at firma.seznam.cz (Vaclav Blazek)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040107072201.GD3045@rz-online.net>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
	<20040107072201.GD3045@rz-online.net>
Message-ID: <200401070959.54180.blazek@firma.seznam.cz>

Dne st 7. ledna 2004 08:22 Oliver Graf napsal(a):
> Out of my stomach I would answer: this is an apache topic, mod_python
> will do whatever apache can do. So If there is a mpm for apache under
> win32 that does forks (no mpm_prefork for win32? can't believe this,
> but I never used this win32 platform...) mod_python should behave well
> with SMP...
>
> Oliver.
>
> P.S.: If I am wrong, I'm really interested why. :)

Hallo,

fork() (process duplication) is unix specific feature, no other kind of system 
has it. On non-unix platforms you have to use threading instead. But as you 
know, threads are evil :-). You can be sure you propperly synchronize 
everything but... just try to close one file descriptor twice and disaster is 
near at hand...

Vasek

PS I've heard the new version of OpenVMS will have fork().

From fowlertrainer at anonym.hu  Wed Jan  7 10:09:27 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Have the mod_python an example store on web... ?
Message-ID: <306091519.20040107100927@anonym.hu>

Hello mod,

  ... or other site, what have online FAQ, or other ?
  I have some modules, and I send these modules, if needed.
  (A persistent DB connection pool, and a session manager tool)

  I want to send it/share it, because I use win32 mod_py, and I want to remove
  bugs (by found another users), and to help the mod_python to staying
  alive/growing/advancing.

  I want to learn the mod_py, get more and more knowledge, and I
  possible, share these informations with anothers.

  Thanx.

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From kevin at sb.org  Wed Jan  7 11:02:42 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <ECE51A3C-412A-11D8-9AD2-000A95A072FC@sb.org>

To make the browser display as UTF-8, you need to tell it to do that 
either in the headers or in a <meta> tag in the source.

On Jan 6, 2004, at 8:40 PM, jalil@securia.com wrote:

> - The reason I decided doing above is that I have a table in MySQL 
> which is using
> utf-8 character sets. Everything works fine if I put the received data 
> directly into my table and read it back and send it to browser but two 
> problems happen if I do this. First, some characters don't display 
> right. Second, althought I set the charset in my returned data to 
> utf-8, the browser doesn't select utf-8 as encoding. So, I thought 
> maybe I should try to convert into unicode b/f putting the data into 
> my table. Is this right? Should I  do anything b/f storing and/or 
> sending the data?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From spoerri at duke.edu  Thu Jan  8 10:33:40 2004
From: spoerri at duke.edu (Christoph Spoerri)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] RE: Session handling: example needed
Message-ID: <200401081033.40738.spoerri@duke.edu>

Hi list users,

I saw that recently somebody added for an example of using the session 
handler. I was looking for the same with out any luck, but was able to get 
things working (love the trial-and-error stuff ;) ).

I have attached a short script that uses two counters (int and object) to 
count the number of visits by the users during a session.

Notes:
- use is_new() to check if you have a new session or not before you use it (as 
mentioned in the manual)
- you need to save the session object at the end otherwise, the ID and any 
other stuff won't be saved (!), and you'll be wondering what happend to the 
session (as I did).

cheers,
Christoph

PS: I'm new to python, so forgive me any strange python coding.

***************** session_sample.py ***********************

from mod_python import apache

class simpelCountClass:
	count = 0
	def __init__(self,c):
		self.count = c
	def increment(self):
		self.count = self.count+1
	def asString(self):
		return str(self.count)


def sessionTest(req):
	req.content_type = "text/html"
	s = "<html><body>testing<br>"

	t = Session.DbmSession(req)
	if (t.is_new()):
		s += "new session id: "+str(t.id())+"<br>"
		t['count']=1
		t['countObj']=simpelCountClass(1)

	else:
		s += "session id: "+str(t.id())+"<br>"
		t['count']=t['count']+1
		t['countObj'].increment()

	s += "count: "+str(t['count'])+"<br>"
	s += "countObj: "+t['countObj'].asString()+"<br>"
	s += "timeout: "+str(t.timeout())+"<br>"
	s += "created: "+str(t.created())+"<br>"
	s += "last_accessed: "+str(t.last_accessed())+"<br>"
	s += "</body></html>"
	t.save() # DON'T FORGET THIS ONE!!!
	return s

From dg at sponsera.com  Thu Jan  8 14:30:26 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFDAFD2.1010708@sponsera.com>

Help!

I have the weirdest problem - I am using the following:

redhat9
mysql 4.0.13
mod_python 3.0.4
python 2.2.3
MySQL-python 0.9.2 (python interface to the mysql libraries)
apache 2.0.47

When I run ordinary python programs to access the mysql database, things 
seem to work fine. (i can connect to the database, so selects, updates, etc)

When I run identical queries under mod_python via request to apache, 
apache tends to core dump on database accesses - or sometimes, doesn't 
core dump but I get very strange,inconsistant results.

Any ideas? Are "threads" an issue? I am almost positive the python 
enviornment that apache is getting is the same as the "normal" environment.

I just have no idea why this is happening - I have used mod_python w/ 
mysql before, with generally very good results.

Thanks a lot!

David





From chip at force-elite.com  Thu Jan  8 11:44:24 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDAFD2.1010708@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com>
Message-ID: <3FFDB318.2090401@force-elite.com>

Are you running mod_auth_mysql or any other apache modules that use 
MySQL Client Connections?

Make sure they are all compiled with the exact same client lib versions..

Also, did you build from source, or are you using someones RPMs?

-Paul Querna

David Geller wrote:
> Help!
> 
> I have the weirdest problem - I am using the following:
> 
> redhat9
> mysql 4.0.13
> mod_python 3.0.4
> python 2.2.3
> MySQL-python 0.9.2 (python interface to the mysql libraries)
> apache 2.0.47
> 
> When I run ordinary python programs to access the mysql database, things 
> seem to work fine. (i can connect to the database, so selects, updates, 
> etc)
> 
> When I run identical queries under mod_python via request to apache, 
> apache tends to core dump on database accesses - or sometimes, doesn't 
> core dump but I get very strange,inconsistant results.
> 
> Any ideas? Are "threads" an issue? I am almost positive the python 
> enviornment that apache is getting is the same as the "normal" environment.
> 
> I just have no idea why this is happening - I have used mod_python w/ 
> mysql before, with generally very good results.
> 
> Thanks a lot!
> 
> David
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From pkeshishian at yahoo.com  Thu Jan  8 12:05:53 2004
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Re: mysqldb / mod_python problem
In-Reply-To: <3FFDB598.1050608@sponsera.com>
Message-ID: <20040108200553.58614.qmail@web40015.mail.yahoo.com>

Hi David:
 
I did not really find any solution for my problem. The main problem I had was that mod_python was working when I was trying to select a single column, but it was failing in case of 2 or more columns. Since the database I am running is very small I just wrote a python function that queries each column separately than puts them together and returns the result. Since my database is very small the slowdown is insignificant. But it won't be recommended for large databases, and it is not really a solution. I believe this problem deserves a more serious consideration.
 
Cheers,
Petros
 

David Geller <dg@sponsera.com> wrote:
Hi Petros -

I read your posting in the [mod_python] list Dec 30, 2003 regarding 
problems you were having with Mysql not working under mod_python 
correctly (while "regular" console python progrems seemed to work fine).

Well, I am running into exactly the same, frustrating problem!!! What is 
going on? I can't figure it out, and am about to abandon mod_python.

Did you ever get your problem resolved? I'd be most interested in hearing.

Thanks a lot!

Regards,
David
dg@sponsera.com



---------------------------------
Do you Yahoo!?
Yahoo! Hotjobs: Enter the "Signing Bonus" Sweepstakes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040108/612a754e/attachment-0001.htm
From dg at sponsera.com  Thu Jan  8 15:54:56 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDB318.2090401@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
Message-ID: <3FFDC3A0.8010900@sponsera.com>

1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot 
seem to find any references anywhere to such modules....)

2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.

Also, everything (my entire mod_python application, including all mysql 
accessing), seems to run *fine* on my home machine (redhat8-based). It 
is when I have tried running on our redhat-9-based server where these 
problems start to appear....(note that I reuilt all the sources on the 
redhat9 machine...)


Paul Querna wrote:

> Are you running mod_auth_mysql or any other apache modules that use 
> MySQL Client Connections?
>
> Make sure they are all compiled with the exact same client lib versions..
>
> Also, did you build from source, or are you using someones RPMs?
>
> -Paul Querna
>
> David Geller wrote:
>
>> Help!
>>
>> I have the weirdest problem - I am using the following:
>>
>> redhat9
>> mysql 4.0.13
>> mod_python 3.0.4
>> python 2.2.3
>> MySQL-python 0.9.2 (python interface to the mysql libraries)
>> apache 2.0.47
>>
>> When I run ordinary python programs to access the mysql database, 
>> things seem to work fine. (i can connect to the database, so selects, 
>> updates, etc)
>>
>> When I run identical queries under mod_python via request to apache, 
>> apache tends to core dump on database accesses - or sometimes, 
>> doesn't core dump but I get very strange,inconsistant results.
>>
>> Any ideas? Are "threads" an issue? I am almost positive the python 
>> enviornment that apache is getting is the same as the "normal" 
>> environment.
>>
>> I just have no idea why this is happening - I have used mod_python w/ 
>> mysql before, with generally very good results.
>>
>> Thanks a lot!
>>
>> David
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

-- 
David Geller
Sponsera, LLC
dg@sponsera.com
www.sponsera.com
Phone: 703.532.6812
Fax: 703.532.6058



From chip at force-elite.com  Thu Jan  8 13:17:40 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC3A0.8010900@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com>
Message-ID: <3FFDC8F4.7000607@force-elite.com>

David Geller wrote:
> 1. As far as I know, I am not running any other apache modules using 
> MySQL ( I am not sure how to check this out definitely, but I cannot 
> seem to find any references anywhere to such modules....)
> 
> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.
> 
> Also, everything (my entire mod_python application, including all mysql 
> accessing), seems to run *fine* on my home machine (redhat8-based). It 
> is when I have tried running on our redhat-9-based server where these 
> problems start to appear....(note that I reuilt all the sources on the 
> redhat9 machine...)

Could you try to get a Backtrace in GDB from the Apache Core Files?
From grisha at modpython.org  Thu Jan  8 18:33:01 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040108183117.S67407@onyx.ispol.com>



On Wed, 7 Jan 2004, Robert Leftwich wrote:

> So it appears that I am running into this limitation. Is there any
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> useable?

s/Windows/Unix ? ;-)

Grisha
From neel at mediapulse.com  Thu Jan  8 18:58:40 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <C0FC22C08B82074A88B50061764157776B996D@johnson.mediapulse.net>

> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of 
> Windows/Apache2.xx/mod_python/SMP not
> > useable?
> 
> s/Windows/Unix ? ;-)
> 
%s/Windows/Unix/g =)

From khalid_kary at hotmail.com  Fri Jan  9 00:12:48 2004
From: khalid_kary at hotmail.com (Khalid El-Kary)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <BAY8-F965rrgJGERxKF000142da@hotmail.com>

> > s/Windows/Unix ? ;-)
> >
>%s/Windows/Unix/g =)

Execuse my ignorance, but what do both of them mean ? :-)

Khalid

_________________________________________________________________
MSN 8 with e-mail virus protection service: 2 months FREE* 
http://join.msn.com/?page=features/virus

From dg at sponsera.com  Thu Jan  8 19:26:54 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC8F4.7000607@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com> <3FFDC8F4.7000607@force-elite.com>
Message-ID: <3FFDF54E.4000403@sponsera.com>

I am not quite sure how to do this.

Presumably, I would have to rebuild apache with -g enabled.  Is this 
correct? How do I actually get the core files? (the actual error I have 
been getting is "Segmentation fault")

Thanks!


Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
>> MySQL ( I am not sure how to check this out definitely, but I cannot 
>> seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
>> source.
>>
>> Also, everything (my entire mod_python application, including all 
>> mysql accessing), seems to run *fine* on my home machine 
>> (redhat8-based). It is when I have tried running on our 
>> redhat-9-based server where these problems start to appear....(note 
>> that I reuilt all the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>



From robert at leftwich.info  Fri Jan  9 14:25:43 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040108183117.S67407@onyx.ispol.com>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
 <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <5.2.0.9.0.20040109140327.01b15748@192.168.0.1>

At 10:33 AM 9/01/2004, Gregory (Grisha) Trubetskoy wrote:

>On Wed, 7 Jan 2004, Robert Leftwich wrote:
>
> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> > useable?
>
>s/Windows/Unix ? ;-)

Unfortunately the people I'm doing this project for are committed to 
Windows and cannot switch their production boxen (all SMP) to *nix :-((

After looking at a few options it's back to Java/servlets I go .... (at 
least for this project).

Robert

PS Can I suggest that this limitation be highlighted on the website/readme 
as it might save anyone else in the same situation from a lot of wasted 
time/effort. 
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From davidf at sjsoft.com  Fri Jan  9 06:44:24 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
References: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
Message-ID: <3FFE31A8.2000103@sjsoft.com>

Khalid El-Kary wrote:

>> > s/Windows/Unix ? ;-)
>> >
>> %s/Windows/Unix/g =)
>
>
> Execuse my ignorance, but what do both of them mean ? :-)
>
> Khalid

They are instructions that mean "replace 'Windows' with 'Unix' from sed 
(a command line search and replace tool) and used in other tools such as 
vim (text editor).

David

From dg at sponsera.com  Fri Jan  9 00:12:42 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <000b01c3d66a$d282f0e0$0600a8c0@santana>
References: <000b01c3d66a$d282f0e0$0600a8c0@santana>
Message-ID: <3FFE384A.8010805@sponsera.com>

Thanks, Mike.

While I am not following what you do *exactly*, it is similar.
And as I said, everything runs fine on one machine. (and has for a few 
years with multiple apps). It was an incredible suprise to all of a 
sudden find such difficulty on a new machine.

What *we* do is:
1. Get sources from relevent places as tarballs  - (apache, python, 
msql, MySQLdb, mod_python,....)
2. place sources in /usr/local/src
3. build and compile them there
4. install them in /usr/local

Soooo, python is in /usr/local/lib/python2.2... (execuatable in 
/usr/local/bin as /usr/local/bin/python)
apache is in /usr/local/apache2/...
mysql is in /usr/local/mysql...

And I have confirmed that mod_python is picking up the correct python.

D.

Michael Neel wrote:

>I see a lot of posts about trouble with MySQL and mod_python.  I use
>both in almost every project I do, and have yet to have any of these
>problems.  So here is how we configure a box:
>
>Redhat is used, versions 6x to 9 have been in use.
>We do not install the RPMs of MySQL that come with redhat, but do use
>the RPMs from MySQL's website.
>Apache's have been both compiled from source and RehHat RPMs.  When
>going from source, we use apache toolbox.  We've used both 1.3 and 2.0
>apaches.
>Python is compiled from source, and replaces the redhat version 
>(--prefix=/usr)
>Mod python is compiled from source as well.  This after python is
>installed to make sure it gets set to the same paths as the command
>line.  I never remember what to pass to configure, so I have to edit the
>src/Makefile and add -DEAPI to the opts.
>MySQLdb is installed with a simple python setup.py install
>
>If this helps or not I'm not sure, but I though I'd post it.
>Mike
>
>
>
>  
>



From dg at sponsera.com  Fri Jan  9 00:30:03 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFE3C5B.9090901@sponsera.com>

Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot
seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
source.
>>
>> Also, everything (my entire mod_python application, including all 
mysql accessing), seems to run *fine* on my home machine
(redhat8-based). It is when I have tried running on our redhat-9-based
server where these problems start to appear....(note that I reuilt all
the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?




Stack trace from wierd mod_python/mysql bug obtained!

================== basic program (outline) being run
from mod_python import util
from mod_python import apache
import MySQLdb

def hander(req):

db = MySQLdb.connect(db="quest1",
                          host="localhost",
                          user="dg",
                          passwd="pass")

     c = db.cursor(MySQLdb.cursors.DictCursor)
    sql = """select * from subject"""

     c.execute(sql)
==================================
Note that we get Seg fault on the c.execute().
And note also: with certain sql statements, does not crash but obtain
inconsistant results.


=====================GDB Stack ========================================

(gdb) r
Starting program: /usr/local/apache2/sbin/httpd -DONE_PROCESS
[New Thread 16384 (LWP 17860)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 17860)]
0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa) at Python/modsupport.c:334

(gdb) where
#0  0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa)
     at Python/modsupport.c:334
#1  0x402f8f9a in do_mktuple (p_format=0xbfffe790, p_va=0xbfffe794,
     endchar=41, n=7) at Python/modsupport.c:223
#2  0x402f88cf in do_mkvalue (p_format=0xbfffe790, p_va=0xbfffe794)
     at Python/modsupport.c:247
#3  0x402f8b4c in Py_VaBuildValue (format=0x0, va=0x0)
     at Python/modsupport.c:428
#4  0x402f8aea in Py_BuildValue (format=0x406ceb95 "(siiiiii)")
     at Python/modsupport.c:399
#5  0x406cce33 in _mysql_ResultObject_describe (self=0x828f160, args=0x0)
     at _mysql.c:737
#6  0x402d6988 in fast_cfunction (func=0x0, pp_stack=0xbfffe8c4, na=-1)
     at Python/ceval.c:3132
#7  0x402d51d5 in eval_frame (f=0x822baec) at Python/ceval.c:2017
#8  0x402d5be3 in PyEval_EvalCodeEx (co=0x81fa500, globals=0x0, locals=0x0,
     args=0x822b73c, argcount=2, kws=0x822b744, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#9  0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#10 0x402d514f in eval_frame (f=0x822b5e4) at Python/ceval.c:2034
#11 0x402d5be3 in PyEval_EvalCodeEx (co=0x8285908, globals=0x0, locals=0x0,
     args=0x82491dc, argcount=2, kws=0x82491e4, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#12 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#13 0x402d514f in eval_frame (f=0x8249064) at Python/ceval.c:2034
#14 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f95d0, globals=0x0, locals=0x0,
     args=0x817341c, argcount=3, kws=0x8173428, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#15 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=3, nk=0)
     at Python/ceval.c:3170
#16 0x402d514f in eval_frame (f=0x81732c4) at Python/ceval.c:2034
#17 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f8df8, globals=0x0, locals=0x0,
     args=0x8173410, argcount=2, kws=0x823b4a0, kwcount=0, defs=0x8289a80,
     defcount=1, closure=0x0) at Python/ceval.c:2595
#18 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#19 0x402d514f in eval_frame (f=0x823b32c) at Python/ceval.c:2034
#20 0x402d5be3 in PyEval_EvalCodeEx (co=0x823ef80, globals=0x0, locals=0x0,
     args=0x8233280, argcount=1, kws=0x8233284, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#21 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=1, nk=0)
     at Python/ceval.c:3170
#22 0x402d514f in eval_frame (f=0x82330d4) at Python/ceval.c:2034
#23 0x402d5be3 in PyEval_EvalCodeEx (co=0x81e6b18, globals=0x0, locals=0x0,
     args=0x81d0640, argcount=2, kws=0x0, kwcount=0, defs=0x0, defcount=0,
     closure=0x0) at Python/ceval.c:2595
#24 0x4031a729 in function_call (func=0x822f7d4, arg=0x81d0634, kw=0x0)
     at Objects/funcobject.c:476
#25 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81d0634, kw=0x0)
     at Objects/abstract.c:1688
#26 0x402a3148 in instancemethod_call (func=0x822f7d4, arg=0x81d0634,
kw=0x0)
     at Objects/classobject.c:2315
#27 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81e99d4, kw=0x0)
     at Objects/abstract.c:1688
#28 0x402d6847 in PyEval_CallObjectWithKeywords (func=0x81cc8b4,
     arg=0x81e99d4, kw=0x0) at Python/ceval.c:3058
#29 0x4029aa8d in PyObject_CallMethod (o=0x0, name=0x81e99d4 "\002",
     format=0x81e99d4 "\002") at Objects/abstract.c:1679
#30 0x402985fc in python_handler (req=0x81bb018,
     phase=0x4031ee18 "PythonHandler") at mod_python.c:899
#31 0x4029973e in PythonHandler (req=0x81bb018) at mod_python.c:1699
#32 0x0807baca in ap_run_handler (r=0x81bb018) at config.c:195
#33 0x0807bfe2 in ap_invoke_handler (r=0x81bb018) at config.c:401
#34 0x0806bd8b in ap_process_request (r=0x81bb018) at http_request.c:288
#35 0x08067f25 in ap_process_http_connection (c=0x81b6fe8) at
http_core.c:293
#36 0x0808493a in ap_run_process_connection (c=0x81b6fe8) at connection.c:85
#37 0x0807a67f in child_main (child_num_arg=0) at prefork.c:694
#38 0x0807a82a in make_child (s=0x80b7118, slot=0) at prefork.c:734
#39 0x0807a883 in startup_children (number_to_start=5) at prefork.c:806
#40 0x0807af75 in ap_mpm_run (_pconf=0x8079f68, plog=0x80ecaf0, s=0x80b7118)
     at prefork.c:1022
#41 0x0807fd02 in main (argc=2, argv=0xbffff404) at main.c:660
#42 0x401415cd in __libc_start_main () from /lib/libc.so.6
(gdb)





From dwmp at opti.cgi.net  Fri Jan  9 00:15:40 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] get_options() problem
Message-ID: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>


According to the 3.1.2b documentation there should be a get_options() 
method on the server object.  When trying to access it I get a traceback.

code (under psp):

req.log_error('options: %s' % `req.server.get_options()`)

error:

AttributeError: 'mp_server' object has no attribute 'get_options'


Does the server.get_options() method no longer exist and is the 
documentation (section 4.5.6.1) just out of date?

I'm trying to get to the DocumentRoot value for the virtual server handling 
the current request and was hoping I might find it in there.

-Dan

From dwmp at opti.cgi.net  Fri Jan  9 00:23:11 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] get_options() problem
In-Reply-To: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109002211.03797eb8@mail.pyxos.com>


I found the DocumentRoot value I was after.  Duh.  req.document_root().

However, that server.get_options() probably needs some looking into.

-Dan



At 12:15 AM 1/9/2004 -0600, you wrote:

>According to the 3.1.2b documentation there should be a get_options() 
>method on the server object.  When trying to access it I get a traceback.
>
>code (under psp):
>
>req.log_error('options: %s' % `req.server.get_options()`)
>
>error:
>
>AttributeError: 'mp_server' object has no attribute 'get_options'
>
>
>Does the server.get_options() method no longer exist and is the 
>documentation (section 4.5.6.1) just out of date?
>
>I'm trying to get to the DocumentRoot value for the virtual server 
>handling the current request and was hoping I might find it in there.
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From a.w at quirxi.com  Fri Jan  9 14:12:31 2004
From: a.w at quirxi.com (Arno Wilhelm)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] 
	Newbie question: Fieldstorage is empty in the second handler
Message-ID: <3FFEA8BF.2060408@quirxi.com>

Hello,

I have just started using mod_pyhon and have come to a problem I cannot find an 
solution for:

In my html file there is a hidden input named PATH:

<FORM method="post" action="/qwer/eval.py">
<INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
...
</FORM>

When the form is submitted the PATH variable reaches the authenhandler(req) 
which I can give out to a file:

PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24

but after that it does not reach the following handler(req) function. It always 
raises an KeyError since the PATH variable does not exist in this function anymore !
Can anyone point me to the right direction ?



cheers,

Arno





	

From fowlertrainer at anonym.hu  Fri Jan  9 16:19:41 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] How to globalize vars ???
Message-ID: <17328262299.20040109161941@anonym.hu>

Hello !

I have get a strange problem in mod_python site.
More modules I have, and think, to I initialize my Session handler
from main module.

Like this:

-- main --

import BHASession

# Session info
BHASessionDir="C:/bhaweb/sessions"
#f=open("c:/now.txt","a");f.write(" 1");f.close();
BHASession.SSInit(BHASessionDir)
#f=open("c:/now.txt","a");f.write(" 2");f.close();

-- Session --
f=open("c:/now.txt","a");f.write(" 01");f.close();
#global SSDefaultDir
SSDefaultDir="c:/bhaweb/sessions"
f=open("c:/now.txt","a");f.write(" 02");f.close();
SSLockObj=threading.Lock()

def SSLock():
    SSLockObj.acquire()

def SSUnlock():
    SSLockObj.release()

def SSInit(SessionDir):
    #f=open("c:/now.txt","a");f.write(" 03");f.close();
    SSLock()
    try:
      #global SSDefaultDir
      #r.append(str(SSDefaultDir))
      #f=open("c:/now.txt","a")
      #f.write(" "+SSDefaultDir)
      #f.close()
      #r.append(str(SSInitialized))
      if SSDefaultDir.strip()=="":
#       <-
# UnboundLocalError: local variable 'SSDefaultDir' referenced before assignment
         r.append(str(SSDefaultDir))
         SSDefaultDir=SessionDir
         f=open("c:/now.txt","a")
         f.write(" "+SSDefaultDir)
         f.close()
    finally:
      SSUnlock()

--------------
      
When I not use SSInit, only I write the global variable in BHASession
module like this:

SSDefaultDir="c:/bhaweb/sessions"

then it is working good !!!

Why ? How to force python to module see his variable ?

Thanx for any advance  !

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From dwmp at opti.cgi.net  Fri Jan  9 10:08:28 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in
  the second handler
In-Reply-To: <3FFEA8BF.2060408@quirxi.com>
Message-ID: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>


You're probably creating a FieldStorage in authenhandler() and then 
recreating the FieldStorage in your handler().  You're using a POST request 
so the when FieldStorage is created it reads the fields from the body of 
the request (GET requests put the variables in the header) via the 
req.read() method. Once you've read the body of the of a request, it cannot 
be read again.  So when your second FieldStorage is created, there is no 
body request data left to be read.

As it turns out, the req object you get in authenhandler() and handler() is 
the same object.  So when you create your first FieldStorage in 
authenhandler(), assign it to the req object and it will be available in 
your handler() function without having to recreate it again.

-Dan




At 02:12 PM 1/9/2004 +0100, you wrote:
>Hello,
>
>I have just started using mod_pyhon and have come to a problem I cannot 
>find an solution for:
>
>In my html file there is a hidden input named PATH:
>
><FORM method="post" action="/qwer/eval.py">
><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>...
></FORM>
>
>When the form is submitted the PATH variable reaches the 
>authenhandler(req) which I can give out to a file:
>
>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>
>but after that it does not reach the following handler(req) function. It 
>always raises an KeyError since the PATH variable does not exist in this 
>function anymore !
>Can anyone point me to the right direction ?
>
>
>
>cheers,
>
>Arno

From dwmp at opti.cgi.net  Fri Jan  9 10:12:57 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] How to globalize vars ???
In-Reply-To: <17328262299.20040109161941@anonym.hu>
Message-ID: <5.2.1.1.2.20040109101042.042fa6f0@mail.pyxos.com>


Try assigning global SSDefaultDir at the top of your SSInit function like this:

def SSInit(SessionDir):
     global SSDefaultDir
     SSLock()
     ...

-Dan




At 04:19 PM 1/9/2004 +0100, you wrote:
>Hello !
>
>I have get a strange problem in mod_python site.
>More modules I have, and think, to I initialize my Session handler
>from main module.
>
>Like this:
>
>-- main --
>
>import BHASession
>
># Session info
>BHASessionDir="C:/bhaweb/sessions"
>#f=open("c:/now.txt","a");f.write(" 1");f.close();
>BHASession.SSInit(BHASessionDir)
>#f=open("c:/now.txt","a");f.write(" 2");f.close();
>
>-- Session --
>f=open("c:/now.txt","a");f.write(" 01");f.close();
>#global SSDefaultDir
>SSDefaultDir="c:/bhaweb/sessions"
>f=open("c:/now.txt","a");f.write(" 02");f.close();
>SSLockObj=threading.Lock()
>
>def SSLock():
>     SSLockObj.acquire()
>
>def SSUnlock():
>     SSLockObj.release()
>
>def SSInit(SessionDir):
>     #f=open("c:/now.txt","a");f.write(" 03");f.close();
>     SSLock()
>     try:
>       #global SSDefaultDir
>       #r.append(str(SSDefaultDir))
>       #f=open("c:/now.txt","a")
>       #f.write(" "+SSDefaultDir)
>       #f.close()
>       #r.append(str(SSInitialized))
>       if SSDefaultDir.strip()=="":
>#       <-
># UnboundLocalError: local variable 'SSDefaultDir' referenced before 
>assignment
>          r.append(str(SSDefaultDir))
>          SSDefaultDir=SessionDir
>          f=open("c:/now.txt","a")
>          f.write(" "+SSDefaultDir)
>          f.close()
>     finally:
>       SSUnlock()
>
>--------------
>
>When I not use SSInit, only I write the global variable in BHASession
>module like this:
>
>SSDefaultDir="c:/bhaweb/sessions"
>
>then it is working good !!!
>
>Why ? How to force python to module see his variable ?
>
>Thanx for any advance  !
>
>--
>Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From jalil at securia.com  Fri Jan  9 08:22:22 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] How to set connection parameters?
Message-ID: <3FFED53E.20402@securia.com>

When using JDBC,  one can pass the following parameters in the 
connection string:

useUnicode=true&characterEncoding=UTF-8

How do we do this in Python?

Thanks,

-Jalil



From dwmp at opti.cgi.net  Fri Jan  9 10:41:18 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in 
  the second handler
In-Reply-To: <3FFED6FE.8000702@quirxi.com>
References: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
 <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109103843.036e4ce0@mail.pyxos.com>


The req object is just a python object.  You can assign any new members you 
want to it and they will remain throughout Apache's request handling 
process.   So in your authenhandler() do this:

req.form = FieldStorage(req)

Then when you need to get your variables in handler() just do this:

path = req.form['PATH'].value


-Dan



At 05:29 PM 1/9/2004 +0100, you wrote:
>Hello Daniel,
>
>
>>You're probably creating a FieldStorage in authenhandler() and then 
>>recreating the FieldStorage in your handler().  You're using a POST 
>>request so the when FieldStorage is created it reads the fields from the 
>>body of the request (GET requests put the variables in the header) via 
>>the req.read() method. Once you've read the body of the of a request, it 
>>cannot be read again.  So when your second FieldStorage is created, there 
>>is no body request data left to be read.
>>As it turns out, the req object you get in authenhandler() and handler() 
>>is the same object.
>
>
>It is just as you said: I used a POST request and called FieldStorage in 
>authenhandler() and handler().
>
>>So when you create your first FieldStorage in authenhandler(), assign it 
>>to the req object and it will be available in your handler() function 
>>without having to recreate it again.
>
>How can you assign the FieldStorage to a req object ? I could not find any 
>variable it could be assigned to in the docu.
>
>
>
>Arno
>
>
>
>>-Dan
>>
>>
>>At 02:12 PM 1/9/2004 +0100, you wrote:
>>
>>>Hello,
>>>
>>>I have just started using mod_pyhon and have come to a problem I cannot 
>>>find an solution for:
>>>
>>>In my html file there is a hidden input named PATH:
>>>
>>><FORM method="post" action="/qwer/eval.py">
>>><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>>>...
>>></FORM>
>>>
>>>When the form is submitted the PATH variable reaches the 
>>>authenhandler(req) which I can give out to a file:
>>>
>>>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>>>
>>>but after that it does not reach the following handler(req) function. It 
>>>always raises an KeyError since the PATH variable does not exist in this 
>>>function anymore !
>>>Can anyone point me to the right direction ?
>>>
>>>
>>>
>>>cheers,
>>>
>>>Arno
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From neel at mediapulse.com  Fri Jan  9 12:15:16 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] get_options() problem
Message-ID: <C0FC22C08B82074A88B50061764157776B9971@johnson.mediapulse.net>

I use req.get_options(), this is 2.x - and it should be the same (at
least I hope it is) for 3.x

Mike

> -----Original Message-----
> From: Daniel West [mailto:dwmp@opti.cgi.net] 
> Sent: Friday, January 09, 2004 1:23 AM
> To: mod_python@modpython.org
> Subject: Re: [mod_python] get_options() problem
> 
> 
> 
> I found the DocumentRoot value I was after.  Duh.  
> req.document_root().
> 
> However, that server.get_options() probably needs some looking into.
> 
> -Dan
> 
> 
> 
> At 12:15 AM 1/9/2004 -0600, you wrote:
> 
> >According to the 3.1.2b documentation there should be a 
> get_options() 
> >method on the server object.  When trying to access it I get 
> a traceback.
> >
> >code (under psp):
> >
> >req.log_error('options: %s' % `req.server.get_options()`)
> >
> >error:
> >
> >AttributeError: 'mp_server' object has no attribute 'get_options'
> >
> >
> >Does the server.get_options() method no longer exist and is the 
> >documentation (section 4.5.6.1) just out of date?
> >
> >I'm trying to get to the DocumentRoot value for the virtual server 
> >handling the current request and was hoping I might find it in there.
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From jalil at securia.com  Fri Jan  9 11:33:27 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Cannot load templates using PSP class
Message-ID: <3FFF0207.3000003@securia.com>

 
In my python default handler, I am trying to load an html file in my 
code using the example below:

template = psp.PSP(req, filename='template.html')

The html file is located in the same directory as my .py file but this call 
fails unless I pass the full path of the html file in the call!

Any way to change this behaviour?

Thanks,

-Jalil



From grisha at modpython.org  Fri Jan  9 17:05:53 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <3FFF0207.3000003@securia.com>
References: <3FFF0207.3000003@securia.com>
Message-ID: <20040109165951.K82783@onyx.ispol.com>


It's impossible to answer this without the details of your configuration.

Take a look at your req.filename. PSP tries to figure out the "current
directory" by looking at req.filename. Under certain configs this won't
work.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

>
> In my python default handler, I am trying to load an html file in my
> code using the example below:
>
> template = psp.PSP(req, filename='template.html')
>
> The html file is located in the same directory as my .py file but this call
> fails unless I pass the full path of the html file in the call!
>
> Any way to change this behaviour?
>
> Thanks,
>
> -Jalil
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From jalil at securia.com  Fri Jan  9 14:27:32 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <20040109165951.K82783@onyx.ispol.com>
References: <3FFF0207.3000003@securia.com>
	<20040109165951.K82783@onyx.ispol.com>
Message-ID: <3FFF2AD4.5090909@securia.com>

Grisha,

req.filename is the the full path of the resource on my filesystem and 
looks fine.
Please let me know what info you need regarding my configuration or what 
config parameters make this fail.

Thanks,

-Jalil

Gregory (Grisha) Trubetskoy wrote:

>It's impossible to answer this without the details of your configuration.
>
>Take a look at your req.filename. PSP tries to figure out the "current
>directory" by looking at req.filename. Under certain configs this won't
>work.
>
>Grisha
>
>On Fri, 9 Jan 2004, jalil wrote:
>
>  
>
>>In my python default handler, I am trying to load an html file in my
>>code using the example below:
>>
>>template = psp.PSP(req, filename='template.html')
>>
>>The html file is located in the same directory as my .py file but this call
>>fails unless I pass the full path of the html file in the call!
>>
>>Any way to change this behaviour?
>>
>>Thanks,
>>
>>-Jalil
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>

From jalil at securia.com  Fri Jan  9 15:41:23 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] Error using Session
Message-ID: <3FFF3C23.8060301@securia.com>

Today I upgraded to Python 2.3.3 and mod_python 3.1.2b fine. I am trying to use the Session
class now and when in my request handler I do something simple like:

sess = Session.Session(req)
req.write (sess.id())

I get the following error. Any idea why this happens and why python2.2 is still being 
used in mod_python? The 2.3.3 is installed in /usr/local/lib which comes first in my PATH.
I am using Redhad which seems to depend on 2.2!


Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)

  File "/development/webnotes/src/pylib/dispatch.py", line 54, in handler
    ses = Session.Session(req)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)

ValueError: Failed to acquire global mutex lock

Thanks,

-Jalil


From egrubbs at rackspace.com  Fri Jan  9 17:53:19 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Fri Jan  9 21:54:12 2004
Subject: [mod_python] SetEnv and add_common_vars()
Message-ID: <20040109235319.GJ5495@rackspace.com>

When I use SetEnv in my apache conf file, it causes a lot of the
environment variables (such as DOCUMENT_ROOT) to disappear that
add_common_vars() normally would set.

The only workaround I have is to put the SetEnv statements in a
different <Directory> block than the directory with the files served by
mod_python.

Is this a bug in mod_env or mod_python? Is there a better way to fix
this?

-Edwin
From grisha at modpython.org  Fri Jan  9 19:48:39 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:13 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040109235319.GJ5495@rackspace.com>
References: <20040109235319.GJ5495@rackspace.com>
Message-ID: <20040109194651.V82783@onyx.ispol.com>


On Fri, 9 Jan 2004, Edwin Grubbs wrote:

> When I use SetEnv in my apache conf file, it causes a lot of the
> environment variables (such as DOCUMENT_ROOT) to disappear that
> add_common_vars() normally would set.

When you say "dissapear" - what are you using to look them up?

> The only workaround I have is to put the SetEnv statements in a
> different <Directory> block than the directory with the files served by
> mod_python.

What is the objective here? If you are you trying to pass information to
mod_python from the config, a better way is to use PythonOption.

Grisha
From jalil at securia.com  Fri Jan  9 17:01:19 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 21:54:13 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
Message-ID: <3FFF4EDF.2050401@securia.com>

I have built and updated my Python and mod_python to the latest version 
and the new mod_python.so is now in the modules directory. However, my 
mod_python still picks up the old version of Python. Does anybody know 
how to fix this?

Thanks,

From grisha at modpython.org  Fri Jan  9 20:38:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 21:54:13 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <20040109203726.L85266@onyx.ispol.com>


Just a guess - before re-running ./configure, make sure to remove
config.cache file.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

> I have built and updated my Python and mod_python to the latest version
> and the new mod_python.so is now in the modules directory. However, my
> mod_python still picks up the old version of Python. Does anybody know
> how to fix this?
>
> Thanks,
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Fri Jan  9 20:41:08 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 21:54:13 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <0FE6C376-430E-11D8-9AD2-000A95A072FC@sb.org>

You could remove the old version?

Alternately, there's an option to ./configure for building mod_python 
that lets you specify the exact path to python in case you have 
multiple copies. That might be what you're looking for.

On Jan 9, 2004, at 8:01 PM, jalil wrote:

> I have built and updated my Python and mod_python to the latest 
> version and the new mod_python.so is now in the modules directory. 
> However, my mod_python still picks up the old version of Python. Does 
> anybody know how to fix this?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:58:35 2004
Subject: No subject
Message-ID: <mailman.0.1073703515.54785.mod_python@modpython.org>

    Internal Server Error

    The server encountered an internal error or misconfiguration and was     
    unable to complete your request.

Other normal web request seem to work fine. 
This is what the error logs show...

    [Wed Aug  2 20:58:57 2000] [notice] caught SIGTERM, shutting down
    [Wed Aug  2 20:59:02 2000] [notice] Apache/1.3.12 (Unix) configured
-- resuming
        normal operations
    'import site' failed; use -v for traceback
    make_obcallback(): could not import mod_python.apache.
    make_obcallback(): could not call init.
    [Wed Aug  2 20:59:45 2000] [error] [client 202.77.245.126] python_handler:
        make_obcallback returned no obCallBack!


The mod_python module sits in 

        /usr/local/lib/python1.5/mod_python

    (along with other .pc. .pyc modules)


In my httpd.conf (everything is there, no srm.conf, access.conf), I have 

    AddHandler python-program .py
    PythonHandler pytest.py
    PythonDebug on
    PythonPath "sys.path+['/usr/local/lib/python1.5/mod_python']

this is within the <Directory..> directives for ~/apache/htdocs.
pytest.py is same as the "Hello World" example in the tutorial in
mod_python...


Also when in the Python interpreter, I try to load stuff manually, 
ie:

    >>> from mod_python import apache
    Traceback (innermost last):
    File "<stdin>", line 1, in ?
    File "/usr/local/lib/python1.5/mod_python/apache.py", line 18, in ?
        import _apache
    ImportError: No module named _apache
    >>>

and apache.py does indeed have the line "import _apache"

Loading other standard python modules like "sys" works OK, hence I think
PYTHONPATH seems OK.


config_info
------------------
Apache - 1.3.12
Python 1.5, compiled from source, standard
    (both are installed in /usr/local)
system Linux Mandrake 7.0, 2.2.12 kernel 
Compaq box, P3.


Any help from anyone will be appreciated.

Hope I can get this working. Would love to use Python for a few things here.



----------------------------------------------------------
Boh-heong Yap
Project Manager, eCommerce
				bohheong@asiacontent.com				

Asiacontent.com a leading pan-Asian Internet company,
with focus on: content, advertising and e-commerce.
-----------------------------------------------------------


From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:58:40 2004
Subject: No subject
Message-ID: <mailman.1.1073703520.54785.mod_python@modpython.org>

req.headers_out['Set-Cookie']='key=value'
req.headers_out['location'] = 'http://localhost/index.html'
return apache.HTTP_MOVED_TEMPORARILY

The problem seems to be that if I don't do req.send_http_header() the
Set-Cookie doesn't get sent so the cookie doesn't get set.  If I do call
req.send_http_header() the cookie does get set but it seems as though
two sets of headers are sent and the response code is 200.  Any ideas?

Geoff Cadien
geoff@infostreet.com

From rassilkapoemail at yahoo.com  Fri Jan  9 21:58:29 2004
From: rassilkapoemail at yahoo.com (rassilkapoemail@yahoo.com)
Date: Fri Jan  9 21:58:58 2004
Subject: [mod_python] Массовая рассылка вашей рекламы по 350.000 е-майлов.
Message-ID: <200106242108.f5OL8E296083@eden.ispol.com>

Массовая рассылка вашей рекламы по 350.000 е-майлов.
Стоимость 1$ - 1000 писем. Минимальный заказ 100$.

Разошлем Вашу рекламу по 42.000 организациям Москвы - 50$.

Пишите: rassilkapoemail@yahoo.com или email_reklama@yahoo.com
 
 
 
 
 
 
 
 

From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:58:59 2004
Subject: No subject
Message-ID: <mailman.2.1073703539.54785.mod_python@modpython.org>

is posible that is a problem in the debian package libpapache-mod-python.




-- 


From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:59:20 2004
Subject: No subject
Message-ID: <mailman.3.1073703560.54785.mod_python@modpython.org>

add_handler (htype, handler[, dir])
    Allows dynamic handler registration. htype is a string containing the
    name of any of the apache Python*Handler directives, e.g.
    "PythonHandler". handler is a string containing the name of the module
    and the handler function. Optional dir is a string containing the name of
    the directory to be added to the pythonpath. If no directory is
    specified, then, if there is already a handler of the same type
    specified, its directory is inherited, otherwise the directory of the
    presently executing handler is used.

However, if a PythonPath directive is in force, the third argument seems to
be ignored (from my reading of apache.py).  Two solutions present themselves:
(a) fix the documentation or (b) change the code to suit the documentation.

For the record, I'd prefer the latter.  It allows me to dynamically import
handlers directly instead of traversing long strings of Python packages.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:59:21 2004
Subject: No subject
Message-ID: <mailman.4.1073703561.54785.mod_python@modpython.org>

[Wed May 15 15:46:25 2002] [error] [client 127.0.0.1] Invalid method in
request
agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1

...and from the access log:

127.0.0.1 - - [15/May/2002:16:07:42 +0200] "POST /cgi/login.py HTTP/1.1" 200
1396
127.0.0.1 - - [15/May/2002:16:07:42 +0200]
"agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1" 501 459

So, it seems as the GET for the stylesheet is 'colliding' with the login
POST operation...?

This is not a problem when we keep the module cleanup loop. However, the
application is too slow when we have many simultaneous users, actually
slower than the old cgi, so we are trying to speed up everywhere we can.

The lock in cgihandler.py will prevent multiple simultaneous users? It seems
like it is. The server load is reduced, because there are no python
processes starting for each access, but the users perceive the application
as _slower_ than it was as a classic cgi, and I think it is because of the
lock in cgihandler.py beeing a bottleneck, slipping through only one user at
the time... is this the way mod_python is supposed to work?

win2k, SP2, 5.00.2195
apache 1.3.24
mod_python 2.7.4
python 2.1.3 (214)

--
Roger


From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:59:30 2004
Subject: No subject
Message-ID: <mailman.5.1073703570.54785.mod_python@modpython.org>

LoadModule python_module modules/mod_python276.dll
AddModule mod_python.c

ScriptAlias /python/ "C:/Program Files/Apache Group/Apache/htdocs/python/"

<Directory "C:/Program Files/Apache Group/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on
</Directory>

mod_python is located in C:\Python21\Lib\mod_python.  The folder has been
stripped of version numbers to just mod_python.  The following files are found
in the mod_python folder:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

When I try to start the Apache service, I get the error
"Could not start the Apache service on Local Computer.  The service did not
return an error.  This could be an internal Windows error or an internal service
error"
If I comment out the mod_python directives, it runs just fine.

Any help would be greatly appreciated and it will give the bruises on my head a
chance to heal ;-)

TIA,

Mark



From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:59:32 2004
Subject: No subject
Message-ID: <mailman.6.1073703572.54785.mod_python@modpython.org>

This routine gives allows for an opportunity to translate the URI into
an actual filename, before the server's default rules (Alias directives
and the like) are followed. 

Again, how do I do this?

I am implimenting a specialized web cache server and I need to resolve
an url to a path on my server - the logic to resolve the url to path is
the main part of my program.

I can easily enough just resove the url in my main handler and then
manually feed the client form the static file, but im ny oppionion
apache should be doing this itself.  I just need to tell it what file to
use.

My problem is that the request object members such as filename and the
like are read-only, so how do I pass the new filename back to apache?

Alex

From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:59:40 2004
Subject: No subject
Message-ID: <mailman.7.1073703580.54785.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From bogus@does.not.exist.com  Fri Jan  9 21:58:29 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 21:59:40 2004
Subject: No subject
Message-ID: <mailman.8.1073703580.54785.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From redconectabilbao at telefonica.net  Fri Jan  2 09:34:52 2004
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 22:00:41 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <20031231143016.GB10034@stellar.eradman.com>
References: <3FF29D8B.6030208@telefonica.net>
	<20031231143016.GB10034@stellar.eradman.com>
Message-ID: <3FF52D2C.70809@telefonica.net>

theman@stellar.eradman.com escribi?:

>One thing to watch out for is that when you're calling pages using the http://domain/script/function relative paths do not work corrrectly. So instead of href="estilo.css" it probably needs to be href="/estilo.css".
>
>Eric Radman
>theman@eradman.com
>
>Wed, Dec 31, 2003 at 10:57:31AM +0100, Red Conecta wrote:
>  
>
>>I'm trying to use css with the publisherhandler; here is the code:
>>
>>   def _inicio():
>>       ini= '''<head><title>nombredelsitio</title>
>>                 <link rel="stylesheet" href="estilo.css"
>>   Type="text/css"></head>
>>                 <body leftmargin=0 rightmargin=0 topmargin=0
>>   bottommargin=0>'''
>>      
>>       return ini
>>
>>   def _final():
>>       return '</body></html>'
>>
>>   def mostrar(req,direccion='/'):
>>       req.content_type = "text/html"
>>       html=_inicio()
>>       obj=leerobjeto(direccion)
>>       if obj!=None:
>>           for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>>       else:html+='error'
>>       html+=_final()
>>       return html
>>
>>the output doesn't use the estilo.css archive but if I save the page in 
>>'mostrar.html' all is ok.
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>    
>>
>
>  
>
I've tryed /estilo.css, ./estilo.css, ../estilo.css and 
/var/www/html/portal/estilo.css, but it still doesn't work

From stian at soiland.no  Fri Jan  2 10:42:49 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <20040102094249.GC11946@itea.ntnu.no>

On 2003-12-31 10:57:31, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:

You've probably used SetHandler instead of AddHandler. SetHandler eats
ALL requests for the directory and passes them on to mod_python.
Effectually static files like your css-file is therefore unavailable.

Solutions:
   
   a) Create one or more static-directories with SetHandler none
      (these could be called "css", "images", etc.)

   b) Place static files somewhere outside the directory structure
      handled by SetHandler python-program
   
   c) Use AddHandler python-program .py instead
      (requires a .py-ending for all mod-python requests)     

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From grisha at modpython.org  Fri Jan  2 16:43:46 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <20040102094249.GC11946@itea.ntnu.no>
References: <3FF29D8B.6030208@telefonica.net>
	<20040102094249.GC11946@itea.ntnu.no>
Message-ID: <20040102164112.Q70689@onyx.ispol.com>


There also:

   d) SetHandler None
      To reverse any previous SetHandler directives to default Apache
      behaviour. Handy for those images/ or styles/ directories.

Grisha

On Fri, 2 Jan 2004, Stian [iso-8859-1] S?iland wrote:

> On 2003-12-31 10:57:31, Red Conecta wrote:
>
> > I'm trying to use css with the publisherhandler; here is the code:
>
> You've probably used SetHandler instead of AddHandler. SetHandler eats
> ALL requests for the directory and passes them on to mod_python.
> Effectually static files like your css-file is therefore unavailable.
>
> Solutions:
>
>    a) Create one or more static-directories with SetHandler none
>       (these could be called "css", "images", etc.)
>
>    b) Place static files somewhere outside the directory structure
>       handled by SetHandler python-program
>
>    c) Use AddHandler python-program .py instead
>       (requires a .py-ending for all mod-python requests)
>
> --
> Stian S?iland               Work toward win-win situation. Win-lose
> Trondheim, Norway           is where you win and the other lose.
> http://www.soiland.no/      Lose-lose and lose-win are left as an
>                             exercise to the reader.  [Limoncelli/Hogan]
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:23:33 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
Message-ID: <000101c3d248$3c485f00$6400a8c0@infoserve.net>

How do you get a second frame to refresh a grid on a first frame? I have a
wxGrid on my main frame that is populated from a database. Double clicking a
row in that grid brings up a second frame where an individual record is
displayed. When the user clicks a submit button on the second form, it
updates the database, then closes the second form. I then want the grid on
the first frame to refresh. I know that I can access the grid from the
second frame because if I code:
 
frame.grid.Destroy()
 
it destroys the grid on the first frame. But this has no effect:
 
frame.grid.ForceRefresh()
 
Any suggestions?
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/d50365e9/attachment-0002.htm
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:32:42 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] CANNOT FIND mod_python
Message-ID: <000b01c3d249$83b0e640$6400a8c0@infoserve.net>

I have Apache 2.0.48(Win32), mod_python 3.0.4 and Python 2.3.2. When I set
up the PythonHandler as mptest.py as indicated in the documention for
mod_python, the browser can find mypython.py. However, when I switch the
handler in httpd.conf as suggested to:
 
PythonHandler mod_python.publisher
 
I get a 404, cannot find mypython.py
 
I know that it is finding the modules/mod_python.so file because Apache
gives me an error if I hide it.
 
Any suggestions?
 
Thanks
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/66dd2090/attachment-0002.htm
From eurleif at ecritters.biz  Sun Jan  4 02:49:15 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
Message-ID: <3FF7C57A.2090002@ecritters.biz>

Sorry for the newbie question, but how do I parse query strings, handle 
POST data, and such? Is there a library I should be using?

From manfred.stienstra at dwerg.net  Sun Jan  4 12:55:40 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
In-Reply-To: <3FF7C57A.2090002@ecritters.biz>
References: <3FF7C57A.2090002@ecritters.biz>
Message-ID: <1073217340.10014.3.camel@ack.dwerg.net>

On Sun, 2004-01-04 at 08:49, Leif K-Brooks wrote:
> Sorry for the newbie question, but how do I parse query strings, handle 
> POST data, and such? Is there a library I should be using?

In the util module, there is a FieldStorage object.

fs = util.FieldStorage(request, True)

http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html

If you don't like it, you free to do it some other way (:

Manfred

From rmangaliag at slu.edu.ph  Mon Jan  5 15:19:29 2004
From: rmangaliag at slu.edu.ph (ali)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] a newbie on sessions and psp
Message-ID: <003301c3d35c$41e53c20$da19a8c0@slu.edu.ph>

hi.. am a modpyton newbie...

can someone please give me an example of sessions applied in psp...

thanks...

ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040105/e3c5c90f/attachment-0002.htm
From dwmp at opti.cgi.net  Mon Jan  5 01:41:02 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] OutputFilter example
Message-ID: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>


In the example of the output filter in the 3.1.2b documentation the last 
lines seem to indicate that filter.close() should only be called if 
filter.read() returns None.  I paired up an output filter this evening with 
the mod_python.psp handler and I was getting an empty string on the last 
filter.read() for every request.  The example code only calls 
filter.close() if the last read result is None.  Not calling filter.close() 
on the first call caused the output filter handler to be called a second 
time.  The second time around, it tried to read from filter.read() and got 
None, therefore calling filter.close() and ending the cycle.  Should this 
be normal behavior or should I be calling filter.close() when filter.read() 
returns empty string as well?

My server config:

     AddHandler mod_python .psp
     PythonHandler mod_python.psp | .psp
     PythonOutputFilter mypackage.mymodule TESTFILTER
     AddOutputFilter TESTFILTER .psp


-Dan

From eurleif at ecritters.biz  Mon Jan  5 02:40:33 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Are there any good examples?
Message-ID: <3FF914F1.50609@ecritters.biz>

I'm trying to learn to use mod_python well, and I can't find too many 
examples to learn from. Is there a site with examples somewhere?

From davidf at sjsoft.com  Mon Jan  5 10:15:34 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
In-Reply-To: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
References: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
Message-ID: <3FF91D26.2090109@sjsoft.com>

Jim OLeary wrote:

>How do you get a second frame to refresh a grid on a first frame? I have a
>wxGrid on my main frame that is populated from a database.
>  
>
Why are you asking about wxGrid on a mailing list that is about a python 
application server???

>Double clicking a row in that grid brings up a second frame where an individual record is
>displayed. When the user clicks a submit button on the second form, it
>updates the database, then closes the second form. I then want the grid on
>the first frame to refresh. I know that I can access the grid from the
>second frame because if I code:
> 
>frame.grid.Destroy()
> 
>it destroys the grid on the first frame. But this has no effect:
> 
>frame.grid.ForceRefresh()
> 
>Any suggestions?
>  
>
You probably are asking these questions on the wrong list. If not please 
confirm and clarify, as this is not a wxWindows mailing list...

David
From fowlertrainer at anonym.hu  Mon Jan  5 09:46:10 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <84772282.20040105094610@anonym.hu>

Hi !

I want to control my website with only one py file: the main.py.
But I got experience with one ugly thing in mod_python.

In mod_php, the main.php file is can include many files, and all of
them can include many other files.
When I modify some or one of these files, the website is refreshed.

But in mod_python, I cannot use the include, I have only one way to share/split my sources: the import.
It is ok, but when I modify some of these imported files, the website is not refreshed !!!

My solution in this time to I use only one file.
It is not too good, because it is growing too much, and I cannot
separate it to units.

Have any solution to this problem ????

Thanx for any advance !!!

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Mon Jan  5 09:47:34 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Zope Access Rule in mod_py
Message-ID: <754856212.20040105094734@anonym.hu>

Hi !

My problem is that.
I want to use only one main.py file in my mod_python site.
But I want to handle some virtual paths.

So the structure is:
- root+
------+main.py

I want to this:

When the user type this path:
http://root/users/files/work1
then the Apache don't raise an error, only call a py file's procedure with this path.

I can take this path, and do anything what I needed. If the path is wrong, I can show error message, if not, 
I can show the result. In the example the path is don't exists, but I redirect the process to the my UserFileHandler method,
and I do get this user file named "Work1".

This is just like Access Rule in Zope.

Can I do that in mod_python ?

Thanx:
 KK



From fowlertrainer at anonym.hu  Mon Jan  5 09:50:28 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Session handling: example needed
Message-ID: <1835030833.20040105095028@anonym.hu>

Hi !

My problem is that: I want to create a site with session handling.
But: the mod_python Cookie or Session handling is not working in my
machine, or I have some wrong trying with this.

Anyone has an working example, what I can try ?

{
My idea is that: I set an special named cookie in browser.
The cookie's value is the session id.
When it is setted, the req is get the sid, and get the session data
from session dictionary with sid.
It is wrong way ?
}


Thanx for any advance !
KK


From fowlertrainer at anonym.hu  Mon Jan  5 09:55:17 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] One file controlled site: howto
Message-ID: <1245319669.20040105095517@anonym.hu>

Hello !

I want to control my website with one file, the main.py.
I want that:
 - the index, or index.html, or the empty request is redirected to
   main.py
   http://rootdir/index
   http://rootdir/index.html
   http://rootdir/index.htm
   http://rootdir/main
   http://rootdir/

   is let same thing, everyone is let load the main.py.
   
 - the main.py is let hidden in request !
   or if it is not possible, the .py is let hidden !
   So the site is let used with this:
   http://rootdir/
   or
   http://rootdir/main
   and not
   http://rootdir/main.py


Can anyone help me with this tricks ?

Thanx:
 KK


From ograf at rz-online.net  Mon Jan  5 12:19:12 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
Message-ID: <20040105111912.GJ25566@rz-online.net>

[already send this to python-dev@httpd.apache.org, but got nothing
back...]

Hi!

The resolve_object method does not work with class instances.

The error is simple: in line 551 there is a if

        if silent and not hasattr(module, obj_str):
            return None

this checks always module for obj_str. But it should check the current
obj in traversal!

So correct would be:

        if silent and not hasattr(obj, obj_str):
            return None

Regards,
  Oliver.

-------------- next part --------------
--- mod_python-3.1.2b/lib/python/mod_python/apache.py.orig	2004-01-05 11:16:44.000000000 +0100
+++ mod_python-3.1.2b/lib/python/mod_python/apache.py	2004-01-05 11:16:53.000000000 +0100
@@ -552,7 +552,7 @@
             return None
 
         # this adds a little clarity if we have an attriute error
-        if obj == module and not hasattr(module, obj_str):
+        if obj == module and not hasattr(obj, obj_str):
             if hasattr(module, "__file__"):
                 s = "module '%s' contains no '%s'" % (module.__file__, obj_str)
                 raise AttributeError, s
From ograf at rz-online.net  Mon Jan  5 12:26:28 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
In-Reply-To: <20040105111912.GJ25566@rz-online.net>
References: <20040105111912.GJ25566@rz-online.net>
Message-ID: <20040105112628.GK25566@rz-online.net>

On Mon, Jan 05, 2004 at 12:19:12PM +0100, Oliver Graf wrote:
> [already send this to python-dev@httpd.apache.org, but got nothing
> back...]
> 
> Hi!
> 
> The resolve_object method does not work with class instances.

actually this should read 'does not work with object subpaths'...

So any module::obj.subobj.method handler should not work without the
patch...

Oliver.

From kevin at sb.org  Mon Jan  5 07:38:27 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <84772282.20040105094610@anonym.hu>
References: <84772282.20040105094610@anonym.hu>
Message-ID: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>

There's an easy solution:

Keep a table of the modification dates of the relevant modules. In your 
handler function, compare the modification dates you stored with the 
current ones, and if any differ call reload() on that module.

If you want an example, ask me and I can make one. But it shouldn't be 
too hard to do on your own.

HTH,
Kevin

On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:

> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
>
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
>
> But in mod_python, I cannot use the include, I have only one way to 
> share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the website 
> is not refreshed !!!
>
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
>
> Have any solution to this problem ????

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:46:01 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <754856212.20040105094734@anonym.hu>
References: <754856212.20040105094734@anonym.hu>
Message-ID: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Well, that URL isn't valid. I assume you mean something like

http://my.domain.com/root/users/files/work1

right?

That's not hard. There's a few variations on the solution:

1) If you want it to only work for valid directory trees (i.e. 
/root/users/files/work1 is valid but /root/foo/bar wouldn't be, 
assuming /root/foo doesn't exist) then you can use a <Directory> 
directive. Stick a SetHandler python-program and PythonHandler main in 
there (assuming the directory with main.py will be in the Python path, 
i.e. if the main.py is in the directory specified in the <Directory> 
directive. If it's not there, use the PythonPath directive to tell it 
where to look).

2) If you want it to work for all paths that match a pattern (say, all 
paths starting with /root/) then use a <Files> directive and set the 
same handlers as #1. Same caveats with the python include path.

3) If you want it to apply to every single request to your site, add 
the handlers from #1 in the root level of your httpd.conf file. Same 
caveats apply to the include path for main.py (although since this 
isn't nested, it's just the default Python path so you'll need to add 
the directory for main.py, such as sys.path+['/foo'])

HTH,
Kevin

On Jan 5, 2004, at 3:47 AM, fowlertrainer@anonym.hu wrote:

> I want to this:
>
> When the user type this path:
> http://root/users/files/work1
> then the Apache don't raise an error, only call a py file's procedure 
> with this path.
>
> I can take this path, and do anything what I needed. If the path is 
> wrong, I can show error message, if not,
> I can show the result. In the example the path is don't exists, but I 
> redirect the process to the my UserFileHandler method,
> and I do get this user file named "Work1".
>
> This is just like Access Rule in Zope.
>
> Can I do that in mod_python ?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:49:29 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
References: <754856212.20040105094734@anonym.hu>
	<1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <9A4F92CA-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Erm, I mean a <Location> directive.

On Jan 5, 2004, at 7:46 AM, Kevin Ballard wrote:

> 2) If you want it to work for all paths that match a pattern (say, all 
> paths starting with /root/) then use a <Files> directive and set the 
> same handlers as #1. Same caveats with the python include path.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From vincent_delft at yahoo.com  Mon Jan  5 09:55:57 2004
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <20040105175557.63346.qmail@web11501.mail.yahoo.com>

Draco does what Kevin explain.
Among other, allows you to use the "inclide" like in
PHP.

(check the "links" page).



--- Kevin Ballard <kevin@sb.org> wrote:
> There's an easy solution:
> 
> Keep a table of the modification dates of the
> relevant modules. In your 
> handler function, compare the modification dates you
> stored with the 
> current ones, and if any differ call reload() on
> that module.
> 
> If you want an example, ask me and I can make one.
> But it shouldn't be 
> too hard to do on your own.
> 
> HTH,
> Kevin
> 
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu
> wrote:
> 
> > I want to control my website with only one py
> file: the main.py.
> > But I got experience with one ugly thing in
> mod_python.
> >
> > In mod_php, the main.php file is can include many
> files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the
> website is refreshed.
> >
> > But in mod_python, I cannot use the include, I
> have only one way to 
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported
> files, the website 
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too
> much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
> 
> -- 
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From brianh at exelixis.com  Mon Jan  5 11:31:56 2004
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <Pine.GSO.4.44.0401051125160.28612-100000@timeless.exelixis.com>

be careful though; there are some hidden gotchas lurking in this solution.
for example, if you reload a module defining some base class, but don't
reload all modules defining subclasses of that base, then the base class
object will no longer be the same as the corresponding base class object
in the __bases__ list for subclasses, and isinstance(sub, base) will fail
(leading to other failures, like the new builtin 'super' won't work
properly).

i did a lot of head scratching before i figured this out; but if all
you're reloading are static configuration modules exporting simple things
like constant immutable string or numeric variables, you should be ok.

cheers,
brian


On Mon, 5 Jan 2004, Kevin Ballard wrote:

> There's an easy solution:
>
> Keep a table of the modification dates of the relevant modules. In your
> handler function, compare the modification dates you stored with the
> current ones, and if any differ call reload() on that module.
>
> If you want an example, ask me and I can make one. But it shouldn't be
> too hard to do on your own.
>
> HTH,
> Kevin
>
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:
>
> > I want to control my website with only one py file: the main.py.
> > But I got experience with one ugly thing in mod_python.
> >
> > In mod_php, the main.php file is can include many files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the website is refreshed.
> >
> > But in mod_python, I cannot use the include, I have only one way to
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported files, the website
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From neel at mediapulse.com  Mon Jan  5 14:33:55 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <C0FC22C08B82074A88B500617641577787A7FD@johnson.mediapulse.net>

We use the reload method here, if PythonDebug is set to on, basically:

    debug = req.get_config().has_key('PythonDebug')

    if debug:
        reload(www_forms)
        reload(globals)

See the python docs on reload before using, it doesn't work in all
cases.  I also think there was a mention on the list of an apache.import
method to use so this wouldn't be needed, so you may want to do some
searching on the archives; not sure if it was a mod_python thing or a
patch someone did.

Mike

> -----Original Message-----
> From: fowlertrainer@anonym.hu [mailto:fowlertrainer@anonym.hu] 
> Sent: Monday, January 05, 2004 3:46 AM
> To: mod_python@modpython.org
> Subject: [mod_python] mod_php vs mod_py - include vs. import
> 
> 
> Hi !
> 
> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
> 
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
> 
> But in mod_python, I cannot use the include, I have only one 
> way to share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the 
> website is not refreshed !!!
> 
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
> 
> Have any solution to this problem ????
> 
> Thanx for any advance !!!
> 
> -- 
> Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From kevin at sb.org  Mon Jan  5 15:30:37 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Internal Server Errors on restart
Message-ID: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>

I've found some odd problems with mod_python. The big one is that if I 
ever do a restart of my apache server (graceful or not), the next time 
I access a python script, I get an internal server error, and this 
persists until I shut down the server, wait for all the processes to 
die off, and then start it back up. Also, nothing is put in the error 
log for the Internal Server Error, which is also strange.

Does anybody have any information on this?

Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS 
X Panther Server without actually running it by hand (i.e. replacing 
all the standard access to Apache 1.3 through things like Server Admin 
with access to Apache 2). Yes, Apache 2 comes on Panther Server, but 
it's hidden in /opt/apache2/ and there's no GUI way to access it.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Jan  5 12:46:23 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <3FF9CD1F.5010304@dynamine.net>

Kevin Ballard wrote:
> I've found some odd problems with mod_python. The big one is that if I 
> ever do a restart of my apache server (graceful or not), the next time I 
> access a python script, I get an internal server error, and this 
> persists until I shut down the server, wait for all the processes to die 
> off, and then start it back up. Also, nothing is put in the error log 
> for the Internal Server Error, which is also strange.
> 
> Does anybody have any information on this?

I don't know, but I have the same problem (running Panther as well).

> Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS X 
> Panther Server without actually running it by hand (i.e. replacing all 
> the standard access to Apache 1.3 through things like Server Admin with 
> access to Apache 2). Yes, Apache 2 comes on Panther Server, but it's 
> hidden in /opt/apache2/ and there's no GUI way to access it.

If there is a way, I'm unaware of it.  The documentation says the 
installation in /opt/apache2 is "for experimental purposes."  Don't try 
to use it for mod_python though, because the apxs configuration is wrong 
and it won't compile properly.  (I did my own Apache 2 installation in 
/usr/local/apache2.)

I use mod_proxy on the front-end Apache 1.3 server to pass through 
mod_python requests to the back-end Apache 2.0 server.

--Michael
From grisha at modpython.org  Mon Jan  5 21:58:24 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <20040105215701.M19958@onyx.ispol.com>


I think this is the way it's supposed to work.

On Mon, 5 Jan 2004, Dan W. wrote:

>
> In the example of the output filter in the 3.1.2b documentation the last
> lines seem to indicate that filter.close() should only be called if
> filter.read() returns None.  I paired up an output filter this evening with
> the mod_python.psp handler and I was getting an empty string on the last
> filter.read() for every request.  The example code only calls
> filter.close() if the last read result is None.  Not calling filter.close()
> on the first call caused the output filter handler to be called a second
> time.  The second time around, it tried to read from filter.read() and got
> None, therefore calling filter.close() and ending the cycle.  Should this
> be normal behavior or should I be calling filter.close() when filter.read()
> returns empty string as well?
>
> My server config:
>
>      AddHandler mod_python .psp
>      PythonHandler mod_python.psp | .psp
>      PythonOutputFilter mypackage.mymodule TESTFILTER
>      AddOutputFilter TESTFILTER .psp
>
>
> -Dan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Mon Jan  5 22:57:41 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <3FF9CD1F.5010304@dynamine.net>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
	<3FF9CD1F.5010304@dynamine.net>
Message-ID: <79B6A1A3-3FFC-11D8-9AD2-000A95A072FC@sb.org>

Well, *that's* silly. I simply edited the .mk files in 
/opt/apache2/build to remove the -arch i386 strings from a few lines 
and it compiled just fine!

On Jan 5, 2004, at 3:46 PM, Michael S. Fischer wrote:

> If there is a way, I'm unaware of it.  The documentation says the 
> installation in /opt/apache2 is "for experimental purposes."  Don't 
> try to use it for mod_python though, because the apxs configuration is 
> wrong and it won't compile properly.  (I did my own Apache 2 
> installation in /usr/local/apache2.)
>
> I use mod_proxy on the front-end Apache 1.3 server to pass through 
> mod_python requests to the back-end Apache 2.0 server.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From dwmp at opti.cgi.net  Mon Jan  5 22:50:57 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <20040105215701.M19958@onyx.ispol.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
 <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040105224658.01196ec8@mail.pyxos.com>


I don't see why two calls would make sense.  On the second call the headers 
have already been sent, so I can't modify those and the body has already 
been sent as well and the very first call to filter.read() returns 
None.  On the other hand, if I do filter.close() when I receive empty 
string from filter.read() then I only end up with one call to my output 
filter and everything works normally.

-Dan



At 09:58 PM 1/5/2004 -0500, you wrote:

>I think this is the way it's supposed to work.
>
>On Mon, 5 Jan 2004, Dan W. wrote:
>
> >
> > In the example of the output filter in the 3.1.2b documentation the last
> > lines seem to indicate that filter.close() should only be called if
> > filter.read() returns None.  I paired up an output filter this evening with
> > the mod_python.psp handler and I was getting an empty string on the last
> > filter.read() for every request.  The example code only calls
> > filter.close() if the last read result is None.  Not calling filter.close()
> > on the first call caused the output filter handler to be called a second
> > time.  The second time around, it tried to read from filter.read() and got
> > None, therefore calling filter.close() and ending the cycle.  Should this
> > be normal behavior or should I be calling filter.close() when filter.read()
> > returns empty string as well?
> >
> > My server config:
> >
> >      AddHandler mod_python .psp
> >      PythonHandler mod_python.psp | .psp
> >      PythonOutputFilter mypackage.mymodule TESTFILTER
> >      AddOutputFilter TESTFILTER .psp
> >
> >
> > -Dan
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From dwmp at opti.cgi.net  Mon Jan  5 23:44:34 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] PythonOption and PythonImport
Message-ID: <5.2.1.1.2.20040105234211.0394ad68@mail.pyxos.com>


Is there any way to get to PythonOptions from the PythonImport startup 
script?  From the documentation it appears as though I can only get to 
PythonOptions from the request object.

-Dan

From jay at jaydorsey.com  Tue Jan  6 09:39:44 2004
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] One file controlled site: howto
In-Reply-To: <1245319669.20040105095517@anonym.hu>
References: <1245319669.20040105095517@anonym.hu>
Message-ID: <20040106153944.GA3462@gentoo.Earthlink.net>

On Mon, Jan 05, 2004 at 09:55:17AM +0100, fowlertrainer@anonym.hu wrote:
> Hello !
> 
> I want to control my website with one file, the main.py.
> I want that:
<snip>    
>  - the main.py is let hidden in request !
You can do this with mod_python by adding a request handler 
in your httpd.conf file, similar to this:

<Directory /path/to/webroot>
AddHandler python-program
PythonHandler main
</Directory>

The main.py script will be executed each time a document is 
requested in the /path/to/webroot folder.


hth


-- 
Jay Dorsey
jay at jaydorsey dot com
From jalil at securia.com  Tue Jan  6 17:40:20 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] Params submitted using utf-8
Message-ID: <3FFB6384.2010408@securia.com>

    I have a form that submits some text using utf-8 encoding and I 
process the form using  mod_python on Apache.

- When I read in a parameter value and print the type of the string, it 
is "str" and not "unicode". I know unicode is not "utf-8" and I think 
this is fine

- When I try to decode the value into "utf-8" and turn it into unicode 
in python, I get an exception (decoding error - invalid data). Why is 
that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
so why I get invalid data?

- The reason I decided doing above is that I have a table in MySQL which 
is using
utf-8 character sets. Everything works fine if I put the received data 
directly into my table and read it back and send it to browser but two 
problems happen if I do this. First, some characters don't display 
right. Second, althought I set the charset in my returned data to utf-8, 
the browser doesn't select utf-8 as encoding. So, I thought maybe I 
should try to convert into unicode b/f putting the data into my table. 
Is this right? Should I  do anything b/f storing and/or sending the data?

I appriciate any help.

-Jalil


From robert at leftwich.info  Wed Jan  7 15:09:07 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 22:00:42 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150406.01b14d70@192.168.0.1>

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt)
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From dwmp at opti.cgi.net  Tue Jan  6 22:18:27 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] AddOutputFilterByType
Message-ID: <5.2.1.1.2.20040106213833.03ad4420@mail.pyxos.com>


I'm running a PSP script which outputs a PNG image.  The PSP script sets 
the req.content_type to image/png but its still going through a mod_python 
filter I have setup with AddOutputFilterByType.  The AddOutputFilterByType 
is setup for two types, text/html and text/plain.  Does changing 
req.content_type not update the Apache info before it gets to the filtering 
stage?  Can this be fixed?

-Dan
mod_python: 3.1.2b
apache: 2.0.48
python: 2.3.2
linux: 2.4


From robert at leftwich.info  Wed Jan  7 15:23:26 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>

Sorry - finger trouble on the first attempt:

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt) and the second serves up some xml after first 
filtering it (again via libxslt). The problem I have is when I ask the 
first service to run some xsl on an xml file where the xsl uses the 
document() function to access the second service, the second service is 
never accessed and there is nothing in any of the logs to suggest otherwise.
I tried setting mod_python to use different child interpreters but it made 
no difference. Some googling turned up 
(http://www.modpython.org/pipermail/mod_python/2003-June/003307.html) 
where Grisha says in answer to Paul Robinson:

"> For example, on a Windows platform where there is a single
 > multi-threaded Apache process (mpm_wint
 > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
 > say that mod_python would not be able to take advantage of a
 > multi-processor machine due to the GIL?

The answer, unfortunately, is yes. Here is a google search that has some
info on the subject: http://www.google.com/search?q=python+free-threading

AFAIK the state of things has not changed with respect to SMP and GIL."

So it appears that I am running into this limitation. Is there any 
alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
useable?

Robert
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From manfred.stienstra at dwerg.net  Wed Jan  7 07:32:31 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <1073457151.15608.15.camel@ack.dwerg.net>

On Wed, 2004-01-07 at 02:40, jalil@securia.com wrote:
> - When I read in a parameter value and print the type of the string, it 
> is "str" and not "unicode". I know unicode is not "utf-8" and I think 
> this is fine

Yes, this should be a utf-8 encoded string. Personally I think no
application should convert this data to a unicode object because you
always want to know the encoding it came from. For example utf-8 ->
unicode object -> iso8859-15 could mean loss of characters.

> - When I try to decode the value into "utf-8" and turn it into unicode 
> in python, I get an exception (decoding error - invalid data). Why is 
> that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
> so why I get invalid data?

Are you using the unicode constructor or an decode method? Also, a bad
browser could send something that is not unicode, you should always
expect unicode errors here.

Here is a nice introduction to the whole encode/decode confusion:

http://www.vandervossen.net/2003/07/unicode_in_python

> Second, althought I set the charset in my returned data to utf-8, 
> the browser doesn't select utf-8 as encoding.

If the document isn't utf-8 encoded and the headers claim it is, the
browser could try to correct it and show the proper encoding.

> So, I thought maybe I 
> should try to convert into unicode b/f putting the data into my table. 
> Is this right? Should I  do anything b/f storing and/or sending the data?

Yes, you should check the input. You don't have to do this by converting
the string into a unicode object, but you can do it by checking the byte
ordering (see the utf-8 specifications for more information).

Manfred

From ograf at rz-online.net  Wed Jan  7 08:22:01 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040107072201.GD3045@rz-online.net>

On Wed, Jan 07, 2004 at 03:23:26PM +1100, Robert Leftwich wrote:
> "> For example, on a Windows platform where there is a single
> > multi-threaded Apache process (mpm_wint
> > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
> > say that mod_python would not be able to take advantage of a
> > multi-processor machine due to the GIL?
> 
> The answer, unfortunately, is yes. Here is a google search that has some
> info on the subject: http://www.google.com/search?q=python+free-threading
> 
> AFAIK the state of things has not changed with respect to SMP and GIL."
> 
> So it appears that I am running into this limitation. Is there any 
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
> useable?

Out of my stomach I would answer: this is an apache topic, mod_python
will do whatever apache can do. So If there is a mpm for apache under
win32 that does forks (no mpm_prefork for win32? can't believe this,
but I never used this win32 platform...) mod_python should behave well
with SMP...

Oliver.

P.S.: If I am wrong, I'm really interested why. :)

From blazek at firma.seznam.cz  Wed Jan  7 09:59:54 2004
From: blazek at firma.seznam.cz (Vaclav Blazek)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040107072201.GD3045@rz-online.net>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
	<20040107072201.GD3045@rz-online.net>
Message-ID: <200401070959.54180.blazek@firma.seznam.cz>

Dne st 7. ledna 2004 08:22 Oliver Graf napsal(a):
> Out of my stomach I would answer: this is an apache topic, mod_python
> will do whatever apache can do. So If there is a mpm for apache under
> win32 that does forks (no mpm_prefork for win32? can't believe this,
> but I never used this win32 platform...) mod_python should behave well
> with SMP...
>
> Oliver.
>
> P.S.: If I am wrong, I'm really interested why. :)

Hallo,

fork() (process duplication) is unix specific feature, no other kind of system 
has it. On non-unix platforms you have to use threading instead. But as you 
know, threads are evil :-). You can be sure you propperly synchronize 
everything but... just try to close one file descriptor twice and disaster is 
near at hand...

Vasek

PS I've heard the new version of OpenVMS will have fork().

From fowlertrainer at anonym.hu  Wed Jan  7 10:09:27 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] Have the mod_python an example store on web... ?
Message-ID: <306091519.20040107100927@anonym.hu>

Hello mod,

  ... or other site, what have online FAQ, or other ?
  I have some modules, and I send these modules, if needed.
  (A persistent DB connection pool, and a session manager tool)

  I want to send it/share it, because I use win32 mod_py, and I want to remove
  bugs (by found another users), and to help the mod_python to staying
  alive/growing/advancing.

  I want to learn the mod_py, get more and more knowledge, and I
  possible, share these informations with anothers.

  Thanx.

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From kevin at sb.org  Wed Jan  7 11:02:42 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <ECE51A3C-412A-11D8-9AD2-000A95A072FC@sb.org>

To make the browser display as UTF-8, you need to tell it to do that 
either in the headers or in a <meta> tag in the source.

On Jan 6, 2004, at 8:40 PM, jalil@securia.com wrote:

> - The reason I decided doing above is that I have a table in MySQL 
> which is using
> utf-8 character sets. Everything works fine if I put the received data 
> directly into my table and read it back and send it to browser but two 
> problems happen if I do this. First, some characters don't display 
> right. Second, althought I set the charset in my returned data to 
> utf-8, the browser doesn't select utf-8 as encoding. So, I thought 
> maybe I should try to convert into unicode b/f putting the data into 
> my table. Is this right? Should I  do anything b/f storing and/or 
> sending the data?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From spoerri at duke.edu  Thu Jan  8 10:33:40 2004
From: spoerri at duke.edu (Christoph Spoerri)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] RE: Session handling: example needed
Message-ID: <200401081033.40738.spoerri@duke.edu>

Hi list users,

I saw that recently somebody added for an example of using the session 
handler. I was looking for the same with out any luck, but was able to get 
things working (love the trial-and-error stuff ;) ).

I have attached a short script that uses two counters (int and object) to 
count the number of visits by the users during a session.

Notes:
- use is_new() to check if you have a new session or not before you use it (as 
mentioned in the manual)
- you need to save the session object at the end otherwise, the ID and any 
other stuff won't be saved (!), and you'll be wondering what happend to the 
session (as I did).

cheers,
Christoph

PS: I'm new to python, so forgive me any strange python coding.

***************** session_sample.py ***********************

from mod_python import apache

class simpelCountClass:
	count = 0
	def __init__(self,c):
		self.count = c
	def increment(self):
		self.count = self.count+1
	def asString(self):
		return str(self.count)


def sessionTest(req):
	req.content_type = "text/html"
	s = "<html><body>testing<br>"

	t = Session.DbmSession(req)
	if (t.is_new()):
		s += "new session id: "+str(t.id())+"<br>"
		t['count']=1
		t['countObj']=simpelCountClass(1)

	else:
		s += "session id: "+str(t.id())+"<br>"
		t['count']=t['count']+1
		t['countObj'].increment()

	s += "count: "+str(t['count'])+"<br>"
	s += "countObj: "+t['countObj'].asString()+"<br>"
	s += "timeout: "+str(t.timeout())+"<br>"
	s += "created: "+str(t.created())+"<br>"
	s += "last_accessed: "+str(t.last_accessed())+"<br>"
	s += "</body></html>"
	t.save() # DON'T FORGET THIS ONE!!!
	return s

From dg at sponsera.com  Thu Jan  8 14:30:26 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFDAFD2.1010708@sponsera.com>

Help!

I have the weirdest problem - I am using the following:

redhat9
mysql 4.0.13
mod_python 3.0.4
python 2.2.3
MySQL-python 0.9.2 (python interface to the mysql libraries)
apache 2.0.47

When I run ordinary python programs to access the mysql database, things 
seem to work fine. (i can connect to the database, so selects, updates, etc)

When I run identical queries under mod_python via request to apache, 
apache tends to core dump on database accesses - or sometimes, doesn't 
core dump but I get very strange,inconsistant results.

Any ideas? Are "threads" an issue? I am almost positive the python 
enviornment that apache is getting is the same as the "normal" environment.

I just have no idea why this is happening - I have used mod_python w/ 
mysql before, with generally very good results.

Thanks a lot!

David





From chip at force-elite.com  Thu Jan  8 11:44:24 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDAFD2.1010708@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com>
Message-ID: <3FFDB318.2090401@force-elite.com>

Are you running mod_auth_mysql or any other apache modules that use 
MySQL Client Connections?

Make sure they are all compiled with the exact same client lib versions..

Also, did you build from source, or are you using someones RPMs?

-Paul Querna

David Geller wrote:
> Help!
> 
> I have the weirdest problem - I am using the following:
> 
> redhat9
> mysql 4.0.13
> mod_python 3.0.4
> python 2.2.3
> MySQL-python 0.9.2 (python interface to the mysql libraries)
> apache 2.0.47
> 
> When I run ordinary python programs to access the mysql database, things 
> seem to work fine. (i can connect to the database, so selects, updates, 
> etc)
> 
> When I run identical queries under mod_python via request to apache, 
> apache tends to core dump on database accesses - or sometimes, doesn't 
> core dump but I get very strange,inconsistant results.
> 
> Any ideas? Are "threads" an issue? I am almost positive the python 
> enviornment that apache is getting is the same as the "normal" environment.
> 
> I just have no idea why this is happening - I have used mod_python w/ 
> mysql before, with generally very good results.
> 
> Thanks a lot!
> 
> David
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From pkeshishian at yahoo.com  Thu Jan  8 12:05:53 2004
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] Re: mysqldb / mod_python problem
In-Reply-To: <3FFDB598.1050608@sponsera.com>
Message-ID: <20040108200553.58614.qmail@web40015.mail.yahoo.com>

Hi David:
 
I did not really find any solution for my problem. The main problem I had was that mod_python was working when I was trying to select a single column, but it was failing in case of 2 or more columns. Since the database I am running is very small I just wrote a python function that queries each column separately than puts them together and returns the result. Since my database is very small the slowdown is insignificant. But it won't be recommended for large databases, and it is not really a solution. I believe this problem deserves a more serious consideration.
 
Cheers,
Petros
 

David Geller <dg@sponsera.com> wrote:
Hi Petros -

I read your posting in the [mod_python] list Dec 30, 2003 regarding 
problems you were having with Mysql not working under mod_python 
correctly (while "regular" console python progrems seemed to work fine).

Well, I am running into exactly the same, frustrating problem!!! What is 
going on? I can't figure it out, and am about to abandon mod_python.

Did you ever get your problem resolved? I'd be most interested in hearing.

Thanks a lot!

Regards,
David
dg@sponsera.com



---------------------------------
Do you Yahoo!?
Yahoo! Hotjobs: Enter the "Signing Bonus" Sweepstakes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040108/612a754e/attachment-0002.htm
From dg at sponsera.com  Thu Jan  8 15:54:56 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDB318.2090401@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
Message-ID: <3FFDC3A0.8010900@sponsera.com>

1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot 
seem to find any references anywhere to such modules....)

2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.

Also, everything (my entire mod_python application, including all mysql 
accessing), seems to run *fine* on my home machine (redhat8-based). It 
is when I have tried running on our redhat-9-based server where these 
problems start to appear....(note that I reuilt all the sources on the 
redhat9 machine...)


Paul Querna wrote:

> Are you running mod_auth_mysql or any other apache modules that use 
> MySQL Client Connections?
>
> Make sure they are all compiled with the exact same client lib versions..
>
> Also, did you build from source, or are you using someones RPMs?
>
> -Paul Querna
>
> David Geller wrote:
>
>> Help!
>>
>> I have the weirdest problem - I am using the following:
>>
>> redhat9
>> mysql 4.0.13
>> mod_python 3.0.4
>> python 2.2.3
>> MySQL-python 0.9.2 (python interface to the mysql libraries)
>> apache 2.0.47
>>
>> When I run ordinary python programs to access the mysql database, 
>> things seem to work fine. (i can connect to the database, so selects, 
>> updates, etc)
>>
>> When I run identical queries under mod_python via request to apache, 
>> apache tends to core dump on database accesses - or sometimes, 
>> doesn't core dump but I get very strange,inconsistant results.
>>
>> Any ideas? Are "threads" an issue? I am almost positive the python 
>> enviornment that apache is getting is the same as the "normal" 
>> environment.
>>
>> I just have no idea why this is happening - I have used mod_python w/ 
>> mysql before, with generally very good results.
>>
>> Thanks a lot!
>>
>> David
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

-- 
David Geller
Sponsera, LLC
dg@sponsera.com
www.sponsera.com
Phone: 703.532.6812
Fax: 703.532.6058



From chip at force-elite.com  Thu Jan  8 13:17:40 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC3A0.8010900@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com>
Message-ID: <3FFDC8F4.7000607@force-elite.com>

David Geller wrote:
> 1. As far as I know, I am not running any other apache modules using 
> MySQL ( I am not sure how to check this out definitely, but I cannot 
> seem to find any references anywhere to such modules....)
> 
> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.
> 
> Also, everything (my entire mod_python application, including all mysql 
> accessing), seems to run *fine* on my home machine (redhat8-based). It 
> is when I have tried running on our redhat-9-based server where these 
> problems start to appear....(note that I reuilt all the sources on the 
> redhat9 machine...)

Could you try to get a Backtrace in GDB from the Apache Core Files?
From grisha at modpython.org  Thu Jan  8 18:33:01 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040108183117.S67407@onyx.ispol.com>



On Wed, 7 Jan 2004, Robert Leftwich wrote:

> So it appears that I am running into this limitation. Is there any
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> useable?

s/Windows/Unix ? ;-)

Grisha
From neel at mediapulse.com  Thu Jan  8 18:58:40 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <C0FC22C08B82074A88B50061764157776B996D@johnson.mediapulse.net>

> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of 
> Windows/Apache2.xx/mod_python/SMP not
> > useable?
> 
> s/Windows/Unix ? ;-)
> 
%s/Windows/Unix/g =)

From khalid_kary at hotmail.com  Fri Jan  9 00:12:48 2004
From: khalid_kary at hotmail.com (Khalid El-Kary)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <BAY8-F965rrgJGERxKF000142da@hotmail.com>

> > s/Windows/Unix ? ;-)
> >
>%s/Windows/Unix/g =)

Execuse my ignorance, but what do both of them mean ? :-)

Khalid

_________________________________________________________________
MSN 8 with e-mail virus protection service: 2 months FREE* 
http://join.msn.com/?page=features/virus

From dg at sponsera.com  Thu Jan  8 19:26:54 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC8F4.7000607@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com> <3FFDC8F4.7000607@force-elite.com>
Message-ID: <3FFDF54E.4000403@sponsera.com>

I am not quite sure how to do this.

Presumably, I would have to rebuild apache with -g enabled.  Is this 
correct? How do I actually get the core files? (the actual error I have 
been getting is "Segmentation fault")

Thanks!


Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
>> MySQL ( I am not sure how to check this out definitely, but I cannot 
>> seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
>> source.
>>
>> Also, everything (my entire mod_python application, including all 
>> mysql accessing), seems to run *fine* on my home machine 
>> (redhat8-based). It is when I have tried running on our 
>> redhat-9-based server where these problems start to appear....(note 
>> that I reuilt all the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>



From robert at leftwich.info  Fri Jan  9 14:25:43 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040108183117.S67407@onyx.ispol.com>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
 <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <5.2.0.9.0.20040109140327.01b15748@192.168.0.1>

At 10:33 AM 9/01/2004, Gregory (Grisha) Trubetskoy wrote:

>On Wed, 7 Jan 2004, Robert Leftwich wrote:
>
> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> > useable?
>
>s/Windows/Unix ? ;-)

Unfortunately the people I'm doing this project for are committed to 
Windows and cannot switch their production boxen (all SMP) to *nix :-((

After looking at a few options it's back to Java/servlets I go .... (at 
least for this project).

Robert

PS Can I suggest that this limitation be highlighted on the website/readme 
as it might save anyone else in the same situation from a lot of wasted 
time/effort. 
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From davidf at sjsoft.com  Fri Jan  9 06:44:24 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
References: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
Message-ID: <3FFE31A8.2000103@sjsoft.com>

Khalid El-Kary wrote:

>> > s/Windows/Unix ? ;-)
>> >
>> %s/Windows/Unix/g =)
>
>
> Execuse my ignorance, but what do both of them mean ? :-)
>
> Khalid

They are instructions that mean "replace 'Windows' with 'Unix' from sed 
(a command line search and replace tool) and used in other tools such as 
vim (text editor).

David

From dg at sponsera.com  Fri Jan  9 00:12:42 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <000b01c3d66a$d282f0e0$0600a8c0@santana>
References: <000b01c3d66a$d282f0e0$0600a8c0@santana>
Message-ID: <3FFE384A.8010805@sponsera.com>

Thanks, Mike.

While I am not following what you do *exactly*, it is similar.
And as I said, everything runs fine on one machine. (and has for a few 
years with multiple apps). It was an incredible suprise to all of a 
sudden find such difficulty on a new machine.

What *we* do is:
1. Get sources from relevent places as tarballs  - (apache, python, 
msql, MySQLdb, mod_python,....)
2. place sources in /usr/local/src
3. build and compile them there
4. install them in /usr/local

Soooo, python is in /usr/local/lib/python2.2... (execuatable in 
/usr/local/bin as /usr/local/bin/python)
apache is in /usr/local/apache2/...
mysql is in /usr/local/mysql...

And I have confirmed that mod_python is picking up the correct python.

D.

Michael Neel wrote:

>I see a lot of posts about trouble with MySQL and mod_python.  I use
>both in almost every project I do, and have yet to have any of these
>problems.  So here is how we configure a box:
>
>Redhat is used, versions 6x to 9 have been in use.
>We do not install the RPMs of MySQL that come with redhat, but do use
>the RPMs from MySQL's website.
>Apache's have been both compiled from source and RehHat RPMs.  When
>going from source, we use apache toolbox.  We've used both 1.3 and 2.0
>apaches.
>Python is compiled from source, and replaces the redhat version 
>(--prefix=/usr)
>Mod python is compiled from source as well.  This after python is
>installed to make sure it gets set to the same paths as the command
>line.  I never remember what to pass to configure, so I have to edit the
>src/Makefile and add -DEAPI to the opts.
>MySQLdb is installed with a simple python setup.py install
>
>If this helps or not I'm not sure, but I though I'd post it.
>Mike
>
>
>
>  
>



From dg at sponsera.com  Fri Jan  9 00:30:03 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFE3C5B.9090901@sponsera.com>

Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot
seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
source.
>>
>> Also, everything (my entire mod_python application, including all 
mysql accessing), seems to run *fine* on my home machine
(redhat8-based). It is when I have tried running on our redhat-9-based
server where these problems start to appear....(note that I reuilt all
the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?




Stack trace from wierd mod_python/mysql bug obtained!

================== basic program (outline) being run
from mod_python import util
from mod_python import apache
import MySQLdb

def hander(req):

db = MySQLdb.connect(db="quest1",
                          host="localhost",
                          user="dg",
                          passwd="pass")

     c = db.cursor(MySQLdb.cursors.DictCursor)
    sql = """select * from subject"""

     c.execute(sql)
==================================
Note that we get Seg fault on the c.execute().
And note also: with certain sql statements, does not crash but obtain
inconsistant results.


=====================GDB Stack ========================================

(gdb) r
Starting program: /usr/local/apache2/sbin/httpd -DONE_PROCESS
[New Thread 16384 (LWP 17860)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 17860)]
0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa) at Python/modsupport.c:334

(gdb) where
#0  0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa)
     at Python/modsupport.c:334
#1  0x402f8f9a in do_mktuple (p_format=0xbfffe790, p_va=0xbfffe794,
     endchar=41, n=7) at Python/modsupport.c:223
#2  0x402f88cf in do_mkvalue (p_format=0xbfffe790, p_va=0xbfffe794)
     at Python/modsupport.c:247
#3  0x402f8b4c in Py_VaBuildValue (format=0x0, va=0x0)
     at Python/modsupport.c:428
#4  0x402f8aea in Py_BuildValue (format=0x406ceb95 "(siiiiii)")
     at Python/modsupport.c:399
#5  0x406cce33 in _mysql_ResultObject_describe (self=0x828f160, args=0x0)
     at _mysql.c:737
#6  0x402d6988 in fast_cfunction (func=0x0, pp_stack=0xbfffe8c4, na=-1)
     at Python/ceval.c:3132
#7  0x402d51d5 in eval_frame (f=0x822baec) at Python/ceval.c:2017
#8  0x402d5be3 in PyEval_EvalCodeEx (co=0x81fa500, globals=0x0, locals=0x0,
     args=0x822b73c, argcount=2, kws=0x822b744, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#9  0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#10 0x402d514f in eval_frame (f=0x822b5e4) at Python/ceval.c:2034
#11 0x402d5be3 in PyEval_EvalCodeEx (co=0x8285908, globals=0x0, locals=0x0,
     args=0x82491dc, argcount=2, kws=0x82491e4, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#12 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#13 0x402d514f in eval_frame (f=0x8249064) at Python/ceval.c:2034
#14 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f95d0, globals=0x0, locals=0x0,
     args=0x817341c, argcount=3, kws=0x8173428, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#15 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=3, nk=0)
     at Python/ceval.c:3170
#16 0x402d514f in eval_frame (f=0x81732c4) at Python/ceval.c:2034
#17 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f8df8, globals=0x0, locals=0x0,
     args=0x8173410, argcount=2, kws=0x823b4a0, kwcount=0, defs=0x8289a80,
     defcount=1, closure=0x0) at Python/ceval.c:2595
#18 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#19 0x402d514f in eval_frame (f=0x823b32c) at Python/ceval.c:2034
#20 0x402d5be3 in PyEval_EvalCodeEx (co=0x823ef80, globals=0x0, locals=0x0,
     args=0x8233280, argcount=1, kws=0x8233284, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#21 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=1, nk=0)
     at Python/ceval.c:3170
#22 0x402d514f in eval_frame (f=0x82330d4) at Python/ceval.c:2034
#23 0x402d5be3 in PyEval_EvalCodeEx (co=0x81e6b18, globals=0x0, locals=0x0,
     args=0x81d0640, argcount=2, kws=0x0, kwcount=0, defs=0x0, defcount=0,
     closure=0x0) at Python/ceval.c:2595
#24 0x4031a729 in function_call (func=0x822f7d4, arg=0x81d0634, kw=0x0)
     at Objects/funcobject.c:476
#25 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81d0634, kw=0x0)
     at Objects/abstract.c:1688
#26 0x402a3148 in instancemethod_call (func=0x822f7d4, arg=0x81d0634,
kw=0x0)
     at Objects/classobject.c:2315
#27 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81e99d4, kw=0x0)
     at Objects/abstract.c:1688
#28 0x402d6847 in PyEval_CallObjectWithKeywords (func=0x81cc8b4,
     arg=0x81e99d4, kw=0x0) at Python/ceval.c:3058
#29 0x4029aa8d in PyObject_CallMethod (o=0x0, name=0x81e99d4 "\002",
     format=0x81e99d4 "\002") at Objects/abstract.c:1679
#30 0x402985fc in python_handler (req=0x81bb018,
     phase=0x4031ee18 "PythonHandler") at mod_python.c:899
#31 0x4029973e in PythonHandler (req=0x81bb018) at mod_python.c:1699
#32 0x0807baca in ap_run_handler (r=0x81bb018) at config.c:195
#33 0x0807bfe2 in ap_invoke_handler (r=0x81bb018) at config.c:401
#34 0x0806bd8b in ap_process_request (r=0x81bb018) at http_request.c:288
#35 0x08067f25 in ap_process_http_connection (c=0x81b6fe8) at
http_core.c:293
#36 0x0808493a in ap_run_process_connection (c=0x81b6fe8) at connection.c:85
#37 0x0807a67f in child_main (child_num_arg=0) at prefork.c:694
#38 0x0807a82a in make_child (s=0x80b7118, slot=0) at prefork.c:734
#39 0x0807a883 in startup_children (number_to_start=5) at prefork.c:806
#40 0x0807af75 in ap_mpm_run (_pconf=0x8079f68, plog=0x80ecaf0, s=0x80b7118)
     at prefork.c:1022
#41 0x0807fd02 in main (argc=2, argv=0xbffff404) at main.c:660
#42 0x401415cd in __libc_start_main () from /lib/libc.so.6
(gdb)





From dwmp at opti.cgi.net  Fri Jan  9 00:15:40 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] get_options() problem
Message-ID: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>


According to the 3.1.2b documentation there should be a get_options() 
method on the server object.  When trying to access it I get a traceback.

code (under psp):

req.log_error('options: %s' % `req.server.get_options()`)

error:

AttributeError: 'mp_server' object has no attribute 'get_options'


Does the server.get_options() method no longer exist and is the 
documentation (section 4.5.6.1) just out of date?

I'm trying to get to the DocumentRoot value for the virtual server handling 
the current request and was hoping I might find it in there.

-Dan

From dwmp at opti.cgi.net  Fri Jan  9 00:23:11 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] get_options() problem
In-Reply-To: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109002211.03797eb8@mail.pyxos.com>


I found the DocumentRoot value I was after.  Duh.  req.document_root().

However, that server.get_options() probably needs some looking into.

-Dan



At 12:15 AM 1/9/2004 -0600, you wrote:

>According to the 3.1.2b documentation there should be a get_options() 
>method on the server object.  When trying to access it I get a traceback.
>
>code (under psp):
>
>req.log_error('options: %s' % `req.server.get_options()`)
>
>error:
>
>AttributeError: 'mp_server' object has no attribute 'get_options'
>
>
>Does the server.get_options() method no longer exist and is the 
>documentation (section 4.5.6.1) just out of date?
>
>I'm trying to get to the DocumentRoot value for the virtual server 
>handling the current request and was hoping I might find it in there.
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From a.w at quirxi.com  Fri Jan  9 14:12:31 2004
From: a.w at quirxi.com (Arno Wilhelm)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] 
	Newbie question: Fieldstorage is empty in the second handler
Message-ID: <3FFEA8BF.2060408@quirxi.com>

Hello,

I have just started using mod_pyhon and have come to a problem I cannot find an 
solution for:

In my html file there is a hidden input named PATH:

<FORM method="post" action="/qwer/eval.py">
<INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
...
</FORM>

When the form is submitted the PATH variable reaches the authenhandler(req) 
which I can give out to a file:

PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24

but after that it does not reach the following handler(req) function. It always 
raises an KeyError since the PATH variable does not exist in this function anymore !
Can anyone point me to the right direction ?



cheers,

Arno





	

From fowlertrainer at anonym.hu  Fri Jan  9 16:19:41 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] How to globalize vars ???
Message-ID: <17328262299.20040109161941@anonym.hu>

Hello !

I have get a strange problem in mod_python site.
More modules I have, and think, to I initialize my Session handler
from main module.

Like this:

-- main --

import BHASession

# Session info
BHASessionDir="C:/bhaweb/sessions"
#f=open("c:/now.txt","a");f.write(" 1");f.close();
BHASession.SSInit(BHASessionDir)
#f=open("c:/now.txt","a");f.write(" 2");f.close();

-- Session --
f=open("c:/now.txt","a");f.write(" 01");f.close();
#global SSDefaultDir
SSDefaultDir="c:/bhaweb/sessions"
f=open("c:/now.txt","a");f.write(" 02");f.close();
SSLockObj=threading.Lock()

def SSLock():
    SSLockObj.acquire()

def SSUnlock():
    SSLockObj.release()

def SSInit(SessionDir):
    #f=open("c:/now.txt","a");f.write(" 03");f.close();
    SSLock()
    try:
      #global SSDefaultDir
      #r.append(str(SSDefaultDir))
      #f=open("c:/now.txt","a")
      #f.write(" "+SSDefaultDir)
      #f.close()
      #r.append(str(SSInitialized))
      if SSDefaultDir.strip()=="":
#       <-
# UnboundLocalError: local variable 'SSDefaultDir' referenced before assignment
         r.append(str(SSDefaultDir))
         SSDefaultDir=SessionDir
         f=open("c:/now.txt","a")
         f.write(" "+SSDefaultDir)
         f.close()
    finally:
      SSUnlock()

--------------
      
When I not use SSInit, only I write the global variable in BHASession
module like this:

SSDefaultDir="c:/bhaweb/sessions"

then it is working good !!!

Why ? How to force python to module see his variable ?

Thanx for any advance  !

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From dwmp at opti.cgi.net  Fri Jan  9 10:08:28 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in
  the second handler
In-Reply-To: <3FFEA8BF.2060408@quirxi.com>
Message-ID: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>


You're probably creating a FieldStorage in authenhandler() and then 
recreating the FieldStorage in your handler().  You're using a POST request 
so the when FieldStorage is created it reads the fields from the body of 
the request (GET requests put the variables in the header) via the 
req.read() method. Once you've read the body of the of a request, it cannot 
be read again.  So when your second FieldStorage is created, there is no 
body request data left to be read.

As it turns out, the req object you get in authenhandler() and handler() is 
the same object.  So when you create your first FieldStorage in 
authenhandler(), assign it to the req object and it will be available in 
your handler() function without having to recreate it again.

-Dan




At 02:12 PM 1/9/2004 +0100, you wrote:
>Hello,
>
>I have just started using mod_pyhon and have come to a problem I cannot 
>find an solution for:
>
>In my html file there is a hidden input named PATH:
>
><FORM method="post" action="/qwer/eval.py">
><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>...
></FORM>
>
>When the form is submitted the PATH variable reaches the 
>authenhandler(req) which I can give out to a file:
>
>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>
>but after that it does not reach the following handler(req) function. It 
>always raises an KeyError since the PATH variable does not exist in this 
>function anymore !
>Can anyone point me to the right direction ?
>
>
>
>cheers,
>
>Arno

From dwmp at opti.cgi.net  Fri Jan  9 10:12:57 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] How to globalize vars ???
In-Reply-To: <17328262299.20040109161941@anonym.hu>
Message-ID: <5.2.1.1.2.20040109101042.042fa6f0@mail.pyxos.com>


Try assigning global SSDefaultDir at the top of your SSInit function like this:

def SSInit(SessionDir):
     global SSDefaultDir
     SSLock()
     ...

-Dan




At 04:19 PM 1/9/2004 +0100, you wrote:
>Hello !
>
>I have get a strange problem in mod_python site.
>More modules I have, and think, to I initialize my Session handler
>from main module.
>
>Like this:
>
>-- main --
>
>import BHASession
>
># Session info
>BHASessionDir="C:/bhaweb/sessions"
>#f=open("c:/now.txt","a");f.write(" 1");f.close();
>BHASession.SSInit(BHASessionDir)
>#f=open("c:/now.txt","a");f.write(" 2");f.close();
>
>-- Session --
>f=open("c:/now.txt","a");f.write(" 01");f.close();
>#global SSDefaultDir
>SSDefaultDir="c:/bhaweb/sessions"
>f=open("c:/now.txt","a");f.write(" 02");f.close();
>SSLockObj=threading.Lock()
>
>def SSLock():
>     SSLockObj.acquire()
>
>def SSUnlock():
>     SSLockObj.release()
>
>def SSInit(SessionDir):
>     #f=open("c:/now.txt","a");f.write(" 03");f.close();
>     SSLock()
>     try:
>       #global SSDefaultDir
>       #r.append(str(SSDefaultDir))
>       #f=open("c:/now.txt","a")
>       #f.write(" "+SSDefaultDir)
>       #f.close()
>       #r.append(str(SSInitialized))
>       if SSDefaultDir.strip()=="":
>#       <-
># UnboundLocalError: local variable 'SSDefaultDir' referenced before 
>assignment
>          r.append(str(SSDefaultDir))
>          SSDefaultDir=SessionDir
>          f=open("c:/now.txt","a")
>          f.write(" "+SSDefaultDir)
>          f.close()
>     finally:
>       SSUnlock()
>
>--------------
>
>When I not use SSInit, only I write the global variable in BHASession
>module like this:
>
>SSDefaultDir="c:/bhaweb/sessions"
>
>then it is working good !!!
>
>Why ? How to force python to module see his variable ?
>
>Thanx for any advance  !
>
>--
>Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From jalil at securia.com  Fri Jan  9 08:22:22 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] How to set connection parameters?
Message-ID: <3FFED53E.20402@securia.com>

When using JDBC,  one can pass the following parameters in the 
connection string:

useUnicode=true&characterEncoding=UTF-8

How do we do this in Python?

Thanks,

-Jalil



From dwmp at opti.cgi.net  Fri Jan  9 10:41:18 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in 
  the second handler
In-Reply-To: <3FFED6FE.8000702@quirxi.com>
References: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
 <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109103843.036e4ce0@mail.pyxos.com>


The req object is just a python object.  You can assign any new members you 
want to it and they will remain throughout Apache's request handling 
process.   So in your authenhandler() do this:

req.form = FieldStorage(req)

Then when you need to get your variables in handler() just do this:

path = req.form['PATH'].value


-Dan



At 05:29 PM 1/9/2004 +0100, you wrote:
>Hello Daniel,
>
>
>>You're probably creating a FieldStorage in authenhandler() and then 
>>recreating the FieldStorage in your handler().  You're using a POST 
>>request so the when FieldStorage is created it reads the fields from the 
>>body of the request (GET requests put the variables in the header) via 
>>the req.read() method. Once you've read the body of the of a request, it 
>>cannot be read again.  So when your second FieldStorage is created, there 
>>is no body request data left to be read.
>>As it turns out, the req object you get in authenhandler() and handler() 
>>is the same object.
>
>
>It is just as you said: I used a POST request and called FieldStorage in 
>authenhandler() and handler().
>
>>So when you create your first FieldStorage in authenhandler(), assign it 
>>to the req object and it will be available in your handler() function 
>>without having to recreate it again.
>
>How can you assign the FieldStorage to a req object ? I could not find any 
>variable it could be assigned to in the docu.
>
>
>
>Arno
>
>
>
>>-Dan
>>
>>
>>At 02:12 PM 1/9/2004 +0100, you wrote:
>>
>>>Hello,
>>>
>>>I have just started using mod_pyhon and have come to a problem I cannot 
>>>find an solution for:
>>>
>>>In my html file there is a hidden input named PATH:
>>>
>>><FORM method="post" action="/qwer/eval.py">
>>><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>>>...
>>></FORM>
>>>
>>>When the form is submitted the PATH variable reaches the 
>>>authenhandler(req) which I can give out to a file:
>>>
>>>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>>>
>>>but after that it does not reach the following handler(req) function. It 
>>>always raises an KeyError since the PATH variable does not exist in this 
>>>function anymore !
>>>Can anyone point me to the right direction ?
>>>
>>>
>>>
>>>cheers,
>>>
>>>Arno
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From neel at mediapulse.com  Fri Jan  9 12:15:16 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] get_options() problem
Message-ID: <C0FC22C08B82074A88B50061764157776B9971@johnson.mediapulse.net>

I use req.get_options(), this is 2.x - and it should be the same (at
least I hope it is) for 3.x

Mike

> -----Original Message-----
> From: Daniel West [mailto:dwmp@opti.cgi.net] 
> Sent: Friday, January 09, 2004 1:23 AM
> To: mod_python@modpython.org
> Subject: Re: [mod_python] get_options() problem
> 
> 
> 
> I found the DocumentRoot value I was after.  Duh.  
> req.document_root().
> 
> However, that server.get_options() probably needs some looking into.
> 
> -Dan
> 
> 
> 
> At 12:15 AM 1/9/2004 -0600, you wrote:
> 
> >According to the 3.1.2b documentation there should be a 
> get_options() 
> >method on the server object.  When trying to access it I get 
> a traceback.
> >
> >code (under psp):
> >
> >req.log_error('options: %s' % `req.server.get_options()`)
> >
> >error:
> >
> >AttributeError: 'mp_server' object has no attribute 'get_options'
> >
> >
> >Does the server.get_options() method no longer exist and is the 
> >documentation (section 4.5.6.1) just out of date?
> >
> >I'm trying to get to the DocumentRoot value for the virtual server 
> >handling the current request and was hoping I might find it in there.
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From jalil at securia.com  Fri Jan  9 11:33:27 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:00:43 2004
Subject: [mod_python] Cannot load templates using PSP class
Message-ID: <3FFF0207.3000003@securia.com>

 
In my python default handler, I am trying to load an html file in my 
code using the example below:

template = psp.PSP(req, filename='template.html')

The html file is located in the same directory as my .py file but this call 
fails unless I pass the full path of the html file in the call!

Any way to change this behaviour?

Thanks,

-Jalil



From grisha at modpython.org  Fri Jan  9 17:05:53 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <3FFF0207.3000003@securia.com>
References: <3FFF0207.3000003@securia.com>
Message-ID: <20040109165951.K82783@onyx.ispol.com>


It's impossible to answer this without the details of your configuration.

Take a look at your req.filename. PSP tries to figure out the "current
directory" by looking at req.filename. Under certain configs this won't
work.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

>
> In my python default handler, I am trying to load an html file in my
> code using the example below:
>
> template = psp.PSP(req, filename='template.html')
>
> The html file is located in the same directory as my .py file but this call
> fails unless I pass the full path of the html file in the call!
>
> Any way to change this behaviour?
>
> Thanks,
>
> -Jalil
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From jalil at securia.com  Fri Jan  9 14:27:32 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <20040109165951.K82783@onyx.ispol.com>
References: <3FFF0207.3000003@securia.com>
	<20040109165951.K82783@onyx.ispol.com>
Message-ID: <3FFF2AD4.5090909@securia.com>

Grisha,

req.filename is the the full path of the resource on my filesystem and 
looks fine.
Please let me know what info you need regarding my configuration or what 
config parameters make this fail.

Thanks,

-Jalil

Gregory (Grisha) Trubetskoy wrote:

>It's impossible to answer this without the details of your configuration.
>
>Take a look at your req.filename. PSP tries to figure out the "current
>directory" by looking at req.filename. Under certain configs this won't
>work.
>
>Grisha
>
>On Fri, 9 Jan 2004, jalil wrote:
>
>  
>
>>In my python default handler, I am trying to load an html file in my
>>code using the example below:
>>
>>template = psp.PSP(req, filename='template.html')
>>
>>The html file is located in the same directory as my .py file but this call
>>fails unless I pass the full path of the html file in the call!
>>
>>Any way to change this behaviour?
>>
>>Thanks,
>>
>>-Jalil
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>

From jalil at securia.com  Fri Jan  9 15:41:23 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] Error using Session
Message-ID: <3FFF3C23.8060301@securia.com>

Today I upgraded to Python 2.3.3 and mod_python 3.1.2b fine. I am trying to use the Session
class now and when in my request handler I do something simple like:

sess = Session.Session(req)
req.write (sess.id())

I get the following error. Any idea why this happens and why python2.2 is still being 
used in mod_python? The 2.3.3 is installed in /usr/local/lib which comes first in my PATH.
I am using Redhad which seems to depend on 2.2!


Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)

  File "/development/webnotes/src/pylib/dispatch.py", line 54, in handler
    ses = Session.Session(req)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)

ValueError: Failed to acquire global mutex lock

Thanks,

-Jalil


From egrubbs at rackspace.com  Fri Jan  9 17:53:19 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] SetEnv and add_common_vars()
Message-ID: <20040109235319.GJ5495@rackspace.com>

When I use SetEnv in my apache conf file, it causes a lot of the
environment variables (such as DOCUMENT_ROOT) to disappear that
add_common_vars() normally would set.

The only workaround I have is to put the SetEnv statements in a
different <Directory> block than the directory with the files served by
mod_python.

Is this a bug in mod_env or mod_python? Is there a better way to fix
this?

-Edwin
From grisha at modpython.org  Fri Jan  9 19:48:39 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040109235319.GJ5495@rackspace.com>
References: <20040109235319.GJ5495@rackspace.com>
Message-ID: <20040109194651.V82783@onyx.ispol.com>


On Fri, 9 Jan 2004, Edwin Grubbs wrote:

> When I use SetEnv in my apache conf file, it causes a lot of the
> environment variables (such as DOCUMENT_ROOT) to disappear that
> add_common_vars() normally would set.

When you say "dissapear" - what are you using to look them up?

> The only workaround I have is to put the SetEnv statements in a
> different <Directory> block than the directory with the files served by
> mod_python.

What is the objective here? If you are you trying to pass information to
mod_python from the config, a better way is to use PythonOption.

Grisha
From jalil at securia.com  Fri Jan  9 17:01:19 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
Message-ID: <3FFF4EDF.2050401@securia.com>

I have built and updated my Python and mod_python to the latest version 
and the new mod_python.so is now in the modules directory. However, my 
mod_python still picks up the old version of Python. Does anybody know 
how to fix this?

Thanks,

From grisha at modpython.org  Fri Jan  9 20:38:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <20040109203726.L85266@onyx.ispol.com>


Just a guess - before re-running ./configure, make sure to remove
config.cache file.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

> I have built and updated my Python and mod_python to the latest version
> and the new mod_python.so is now in the modules directory. However, my
> mod_python still picks up the old version of Python. Does anybody know
> how to fix this?
>
> Thanks,
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Fri Jan  9 20:41:08 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:00:44 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <0FE6C376-430E-11D8-9AD2-000A95A072FC@sb.org>

You could remove the old version?

Alternately, there's an option to ./configure for building mod_python 
that lets you specify the exact path to python in case you have 
multiple copies. That might be what you're looking for.

On Jan 9, 2004, at 8:01 PM, jalil wrote:

> I have built and updated my Python and mod_python to the latest 
> version and the new mod_python.so is now in the modules directory. 
> However, my mod_python still picks up the old version of Python. Does 
> anybody know how to fix this?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:02:24 2004
Subject: No subject
Message-ID: <mailman.0.1073703744.54797.mod_python@modpython.org>

    Internal Server Error

    The server encountered an internal error or misconfiguration and was     
    unable to complete your request.

Other normal web request seem to work fine. 
This is what the error logs show...

    [Wed Aug  2 20:58:57 2000] [notice] caught SIGTERM, shutting down
    [Wed Aug  2 20:59:02 2000] [notice] Apache/1.3.12 (Unix) configured
-- resuming
        normal operations
    'import site' failed; use -v for traceback
    make_obcallback(): could not import mod_python.apache.
    make_obcallback(): could not call init.
    [Wed Aug  2 20:59:45 2000] [error] [client 202.77.245.126] python_handler:
        make_obcallback returned no obCallBack!


The mod_python module sits in 

        /usr/local/lib/python1.5/mod_python

    (along with other .pc. .pyc modules)


In my httpd.conf (everything is there, no srm.conf, access.conf), I have 

    AddHandler python-program .py
    PythonHandler pytest.py
    PythonDebug on
    PythonPath "sys.path+['/usr/local/lib/python1.5/mod_python']

this is within the <Directory..> directives for ~/apache/htdocs.
pytest.py is same as the "Hello World" example in the tutorial in
mod_python...


Also when in the Python interpreter, I try to load stuff manually, 
ie:

    >>> from mod_python import apache
    Traceback (innermost last):
    File "<stdin>", line 1, in ?
    File "/usr/local/lib/python1.5/mod_python/apache.py", line 18, in ?
        import _apache
    ImportError: No module named _apache
    >>>

and apache.py does indeed have the line "import _apache"

Loading other standard python modules like "sys" works OK, hence I think
PYTHONPATH seems OK.


config_info
------------------
Apache - 1.3.12
Python 1.5, compiled from source, standard
    (both are installed in /usr/local)
system Linux Mandrake 7.0, 2.2.12 kernel 
Compaq box, P3.


Any help from anyone will be appreciated.

Hope I can get this working. Would love to use Python for a few things here.



----------------------------------------------------------
Boh-heong Yap
Project Manager, eCommerce
				bohheong@asiacontent.com				

Asiacontent.com a leading pan-Asian Internet company,
with focus on: content, advertising and e-commerce.
-----------------------------------------------------------


From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:02:29 2004
Subject: No subject
Message-ID: <mailman.1.1073703749.54797.mod_python@modpython.org>

req.headers_out['Set-Cookie']='key=value'
req.headers_out['location'] = 'http://localhost/index.html'
return apache.HTTP_MOVED_TEMPORARILY

The problem seems to be that if I don't do req.send_http_header() the
Set-Cookie doesn't get sent so the cookie doesn't get set.  If I do call
req.send_http_header() the cookie does get set but it seems as though
two sets of headers are sent and the response code is 200.  Any ideas?

Geoff Cadien
geoff@infostreet.com

From rassilkapoemail at yahoo.com  Fri Jan  9 22:02:18 2004
From: rassilkapoemail at yahoo.com (rassilkapoemail@yahoo.com)
Date: Fri Jan  9 22:02:48 2004
Subject: [mod_python] Массовая рассылка вашей рекламы по 350.000 е-майлов.
Message-ID: <200106242108.f5OL8E296083@eden.ispol.com>

Массовая рассылка вашей рекламы по 350.000 е-майлов.
Стоимость 1$ - 1000 писем. Минимальный заказ 100$.

Разошлем Вашу рекламу по 42.000 организациям Москвы - 50$.

Пишите: rassilkapoemail@yahoo.com или email_reklama@yahoo.com
 
 
 
 
 
 
 
 

From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:02:49 2004
Subject: No subject
Message-ID: <mailman.2.1073703769.54797.mod_python@modpython.org>

is posible that is a problem in the debian package libpapache-mod-python.




-- 


From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:03:10 2004
Subject: No subject
Message-ID: <mailman.3.1073703790.54797.mod_python@modpython.org>

add_handler (htype, handler[, dir])
    Allows dynamic handler registration. htype is a string containing the
    name of any of the apache Python*Handler directives, e.g.
    "PythonHandler". handler is a string containing the name of the module
    and the handler function. Optional dir is a string containing the name of
    the directory to be added to the pythonpath. If no directory is
    specified, then, if there is already a handler of the same type
    specified, its directory is inherited, otherwise the directory of the
    presently executing handler is used.

However, if a PythonPath directive is in force, the third argument seems to
be ignored (from my reading of apache.py).  Two solutions present themselves:
(a) fix the documentation or (b) change the code to suit the documentation.

For the record, I'd prefer the latter.  It allows me to dynamically import
handlers directly instead of traversing long strings of Python packages.

Dustin

-- 

  Dustin Mitchell
  dustin@ywlcs.org
  http://people.cs.uchicago.edu/~dustin/

From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:03:11 2004
Subject: No subject
Message-ID: <mailman.4.1073703791.54797.mod_python@modpython.org>

[Wed May 15 15:46:25 2002] [error] [client 127.0.0.1] Invalid method in
request
agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1

...and from the access log:

127.0.0.1 - - [15/May/2002:16:07:42 +0200] "POST /cgi/login.py HTTP/1.1" 200
1396
127.0.0.1 - - [15/May/2002:16:07:42 +0200]
"agent=roger&password=xXxX&login=logg+innGET /style.css HTTP/1.1" 501 459

So, it seems as the GET for the stylesheet is 'colliding' with the login
POST operation...?

This is not a problem when we keep the module cleanup loop. However, the
application is too slow when we have many simultaneous users, actually
slower than the old cgi, so we are trying to speed up everywhere we can.

The lock in cgihandler.py will prevent multiple simultaneous users? It seems
like it is. The server load is reduced, because there are no python
processes starting for each access, but the users perceive the application
as _slower_ than it was as a classic cgi, and I think it is because of the
lock in cgihandler.py beeing a bottleneck, slipping through only one user at
the time... is this the way mod_python is supposed to work?

win2k, SP2, 5.00.2195
apache 1.3.24
mod_python 2.7.4
python 2.1.3 (214)

--
Roger


From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:03:20 2004
Subject: No subject
Message-ID: <mailman.5.1073703800.54797.mod_python@modpython.org>

LoadModule python_module modules/mod_python276.dll
AddModule mod_python.c

ScriptAlias /python/ "C:/Program Files/Apache Group/Apache/htdocs/python/"

<Directory "C:/Program Files/Apache Group/Apache/htdocs/python">
    AddHandler python-program .py
    PythonHandler mptest
    PythonDebug on
</Directory>

mod_python is located in C:\Python21\Lib\mod_python.  The folder has been
stripped of version numbers to just mod_python.  The following files are found
in the mod_python folder:
__init__.py
apache.py
cgihandler.py
httpdapi.py
publisher.py
util.py
zhandler.py

When I try to start the Apache service, I get the error
"Could not start the Apache service on Local Computer.  The service did not
return an error.  This could be an internal Windows error or an internal service
error"
If I comment out the mod_python directives, it runs just fine.

Any help would be greatly appreciated and it will give the bruises on my head a
chance to heal ;-)

TIA,

Mark



From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:03:21 2004
Subject: No subject
Message-ID: <mailman.6.1073703801.54797.mod_python@modpython.org>

This routine gives allows for an opportunity to translate the URI into
an actual filename, before the server's default rules (Alias directives
and the like) are followed. 

Again, how do I do this?

I am implimenting a specialized web cache server and I need to resolve
an url to a path on my server - the logic to resolve the url to path is
the main part of my program.

I can easily enough just resove the url in my main handler and then
manually feed the client form the static file, but im ny oppionion
apache should be doing this itself.  I just need to tell it what file to
use.

My problem is that the request object members such as filename and the
like are read-only, so how do I pass the new filename back to apache?

Alex

From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:03:30 2004
Subject: No subject
Message-ID: <mailman.7.1073703810.54797.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From bogus@does.not.exist.com  Fri Jan  9 22:02:18 2004
From: bogus@does.not.exist.com ()
Date: Fri Jan  9 22:03:30 2004
Subject: No subject
Message-ID: <mailman.8.1073703810.54797.mod_python@modpython.org>

./configure --activate-module=src/modules/python/libpython.a

which gave : 

Configuring for Apache, Version 1.3.26
 + using installation path layout: Apache (config.layout)
 + activated python module (modules/python/libpython.a)
Creating Makefile
Creating Configuration.apaci in src
Creating Makefile in src
 + configured for Linux platform
 + setting C compiler to gcc
 + setting C pre-processor to gcc -E
 + checking for system header files
 + adding selected modules
    o python_module uses ConfigStart/End
 + using system Expat
 + checking sizeof various data types
 + doing sanity check on compiler and options
Creating Makefile in src/support
Creating Makefile in src/regex
Creating Makefile in src/os/unix
Creating Makefile in src/ap
Creating Makefile in src/main
Creating Makefile in src/modules/standard
Creating Makefile in src/modules/python

then issued make

This is the last part of the Apache compilation that shows the errors :


gcc -c -I/usr/drunix/webservers/apache/mod_python-2.7.8/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/include
-I/usr/drunix/webservers/apache/apache_1.3.26/src/os/unix
-I/usr/drunix/programming/python/Python-2.2.1
-I/usr/drunix/programming/python/Python-2.2.1/Include -I./os/unix
-I./include   -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` buildmark.c
gcc  -DLINUX=22 -DUSE_HSREGEX -DNO_DL_NEEDED `./apaci` -Xlinker
-export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a
modules/python/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a
regex/libregex.a   -lm -lcrypt -lm  /usr/drunix/programming/python/Python-2.2.1/libpython2.2.a
-lexpat

--->> This is my note : Up to here everything seems to be okay, but then
...  --->>

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tmpnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4503:
the use of `tmpnam' is dangerous, better use `mkstemp'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_tempnam':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:4451:
the use of `tempnam' is dangerous, better use `mkstemp'

/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(dynload_shlib.o):
In function `_PyImport_GetDynLoadFunc':
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:90:
undefined reference to `dlopen'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:93:
undefined reference to `dlerror'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:74:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/Python/dynload_shlib.c:98:
undefined reference to `dlsym'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_openpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1934:
undefined reference to `openpty'
/usr/drunix/programming/python/Python-2.2.1/libpython2.2.a(posixmodule.o):
In function `posix_forkpty':
/usr/drunix/programming/python/Python-2.2.1/./Modules/posixmodule.c:1965:
undefined reference to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/drunix/webservers/apache/apache_1.3.26'
make: *** [build] Error 2

I have been stuck here for days, found no similar errors in the mailing
list, I scanned them form January to September (2002).

Any susgestions would be greatly appreciated.

G.K.


From redconectabilbao at telefonica.net  Fri Jan  2 09:34:52 2004
From: redconectabilbao at telefonica.net (Red Conecta)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] mod_python and css
In-Reply-To: <20031231143016.GB10034@stellar.eradman.com>
References: <3FF29D8B.6030208@telefonica.net>
	<20031231143016.GB10034@stellar.eradman.com>
Message-ID: <3FF52D2C.70809@telefonica.net>

theman@stellar.eradman.com escribi?:

>One thing to watch out for is that when you're calling pages using the http://domain/script/function relative paths do not work corrrectly. So instead of href="estilo.css" it probably needs to be href="/estilo.css".
>
>Eric Radman
>theman@eradman.com
>
>Wed, Dec 31, 2003 at 10:57:31AM +0100, Red Conecta wrote:
>  
>
>>I'm trying to use css with the publisherhandler; here is the code:
>>
>>   def _inicio():
>>       ini= '''<head><title>nombredelsitio</title>
>>                 <link rel="stylesheet" href="estilo.css"
>>   Type="text/css"></head>
>>                 <body leftmargin=0 rightmargin=0 topmargin=0
>>   bottommargin=0>'''
>>      
>>       return ini
>>
>>   def _final():
>>       return '</body></html>'
>>
>>   def mostrar(req,direccion='/'):
>>       req.content_type = "text/html"
>>       html=_inicio()
>>       obj=leerobjeto(direccion)
>>       if obj!=None:
>>           for i in obj.__dict__:html+=i+': '+obj.__dict__[i]+'<br>'
>>       else:html+='error'
>>       html+=_final()
>>       return html
>>
>>the output doesn't use the estilo.css archive but if I save the page in 
>>'mostrar.html' all is ok.
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>    
>>
>
>  
>
I've tryed /estilo.css, ./estilo.css, ../estilo.css and 
/var/www/html/portal/estilo.css, but it still doesn't work

From stian at soiland.no  Fri Jan  2 10:42:49 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <3FF29D8B.6030208@telefonica.net>
References: <3FF29D8B.6030208@telefonica.net>
Message-ID: <20040102094249.GC11946@itea.ntnu.no>

On 2003-12-31 10:57:31, Red Conecta wrote:

> I'm trying to use css with the publisherhandler; here is the code:

You've probably used SetHandler instead of AddHandler. SetHandler eats
ALL requests for the directory and passes them on to mod_python.
Effectually static files like your css-file is therefore unavailable.

Solutions:
   
   a) Create one or more static-directories with SetHandler none
      (these could be called "css", "images", etc.)

   b) Place static files somewhere outside the directory structure
      handled by SetHandler python-program
   
   c) Use AddHandler python-program .py instead
      (requires a .py-ending for all mod-python requests)     

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From grisha at modpython.org  Fri Jan  2 16:43:46 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Re: mod_python and css
In-Reply-To: <20040102094249.GC11946@itea.ntnu.no>
References: <3FF29D8B.6030208@telefonica.net>
	<20040102094249.GC11946@itea.ntnu.no>
Message-ID: <20040102164112.Q70689@onyx.ispol.com>


There also:

   d) SetHandler None
      To reverse any previous SetHandler directives to default Apache
      behaviour. Handy for those images/ or styles/ directories.

Grisha

On Fri, 2 Jan 2004, Stian [iso-8859-1] S?iland wrote:

> On 2003-12-31 10:57:31, Red Conecta wrote:
>
> > I'm trying to use css with the publisherhandler; here is the code:
>
> You've probably used SetHandler instead of AddHandler. SetHandler eats
> ALL requests for the directory and passes them on to mod_python.
> Effectually static files like your css-file is therefore unavailable.
>
> Solutions:
>
>    a) Create one or more static-directories with SetHandler none
>       (these could be called "css", "images", etc.)
>
>    b) Place static files somewhere outside the directory structure
>       handled by SetHandler python-program
>
>    c) Use AddHandler python-program .py instead
>       (requires a .py-ending for all mod-python requests)
>
> --
> Stian S?iland               Work toward win-win situation. Win-lose
> Trondheim, Norway           is where you win and the other lose.
> http://www.soiland.no/      Lose-lose and lose-win are left as an
>                             exercise to the reader.  [Limoncelli/Hogan]
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:23:33 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
Message-ID: <000101c3d248$3c485f00$6400a8c0@infoserve.net>

How do you get a second frame to refresh a grid on a first frame? I have a
wxGrid on my main frame that is populated from a database. Double clicking a
row in that grid brings up a second frame where an individual record is
displayed. When the user clicks a submit button on the second form, it
updates the database, then closes the second form. I then want the grid on
the first frame to refresh. I know that I can access the grid from the
second frame because if I code:
 
frame.grid.Destroy()
 
it destroys the grid on the first frame. But this has no effect:
 
frame.grid.ForceRefresh()
 
Any suggestions?
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/d50365e9/attachment-0003.htm
From j_oleary_ed at yahoo.ca  Sat Jan  3 14:32:42 2004
From: j_oleary_ed at yahoo.ca (Jim OLeary)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] CANNOT FIND mod_python
Message-ID: <000b01c3d249$83b0e640$6400a8c0@infoserve.net>

I have Apache 2.0.48(Win32), mod_python 3.0.4 and Python 2.3.2. When I set
up the PythonHandler as mptest.py as indicated in the documention for
mod_python, the browser can find mypython.py. However, when I switch the
handler in httpd.conf as suggested to:
 
PythonHandler mod_python.publisher
 
I get a 404, cannot find mypython.py
 
I know that it is finding the modules/mod_python.so file because Apache
gives me an error if I hide it.
 
Any suggestions?
 
Thanks
 
Jim OLeary
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040103/66dd2090/attachment-0003.htm
From eurleif at ecritters.biz  Sun Jan  4 02:49:15 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
Message-ID: <3FF7C57A.2090002@ecritters.biz>

Sorry for the newbie question, but how do I parse query strings, handle 
POST data, and such? Is there a library I should be using?

From manfred.stienstra at dwerg.net  Sun Jan  4 12:55:40 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Newbie: how do I parse query strings and such?
In-Reply-To: <3FF7C57A.2090002@ecritters.biz>
References: <3FF7C57A.2090002@ecritters.biz>
Message-ID: <1073217340.10014.3.camel@ack.dwerg.net>

On Sun, 2004-01-04 at 08:49, Leif K-Brooks wrote:
> Sorry for the newbie question, but how do I parse query strings, handle 
> POST data, and such? Is there a library I should be using?

In the util module, there is a FieldStorage object.

fs = util.FieldStorage(request, True)

http://www.modpython.org/live/current/doc-html/pyapi-util-fstor.html

If you don't like it, you free to do it some other way (:

Manfred

From rmangaliag at slu.edu.ph  Mon Jan  5 15:19:29 2004
From: rmangaliag at slu.edu.ph (ali)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] a newbie on sessions and psp
Message-ID: <003301c3d35c$41e53c20$da19a8c0@slu.edu.ph>

hi.. am a modpyton newbie...

can someone please give me an example of sessions applied in psp...

thanks...

ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040105/e3c5c90f/attachment-0003.htm
From dwmp at opti.cgi.net  Mon Jan  5 01:41:02 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] OutputFilter example
Message-ID: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>


In the example of the output filter in the 3.1.2b documentation the last 
lines seem to indicate that filter.close() should only be called if 
filter.read() returns None.  I paired up an output filter this evening with 
the mod_python.psp handler and I was getting an empty string on the last 
filter.read() for every request.  The example code only calls 
filter.close() if the last read result is None.  Not calling filter.close() 
on the first call caused the output filter handler to be called a second 
time.  The second time around, it tried to read from filter.read() and got 
None, therefore calling filter.close() and ending the cycle.  Should this 
be normal behavior or should I be calling filter.close() when filter.read() 
returns empty string as well?

My server config:

     AddHandler mod_python .psp
     PythonHandler mod_python.psp | .psp
     PythonOutputFilter mypackage.mymodule TESTFILTER
     AddOutputFilter TESTFILTER .psp


-Dan

From eurleif at ecritters.biz  Mon Jan  5 02:40:33 2004
From: eurleif at ecritters.biz (Leif K-Brooks)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Are there any good examples?
Message-ID: <3FF914F1.50609@ecritters.biz>

I'm trying to learn to use mod_python well, and I can't find too many 
examples to learn from. Is there a site with examples somewhere?

From davidf at sjsoft.com  Mon Jan  5 10:15:34 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] REFRESHING A GRID FROM ANOTHER FORM
In-Reply-To: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
References: <000101c3d248$3c485f00$6400a8c0@infoserve.net>
Message-ID: <3FF91D26.2090109@sjsoft.com>

Jim OLeary wrote:

>How do you get a second frame to refresh a grid on a first frame? I have a
>wxGrid on my main frame that is populated from a database.
>  
>
Why are you asking about wxGrid on a mailing list that is about a python 
application server???

>Double clicking a row in that grid brings up a second frame where an individual record is
>displayed. When the user clicks a submit button on the second form, it
>updates the database, then closes the second form. I then want the grid on
>the first frame to refresh. I know that I can access the grid from the
>second frame because if I code:
> 
>frame.grid.Destroy()
> 
>it destroys the grid on the first frame. But this has no effect:
> 
>frame.grid.ForceRefresh()
> 
>Any suggestions?
>  
>
You probably are asking these questions on the wrong list. If not please 
confirm and clarify, as this is not a wxWindows mailing list...

David
From fowlertrainer at anonym.hu  Mon Jan  5 09:46:10 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <84772282.20040105094610@anonym.hu>

Hi !

I want to control my website with only one py file: the main.py.
But I got experience with one ugly thing in mod_python.

In mod_php, the main.php file is can include many files, and all of
them can include many other files.
When I modify some or one of these files, the website is refreshed.

But in mod_python, I cannot use the include, I have only one way to share/split my sources: the import.
It is ok, but when I modify some of these imported files, the website is not refreshed !!!

My solution in this time to I use only one file.
It is not too good, because it is growing too much, and I cannot
separate it to units.

Have any solution to this problem ????

Thanx for any advance !!!

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From fowlertrainer at anonym.hu  Mon Jan  5 09:47:34 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Zope Access Rule in mod_py
Message-ID: <754856212.20040105094734@anonym.hu>

Hi !

My problem is that.
I want to use only one main.py file in my mod_python site.
But I want to handle some virtual paths.

So the structure is:
- root+
------+main.py

I want to this:

When the user type this path:
http://root/users/files/work1
then the Apache don't raise an error, only call a py file's procedure with this path.

I can take this path, and do anything what I needed. If the path is wrong, I can show error message, if not, 
I can show the result. In the example the path is don't exists, but I redirect the process to the my UserFileHandler method,
and I do get this user file named "Work1".

This is just like Access Rule in Zope.

Can I do that in mod_python ?

Thanx:
 KK



From fowlertrainer at anonym.hu  Mon Jan  5 09:50:28 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Session handling: example needed
Message-ID: <1835030833.20040105095028@anonym.hu>

Hi !

My problem is that: I want to create a site with session handling.
But: the mod_python Cookie or Session handling is not working in my
machine, or I have some wrong trying with this.

Anyone has an working example, what I can try ?

{
My idea is that: I set an special named cookie in browser.
The cookie's value is the session id.
When it is setted, the req is get the sid, and get the session data
from session dictionary with sid.
It is wrong way ?
}


Thanx for any advance !
KK


From fowlertrainer at anonym.hu  Mon Jan  5 09:55:17 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] One file controlled site: howto
Message-ID: <1245319669.20040105095517@anonym.hu>

Hello !

I want to control my website with one file, the main.py.
I want that:
 - the index, or index.html, or the empty request is redirected to
   main.py
   http://rootdir/index
   http://rootdir/index.html
   http://rootdir/index.htm
   http://rootdir/main
   http://rootdir/

   is let same thing, everyone is let load the main.py.
   
 - the main.py is let hidden in request !
   or if it is not possible, the .py is let hidden !
   So the site is let used with this:
   http://rootdir/
   or
   http://rootdir/main
   and not
   http://rootdir/main.py


Can anyone help me with this tricks ?

Thanx:
 KK


From ograf at rz-online.net  Mon Jan  5 12:19:12 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
Message-ID: <20040105111912.GJ25566@rz-online.net>

[already send this to python-dev@httpd.apache.org, but got nothing
back...]

Hi!

The resolve_object method does not work with class instances.

The error is simple: in line 551 there is a if

        if silent and not hasattr(module, obj_str):
            return None

this checks always module for obj_str. But it should check the current
obj in traversal!

So correct would be:

        if silent and not hasattr(obj, obj_str):
            return None

Regards,
  Oliver.

-------------- next part --------------
--- mod_python-3.1.2b/lib/python/mod_python/apache.py.orig	2004-01-05 11:16:44.000000000 +0100
+++ mod_python-3.1.2b/lib/python/mod_python/apache.py	2004-01-05 11:16:53.000000000 +0100
@@ -552,7 +552,7 @@
             return None
 
         # this adds a little clarity if we have an attriute error
-        if obj == module and not hasattr(module, obj_str):
+        if obj == module and not hasattr(obj, obj_str):
             if hasattr(module, "__file__"):
                 s = "module '%s' contains no '%s'" % (module.__file__, obj_str)
                 raise AttributeError, s
From ograf at rz-online.net  Mon Jan  5 12:26:28 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] error in mod_python.apache.resolve_object
In-Reply-To: <20040105111912.GJ25566@rz-online.net>
References: <20040105111912.GJ25566@rz-online.net>
Message-ID: <20040105112628.GK25566@rz-online.net>

On Mon, Jan 05, 2004 at 12:19:12PM +0100, Oliver Graf wrote:
> [already send this to python-dev@httpd.apache.org, but got nothing
> back...]
> 
> Hi!
> 
> The resolve_object method does not work with class instances.

actually this should read 'does not work with object subpaths'...

So any module::obj.subobj.method handler should not work without the
patch...

Oliver.

From kevin at sb.org  Mon Jan  5 07:38:27 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <84772282.20040105094610@anonym.hu>
References: <84772282.20040105094610@anonym.hu>
Message-ID: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>

There's an easy solution:

Keep a table of the modification dates of the relevant modules. In your 
handler function, compare the modification dates you stored with the 
current ones, and if any differ call reload() on that module.

If you want an example, ask me and I can make one. But it shouldn't be 
too hard to do on your own.

HTH,
Kevin

On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:

> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
>
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
>
> But in mod_python, I cannot use the include, I have only one way to 
> share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the website 
> is not refreshed !!!
>
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
>
> Have any solution to this problem ????

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:46:01 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <754856212.20040105094734@anonym.hu>
References: <754856212.20040105094734@anonym.hu>
Message-ID: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Well, that URL isn't valid. I assume you mean something like

http://my.domain.com/root/users/files/work1

right?

That's not hard. There's a few variations on the solution:

1) If you want it to only work for valid directory trees (i.e. 
/root/users/files/work1 is valid but /root/foo/bar wouldn't be, 
assuming /root/foo doesn't exist) then you can use a <Directory> 
directive. Stick a SetHandler python-program and PythonHandler main in 
there (assuming the directory with main.py will be in the Python path, 
i.e. if the main.py is in the directory specified in the <Directory> 
directive. If it's not there, use the PythonPath directive to tell it 
where to look).

2) If you want it to work for all paths that match a pattern (say, all 
paths starting with /root/) then use a <Files> directive and set the 
same handlers as #1. Same caveats with the python include path.

3) If you want it to apply to every single request to your site, add 
the handlers from #1 in the root level of your httpd.conf file. Same 
caveats apply to the include path for main.py (although since this 
isn't nested, it's just the default Python path so you'll need to add 
the directory for main.py, such as sys.path+['/foo'])

HTH,
Kevin

On Jan 5, 2004, at 3:47 AM, fowlertrainer@anonym.hu wrote:

> I want to this:
>
> When the user type this path:
> http://root/users/files/work1
> then the Apache don't raise an error, only call a py file's procedure 
> with this path.
>
> I can take this path, and do anything what I needed. If the path is 
> wrong, I can show error message, if not,
> I can show the result. In the example the path is don't exists, but I 
> redirect the process to the my UserFileHandler method,
> and I do get this user file named "Work1".
>
> This is just like Access Rule in Zope.
>
> Can I do that in mod_python ?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From kevin at sb.org  Mon Jan  5 07:49:29 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:31 2004
Subject: [mod_python] Zope Access Rule in mod_py
In-Reply-To: <1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
References: <754856212.20040105094734@anonym.hu>
	<1E1C2524-3F7D-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <9A4F92CA-3F7D-11D8-9AD2-000A95A072FC@sb.org>

Erm, I mean a <Location> directive.

On Jan 5, 2004, at 7:46 AM, Kevin Ballard wrote:

> 2) If you want it to work for all paths that match a pattern (say, all 
> paths starting with /root/) then use a <Files> directive and set the 
> same handlers as #1. Same caveats with the python include path.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From vincent_delft at yahoo.com  Mon Jan  5 09:55:57 2004
From: vincent_delft at yahoo.com (vincent delft)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <20040105175557.63346.qmail@web11501.mail.yahoo.com>

Draco does what Kevin explain.
Among other, allows you to use the "inclide" like in
PHP.

(check the "links" page).



--- Kevin Ballard <kevin@sb.org> wrote:
> There's an easy solution:
> 
> Keep a table of the modification dates of the
> relevant modules. In your 
> handler function, compare the modification dates you
> stored with the 
> current ones, and if any differ call reload() on
> that module.
> 
> If you want an example, ask me and I can make one.
> But it shouldn't be 
> too hard to do on your own.
> 
> HTH,
> Kevin
> 
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu
> wrote:
> 
> > I want to control my website with only one py
> file: the main.py.
> > But I got experience with one ugly thing in
> mod_python.
> >
> > In mod_php, the main.php file is can include many
> files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the
> website is refreshed.
> >
> > But in mod_python, I cannot use the include, I
> have only one way to 
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported
> files, the website 
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too
> much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
> 
> -- 
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

__________________________________
Do you Yahoo!?
Find out what made the Top Yahoo! Searches of 2003
http://search.yahoo.com/top2003
From brianh at exelixis.com  Mon Jan  5 11:31:56 2004
From: brianh at exelixis.com (Brian Hawthorne)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
In-Reply-To: <0F3FF02C-3F7C-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <Pine.GSO.4.44.0401051125160.28612-100000@timeless.exelixis.com>

be careful though; there are some hidden gotchas lurking in this solution.
for example, if you reload a module defining some base class, but don't
reload all modules defining subclasses of that base, then the base class
object will no longer be the same as the corresponding base class object
in the __bases__ list for subclasses, and isinstance(sub, base) will fail
(leading to other failures, like the new builtin 'super' won't work
properly).

i did a lot of head scratching before i figured this out; but if all
you're reloading are static configuration modules exporting simple things
like constant immutable string or numeric variables, you should be ok.

cheers,
brian


On Mon, 5 Jan 2004, Kevin Ballard wrote:

> There's an easy solution:
>
> Keep a table of the modification dates of the relevant modules. In your
> handler function, compare the modification dates you stored with the
> current ones, and if any differ call reload() on that module.
>
> If you want an example, ask me and I can make one. But it shouldn't be
> too hard to do on your own.
>
> HTH,
> Kevin
>
> On Jan 5, 2004, at 3:46 AM, fowlertrainer@anonym.hu wrote:
>
> > I want to control my website with only one py file: the main.py.
> > But I got experience with one ugly thing in mod_python.
> >
> > In mod_php, the main.php file is can include many files, and all of
> > them can include many other files.
> > When I modify some or one of these files, the website is refreshed.
> >
> > But in mod_python, I cannot use the include, I have only one way to
> > share/split my sources: the import.
> > It is ok, but when I modify some of these imported files, the website
> > is not refreshed !!!
> >
> > My solution in this time to I use only one file.
> > It is not too good, because it is growing too much, and I cannot
> > separate it to units.
> >
> > Have any solution to this problem ????
>
> --
> Kevin Ballard
> kevin@sb.org
> http://www.tildesoft.com
> http://kevin.sb.org
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From neel at mediapulse.com  Mon Jan  5 14:33:55 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_php vs mod_py - include vs. import
Message-ID: <C0FC22C08B82074A88B500617641577787A7FD@johnson.mediapulse.net>

We use the reload method here, if PythonDebug is set to on, basically:

    debug = req.get_config().has_key('PythonDebug')

    if debug:
        reload(www_forms)
        reload(globals)

See the python docs on reload before using, it doesn't work in all
cases.  I also think there was a mention on the list of an apache.import
method to use so this wouldn't be needed, so you may want to do some
searching on the archives; not sure if it was a mod_python thing or a
patch someone did.

Mike

> -----Original Message-----
> From: fowlertrainer@anonym.hu [mailto:fowlertrainer@anonym.hu] 
> Sent: Monday, January 05, 2004 3:46 AM
> To: mod_python@modpython.org
> Subject: [mod_python] mod_php vs mod_py - include vs. import
> 
> 
> Hi !
> 
> I want to control my website with only one py file: the main.py.
> But I got experience with one ugly thing in mod_python.
> 
> In mod_php, the main.php file is can include many files, and all of
> them can include many other files.
> When I modify some or one of these files, the website is refreshed.
> 
> But in mod_python, I cannot use the include, I have only one 
> way to share/split my sources: the import.
> It is ok, but when I modify some of these imported files, the 
> website is not refreshed !!!
> 
> My solution in this time to I use only one file.
> It is not too good, because it is growing too much, and I cannot
> separate it to units.
> 
> Have any solution to this problem ????
> 
> Thanx for any advance !!!
> 
> -- 
> Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From kevin at sb.org  Mon Jan  5 15:30:37 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Internal Server Errors on restart
Message-ID: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>

I've found some odd problems with mod_python. The big one is that if I 
ever do a restart of my apache server (graceful or not), the next time 
I access a python script, I get an internal server error, and this 
persists until I shut down the server, wait for all the processes to 
die off, and then start it back up. Also, nothing is put in the error 
log for the Internal Server Error, which is also strange.

Does anybody have any information on this?

Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS 
X Panther Server without actually running it by hand (i.e. replacing 
all the standard access to Apache 1.3 through things like Server Admin 
with access to Apache 2). Yes, Apache 2 comes on Panther Server, but 
it's hidden in /opt/apache2/ and there's no GUI way to access it.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From michael at dynamine.net  Mon Jan  5 12:46:23 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <3FF9CD1F.5010304@dynamine.net>

Kevin Ballard wrote:
> I've found some odd problems with mod_python. The big one is that if I 
> ever do a restart of my apache server (graceful or not), the next time I 
> access a python script, I get an internal server error, and this 
> persists until I shut down the server, wait for all the processes to die 
> off, and then start it back up. Also, nothing is put in the error log 
> for the Internal Server Error, which is also strange.
> 
> Does anybody have any information on this?

I don't know, but I have the same problem (running Panther as well).

> Oh, and semi-off-topic - is there any way to enable Apache 2 on Mac OS X 
> Panther Server without actually running it by hand (i.e. replacing all 
> the standard access to Apache 1.3 through things like Server Admin with 
> access to Apache 2). Yes, Apache 2 comes on Panther Server, but it's 
> hidden in /opt/apache2/ and there's no GUI way to access it.

If there is a way, I'm unaware of it.  The documentation says the 
installation in /opt/apache2 is "for experimental purposes."  Don't try 
to use it for mod_python though, because the apxs configuration is wrong 
and it won't compile properly.  (I did my own Apache 2 installation in 
/usr/local/apache2.)

I use mod_proxy on the front-end Apache 1.3 server to pass through 
mod_python requests to the back-end Apache 2.0 server.

--Michael
From grisha at modpython.org  Mon Jan  5 21:58:24 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <20040105215701.M19958@onyx.ispol.com>


I think this is the way it's supposed to work.

On Mon, 5 Jan 2004, Dan W. wrote:

>
> In the example of the output filter in the 3.1.2b documentation the last
> lines seem to indicate that filter.close() should only be called if
> filter.read() returns None.  I paired up an output filter this evening with
> the mod_python.psp handler and I was getting an empty string on the last
> filter.read() for every request.  The example code only calls
> filter.close() if the last read result is None.  Not calling filter.close()
> on the first call caused the output filter handler to be called a second
> time.  The second time around, it tried to read from filter.read() and got
> None, therefore calling filter.close() and ending the cycle.  Should this
> be normal behavior or should I be calling filter.close() when filter.read()
> returns empty string as well?
>
> My server config:
>
>      AddHandler mod_python .psp
>      PythonHandler mod_python.psp | .psp
>      PythonOutputFilter mypackage.mymodule TESTFILTER
>      AddOutputFilter TESTFILTER .psp
>
>
> -Dan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Mon Jan  5 22:57:41 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Internal Server Errors on restart
In-Reply-To: <3FF9CD1F.5010304@dynamine.net>
References: <05992D35-3FBE-11D8-9AD2-000A95A072FC@sb.org>
	<3FF9CD1F.5010304@dynamine.net>
Message-ID: <79B6A1A3-3FFC-11D8-9AD2-000A95A072FC@sb.org>

Well, *that's* silly. I simply edited the .mk files in 
/opt/apache2/build to remove the -arch i386 strings from a few lines 
and it compiled just fine!

On Jan 5, 2004, at 3:46 PM, Michael S. Fischer wrote:

> If there is a way, I'm unaware of it.  The documentation says the 
> installation in /opt/apache2 is "for experimental purposes."  Don't 
> try to use it for mod_python though, because the apxs configuration is 
> wrong and it won't compile properly.  (I did my own Apache 2 
> installation in /usr/local/apache2.)
>
> I use mod_proxy on the front-end Apache 1.3 server to pass through 
> mod_python requests to the back-end Apache 2.0 server.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From dwmp at opti.cgi.net  Mon Jan  5 22:50:57 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] OutputFilter example
In-Reply-To: <20040105215701.M19958@onyx.ispol.com>
References: <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
 <5.2.1.1.2.20040105011827.03461dc0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040105224658.01196ec8@mail.pyxos.com>


I don't see why two calls would make sense.  On the second call the headers 
have already been sent, so I can't modify those and the body has already 
been sent as well and the very first call to filter.read() returns 
None.  On the other hand, if I do filter.close() when I receive empty 
string from filter.read() then I only end up with one call to my output 
filter and everything works normally.

-Dan



At 09:58 PM 1/5/2004 -0500, you wrote:

>I think this is the way it's supposed to work.
>
>On Mon, 5 Jan 2004, Dan W. wrote:
>
> >
> > In the example of the output filter in the 3.1.2b documentation the last
> > lines seem to indicate that filter.close() should only be called if
> > filter.read() returns None.  I paired up an output filter this evening with
> > the mod_python.psp handler and I was getting an empty string on the last
> > filter.read() for every request.  The example code only calls
> > filter.close() if the last read result is None.  Not calling filter.close()
> > on the first call caused the output filter handler to be called a second
> > time.  The second time around, it tried to read from filter.read() and got
> > None, therefore calling filter.close() and ending the cycle.  Should this
> > be normal behavior or should I be calling filter.close() when filter.read()
> > returns empty string as well?
> >
> > My server config:
> >
> >      AddHandler mod_python .psp
> >      PythonHandler mod_python.psp | .psp
> >      PythonOutputFilter mypackage.mymodule TESTFILTER
> >      AddOutputFilter TESTFILTER .psp
> >
> >
> > -Dan
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >

From dwmp at opti.cgi.net  Mon Jan  5 23:44:34 2004
From: dwmp at opti.cgi.net (Dan W.)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] PythonOption and PythonImport
Message-ID: <5.2.1.1.2.20040105234211.0394ad68@mail.pyxos.com>


Is there any way to get to PythonOptions from the PythonImport startup 
script?  From the documentation it appears as though I can only get to 
PythonOptions from the request object.

-Dan

From jay at jaydorsey.com  Tue Jan  6 09:39:44 2004
From: jay at jaydorsey.com (Jay Dorsey)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] One file controlled site: howto
In-Reply-To: <1245319669.20040105095517@anonym.hu>
References: <1245319669.20040105095517@anonym.hu>
Message-ID: <20040106153944.GA3462@gentoo.Earthlink.net>

On Mon, Jan 05, 2004 at 09:55:17AM +0100, fowlertrainer@anonym.hu wrote:
> Hello !
> 
> I want to control my website with one file, the main.py.
> I want that:
<snip>    
>  - the main.py is let hidden in request !
You can do this with mod_python by adding a request handler 
in your httpd.conf file, similar to this:

<Directory /path/to/webroot>
AddHandler python-program
PythonHandler main
</Directory>

The main.py script will be executed each time a document is 
requested in the /path/to/webroot folder.


hth


-- 
Jay Dorsey
jay at jaydorsey dot com
From jalil at securia.com  Tue Jan  6 17:40:20 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Params submitted using utf-8
Message-ID: <3FFB6384.2010408@securia.com>

    I have a form that submits some text using utf-8 encoding and I 
process the form using  mod_python on Apache.

- When I read in a parameter value and print the type of the string, it 
is "str" and not "unicode". I know unicode is not "utf-8" and I think 
this is fine

- When I try to decode the value into "utf-8" and turn it into unicode 
in python, I get an exception (decoding error - invalid data). Why is 
that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
so why I get invalid data?

- The reason I decided doing above is that I have a table in MySQL which 
is using
utf-8 character sets. Everything works fine if I put the received data 
directly into my table and read it back and send it to browser but two 
problems happen if I do this. First, some characters don't display 
right. Second, althought I set the charset in my returned data to utf-8, 
the browser doesn't select utf-8 as encoding. So, I thought maybe I 
should try to convert into unicode b/f putting the data into my table. 
Is this right? Should I  do anything b/f storing and/or sending the data?

I appriciate any help.

-Jalil


From robert at leftwich.info  Wed Jan  7 15:09:07 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150406.01b14d70@192.168.0.1>

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt)
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From dwmp at opti.cgi.net  Tue Jan  6 22:18:27 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] AddOutputFilterByType
Message-ID: <5.2.1.1.2.20040106213833.03ad4420@mail.pyxos.com>


I'm running a PSP script which outputs a PNG image.  The PSP script sets 
the req.content_type to image/png but its still going through a mod_python 
filter I have setup with AddOutputFilterByType.  The AddOutputFilterByType 
is setup for two types, text/html and text/plain.  Does changing 
req.content_type not update the Apache info before it gets to the filtering 
stage?  Can this be fixed?

-Dan
mod_python: 3.1.2b
apache: 2.0.48
python: 2.3.2
linux: 2.4


From robert at leftwich.info  Wed Jan  7 15:23:26 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>

Sorry - finger trouble on the first attempt:

I'm running into a problem when using mod_python on an older SMP machine 
running windows
The setup is Windows 2000, dual Celeron processors, Apache 2.0.48, 
mod_python 3.0.4, python 2.3.3. I have 2 locations served by mod_python, 
the first is a generic XSL transformer service (performed via the Python 
bindings for libxslt) and the second serves up some xml after first 
filtering it (again via libxslt). The problem I have is when I ask the 
first service to run some xsl on an xml file where the xsl uses the 
document() function to access the second service, the second service is 
never accessed and there is nothing in any of the logs to suggest otherwise.
I tried setting mod_python to use different child interpreters but it made 
no difference. Some googling turned up 
(http://www.modpython.org/pipermail/mod_python/2003-June/003307.html) 
where Grisha says in answer to Paul Robinson:

"> For example, on a Windows platform where there is a single
 > multi-threaded Apache process (mpm_wint
 > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
 > say that mod_python would not be able to take advantage of a
 > multi-processor machine due to the GIL?

The answer, unfortunately, is yes. Here is a google search that has some
info on the subject: http://www.google.com/search?q=python+free-threading

AFAIK the state of things has not changed with respect to SMP and GIL."

So it appears that I am running into this limitation. Is there any 
alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
useable?

Robert
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From manfred.stienstra at dwerg.net  Wed Jan  7 07:32:31 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <1073457151.15608.15.camel@ack.dwerg.net>

On Wed, 2004-01-07 at 02:40, jalil@securia.com wrote:
> - When I read in a parameter value and print the type of the string, it 
> is "str" and not "unicode". I know unicode is not "utf-8" and I think 
> this is fine

Yes, this should be a utf-8 encoded string. Personally I think no
application should convert this data to a unicode object because you
always want to know the encoding it came from. For example utf-8 ->
unicode object -> iso8859-15 could mean loss of characters.

> - When I try to decode the value into "utf-8" and turn it into unicode 
> in python, I get an exception (decoding error - invalid data). Why is 
> that? HTML uses Unicode codepoints and I am sending in utf-8 encoding, 
> so why I get invalid data?

Are you using the unicode constructor or an decode method? Also, a bad
browser could send something that is not unicode, you should always
expect unicode errors here.

Here is a nice introduction to the whole encode/decode confusion:

http://www.vandervossen.net/2003/07/unicode_in_python

> Second, althought I set the charset in my returned data to utf-8, 
> the browser doesn't select utf-8 as encoding.

If the document isn't utf-8 encoded and the headers claim it is, the
browser could try to correct it and show the proper encoding.

> So, I thought maybe I 
> should try to convert into unicode b/f putting the data into my table. 
> Is this right? Should I  do anything b/f storing and/or sending the data?

Yes, you should check the input. You don't have to do this by converting
the string into a unicode object, but you can do it by checking the byte
ordering (see the utf-8 specifications for more information).

Manfred

From ograf at rz-online.net  Wed Jan  7 08:22:01 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040107072201.GD3045@rz-online.net>

On Wed, Jan 07, 2004 at 03:23:26PM +1100, Robert Leftwich wrote:
> "> For example, on a Windows platform where there is a single
> > multi-threaded Apache process (mpm_wint
> > [http://httpd.apache.org/docs-2.0/mod/mpm_winnt.html]) is it correct to
> > say that mod_python would not be able to take advantage of a
> > multi-processor machine due to the GIL?
> 
> The answer, unfortunately, is yes. Here is a google search that has some
> info on the subject: http://www.google.com/search?q=python+free-threading
> 
> AFAIK the state of things has not changed with respect to SMP and GIL."
> 
> So it appears that I am running into this limitation. Is there any 
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not 
> useable?

Out of my stomach I would answer: this is an apache topic, mod_python
will do whatever apache can do. So If there is a mpm for apache under
win32 that does forks (no mpm_prefork for win32? can't believe this,
but I never used this win32 platform...) mod_python should behave well
with SMP...

Oliver.

P.S.: If I am wrong, I'm really interested why. :)

From blazek at firma.seznam.cz  Wed Jan  7 09:59:54 2004
From: blazek at firma.seznam.cz (Vaclav Blazek)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040107072201.GD3045@rz-online.net>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
	<20040107072201.GD3045@rz-online.net>
Message-ID: <200401070959.54180.blazek@firma.seznam.cz>

Dne st 7. ledna 2004 08:22 Oliver Graf napsal(a):
> Out of my stomach I would answer: this is an apache topic, mod_python
> will do whatever apache can do. So If there is a mpm for apache under
> win32 that does forks (no mpm_prefork for win32? can't believe this,
> but I never used this win32 platform...) mod_python should behave well
> with SMP...
>
> Oliver.
>
> P.S.: If I am wrong, I'm really interested why. :)

Hallo,

fork() (process duplication) is unix specific feature, no other kind of system 
has it. On non-unix platforms you have to use threading instead. But as you 
know, threads are evil :-). You can be sure you propperly synchronize 
everything but... just try to close one file descriptor twice and disaster is 
near at hand...

Vasek

PS I've heard the new version of OpenVMS will have fork().

From fowlertrainer at anonym.hu  Wed Jan  7 10:09:27 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Have the mod_python an example store on web... ?
Message-ID: <306091519.20040107100927@anonym.hu>

Hello mod,

  ... or other site, what have online FAQ, or other ?
  I have some modules, and I send these modules, if needed.
  (A persistent DB connection pool, and a session manager tool)

  I want to send it/share it, because I use win32 mod_py, and I want to remove
  bugs (by found another users), and to help the mod_python to staying
  alive/growing/advancing.

  I want to learn the mod_py, get more and more knowledge, and I
  possible, share these informations with anothers.

  Thanx.

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From kevin at sb.org  Wed Jan  7 11:02:42 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Params submitted using utf-8
In-Reply-To: <3FFB6384.2010408@securia.com>
References: <3FFB6384.2010408@securia.com>
Message-ID: <ECE51A3C-412A-11D8-9AD2-000A95A072FC@sb.org>

To make the browser display as UTF-8, you need to tell it to do that 
either in the headers or in a <meta> tag in the source.

On Jan 6, 2004, at 8:40 PM, jalil@securia.com wrote:

> - The reason I decided doing above is that I have a table in MySQL 
> which is using
> utf-8 character sets. Everything works fine if I put the received data 
> directly into my table and read it back and send it to browser but two 
> problems happen if I do this. First, some characters don't display 
> right. Second, althought I set the charset in my returned data to 
> utf-8, the browser doesn't select utf-8 as encoding. So, I thought 
> maybe I should try to convert into unicode b/f putting the data into 
> my table. Is this right? Should I  do anything b/f storing and/or 
> sending the data?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From spoerri at duke.edu  Thu Jan  8 10:33:40 2004
From: spoerri at duke.edu (Christoph Spoerri)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] RE: Session handling: example needed
Message-ID: <200401081033.40738.spoerri@duke.edu>

Hi list users,

I saw that recently somebody added for an example of using the session 
handler. I was looking for the same with out any luck, but was able to get 
things working (love the trial-and-error stuff ;) ).

I have attached a short script that uses two counters (int and object) to 
count the number of visits by the users during a session.

Notes:
- use is_new() to check if you have a new session or not before you use it (as 
mentioned in the manual)
- you need to save the session object at the end otherwise, the ID and any 
other stuff won't be saved (!), and you'll be wondering what happend to the 
session (as I did).

cheers,
Christoph

PS: I'm new to python, so forgive me any strange python coding.

***************** session_sample.py ***********************

from mod_python import apache

class simpelCountClass:
	count = 0
	def __init__(self,c):
		self.count = c
	def increment(self):
		self.count = self.count+1
	def asString(self):
		return str(self.count)


def sessionTest(req):
	req.content_type = "text/html"
	s = "<html><body>testing<br>"

	t = Session.DbmSession(req)
	if (t.is_new()):
		s += "new session id: "+str(t.id())+"<br>"
		t['count']=1
		t['countObj']=simpelCountClass(1)

	else:
		s += "session id: "+str(t.id())+"<br>"
		t['count']=t['count']+1
		t['countObj'].increment()

	s += "count: "+str(t['count'])+"<br>"
	s += "countObj: "+t['countObj'].asString()+"<br>"
	s += "timeout: "+str(t.timeout())+"<br>"
	s += "created: "+str(t.created())+"<br>"
	s += "last_accessed: "+str(t.last_accessed())+"<br>"
	s += "</body></html>"
	t.save() # DON'T FORGET THIS ONE!!!
	return s

From dg at sponsera.com  Thu Jan  8 14:30:26 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFDAFD2.1010708@sponsera.com>

Help!

I have the weirdest problem - I am using the following:

redhat9
mysql 4.0.13
mod_python 3.0.4
python 2.2.3
MySQL-python 0.9.2 (python interface to the mysql libraries)
apache 2.0.47

When I run ordinary python programs to access the mysql database, things 
seem to work fine. (i can connect to the database, so selects, updates, etc)

When I run identical queries under mod_python via request to apache, 
apache tends to core dump on database accesses - or sometimes, doesn't 
core dump but I get very strange,inconsistant results.

Any ideas? Are "threads" an issue? I am almost positive the python 
enviornment that apache is getting is the same as the "normal" environment.

I just have no idea why this is happening - I have used mod_python w/ 
mysql before, with generally very good results.

Thanks a lot!

David





From chip at force-elite.com  Thu Jan  8 11:44:24 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDAFD2.1010708@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com>
Message-ID: <3FFDB318.2090401@force-elite.com>

Are you running mod_auth_mysql or any other apache modules that use 
MySQL Client Connections?

Make sure they are all compiled with the exact same client lib versions..

Also, did you build from source, or are you using someones RPMs?

-Paul Querna

David Geller wrote:
> Help!
> 
> I have the weirdest problem - I am using the following:
> 
> redhat9
> mysql 4.0.13
> mod_python 3.0.4
> python 2.2.3
> MySQL-python 0.9.2 (python interface to the mysql libraries)
> apache 2.0.47
> 
> When I run ordinary python programs to access the mysql database, things 
> seem to work fine. (i can connect to the database, so selects, updates, 
> etc)
> 
> When I run identical queries under mod_python via request to apache, 
> apache tends to core dump on database accesses - or sometimes, doesn't 
> core dump but I get very strange,inconsistant results.
> 
> Any ideas? Are "threads" an issue? I am almost positive the python 
> enviornment that apache is getting is the same as the "normal" environment.
> 
> I just have no idea why this is happening - I have used mod_python w/ 
> mysql before, with generally very good results.
> 
> Thanks a lot!
> 
> David
> 
> 
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From pkeshishian at yahoo.com  Thu Jan  8 12:05:53 2004
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] Re: mysqldb / mod_python problem
In-Reply-To: <3FFDB598.1050608@sponsera.com>
Message-ID: <20040108200553.58614.qmail@web40015.mail.yahoo.com>

Hi David:
 
I did not really find any solution for my problem. The main problem I had was that mod_python was working when I was trying to select a single column, but it was failing in case of 2 or more columns. Since the database I am running is very small I just wrote a python function that queries each column separately than puts them together and returns the result. Since my database is very small the slowdown is insignificant. But it won't be recommended for large databases, and it is not really a solution. I believe this problem deserves a more serious consideration.
 
Cheers,
Petros
 

David Geller <dg@sponsera.com> wrote:
Hi Petros -

I read your posting in the [mod_python] list Dec 30, 2003 regarding 
problems you were having with Mysql not working under mod_python 
correctly (while "regular" console python progrems seemed to work fine).

Well, I am running into exactly the same, frustrating problem!!! What is 
going on? I can't figure it out, and am about to abandon mod_python.

Did you ever get your problem resolved? I'd be most interested in hearing.

Thanks a lot!

Regards,
David
dg@sponsera.com



---------------------------------
Do you Yahoo!?
Yahoo! Hotjobs: Enter the "Signing Bonus" Sweepstakes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://mailman.modpython.org/pipermail/mod_python/attachments/20040108/612a754e/attachment-0003.htm
From dg at sponsera.com  Thu Jan  8 15:54:56 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDB318.2090401@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
Message-ID: <3FFDC3A0.8010900@sponsera.com>

1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot 
seem to find any references anywhere to such modules....)

2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.

Also, everything (my entire mod_python application, including all mysql 
accessing), seems to run *fine* on my home machine (redhat8-based). It 
is when I have tried running on our redhat-9-based server where these 
problems start to appear....(note that I reuilt all the sources on the 
redhat9 machine...)


Paul Querna wrote:

> Are you running mod_auth_mysql or any other apache modules that use 
> MySQL Client Connections?
>
> Make sure they are all compiled with the exact same client lib versions..
>
> Also, did you build from source, or are you using someones RPMs?
>
> -Paul Querna
>
> David Geller wrote:
>
>> Help!
>>
>> I have the weirdest problem - I am using the following:
>>
>> redhat9
>> mysql 4.0.13
>> mod_python 3.0.4
>> python 2.2.3
>> MySQL-python 0.9.2 (python interface to the mysql libraries)
>> apache 2.0.47
>>
>> When I run ordinary python programs to access the mysql database, 
>> things seem to work fine. (i can connect to the database, so selects, 
>> updates, etc)
>>
>> When I run identical queries under mod_python via request to apache, 
>> apache tends to core dump on database accesses - or sometimes, 
>> doesn't core dump but I get very strange,inconsistant results.
>>
>> Any ideas? Are "threads" an issue? I am almost positive the python 
>> enviornment that apache is getting is the same as the "normal" 
>> environment.
>>
>> I just have no idea why this is happening - I have used mod_python w/ 
>> mysql before, with generally very good results.
>>
>> Thanks a lot!
>>
>> David
>>
>>
>>
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

-- 
David Geller
Sponsera, LLC
dg@sponsera.com
www.sponsera.com
Phone: 703.532.6812
Fax: 703.532.6058



From chip at force-elite.com  Thu Jan  8 13:17:40 2004
From: chip at force-elite.com (Paul Querna)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC3A0.8010900@sponsera.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com>
Message-ID: <3FFDC8F4.7000607@force-elite.com>

David Geller wrote:
> 1. As far as I know, I am not running any other apache modules using 
> MySQL ( I am not sure how to check this out definitely, but I cannot 
> seem to find any references anywhere to such modules....)
> 
> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from source.
> 
> Also, everything (my entire mod_python application, including all mysql 
> accessing), seems to run *fine* on my home machine (redhat8-based). It 
> is when I have tried running on our redhat-9-based server where these 
> problems start to appear....(note that I reuilt all the sources on the 
> redhat9 machine...)

Could you try to get a Backtrace in GDB from the Apache Core Files?
From grisha at modpython.org  Thu Jan  8 18:33:01 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <20040108183117.S67407@onyx.ispol.com>



On Wed, 7 Jan 2004, Robert Leftwich wrote:

> So it appears that I am running into this limitation. Is there any
> alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> useable?

s/Windows/Unix ? ;-)

Grisha
From neel at mediapulse.com  Thu Jan  8 18:58:40 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <C0FC22C08B82074A88B50061764157776B996D@johnson.mediapulse.net>

> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of 
> Windows/Apache2.xx/mod_python/SMP not
> > useable?
> 
> s/Windows/Unix ? ;-)
> 
%s/Windows/Unix/g =)

From khalid_kary at hotmail.com  Fri Jan  9 00:12:48 2004
From: khalid_kary at hotmail.com (Khalid El-Kary)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
Message-ID: <BAY8-F965rrgJGERxKF000142da@hotmail.com>

> > s/Windows/Unix ? ;-)
> >
>%s/Windows/Unix/g =)

Execuse my ignorance, but what do both of them mean ? :-)

Khalid

_________________________________________________________________
MSN 8 with e-mail virus protection service: 2 months FREE* 
http://join.msn.com/?page=features/virus

From dg at sponsera.com  Thu Jan  8 19:26:54 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <3FFDC8F4.7000607@force-elite.com>
References: <3FFDAFD2.1010708@sponsera.com> <3FFDB318.2090401@force-elite.com>
	<3FFDC3A0.8010900@sponsera.com> <3FFDC8F4.7000607@force-elite.com>
Message-ID: <3FFDF54E.4000403@sponsera.com>

I am not quite sure how to do this.

Presumably, I would have to rebuild apache with -g enabled.  Is this 
correct? How do I actually get the core files? (the actual error I have 
been getting is "Segmentation fault")

Thanks!


Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
>> MySQL ( I am not sure how to check this out definitely, but I cannot 
>> seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
>> source.
>>
>> Also, everything (my entire mod_python application, including all 
>> mysql accessing), seems to run *fine* on my home machine 
>> (redhat8-based). It is when I have tried running on our 
>> redhat-9-based server where these problems start to appear....(note 
>> that I reuilt all the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
>



From robert at leftwich.info  Fri Jan  9 14:25:43 2004
From: robert at leftwich.info (Robert Leftwich)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <20040108183117.S67407@onyx.ispol.com>
References: <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
 <5.2.0.9.0.20040107150954.01bb6738@192.168.0.1>
Message-ID: <5.2.0.9.0.20040109140327.01b15748@192.168.0.1>

At 10:33 AM 9/01/2004, Gregory (Grisha) Trubetskoy wrote:

>On Wed, 7 Jan 2004, Robert Leftwich wrote:
>
> > So it appears that I am running into this limitation. Is there any
> > alternative or is the combination of Windows/Apache2.xx/mod_python/SMP not
> > useable?
>
>s/Windows/Unix ? ;-)

Unfortunately the people I'm doing this project for are committed to 
Windows and cannot switch their production boxen (all SMP) to *nix :-((

After looking at a few options it's back to Java/servlets I go .... (at 
least for this project).

Robert

PS Can I suggest that this limitation be highlighted on the website/readme 
as it might save anyone else in the same situation from a lot of wasted 
time/effort. 
-------------- next part --------------

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.557 / Virus Database: 349 - Release Date: 30/12/2003
From davidf at sjsoft.com  Fri Jan  9 06:44:24 2004
From: davidf at sjsoft.com (David Fraser)
Date: Fri Jan  9 22:04:32 2004
Subject: [mod_python] mod_python and SMP
In-Reply-To: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
References: <BAY8-F965rrgJGERxKF000142da@hotmail.com>
Message-ID: <3FFE31A8.2000103@sjsoft.com>

Khalid El-Kary wrote:

>> > s/Windows/Unix ? ;-)
>> >
>> %s/Windows/Unix/g =)
>
>
> Execuse my ignorance, but what do both of them mean ? :-)
>
> Khalid

They are instructions that mean "replace 'Windows' with 'Unix' from sed 
(a command line search and replace tool) and used in other tools such as 
vim (text editor).

David

From dg at sponsera.com  Fri Jan  9 00:12:42 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
In-Reply-To: <000b01c3d66a$d282f0e0$0600a8c0@santana>
References: <000b01c3d66a$d282f0e0$0600a8c0@santana>
Message-ID: <3FFE384A.8010805@sponsera.com>

Thanks, Mike.

While I am not following what you do *exactly*, it is similar.
And as I said, everything runs fine on one machine. (and has for a few 
years with multiple apps). It was an incredible suprise to all of a 
sudden find such difficulty on a new machine.

What *we* do is:
1. Get sources from relevent places as tarballs  - (apache, python, 
msql, MySQLdb, mod_python,....)
2. place sources in /usr/local/src
3. build and compile them there
4. install them in /usr/local

Soooo, python is in /usr/local/lib/python2.2... (execuatable in 
/usr/local/bin as /usr/local/bin/python)
apache is in /usr/local/apache2/...
mysql is in /usr/local/mysql...

And I have confirmed that mod_python is picking up the correct python.

D.

Michael Neel wrote:

>I see a lot of posts about trouble with MySQL and mod_python.  I use
>both in almost every project I do, and have yet to have any of these
>problems.  So here is how we configure a box:
>
>Redhat is used, versions 6x to 9 have been in use.
>We do not install the RPMs of MySQL that come with redhat, but do use
>the RPMs from MySQL's website.
>Apache's have been both compiled from source and RehHat RPMs.  When
>going from source, we use apache toolbox.  We've used both 1.3 and 2.0
>apaches.
>Python is compiled from source, and replaces the redhat version 
>(--prefix=/usr)
>Mod python is compiled from source as well.  This after python is
>installed to make sure it gets set to the same paths as the command
>line.  I never remember what to pass to configure, so I have to edit the
>src/Makefile and add -DEAPI to the opts.
>MySQLdb is installed with a simple python setup.py install
>
>If this helps or not I'm not sure, but I though I'd post it.
>Mike
>
>
>
>  
>



From dg at sponsera.com  Fri Jan  9 00:30:03 2004
From: dg at sponsera.com (David Geller)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] mod_python and mysql - wierd problem!
Message-ID: <3FFE3C5B.9090901@sponsera.com>

Paul Querna wrote:

> David Geller wrote:
>
>> 1. As far as I know, I am not running any other apache modules using 
MySQL ( I am not sure how to check this out definitely, but I cannot
seem to find any references anywhere to such modules....)
>>
>> 2. Yes, I built mysql,mod_python, python, MySQL, apache,.... from 
source.
>>
>> Also, everything (my entire mod_python application, including all 
mysql accessing), seems to run *fine* on my home machine
(redhat8-based). It is when I have tried running on our redhat-9-based
server where these problems start to appear....(note that I reuilt all
the sources on the redhat9 machine...)
>
>
> Could you try to get a Backtrace in GDB from the Apache Core Files?




Stack trace from wierd mod_python/mysql bug obtained!

================== basic program (outline) being run
from mod_python import util
from mod_python import apache
import MySQLdb

def hander(req):

db = MySQLdb.connect(db="quest1",
                          host="localhost",
                          user="dg",
                          passwd="pass")

     c = db.cursor(MySQLdb.cursors.DictCursor)
    sql = """select * from subject"""

     c.execute(sql)
==================================
Note that we get Seg fault on the c.execute().
And note also: with certain sql statements, does not crash but obtain
inconsistant results.


=====================GDB Stack ========================================

(gdb) r
Starting program: /usr/local/apache2/sbin/httpd -DONE_PROCESS
[New Thread 16384 (LWP 17860)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 16384 (LWP 17860)]
0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa) at Python/modsupport.c:334

(gdb) where
#0  0x402f8a92 in do_mkvalue (p_format=0xa, p_va=0xa)
     at Python/modsupport.c:334
#1  0x402f8f9a in do_mktuple (p_format=0xbfffe790, p_va=0xbfffe794,
     endchar=41, n=7) at Python/modsupport.c:223
#2  0x402f88cf in do_mkvalue (p_format=0xbfffe790, p_va=0xbfffe794)
     at Python/modsupport.c:247
#3  0x402f8b4c in Py_VaBuildValue (format=0x0, va=0x0)
     at Python/modsupport.c:428
#4  0x402f8aea in Py_BuildValue (format=0x406ceb95 "(siiiiii)")
     at Python/modsupport.c:399
#5  0x406cce33 in _mysql_ResultObject_describe (self=0x828f160, args=0x0)
     at _mysql.c:737
#6  0x402d6988 in fast_cfunction (func=0x0, pp_stack=0xbfffe8c4, na=-1)
     at Python/ceval.c:3132
#7  0x402d51d5 in eval_frame (f=0x822baec) at Python/ceval.c:2017
#8  0x402d5be3 in PyEval_EvalCodeEx (co=0x81fa500, globals=0x0, locals=0x0,
     args=0x822b73c, argcount=2, kws=0x822b744, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#9  0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#10 0x402d514f in eval_frame (f=0x822b5e4) at Python/ceval.c:2034
#11 0x402d5be3 in PyEval_EvalCodeEx (co=0x8285908, globals=0x0, locals=0x0,
     args=0x82491dc, argcount=2, kws=0x82491e4, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#12 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#13 0x402d514f in eval_frame (f=0x8249064) at Python/ceval.c:2034
#14 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f95d0, globals=0x0, locals=0x0,
     args=0x817341c, argcount=3, kws=0x8173428, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#15 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=3, nk=0)
     at Python/ceval.c:3170
#16 0x402d514f in eval_frame (f=0x81732c4) at Python/ceval.c:2034
#17 0x402d5be3 in PyEval_EvalCodeEx (co=0x81f8df8, globals=0x0, locals=0x0,
     args=0x8173410, argcount=2, kws=0x823b4a0, kwcount=0, defs=0x8289a80,
     defcount=1, closure=0x0) at Python/ceval.c:2595
#18 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=2, nk=0)
     at Python/ceval.c:3170
#19 0x402d514f in eval_frame (f=0x823b32c) at Python/ceval.c:2034
#20 0x402d5be3 in PyEval_EvalCodeEx (co=0x823ef80, globals=0x0, locals=0x0,
     args=0x8233280, argcount=1, kws=0x8233284, kwcount=0, defs=0x0,
     defcount=0, closure=0x0) at Python/ceval.c:2595
#21 0x402d6a1f in fast_function (func=0x0, pp_stack=0x0, n=0, na=1, nk=0)
     at Python/ceval.c:3170
#22 0x402d514f in eval_frame (f=0x82330d4) at Python/ceval.c:2034
#23 0x402d5be3 in PyEval_EvalCodeEx (co=0x81e6b18, globals=0x0, locals=0x0,
     args=0x81d0640, argcount=2, kws=0x0, kwcount=0, defs=0x0, defcount=0,
     closure=0x0) at Python/ceval.c:2595
#24 0x4031a729 in function_call (func=0x822f7d4, arg=0x81d0634, kw=0x0)
     at Objects/funcobject.c:476
#25 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81d0634, kw=0x0)
     at Objects/abstract.c:1688
#26 0x402a3148 in instancemethod_call (func=0x822f7d4, arg=0x81d0634,
kw=0x0)
     at Objects/classobject.c:2315
#27 0x4029d0b8 in PyObject_Call (func=0xffffffff, arg=0x81e99d4, kw=0x0)
     at Objects/abstract.c:1688
#28 0x402d6847 in PyEval_CallObjectWithKeywords (func=0x81cc8b4,
     arg=0x81e99d4, kw=0x0) at Python/ceval.c:3058
#29 0x4029aa8d in PyObject_CallMethod (o=0x0, name=0x81e99d4 "\002",
     format=0x81e99d4 "\002") at Objects/abstract.c:1679
#30 0x402985fc in python_handler (req=0x81bb018,
     phase=0x4031ee18 "PythonHandler") at mod_python.c:899
#31 0x4029973e in PythonHandler (req=0x81bb018) at mod_python.c:1699
#32 0x0807baca in ap_run_handler (r=0x81bb018) at config.c:195
#33 0x0807bfe2 in ap_invoke_handler (r=0x81bb018) at config.c:401
#34 0x0806bd8b in ap_process_request (r=0x81bb018) at http_request.c:288
#35 0x08067f25 in ap_process_http_connection (c=0x81b6fe8) at
http_core.c:293
#36 0x0808493a in ap_run_process_connection (c=0x81b6fe8) at connection.c:85
#37 0x0807a67f in child_main (child_num_arg=0) at prefork.c:694
#38 0x0807a82a in make_child (s=0x80b7118, slot=0) at prefork.c:734
#39 0x0807a883 in startup_children (number_to_start=5) at prefork.c:806
#40 0x0807af75 in ap_mpm_run (_pconf=0x8079f68, plog=0x80ecaf0, s=0x80b7118)
     at prefork.c:1022
#41 0x0807fd02 in main (argc=2, argv=0xbffff404) at main.c:660
#42 0x401415cd in __libc_start_main () from /lib/libc.so.6
(gdb)





From dwmp at opti.cgi.net  Fri Jan  9 00:15:40 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] get_options() problem
Message-ID: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>


According to the 3.1.2b documentation there should be a get_options() 
method on the server object.  When trying to access it I get a traceback.

code (under psp):

req.log_error('options: %s' % `req.server.get_options()`)

error:

AttributeError: 'mp_server' object has no attribute 'get_options'


Does the server.get_options() method no longer exist and is the 
documentation (section 4.5.6.1) just out of date?

I'm trying to get to the DocumentRoot value for the virtual server handling 
the current request and was hoping I might find it in there.

-Dan

From dwmp at opti.cgi.net  Fri Jan  9 00:23:11 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] get_options() problem
In-Reply-To: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109002211.03797eb8@mail.pyxos.com>


I found the DocumentRoot value I was after.  Duh.  req.document_root().

However, that server.get_options() probably needs some looking into.

-Dan



At 12:15 AM 1/9/2004 -0600, you wrote:

>According to the 3.1.2b documentation there should be a get_options() 
>method on the server object.  When trying to access it I get a traceback.
>
>code (under psp):
>
>req.log_error('options: %s' % `req.server.get_options()`)
>
>error:
>
>AttributeError: 'mp_server' object has no attribute 'get_options'
>
>
>Does the server.get_options() method no longer exist and is the 
>documentation (section 4.5.6.1) just out of date?
>
>I'm trying to get to the DocumentRoot value for the virtual server 
>handling the current request and was hoping I might find it in there.
>
>-Dan
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From a.w at quirxi.com  Fri Jan  9 14:12:31 2004
From: a.w at quirxi.com (Arno Wilhelm)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] 
	Newbie question: Fieldstorage is empty in the second handler
Message-ID: <3FFEA8BF.2060408@quirxi.com>

Hello,

I have just started using mod_pyhon and have come to a problem I cannot find an 
solution for:

In my html file there is a hidden input named PATH:

<FORM method="post" action="/qwer/eval.py">
<INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
...
</FORM>

When the form is submitted the PATH variable reaches the authenhandler(req) 
which I can give out to a file:

PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24

but after that it does not reach the following handler(req) function. It always 
raises an KeyError since the PATH variable does not exist in this function anymore !
Can anyone point me to the right direction ?



cheers,

Arno





	

From fowlertrainer at anonym.hu  Fri Jan  9 16:19:41 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] How to globalize vars ???
Message-ID: <17328262299.20040109161941@anonym.hu>

Hello !

I have get a strange problem in mod_python site.
More modules I have, and think, to I initialize my Session handler
from main module.

Like this:

-- main --

import BHASession

# Session info
BHASessionDir="C:/bhaweb/sessions"
#f=open("c:/now.txt","a");f.write(" 1");f.close();
BHASession.SSInit(BHASessionDir)
#f=open("c:/now.txt","a");f.write(" 2");f.close();

-- Session --
f=open("c:/now.txt","a");f.write(" 01");f.close();
#global SSDefaultDir
SSDefaultDir="c:/bhaweb/sessions"
f=open("c:/now.txt","a");f.write(" 02");f.close();
SSLockObj=threading.Lock()

def SSLock():
    SSLockObj.acquire()

def SSUnlock():
    SSLockObj.release()

def SSInit(SessionDir):
    #f=open("c:/now.txt","a");f.write(" 03");f.close();
    SSLock()
    try:
      #global SSDefaultDir
      #r.append(str(SSDefaultDir))
      #f=open("c:/now.txt","a")
      #f.write(" "+SSDefaultDir)
      #f.close()
      #r.append(str(SSInitialized))
      if SSDefaultDir.strip()=="":
#       <-
# UnboundLocalError: local variable 'SSDefaultDir' referenced before assignment
         r.append(str(SSDefaultDir))
         SSDefaultDir=SessionDir
         f=open("c:/now.txt","a")
         f.write(" "+SSDefaultDir)
         f.close()
    finally:
      SSUnlock()

--------------
      
When I not use SSInit, only I write the global variable in BHASession
module like this:

SSDefaultDir="c:/bhaweb/sessions"

then it is working good !!!

Why ? How to force python to module see his variable ?

Thanx for any advance  !

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From dwmp at opti.cgi.net  Fri Jan  9 10:08:28 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in
  the second handler
In-Reply-To: <3FFEA8BF.2060408@quirxi.com>
Message-ID: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>


You're probably creating a FieldStorage in authenhandler() and then 
recreating the FieldStorage in your handler().  You're using a POST request 
so the when FieldStorage is created it reads the fields from the body of 
the request (GET requests put the variables in the header) via the 
req.read() method. Once you've read the body of the of a request, it cannot 
be read again.  So when your second FieldStorage is created, there is no 
body request data left to be read.

As it turns out, the req object you get in authenhandler() and handler() is 
the same object.  So when you create your first FieldStorage in 
authenhandler(), assign it to the req object and it will be available in 
your handler() function without having to recreate it again.

-Dan




At 02:12 PM 1/9/2004 +0100, you wrote:
>Hello,
>
>I have just started using mod_pyhon and have come to a problem I cannot 
>find an solution for:
>
>In my html file there is a hidden input named PATH:
>
><FORM method="post" action="/qwer/eval.py">
><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>...
></FORM>
>
>When the form is submitted the PATH variable reaches the 
>authenhandler(req) which I can give out to a file:
>
>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>
>but after that it does not reach the following handler(req) function. It 
>always raises an KeyError since the PATH variable does not exist in this 
>function anymore !
>Can anyone point me to the right direction ?
>
>
>
>cheers,
>
>Arno

From dwmp at opti.cgi.net  Fri Jan  9 10:12:57 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] How to globalize vars ???
In-Reply-To: <17328262299.20040109161941@anonym.hu>
Message-ID: <5.2.1.1.2.20040109101042.042fa6f0@mail.pyxos.com>


Try assigning global SSDefaultDir at the top of your SSInit function like this:

def SSInit(SessionDir):
     global SSDefaultDir
     SSLock()
     ...

-Dan




At 04:19 PM 1/9/2004 +0100, you wrote:
>Hello !
>
>I have get a strange problem in mod_python site.
>More modules I have, and think, to I initialize my Session handler
>from main module.
>
>Like this:
>
>-- main --
>
>import BHASession
>
># Session info
>BHASessionDir="C:/bhaweb/sessions"
>#f=open("c:/now.txt","a");f.write(" 1");f.close();
>BHASession.SSInit(BHASessionDir)
>#f=open("c:/now.txt","a");f.write(" 2");f.close();
>
>-- Session --
>f=open("c:/now.txt","a");f.write(" 01");f.close();
>#global SSDefaultDir
>SSDefaultDir="c:/bhaweb/sessions"
>f=open("c:/now.txt","a");f.write(" 02");f.close();
>SSLockObj=threading.Lock()
>
>def SSLock():
>     SSLockObj.acquire()
>
>def SSUnlock():
>     SSLockObj.release()
>
>def SSInit(SessionDir):
>     #f=open("c:/now.txt","a");f.write(" 03");f.close();
>     SSLock()
>     try:
>       #global SSDefaultDir
>       #r.append(str(SSDefaultDir))
>       #f=open("c:/now.txt","a")
>       #f.write(" "+SSDefaultDir)
>       #f.close()
>       #r.append(str(SSInitialized))
>       if SSDefaultDir.strip()=="":
>#       <-
># UnboundLocalError: local variable 'SSDefaultDir' referenced before 
>assignment
>          r.append(str(SSDefaultDir))
>          SSDefaultDir=SessionDir
>          f=open("c:/now.txt","a")
>          f.write(" "+SSDefaultDir)
>          f.close()
>     finally:
>       SSUnlock()
>
>--------------
>
>When I not use SSInit, only I write the global variable in BHASession
>module like this:
>
>SSDefaultDir="c:/bhaweb/sessions"
>
>then it is working good !!!
>
>Why ? How to force python to module see his variable ?
>
>Thanx for any advance  !
>
>--
>Best regards,
>  fowlertrainer                          mailto:fowlertrainer@anonym.hu
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From jalil at securia.com  Fri Jan  9 08:22:22 2004
From: jalil at securia.com (jalil@securia.com)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] How to set connection parameters?
Message-ID: <3FFED53E.20402@securia.com>

When using JDBC,  one can pass the following parameters in the 
connection string:

useUnicode=true&characterEncoding=UTF-8

How do we do this in Python?

Thanks,

-Jalil



From dwmp at opti.cgi.net  Fri Jan  9 10:41:18 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python]  Newbie question: Fieldstorage is empty in 
  the second handler
In-Reply-To: <3FFED6FE.8000702@quirxi.com>
References: <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
 <5.2.1.1.2.20040109095537.0373ceb0@mail.pyxos.com>
Message-ID: <5.2.1.1.2.20040109103843.036e4ce0@mail.pyxos.com>


The req object is just a python object.  You can assign any new members you 
want to it and they will remain throughout Apache's request handling 
process.   So in your authenhandler() do this:

req.form = FieldStorage(req)

Then when you need to get your variables in handler() just do this:

path = req.form['PATH'].value


-Dan



At 05:29 PM 1/9/2004 +0100, you wrote:
>Hello Daniel,
>
>
>>You're probably creating a FieldStorage in authenhandler() and then 
>>recreating the FieldStorage in your handler().  You're using a POST 
>>request so the when FieldStorage is created it reads the fields from the 
>>body of the request (GET requests put the variables in the header) via 
>>the req.read() method. Once you've read the body of the of a request, it 
>>cannot be read again.  So when your second FieldStorage is created, there 
>>is no body request data left to be read.
>>As it turns out, the req object you get in authenhandler() and handler() 
>>is the same object.
>
>
>It is just as you said: I used a POST request and called FieldStorage in 
>authenhandler() and handler().
>
>>So when you create your first FieldStorage in authenhandler(), assign it 
>>to the req object and it will be available in your handler() function 
>>without having to recreate it again.
>
>How can you assign the FieldStorage to a req object ? I could not find any 
>variable it could be assigned to in the docu.
>
>
>
>Arno
>
>
>
>>-Dan
>>
>>
>>At 02:12 PM 1/9/2004 +0100, you wrote:
>>
>>>Hello,
>>>
>>>I have just started using mod_pyhon and have come to a problem I cannot 
>>>find an solution for:
>>>
>>>In my html file there is a hidden input named PATH:
>>>
>>><FORM method="post" action="/qwer/eval.py">
>>><INPUT type="hidden" name="PATH" value="/mhanel/physik/1b/2002-11-24"/>
>>>...
>>></FORM>
>>>
>>>When the form is submitted the PATH variable reaches the 
>>>authenhandler(req) which I can give out to a file:
>>>
>>>PATH=/schools/HTL-Imst/innenausbau/teachers/mhanel/physik/1b/2002-11-24
>>>
>>>but after that it does not reach the following handler(req) function. It 
>>>always raises an KeyError since the PATH variable does not exist in this 
>>>function anymore !
>>>Can anyone point me to the right direction ?
>>>
>>>
>>>
>>>cheers,
>>>
>>>Arno
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>

From neel at mediapulse.com  Fri Jan  9 12:15:16 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] get_options() problem
Message-ID: <C0FC22C08B82074A88B50061764157776B9971@johnson.mediapulse.net>

I use req.get_options(), this is 2.x - and it should be the same (at
least I hope it is) for 3.x

Mike

> -----Original Message-----
> From: Daniel West [mailto:dwmp@opti.cgi.net] 
> Sent: Friday, January 09, 2004 1:23 AM
> To: mod_python@modpython.org
> Subject: Re: [mod_python] get_options() problem
> 
> 
> 
> I found the DocumentRoot value I was after.  Duh.  
> req.document_root().
> 
> However, that server.get_options() probably needs some looking into.
> 
> -Dan
> 
> 
> 
> At 12:15 AM 1/9/2004 -0600, you wrote:
> 
> >According to the 3.1.2b documentation there should be a 
> get_options() 
> >method on the server object.  When trying to access it I get 
> a traceback.
> >
> >code (under psp):
> >
> >req.log_error('options: %s' % `req.server.get_options()`)
> >
> >error:
> >
> >AttributeError: 'mp_server' object has no attribute 'get_options'
> >
> >
> >Does the server.get_options() method no longer exist and is the 
> >documentation (section 4.5.6.1) just out of date?
> >
> >I'm trying to get to the DocumentRoot value for the virtual server 
> >handling the current request and was hoping I might find it in there.
> >
> >-Dan
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From jalil at securia.com  Fri Jan  9 11:33:27 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Cannot load templates using PSP class
Message-ID: <3FFF0207.3000003@securia.com>

 
In my python default handler, I am trying to load an html file in my 
code using the example below:

template = psp.PSP(req, filename='template.html')

The html file is located in the same directory as my .py file but this call 
fails unless I pass the full path of the html file in the call!

Any way to change this behaviour?

Thanks,

-Jalil



From grisha at modpython.org  Fri Jan  9 17:05:53 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <3FFF0207.3000003@securia.com>
References: <3FFF0207.3000003@securia.com>
Message-ID: <20040109165951.K82783@onyx.ispol.com>


It's impossible to answer this without the details of your configuration.

Take a look at your req.filename. PSP tries to figure out the "current
directory" by looking at req.filename. Under certain configs this won't
work.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

>
> In my python default handler, I am trying to load an html file in my
> code using the example below:
>
> template = psp.PSP(req, filename='template.html')
>
> The html file is located in the same directory as my .py file but this call
> fails unless I pass the full path of the html file in the call!
>
> Any way to change this behaviour?
>
> Thanks,
>
> -Jalil
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From jalil at securia.com  Fri Jan  9 14:27:32 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Cannot load templates using PSP class
In-Reply-To: <20040109165951.K82783@onyx.ispol.com>
References: <3FFF0207.3000003@securia.com>
	<20040109165951.K82783@onyx.ispol.com>
Message-ID: <3FFF2AD4.5090909@securia.com>

Grisha,

req.filename is the the full path of the resource on my filesystem and 
looks fine.
Please let me know what info you need regarding my configuration or what 
config parameters make this fail.

Thanks,

-Jalil

Gregory (Grisha) Trubetskoy wrote:

>It's impossible to answer this without the details of your configuration.
>
>Take a look at your req.filename. PSP tries to figure out the "current
>directory" by looking at req.filename. Under certain configs this won't
>work.
>
>Grisha
>
>On Fri, 9 Jan 2004, jalil wrote:
>
>  
>
>>In my python default handler, I am trying to load an html file in my
>>code using the example below:
>>
>>template = psp.PSP(req, filename='template.html')
>>
>>The html file is located in the same directory as my .py file but this call
>>fails unless I pass the full path of the html file in the call!
>>
>>Any way to change this behaviour?
>>
>>Thanks,
>>
>>-Jalil
>>
>>
>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>

From jalil at securia.com  Fri Jan  9 15:41:23 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Error using Session
Message-ID: <3FFF3C23.8060301@securia.com>

Today I upgraded to Python 2.3.3 and mod_python 3.1.2b fine. I am trying to use the Session
class now and when in my request handler I do something simple like:

sess = Session.Session(req)
req.write (sess.id())

I get the following error. Any idea why this happens and why python2.2 is still being 
used in mod_python? The 2.3.3 is installed in /usr/local/lib which comes first in my PATH.
I am using Redhad which seems to depend on 2.2!


Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338, in HandlerDispatch
    result = object(req)

  File "/development/webnotes/src/pylib/dispatch.py", line 54, in handler
    ses = Session.Session(req)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 411, in Session
    timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 316, in __init__
    secret=secret, timeout=timeout)

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 170, in __init__
    self.lock()                 # lock new sid

  File "/usr/lib/python2.2/site-packages/mod_python/Session.py", line 241, in lock
    _apache._global_lock(self._req.server, self._sid)

ValueError: Failed to acquire global mutex lock

Thanks,

-Jalil


From egrubbs at rackspace.com  Fri Jan  9 17:53:19 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] SetEnv and add_common_vars()
Message-ID: <20040109235319.GJ5495@rackspace.com>

When I use SetEnv in my apache conf file, it causes a lot of the
environment variables (such as DOCUMENT_ROOT) to disappear that
add_common_vars() normally would set.

The only workaround I have is to put the SetEnv statements in a
different <Directory> block than the directory with the files served by
mod_python.

Is this a bug in mod_env or mod_python? Is there a better way to fix
this?

-Edwin
From grisha at modpython.org  Fri Jan  9 19:48:39 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040109235319.GJ5495@rackspace.com>
References: <20040109235319.GJ5495@rackspace.com>
Message-ID: <20040109194651.V82783@onyx.ispol.com>


On Fri, 9 Jan 2004, Edwin Grubbs wrote:

> When I use SetEnv in my apache conf file, it causes a lot of the
> environment variables (such as DOCUMENT_ROOT) to disappear that
> add_common_vars() normally would set.

When you say "dissapear" - what are you using to look them up?

> The only workaround I have is to put the SetEnv statements in a
> different <Directory> block than the directory with the files served by
> mod_python.

What is the objective here? If you are you trying to pass information to
mod_python from the config, a better way is to use PythonOption.

Grisha
From jalil at securia.com  Fri Jan  9 17:01:19 2004
From: jalil at securia.com (jalil)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
Message-ID: <3FFF4EDF.2050401@securia.com>

I have built and updated my Python and mod_python to the latest version 
and the new mod_python.so is now in the modules directory. However, my 
mod_python still picks up the old version of Python. Does anybody know 
how to fix this?

Thanks,

From grisha at modpython.org  Fri Jan  9 20:38:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <20040109203726.L85266@onyx.ispol.com>


Just a guess - before re-running ./configure, make sure to remove
config.cache file.

Grisha

On Fri, 9 Jan 2004, jalil wrote:

> I have built and updated my Python and mod_python to the latest version
> and the new mod_python.so is now in the modules directory. However, my
> mod_python still picks up the old version of Python. Does anybody know
> how to fix this?
>
> Thanks,
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From kevin at sb.org  Fri Jan  9 20:41:08 2004
From: kevin at sb.org (Kevin Ballard)
Date: Fri Jan  9 22:04:33 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <3FFF4EDF.2050401@securia.com>
References: <3FFF4EDF.2050401@securia.com>
Message-ID: <0FE6C376-430E-11D8-9AD2-000A95A072FC@sb.org>

You could remove the old version?

Alternately, there's an option to ./configure for building mod_python 
that lets you specify the exact path to python in case you have 
multiple copies. That might be what you're looking for.

On Jan 9, 2004, at 8:01 PM, jalil wrote:

> I have built and updated my Python and mod_python to the latest 
> version and the new mod_python.so is now in the modules directory. 
> However, my mod_python still picks up the old version of Python. Does 
> anybody know how to fix this?

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From jalil at securia.com  Sat Jan 10 10:25:39 2004
From: jalil at securia.com (jalil)
Date: Sat Jan 10 14:31:12 2004
Subject: [mod_python] Failed to acquire global mutex lock when using Session
Message-ID: <400043A3.8050109@securia.com>

M upgrade to 3.1.2.b now looks fine now. I removed config.cache as 
Grisha suggested and passed the location of the new python to the 
configre command as per Kevin help. I checked and I am using the right 
version of python (2.3) from mod_python.

However, I still get this message:

Failed to acquire global mutex lock

When I try to use the Session object. 

Any help on how to trouble shoot this problem?

Thanks,

-Jalil



From barry at python.org  Sat Jan 10 13:50:07 2004
From: barry at python.org (Barry Warsaw)
Date: Sat Jan 10 14:49:39 2004
Subject: [mod_python] Wrong version of Python is picked up by mod_python
In-Reply-To: <0FE6C376-430E-11D8-9AD2-000A95A072FC@sb.org>
References: <3FFF4EDF.2050401@securia.com>
	 <0FE6C376-430E-11D8-9AD2-000A95A072FC@sb.org>
Message-ID: <1073760606.1018.47.camel@anthem>

On Fri, 2004-01-09 at 20:41, Kevin Ballard wrote:
> You could remove the old version?
> 
> Alternately, there's an option to ./configure for building mod_python 
> that lets you specify the exact path to python in case you have 
> multiple copies. That might be what you're looking for.

It may not help.  mod_python will always pick the first Python on your
$PATH, even when you use --with-python.  I've reported this before and
seen the behavior on every Linux box I've built on.  This with Apache
2.0.48.

The trick is to hack your $PATH in Apache's bin/envvars script so that
it is sure to pick up the Python executable you want.

-Barry


From michael at dynamine.net  Sat Jan 10 11:16:53 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Sat Jan 10 15:16:25 2004
Subject: [mod_python] Failed to acquire global mutex lock when using
	Session
In-Reply-To: <400043A3.8050109@securia.com>
References: <400043A3.8050109@securia.com>
Message-ID: <40004FA5.40505@dynamine.net>

The consensus seems to be to use the CVS version.  Grisha fixed a 
related bug after 3.1.2b was released.

--Michael

jalil wrote:

> M upgrade to 3.1.2.b now looks fine now. I removed config.cache as 
> Grisha suggested and passed the location of the new python to the 
> configre command as per Kevin help. I checked and I am using the right 
> version of python (2.3) from mod_python.
> 
> However, I still get this message:
> 
> Failed to acquire global mutex lock
> 
> When I try to use the Session object.
> Any help on how to trouble shoot this problem?
> 
> Thanks,
> 
> -Jalil
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 
From modpython at holovaty.com  Sat Jan 10 20:44:45 2004
From: modpython at holovaty.com (Adrian Holovaty)
Date: Sat Jan 10 22:44:31 2004
Subject: [mod_python] returning an integer instead of apache.OK
Message-ID: <200401102044.45514.modpython@holovaty.com>

Hi all,

Instead of returning a mod_python constant (e.g. apache.OK or 
apache.HTTP_NOT_FOUND), can a mod_python handler return an integer of the 
HTTP status code (e.g. 200 or 404) instead? The docs seem to suggest that, 
but I'd like to make sure.

Thanks!

Adrian

From grisha at modpython.org  Sat Jan 10 22:57:54 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sat Jan 10 23:57:24 2004
Subject: [mod_python] Failed to acquire global mutex lock when using
 Session
In-Reply-To: <400043A3.8050109@securia.com>
References: <400043A3.8050109@securia.com>
Message-ID: <20040110225722.O4511@onyx.ispol.com>


3.1.2b has a bug related to session locking - try the latest snapshot from
CVS, it might work better.

Grisha

On Sat, 10 Jan 2004, jalil wrote:

> M upgrade to 3.1.2.b now looks fine now. I removed config.cache as
> Grisha suggested and passed the location of the new python to the
> configre command as per Kevin help. I checked and I am using the right
> version of python (2.3) from mod_python.
>
> However, I still get this message:
>
> Failed to acquire global mutex lock
>
> When I try to use the Session object.
>
> Any help on how to trouble shoot this problem?
>
> Thanks,
>
> -Jalil
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From dwmp at opti.cgi.net  Sun Jan 11 02:09:37 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Sun Jan 11 04:06:27 2004
Subject: [mod_python] 3.1.2b InputFilter SegFault (w/Backtrace)
Message-ID: <5.2.1.1.2.20040111014450.03702310@mail.pyxos.com>


While setting up an InputFilter I ran across a segfault in 3.1.2b.  I 
created an InputFilter to add a few members to the request object 
(filter.req) before the request is sent to the handler and 
OutputFilter.  When run, the InputFilter is processed but the new members 
it adds to the request object are not to be found in the subsequent handler 
or output filter.  After receiving a traceback (PythonDebug On) for trying 
to access non-existent members of the request object the server process 
proceeds to segfault.  Other than setting a few new members to the request 
object, the input filter just calls filter.pass_on().

Extra info: "virtualhost.com" is the virtual host I'm working with.  When 
other virtual hosts are listed before my virtual host, I get their name in 
the second line of the backtrace instead of "virtualhost.com" even though 
the request was made to "virtualhost.com".

The system is Linux 2.4, Apache 2.0.48, and Python 2.3.2.  Apache is 
compiled with the worker_mpm.  Please let me know if there is any other 
information I can provide.


(gdb) r
Starting program: /usr/local/apache2/bin/httpd -DONE_PROCESS
[New Thread 1024 (LWP 7082)]
[New Thread 2049 (LWP 7084)]
[New Thread 1026 (LWP 7085)]
[New Thread 2051 (LWP 7086)]
[New Thread 3076 (LWP 7087)]
[New Thread 4101 (LWP 7088)]
[New Thread 5126 (LWP 7089)]
[New Thread 6151 (LWP 7090)]
[New Thread 7176 (LWP 7091)]
[New Thread 8201 (LWP 7092)]
[New Thread 9226 (LWP 7093)]
[New Thread 10251 (LWP 7094)]
[New Thread 11276 (LWP 7095)]
[New Thread 12301 (LWP 7096)]
[New Thread 13326 (LWP 7097)]
[New Thread 14351 (LWP 7098)]
[New Thread 15376 (LWP 7099)]
[New Thread 16401 (LWP 7100)]
[New Thread 17426 (LWP 7101)]
[New Thread 18451 (LWP 7102)]
[New Thread 19476 (LWP 7103)]
[New Thread 20501 (LWP 7104)]
[New Thread 21526 (LWP 7105)]
[New Thread 22551 (LWP 7106)]
[New Thread 23576 (LWP 7107)]
[New Thread 24601 (LWP 7108)]
[New Thread 25626 (LWP 7109)]
[New Thread 26651 (LWP 7110)]
[New Thread 27676 (LWP 7111)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 2051 (LWP 7086)]
ap_add_cgi_vars (r=0x81f3fd8) at util_script.c:390
390         if (!strcmp(r->protocol, "INCLUDED")) {
(gdb) bt
#0  ap_add_cgi_vars (r=0x81f3fd8) at util_script.c:390
#1  0x401f488a in get_request_object (req=0x81f3fd8, interp_name=0x8127298 
"virtualhost.com",
     phase=0x40289a8e "PythonInputFilter") at mod_python.c:862
#2  0x401f50cc in python_filter (is_input=1, f=0x81f5708, bb=0x81f4c68, 
mode=AP_MODE_GETLINE,
     block=APR_BLOCK_READ, readbytes=0) at mod_python.c:1338
#3  0x401f5190 in python_input_filter (f=0x81f5708, bb=0x81f4c68, 
mode=AP_MODE_GETLINE, block=APR_BLOCK_READ,
     readbytes=0) at mod_python.c:1383
#4  0x0809024e in ap_get_brigade (next=0x81f5708, bb=0x81f4c68, 
mode=AP_MODE_GETLINE, block=APR_BLOCK_READ,
     readbytes=0) at util_filter.c:514
#5  0x0809024e in ap_get_brigade (next=0x81f4c08, bb=0x81f4c68, 
mode=AP_MODE_GETLINE, block=APR_BLOCK_READ,
     readbytes=0) at util_filter.c:514
#6  0x0809104b in ap_rgetline_core (s=0x81f3ff0, n=8192, read=0x40844958, 
r=0x81f3fd8, fold=0, bb=0x81f4c68)
     at protocol.c:256
#7  0x0809150d in read_request_line (r=0x81f3fd8, bb=0x81f4c68) at 
protocol.c:623
#8  0x08091a8f in ap_read_request (conn=0x81ee0b0) at protocol.c:900
#9  0x08069940 in ap_process_http_connection (c=0x81ee0b0) at http_core.c:312
#10 0x0808e742 in ap_run_process_connection (c=0x81ee0b0) at connection.c:85
#11 0x08082c22 in process_socket (p=0x81edf88, sock=0x81edfc0, 
my_child_num=0, my_thread_num=0,
     bucket_alloc=0x81f1f98) at worker.c:632
#12 0x080831f6 in worker_thread (thd=0x8116d48, dummy=0x81beb78) at 
worker.c:946
#13 0x4010e090 in dummy_worker (opaque=0x8116d48) at thread.c:127
#14 0x4011dfef in pthread_start_thread () from /lib/i686/libpthread.so.0
#15 0x4011e0df in pthread_start_thread_event () from /lib/i686/libpthread.so.0
(gdb)





From jalil at securia.com  Sun Jan 11 10:50:31 2004
From: jalil at securia.com (jalil)
Date: Sun Jan 11 14:56:08 2004
Subject: [mod_python] Problem w/ Session
Message-ID: <40019AF7.50402@securia.com>

I am using the session object in my psp page and it seems each request 
in the same session creates a new session.  In my psp page, I check 
session.is_new() and it returns True if I just reload the page.

- Jalil



From jalil at securia.com  Sun Jan 11 12:51:44 2004
From: jalil at securia.com (jalil)
Date: Sun Jan 11 16:57:22 2004
Subject: [mod_python] Problem w/ Session
In-Reply-To: <40019AF7.50402@securia.com>
References: <40019AF7.50402@securia.com>
Message-ID: <4001B760.6090602@securia.com>

I found the source of the problem. I had to set the ApplicationPath 
parameter as I was using an alias in
my httpd.conf file and the cookie was not sent back in the request.



jalil wrote:

> I am using the session object in my psp page and it seems each request 
> in the same session creates a new session.  In my psp page, I check 
> session.is_new() and it returns True if I just reload the page.
>
> - Jalil
>
>
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From egrubbs at rackspace.com  Sun Jan 11 20:58:02 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Sun Jan 11 22:57:54 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040109194651.V82783@onyx.ispol.com>
References: <20040109235319.GJ5495@rackspace.com>
	<20040109194651.V82783@onyx.ispol.com>
Message-ID: <20040112025802.GK5495@rackspace.com>

On Fri, Jan 09, 2004 at 07:48:39PM -0500, Gregory (Grisha) Trubetskoy wrote:
> 
> On Fri, 9 Jan 2004, Edwin Grubbs wrote:
> 
> > When I use SetEnv in my apache conf file, it causes a lot of the
> > environment variables (such as DOCUMENT_ROOT) to disappear that
> > add_common_vars() normally would set.
> 
> When you say "dissapear" - what are you using to look them up?

I am accessing the environment through the req.subprocess_env
dictionary.

> > The only workaround I have is to put the SetEnv statements in a
> > different <Directory> block than the directory with the files served by
> > mod_python.
> 
> What is the objective here? If you are you trying to pass information to
> mod_python from the config, a better way is to use PythonOption.

The objective is to access the environment variables that are unique to
each request such as REMOTE_ADDR, HTTP_USER_AGENT, and our own cookies
such as SESSION_COOKIE.

Here is the full list of environment variables that disappear from
req.subprocess_env when you use SetEnv in the apache conf in the same
<Directory> config block.

    DOCUMENT_ROOT=/home/egrubbs/work/project1/html
    HTTP_ACCEPT=text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,image/jpeg,image/gif;q=0.2,*/*;q=0.1
    HTTP_ACCEPT_CHARSET=ISO-8859-1,utf-8;q=0.7,*;q=0.7
    HTTP_ACCEPT_ENCODING=gzip,deflate
    HTTP_CACHE_CONTROL=max-age=0
    HTTP_CONNECTION=keep-alive
    HTTP_COOKIE=supmark=0-1031685007537-yes;
    supvid=1031685007537-15062133204827238; COOKIE_last_login=egrubbs;
    SESSION_COOKIE=a746faf7b134269514ebfb1e5edbfa1d; COOKIE_last_login=egrubbs; supbid=0; admin_session=979728667
    HTTP_HOST=dev.rackspace.com
    HTTP_KEEP_ALIVE=300
    HTTP_USER_AGENT=Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.5) Gecko/20031107 Debian/1.5-3
    PATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/X11R6/bin
    REMOTE_ADDR=10.1.104.206
    REMOTE_PORT=38121
    SCRIPT_FILENAME=/home/egrubbs/work/project1/python/app/test.pt
    SERVER_ADDR=10.1.15.47
    SERVER_ADMIN=root@localhost
    SERVER_NAME=dev.rackspace.com
    SERVER_PORT=80
    SERVER_SIGNATURE=Apache/1.3.20 Server at dev.rackspace.com Port 80
    SERVER_SOFTWARE=Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_fastcgi/2.2.12 mod_python/2.7.6 Python/2.2.2 DAV/1.0.3 PHP/4.2.2


Thanks,
Edwin
From grisha at modpython.org  Sun Jan 11 23:27:12 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Jan 12 00:26:43 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040112025802.GK5495@rackspace.com>
References: <20040109235319.GJ5495@rackspace.com>
	<20040109194651.V82783@onyx.ispol.com>
	<20040112025802.GK5495@rackspace.com>
Message-ID: <20040111232436.F19336@onyx.ispol.com>


On Sun, 11 Jan 2004, Edwin Grubbs wrote:

> On Fri, Jan 09, 2004 at 07:48:39PM -0500, Gregory (Grisha) Trubetskoy wrote:
> >
> > On Fri, 9 Jan 2004, Edwin Grubbs wrote:
> >
> > > When I use SetEnv in my apache conf file, it causes a lot of the
> > > environment variables (such as DOCUMENT_ROOT) to disappear that
> > > add_common_vars() normally would set.
> >
> > When you say "dissapear" - what are you using to look them up?
>
> I am accessing the environment through the req.subprocess_env
> dictionary.
>
> > > The only workaround I have is to put the SetEnv statements in a
> > > different <Directory> block than the directory with the files served by
> > > mod_python.
> >
> > What is the objective here? If you are you trying to pass information to
> > mod_python from the config, a better way is to use PythonOption.
>
> The objective is to access the environment variables that are unique to
> each request such as REMOTE_ADDR, HTTP_USER_AGENT, and our own cookies
> such as SESSION_COOKIE.
>

Hmm... This may be a bug somehwere, I'll have to take a look at it. But,
all of this information is available directly without having to use
subprocess_env, as part of the request object or req.headers_in.
Subprocess_env is an inefficient way of doing it since it is artificially
constructed from the same sources to which mod_python allows you direct
access.

Grisha
From pm5 at matilda.fiorile.org  Mon Jan 12 13:47:03 2004
From: pm5 at matilda.fiorile.org (pm5@matilda.fiorile.org)
Date: Mon Jan 12 01:50:47 2004
Subject: [mod_python] Error building mod_python
Message-ID: <20040112054703.GA23706@matilda.fiorile.org>

Hi,

I ran into trouble when compiling mod_python.  This is the
configuration I use:

 * mod_python 2.7.9, from source tarball
 * Apache 1.3.29, from source tarball
 * Python 2.3.3, from source tarball
 * Debian stable (woody)

Python installation went well.  Then I tried the command suggested
in the manual:

 % ./configure \
 	--with-apache=/usr/local/src/build/apache_1.3.29 \
	--with-python=/usr/local/src/build/Python-2.3.3
 % make


And following error occurred:


make[1]: Entering directory `/usr/local/src/build/mod_python-2.7.9/src'
gcc  -I/usr/local/src/build/mod_python-2.7.9/src/include -I/usr/local/src/build/
apache_1.3.29/src/include -I/usr/local/src/build/apache_1.3.29/src/os/unix -I/us
r/local/src/build/Python-2.3.3 -I/usr/local/src/build/Python-2.3.3/Include    -c
 -o mod_python.o mod_python.c
In file included from /usr/local/src/build/apache_1.3.29/src/include/httpd.h:72,
                 from /usr/local/src/build/mod_python-2.7.9/src/include/mod_pyth
on.h:63,
                 from mod_python.c:54:
/usr/local/src/build/apache_1.3.29/src/include/ap_config.h:77: ap_config_auto.h:
 No such file or directory
In file included from /usr/local/src/build/Python-2.3.3/Include/Python.h:8,
                 from /usr/local/src/build/mod_python-2.7.9/src/include/mod_pyth
on.h:77,
                 from mod_python.c:54:
/usr/local/src/build/Python-2.3.3/pyconfig.h:847: warning: `_POSIX_C_SOURCE' red
efined
/usr/include/features.h:171: warning: this is the location of the previous defin
ition
make[1]: *** [mod_python.o] Error 1
make[1]: Leaving directory `/usr/local/src/build/mod_python-2.7.9/src'
make: *** [do_static] Error 2
make: *** No rule to make target `src/.install', needed by `install'.  Stop.



From davidf at sjsoft.com  Mon Jan 12 08:16:08 2004
From: davidf at sjsoft.com (David Fraser)
Date: Mon Jan 12 02:15:42 2004
Subject: [mod_python] How to set connection parameters?
In-Reply-To: <3FFED53E.20402@securia.com>
References: <3FFED53E.20402@securia.com>
Message-ID: <40023BA8.6090303@sjsoft.com>

jalil@securia.com wrote:

> When using JDBC,  one can pass the following parameters in the 
> connection string:
>
> useUnicode=true&characterEncoding=UTF-8
>
> How do we do this in Python?
>
> Thanks,
>
> -Jalil

It depends, what database system you are using. I create a wrapper on 
top of the Python DB-API 2.0 and do unicode conversions there...
If you post more details it may be easier to answer your question

David


From pm5 at matilda.fiorile.org  Mon Jan 12 14:32:31 2004
From: pm5 at matilda.fiorile.org (pm5@matilda.fiorile.org)
Date: Mon Jan 12 02:35:55 2004
Subject: [mod_python] Error building mod_python
In-Reply-To: <20040112054703.GA23706@matilda.fiorile.org>
References: <20040112054703.GA23706@matilda.fiorile.org>
Message-ID: <20040112063230.GA31887@matilda.fiorile.org>

On Mon, Jan 12, 2004 at 01:47:03PM +0800, pm5@matilda.fiorile.org wrote:
> Hi,
> 
> I ran into trouble when compiling mod_python.  This is the
> configuration I use:
> 
>  * mod_python 2.7.9, from source tarball
>  * Apache 1.3.29, from source tarball
>  * Python 2.3.3, from source tarball
>  * Debian stable (woody)
> 

I hit the send button too soon.  It turned out I should do a
'configure; make' on the Apache part first.  The ap_config_auto.h file
would show up and mod_python can be installed to the Apache
source tree.

Now the problem came when I tried to build Apache again with
this module.  I did:

 % ./configure \
         --activate-module=src/modules/python/libpython.a
 % make

And ran into the following error:


gcc  -DLINUX=22 -DUSE_HSREGEX -DUSE_EXPAT -I./lib/expat-lite -DNO_DL_NEEDED `./a
paci` -Xlinker -export-dynamic       \
      -o httpd buildmark.o modules.o modules/standard/libstandard.a modules/pyth
on/libpython.a main/libmain.a ./os/unix/libos.a ap/libap.a regex/libregex.a lib/
expat-lite/libexpat.a  -lm -lcrypt -lm  /usr/local/src/build/Python-2.3.3/libpyt
hon2.3.a
/usr/local/src/build/Python-2.3.3/libpython2.3.a(posixmodule.o): In function `po
six_tmpnam':
/usr/local/src/build/Python-2.3.3/./Modules/posixmodule.c:5833: the use of `tmpn
am_r' is dangerous, better use `mkstemp'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(posixmodule.o): In function `po
six_tempnam':
/usr/local/src/build/Python-2.3.3/./Modules/posixmodule.c:5788: the use of `temp
nam' is dangerous, better use `mkstemp'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(dynload_shlib.o): In function `
_PyImport_GetDynLoadFunc':
/usr/local/src/build/Python-2.3.3/Python/dynload_shlib.c:129: undefined referenc
e to `dlopen'
/usr/local/src/build/Python-2.3.3/Python/dynload_shlib.c:132: undefined referenc
e to `dlerror'
/usr/local/src/build/Python-2.3.3/Python/dynload_shlib.c:137: undefined referenc
e to `dlsym'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `find_ke
y':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:406: undefined referen
ce to `sem_wait'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:431: undefined referen
ce to `sem_post'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_delete_key':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:406: undefined referen
ce to `sem_wait'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:431: undefined referen
ce to `sem_post'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_delete_key_value':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:406: undefined referen
ce to `sem_wait'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:431: undefined referen
ce to `sem_post'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_start_new_thread':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:215: undefined reference to `pthread_sigmask'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:217: undefined referen
ce to `pthread_create'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:242: undefined referen
ce to `pthread_sigmask'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:253: undefined referen
ce to `pthread_detach'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_allocate_lock':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:353: undefined referen
ce to `sem_init'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_free_lock':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:377: undefined referen
ce to `sem_destroy'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_acquire_lock':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:406: undefined referen
ce to `sem_wait'
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:408: undefined referen
ce to `sem_trywait'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_release_lock':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:431: undefined referen
ce to `sem_post'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(thread.o): In function `PyThrea
d_create_key':
/usr/local/src/build/Python-2.3.3/Python/thread_pthread.h:353: undefined referen
ce to `sem_init'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(posixmodule.o): In function `po
six_openpty':
/usr/local/src/build/Python-2.3.3/./Modules/posixmodule.c:2590: undefined refere
nce to `openpty'
/usr/local/src/build/Python-2.3.3/libpython2.3.a(posixmodule.o): In function `po
six_forkpty':
/usr/local/src/build/Python-2.3.3/./Modules/posixmodule.c:2648: undefined refere
nce to `forkpty'
collect2: ld returned 1 exit status
make[2]: *** [target_static] Error 1
make[2]: Leaving directory `/usr/local/src/build/apache_1.3.29/src'
make[1]: *** [build-std] Error 2
make[1]: Leaving directory `/usr/local/src/build/apache_1.3.29'
make: *** [build] Error 2



Is this about pthread support in Python?  I admit I'm clueless on
this issue, but I built Python with default configuration and according
to my build log, it seems to have pthread compiled in.

Anyone can help me on this?

From ograf at rz-online.net  Mon Jan 12 07:47:59 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Mon Jan 12 02:47:25 2004
Subject: [mod_python] Error building mod_python
In-Reply-To: <20040112063230.GA31887@matilda.fiorile.org>
References: <20040112054703.GA23706@matilda.fiorile.org>
	<20040112063230.GA31887@matilda.fiorile.org>
Message-ID: <20040112064759.GB2962@rz-online.net>

On Mon, Jan 12, 2004 at 02:32:31PM +0800, pm5@matilda.fiorile.org wrote:
> On Mon, Jan 12, 2004 at 01:47:03PM +0800, pm5@matilda.fiorile.org wrote:
> > Hi,
> > 
> > I ran into trouble when compiling mod_python.  This is the
> > configuration I use:
> > 
> >  * mod_python 2.7.9, from source tarball
> >  * Apache 1.3.29, from source tarball
> >  * Python 2.3.3, from source tarball
> >  * Debian stable (woody)

Do you have any reason for using mod_python-2.7.9 instead of a recent
version?

Oliver.

From pm5 at matilda.fiorile.org  Mon Jan 12 15:01:09 2004
From: pm5 at matilda.fiorile.org (pm5@matilda.fiorile.org)
Date: Mon Jan 12 03:04:40 2004
Subject: [mod_python] Error building mod_python
In-Reply-To: <20040112064759.GB2962@rz-online.net>
References: <20040112054703.GA23706@matilda.fiorile.org>
	<20040112063230.GA31887@matilda.fiorile.org>
	<20040112064759.GB2962@rz-online.net>
Message-ID: <20040112070109.GB31887@matilda.fiorile.org>

On Mon, Jan 12, 2004 at 07:47:59AM +0100, Oliver Graf wrote:
> On Mon, Jan 12, 2004 at 02:32:31PM +0800, pm5@matilda.fiorile.org wrote:
> > On Mon, Jan 12, 2004 at 01:47:03PM +0800, pm5@matilda.fiorile.org wrote:
> > > Hi,
> > > 
> > > I ran into trouble when compiling mod_python.  This is the
> > > configuration I use:
> > > 
> > >  * mod_python 2.7.9, from source tarball
> > >  * Apache 1.3.29, from source tarball
> > >  * Python 2.3.3, from source tarball
> > >  * Debian stable (woody)
> 
> Do you have any reason for using mod_python-2.7.9 instead of a recent
> version?

Hmm.  You're right, I don't.  Although the Apache is old in
Debian stable, it has mod_python packaged.  I should probably
choose Apache 2 for my test server.


> 
> Oliver.
> 
From jalil at securia.com  Mon Jan 12 07:44:25 2004
From: jalil at securia.com (jalil)
Date: Mon Jan 12 11:50:11 2004
Subject: [mod_python] How to set connection parameters?
In-Reply-To: <40023BA8.6090303@sjsoft.com>
References: <3FFED53E.20402@securia.com> <40023BA8.6090303@sjsoft.com>
Message-ID: <4002C0D9.30301@securia.com>

David,

I am using mysql. Could you provide me some info on your wrapper 
especially if it is for mysql.

Thanks,

-Jalil

David Fraser wrote:

> jalil@securia.com wrote:
>
>> When using JDBC,  one can pass the following parameters in the 
>> connection string:
>>
>> useUnicode=true&characterEncoding=UTF-8
>>
>> How do we do this in Python?
>>
>> Thanks,
>>
>> -Jalil
>
>
> It depends, what database system you are using. I create a wrapper on 
> top of the Python DB-API 2.0 and do unicode conversions there...
> If you post more details it may be easier to answer your question
>
> David
>
>
>

From davidf at sjsoft.com  Mon Jan 12 18:05:43 2004
From: davidf at sjsoft.com (David Fraser)
Date: Mon Jan 12 12:05:11 2004
Subject: [mod_python] How to set connection parameters?
In-Reply-To: <4002C0D9.30301@securia.com>
References: <3FFED53E.20402@securia.com> <40023BA8.6090303@sjsoft.com>
	<4002C0D9.30301@securia.com>
Message-ID: <4002C5D7.8030200@sjsoft.com>

jalil wrote:

> David,
>
> I am using mysql. Could you provide me some info on your wrapper 
> especially if it is for mysql.
>
> Thanks,
>
> -Jalil

Jalil,

Our wrapper is part of jToolkit which is at http://jtoolkit.sourceforge.net/
We don't currently support MySQL although it should be easy to add.
But that's a whole framework - you may want to look at
http://www.esrf.fr/computing/bliss/python2/MySQL/MySQLdb-3.html (in the 
Python MySQL interface docs)
It seems that you can just pass in a unicode parametyer to the connect 
function, which contains the encoding
Hope that helps

David

>
> David Fraser wrote:
>
>> jalil@securia.com wrote:
>>
>>> When using JDBC,  one can pass the following parameters in the 
>>> connection string:
>>>
>>> useUnicode=true&characterEncoding=UTF-8
>>>
>>> How do we do this in Python?
>>>
>>> Thanks,
>>>
>>> -Jalil
>>
>>
>>
>> It depends, what database system you are using. I create a wrapper on 
>> top of the Python DB-API 2.0 and do unicode conversions there...
>> If you post more details it may be easier to answer your question
>>
>> David
>>
>>
>>
>

From thm at duke.edu  Mon Jan 12 14:22:47 2004
From: thm at duke.edu (Hunter Matthews)
Date: Mon Jan 12 15:22:23 2004
Subject: [mod_python] typehandler in mod_python 3.0.3
Message-ID: <1073935366.4306.57.camel@jade.biology.duke.edu>

We're having an issue with the typehandler never being run. The same
code on 3.0.1 works perfectly.

This is the mod_python rpm that is included with RHEL 3 - version 3.0.3,
and is similar to the problem that we had with mod_python 3.0, as
included with RH 9.

Are there any known typehandler regressions in 3.0.3?
-- 
Hunter Matthews                          Unix / Network Administrator
Office: BioScience 145/244               Duke Univ. Biology Department
Key: F0F88438 / FFB5 34C0 B350 99A4 BB02  9779 A5DB 8B09 F0F8 8438
Never take candy from strangers. Especially on the internet.

From manfred.stienstra at dwerg.net  Mon Jan 12 22:04:12 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Mon Jan 12 17:01:42 2004
Subject: [mod_python] How to set connection parameters?
In-Reply-To: <4002C5D7.8030200@sjsoft.com>
References: <3FFED53E.20402@securia.com> <40023BA8.6090303@sjsoft.com>
	 <4002C0D9.30301@securia.com>  <4002C5D7.8030200@sjsoft.com>
Message-ID: <1073941452.23698.10.camel@ack.dwerg.net>

On Mon, 2004-01-12 at 17:05, David Fraser wrote:
> It seems that you can just pass in a unicode parametyer to the connect 
> function, which contains the encoding

Please note that most MySQL installs don't support utf-8 yet. Only the
beta versions. There is also a bug in python MySQLdb, it doesn't convert
text fields to unicode objects, because the primary type of a text field
is BLOB in MySQL.

Manfred

From egrubbs at rackspace.com  Mon Jan 12 15:36:42 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Mon Jan 12 17:36:41 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <20040111232436.F19336@onyx.ispol.com>
References: <20040109235319.GJ5495@rackspace.com>
	<20040109194651.V82783@onyx.ispol.com> <20040112025802.GK5495@rackspace.com>
	<20040111232436.F19336@onyx.ispol.com>
Message-ID: <20040112213642.GS5495@rackspace.com>

On Sun, Jan 11, 2004 at 11:27:12PM -0500, Gregory (Grisha) Trubetskoy wrote:
> 
> On Sun, 11 Jan 2004, Edwin Grubbs wrote:
> > The objective is to access the environment variables that are unique to
> > each request such as REMOTE_ADDR, HTTP_USER_AGENT, and our own cookies
> > such as SESSION_COOKIE.
> >
> 
> Hmm... This may be a bug somehwere, I'll have to take a look at it. But,
> all of this information is available directly without having to use
> subprocess_env, as part of the request object or req.headers_in.
> Subprocess_env is an inefficient way of doing it since it is artificially
> constructed from the same sources to which mod_python allows you direct
> access.
> 
> Grisha

The req.headers_in variable does not contain the REMOTE_ADDR or the
SCRIPT_NAME variables which can not be passed in using PythonOption.

-Edwin
From neel at mediapulse.com  Mon Jan 12 17:05:01 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Mon Jan 12 18:04:33 2004
Subject: [mod_python] SetEnv and add_common_vars()
Message-ID: <C0FC22C08B82074A88B500617641577787A806@johnson.mediapulse.net>

IIRC (and it's been a while) the "env's" everyone is used to are part of
the CGI spec, and don't apply outside of it though often it will be
recreated.  mod_perl has a function you can call to setup the standard
env that a cgi script would have, but as Grisha pointed out it isn't the
best use of resources.

Look though the docs on the request, server, and connection objects.
Between those is everything you need to create the env's you are looking
for.  REMOTE_ADDR and SCRIPT_NAME are not client headers, so that's why
you don't see them in headers_in.

I'd recommend downloading Sam Spade for Windows from samspade.org, it
has a browser in it that shows you exactly the information being passed
between the client and server.

HTH,
Mike

> -----Original Message-----
> From: Edwin Grubbs [mailto:egrubbs@rackspace.com] 
> Sent: Monday, January 12, 2004 4:37 PM
> To: Gregory (Grisha) Trubetskoy
> Cc: mod_python@modpython.org
> Subject: Re: [mod_python] SetEnv and add_common_vars()
> 
> 
> On Sun, Jan 11, 2004 at 11:27:12PM -0500, Gregory (Grisha) 
> Trubetskoy wrote:
> > 
> > On Sun, 11 Jan 2004, Edwin Grubbs wrote:
> > > The objective is to access the environment variables that 
> are unique to
> > > each request such as REMOTE_ADDR, HTTP_USER_AGENT, and 
> our own cookies
> > > such as SESSION_COOKIE.
> > >
> > 
> > Hmm... This may be a bug somehwere, I'll have to take a 
> look at it. But,
> > all of this information is available directly without having to use
> > subprocess_env, as part of the request object or req.headers_in.
> > Subprocess_env is an inefficient way of doing it since it 
> is artificially
> > constructed from the same sources to which mod_python 
> allows you direct
> > access.
> > 
> > Grisha
> 
> The req.headers_in variable does not contain the REMOTE_ADDR or the
> SCRIPT_NAME variables which can not be passed in using PythonOption.
> 
> -Edwin
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From egrubbs at rackspace.com  Mon Jan 12 16:41:19 2004
From: egrubbs at rackspace.com (Edwin Grubbs)
Date: Mon Jan 12 18:41:18 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <C0FC22C08B82074A88B500617641577787A806@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A806@johnson.mediapulse.net>
Message-ID: <20040112224119.GX5495@rackspace.com>

On Mon, Jan 12, 2004 at 05:05:01PM -0500, Michael C. Neel wrote:
> IIRC (and it's been a while) the "env's" everyone is used to are part of
> the CGI spec, and don't apply outside of it though often it will be
> recreated.  mod_perl has a function you can call to setup the standard
> env that a cgi script would have, but as Grisha pointed out it isn't the
> best use of resources.
> 
> Look though the docs on the request, server, and connection objects.
> Between those is everything you need to create the env's you are looking
> for.  REMOTE_ADDR and SCRIPT_NAME are not client headers, so that's why
> you don't see them in headers_in.
> 
> I'd recommend downloading Sam Spade for Windows from samspade.org, it
> has a browser in it that shows you exactly the information being passed
> between the client and server.
> 
> HTH,
> Mike

Grisha was pointing out that req.headers_in could be used in place of
req.subprocess_env for accessing the variables I needed. req.headers_in
only provided a few of the variables I needed, so I was writing back to
see if there was another method for retrieving these vars.

Earlier in the thread, you can read about how add_common_vars() fails to
add the standard CGI variables when SetEnv is used in the apache conf
file.

-Edwin

> 
> > -----Original Message-----
> > From: Edwin Grubbs [mailto:egrubbs@rackspace.com] 
> > Sent: Monday, January 12, 2004 4:37 PM
> > To: Gregory (Grisha) Trubetskoy
> > Cc: mod_python@modpython.org
> > Subject: Re: [mod_python] SetEnv and add_common_vars()
> > 
> > 
> > On Sun, Jan 11, 2004 at 11:27:12PM -0500, Gregory (Grisha) 
> > Trubetskoy wrote:
> > > 
> > > On Sun, 11 Jan 2004, Edwin Grubbs wrote:
> > > > The objective is to access the environment variables that 
> > are unique to
> > > > each request such as REMOTE_ADDR, HTTP_USER_AGENT, and 
> > our own cookies
> > > > such as SESSION_COOKIE.
> > > >
> > > 
> > > Hmm... This may be a bug somehwere, I'll have to take a 
> > look at it. But,
> > > all of this information is available directly without having to use
> > > subprocess_env, as part of the request object or req.headers_in.
> > > Subprocess_env is an inefficient way of doing it since it 
> > is artificially
> > > constructed from the same sources to which mod_python 
> > allows you direct
> > > access.
> > > 
> > > Grisha
> > 
> > The req.headers_in variable does not contain the REMOTE_ADDR or the
> > SCRIPT_NAME variables which can not be passed in using PythonOption.
> > 
> > -Edwin
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> > 

-- 
In case you have sensitive data to send, here is my PGP key:
http://pgp.mit.edu:11371/pks/lookup?op=vindex&search=0xEADFF951
From alain at onesite.org  Tue Jan 13 02:52:15 2004
From: alain at onesite.org (Alain Tesio)
Date: Mon Jan 12 21:51:43 2004
Subject: [mod_python] Importing different script with the same names
Message-ID: <20040113025215.1989f82d.alain@onesite.org>

Hi, I have the problem described in the faq here :

http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.009.htp

In short, when you request /home/x/script.py and then another requests
wants /home/y/script.py the first one is used in the same apache process.

This makes it hard to have production and test scripts on the same machine.

Any solution ? If there is none, mentionning it in the faq would be useful.

Thanks
Alain
From alain at onesite.org  Tue Jan 13 03:13:25 2004
From: alain at onesite.org (Alain Tesio)
Date: Mon Jan 12 22:12:53 2004
Subject: [mod_python] Importing different script with the same names
In-Reply-To: <400352B5.7050106@dynamine.net>
References: <20040113025215.1989f82d.alain@onesite.org>
	<400352B5.7050106@dynamine.net>
Message-ID: <20040113031325.222fc618.alain@onesite.org>

On Mon, 12 Jan 2004 18:06:45 -0800
"Michael S. Fischer" <michael@dynamine.net> wrote:

> 
> Alternatively, perhaps you could bind the server to two separate ports 
> using <VirtualHost> blocks, each serving the same namespace but using 
> different mod_python modules.

Indeed it works great, thanks !

Alain
From michael at dynamine.net  Mon Jan 12 18:16:58 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Mon Jan 12 22:16:34 2004
Subject: [mod_python] Importing different script with the same names
In-Reply-To: <20040113025215.1989f82d.alain@onesite.org>
References: <20040113025215.1989f82d.alain@onesite.org>
Message-ID: <4003551A.30800@dynamine.net>

Alain Tesio wrote:
> Hi, I have the problem described in the faq here :
> 
> http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.009.htp
> 
> In short, when you request /home/x/script.py and then another requests
> wants /home/y/script.py the first one is used in the same apache process.
> 
> This makes it hard to have production and test scripts on the same machine.

Alternatively, perhaps you could bind the server to two separate ports
using <VirtualHost> blocks, each serving the same namespace but using
different mod_python modules.

Best,

--Michael


From davidf at sjsoft.com  Tue Jan 13 08:35:45 2004
From: davidf at sjsoft.com (David Fraser)
Date: Tue Jan 13 02:35:18 2004
Subject: [mod_python] SetEnv and add_common_vars()
In-Reply-To: <C0FC22C08B82074A88B500617641577787A806@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A806@johnson.mediapulse.net>
Message-ID: <400391C1.7040009@sjsoft.com>

Michael C. Neel wrote:

>I'd recommend downloading Sam Spade for Windows from samspade.org, it
>has a browser in it that shows you exactly the information being passed
>between the client and server.
>  
>
Or, seeing as your user agent is Mutt and you may not run Windows...
You could also try Live HTTP Headers 
(http://livehttpheaders.mozdev.org/) which is a plugin for Mozilla that 
lets you see http exchanges.
I've found it very helpful

David

From neel at mediapulse.com  Tue Jan 13 10:38:27 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 13 11:37:59 2004
Subject: [mod_python] SetEnv and add_common_vars()
Message-ID: <C0FC22C08B82074A88B50061764157776B998F@johnson.mediapulse.net>

Yes, I have that as well!  Sam Spade also has a web version of the tools
as well, but most of them you'll have in a *nix anyway.

Mike

> -----Original Message-----
> From: David Fraser [mailto:davidf@sjsoft.com] 
> Sent: Tuesday, January 13, 2004 1:36 AM
> To: Michael C. Neel
> Cc: Edwin Grubbs; Gregory (Grisha) Trubetskoy; 
> mod_python@modpython.org
> Subject: Re: [mod_python] SetEnv and add_common_vars()
> 
> 
> Michael C. Neel wrote:
> 
> >I'd recommend downloading Sam Spade for Windows from samspade.org, it
> >has a browser in it that shows you exactly the information 
> being passed
> >between the client and server.
> >  
> >
> Or, seeing as your user agent is Mutt and you may not run Windows...
> You could also try Live HTTP Headers 
> (http://livehttpheaders.mozdev.org/) which is a plugin for 
> Mozilla that 
> lets you see http exchanges.
> I've found it very helpful
> 
> David
> 
> 

From dpopowich at mtrsd.k12.ma.us  Tue Jan 13 10:40:53 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Tue Jan 13 11:40:58 2004
Subject: [mod_python] setting content_type intelligently
Message-ID: <16388.4485.164768.754148@gargle.gargle.HOWL>


In most of my mod_python apps if a request comes in for a file that I
don't want to handle, let's say an image file, foo.gif, I raise
apache.SERVER_RETURN with a value of apache.DECLINED.  Apache then
handles the request and sends in the header:

  Content-Type: image/gif

However, I now have an app that wants to live in a <Location ...>
directive so returning apache.DECLINED doesn't work: apache has no
other means of handling the request so it returns a 404 error.  My
only means of recourse seems to be something like this:

    if NOT_HANDLING_PAGE:
        req.write(open(filename).read())

but content_type is not set properly (it appears to default to
text/plain), so binary files, like image files, appear as gibberish in
a browser.

Two questions:

   1.  What does mod_python/apache do if content_type is not set by a
       handler?  Does it default to text/plain?

   2.  I'm looking for an intelligent means of setting the
       content_type.  I know I can use mimetypes.guess_type(), but
       that is based only on the file's extension.  Apache does more
       than that, eg, if 'foo.gif' was named 'foo' apache still
       determines the content type correctly as image/gif.  Is there a
       way to tap into apache's content_type determination?

Thanks,

------------------
Daniel Popowich
Network Specialist
-------------------------------------
Mohawk Trail Regional School District
24 Ashfield Rd.
Shelburne Falls, MA 01370
413.625.0192 x22
-------------------------------------

From neel at mediapulse.com  Tue Jan 13 10:44:49 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 13 11:44:21 2004
Subject: [mod_python] Importing different script with the same names
Message-ID: <C0FC22C08B82074A88B500617641577787A80A@johnson.mediapulse.net>

I ran into this as well when I was toying with a source code browser.  I
imported the modules and hashed the name against the dir like so:

name = '%s_%s' % (page.split('/')[-1].replace('.py',''),
                  md5.new(fulldir+page).hexdigest())

m = imp.load_module(name,file(fulldir+page),
                    fulldir+page, ('.py', 'r', imp.PY_SOURCE))

HTML = pydoc.HTMLDoc().document(m)

Works fine, but you end up with a lot of modules loaded you are not
using.  I ended up using a method that didn't require an import to get
docstrings.  The virthost is a better way to go if you can.

Mike

--
Michael C. Neel
Mediapulse, Inc. 

> -----Original Message-----
> From: Michael S. Fischer [mailto:michael@dynamine.net] 
> Sent: Monday, January 12, 2004 9:17 PM
> To: mod_python@modpython.org
> Subject: Re: [mod_python] Importing different script with the 
> same names
> 
> 
> Alain Tesio wrote:
> > Hi, I have the problem described in the faq here :
> > 
> > http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.009.htp
> > 
> > In short, when you request /home/x/script.py and then 
> another requests
> > wants /home/y/script.py the first one is used in the same 
> apache process.
> > 
> > This makes it hard to have production and test scripts on 
> the same machine.
> 
> Alternatively, perhaps you could bind the server to two separate ports
> using <VirtualHost> blocks, each serving the same namespace but using
> different mod_python modules.
> 
> Best,
> 
> --Michael
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From remi at python-hosting.com  Tue Jan 13 16:14:52 2004
From: remi at python-hosting.com (Remi Delon)
Date: Tue Jan 13 12:14:21 2004
Subject: [mod_python] mod_python-3.0.4 available at Python-Hosting.com
Message-ID: <02f701c3d9f0$61e4aa20$b817a8c0@hoegh.co.uk>

Hi everybody,

I just want to inform you that mod_python-3.0.4 is now supported at Python-Hosting.com.
I've upgraded my servers to Apache 2 just for that :-)

Also, I'll support 3.1.2 as soon as the final version is released.

Best,

Remi.

From manfred.stienstra at dwerg.net  Tue Jan 13 17:41:56 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Tue Jan 13 12:39:08 2004
Subject: [mod_python] Importing different script with the same names
In-Reply-To: <4003551A.30800@dynamine.net>
References: <20040113025215.1989f82d.alain@onesite.org>
	 <4003551A.30800@dynamine.net>
Message-ID: <1074012116.5434.6.camel@ack.dwerg.net>

On Tue, 2004-01-13 at 03:16, Michael S. Fischer wrote:
> Alain Tesio wrote:
> > Hi, I have the problem described in the faq here :
> > 
> > http://www.modpython.org/FAQ/faqw.py?req=show&file=faq03.009.htp
> > 
> > In short, when you request /home/x/script.py and then another requests
> > wants /home/y/script.py the first one is used in the same apache process.
> > 
> > This makes it hard to have production and test scripts on the same machine.
> 
> Alternatively, perhaps you could bind the server to two separate ports
> using <VirtualHost> blocks, each serving the same namespace but using
> different mod_python modules.

You can also set the interpreter name:

PythonInterpreter "ProjectX"

Manfred

From gah at research.att.com  Tue Jan 13 11:44:28 2004
From: gah at research.att.com (Glenn A. Hochberg)
Date: Tue Jan 13 12:43:55 2004
Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 15
In-Reply-To: <200401131647.i0DGlt1D069909@slash.mediapulse.com>
References: <200401131647.i0DGlt1D069909@slash.mediapulse.com>
Message-ID: <4004206C.8060007@research.att.com>

REMOTE_ADDR is available as req.connection.remote_ip, SCRIPT_NAME as req.filename.

Actually, one CGI env. var. that I have not been able to find via mod_python is HTTPS (set to "on" when using SSL).  

Is there some way to determine whether your baseurl should start with https: versus http:?  I'm trying to pass my full URL to another site via a redirect; I can find out everything I need except for that.

	-Glenn

On Mon, 12 Jan 2004 15:36:42 -0600, Edwin Grubbs wrote:

> On Sun, Jan 11, 2004 at 11:27:12PM -0500, Gregory (Grisha) Trubetskoy wrote:

>> 
>> On Sun, 11 Jan 2004, Edwin Grubbs wrote:
>  
>
>>> > The objective is to access the environment variables that are unique to
>>> > each request such as REMOTE_ADDR, HTTP_USER_AGENT, and our own cookies
>>> > such as SESSION_COOKIE.
>>> >
>>    
>>
>> 
>> Hmm... This may be a bug somehwere, I'll have to take a look at it. But,
>> all of this information is available directly without having to use
>> subprocess_env, as part of the request object or req.headers_in.
>> Subprocess_env is an inefficient way of doing it since it is artificially
>> constructed from the same sources to which mod_python allows you direct
>> access.
>> 
>> Grisha
>  
>

> The req.headers_in variable does not contain the REMOTE_ADDR or the
> SCRIPT_NAME variables which can not be passed in using PythonOption.
> 
> -Edwin


From manfred.stienstra at dwerg.net  Tue Jan 13 17:50:57 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Tue Jan 13 12:48:11 2004
Subject: [mod_python] setting content_type intelligently
In-Reply-To: <16388.4485.164768.754148@gargle.gargle.HOWL>
References: <16388.4485.164768.754148@gargle.gargle.HOWL>
Message-ID: <1074012657.5437.12.camel@ack.dwerg.net>

On Tue, 2004-01-13 at 16:40, Daniel J. Popowich wrote:
>    1.  What does mod_python/apache do if content_type is not set by a
>        handler?  Does it default to text/plain?

It defaults to the default Apache mimetype.

>    2.  I'm looking for an intelligent means of setting the
>        content_type.  I know I can use mimetypes.guess_type(), but
>        that is based only on the file's extension.  Apache does more
>        than that, eg, if 'foo.gif' was named 'foo' apache still
>        determines the content type correctly as image/gif.  Is there a
>        way to tap into apache's content_type determination?

Apache uses the same resolution as the 'file' command on *nix, it uses a
file with rules (/etc/apache*/mime.types) to resolve the mimetype. I'm
not sure if there is a python frontend for this.

Manfred

From lawrence_jesse at yahoo.ca  Tue Jan 13 12:01:59 2004
From: lawrence_jesse at yahoo.ca (Jesse Lawrence)
Date: Tue Jan 13 13:01:26 2004
Subject: [mod_python] setting multiple cookies
Message-ID: <20040113170159.27649.qmail@web11305.mail.yahoo.com>

Hello all,
I scanned the archives a bit for mention of setting
multiple cookies, but didn't come across anything.  I
noticed that the documentation mentions this in regard
to the "table" class.  Could someone give me some
advice regarding this?  I'm not quite sure how to use
the table class to accomplish this.  Thanks a million
for any help, and I apologize if this has already been
covered.

Thanks,

Jesse Lawrence

______________________________________________________________________ 
Post your free ad now! http://personals.yahoo.ca
From kevin at sb.org  Tue Jan 13 12:06:11 2004
From: kevin at sb.org (Kevin Ballard)
Date: Tue Jan 13 13:06:05 2004
Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 15
In-Reply-To: <4004206C.8060007@research.att.com>
References: <200401131647.i0DGlt1D069909@slash.mediapulse.com>
	<4004206C.8060007@research.att.com>
Message-ID: <C9E677D0-45EA-11D8-9AD2-000A95A072FC@sb.org>

One CGI env. var that I want via mod_python is SERVER_SIGNATURE. I 
can't find any way to get at that through mod_python so I have to use 
the add_common_vars() and subprocess_env['SERVER_SIGNATURE'] to get it.

On Jan 13, 2004, at 11:44 AM, Glenn A. Hochberg wrote:

> Actually, one CGI env. var. that I have not been able to find via 
> mod_python is HTTPS (set to "on" when using SSL).
> Is there some way to determine whether your baseurl should start with 
> https: versus http:?  I'm trying to pass my full URL to another site 
> via a redirect; I can find out everything I need except for that.

-- 
Kevin Ballard
kevin@sb.org
http://www.tildesoft.com
http://kevin.sb.org

From neel at mediapulse.com  Tue Jan 13 12:09:20 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 13 13:08:52 2004
Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 15
Message-ID: <C0FC22C08B82074A88B500617641577787A80B@johnson.mediapulse.net>

I haven't seen anything that standardizes the way SSL should create
vars, and I think there is difference even between Apache-SSL and
mod_ssl in naming.  You can get the port, 443, which is the standard for
SSL, but that doesn't mean SSL is in use.  However, given you need a
separate virtural host on port 443 for the ssl configuration, you can
easily add a PythonOption there as well to know if you are in SSL or
not.

Mike


> -----Original Message-----
> From: Glenn A. Hochberg [mailto:gah@research.att.com] 
> Sent: Tuesday, January 13, 2004 11:44 AM
> To: mod_python@modpython.org
> Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 15
> 
> 
> REMOTE_ADDR is available as req.connection.remote_ip, 
> SCRIPT_NAME as req.filename.
> 
> Actually, one CGI env. var. that I have not been able to find 
> via mod_python is HTTPS (set to "on" when using SSL).  
> 
> Is there some way to determine whether your baseurl should 
> start with https: versus http:?  I'm trying to pass my full 
> URL to another site via a redirect; I can find out everything 
> I need except for that.
> 
> 	-Glenn
> 
> On Mon, 12 Jan 2004 15:36:42 -0600, Edwin Grubbs wrote:
> 
> > On Sun, Jan 11, 2004 at 11:27:12PM -0500, Gregory (Grisha) 
> Trubetskoy wrote:
> 
> >> 
> >> On Sun, 11 Jan 2004, Edwin Grubbs wrote:
> >  
> >
> >>> > The objective is to access the environment variables 
> that are unique to
> >>> > each request such as REMOTE_ADDR, HTTP_USER_AGENT, and 
> our own cookies
> >>> > such as SESSION_COOKIE.
> >>> >
> >>    
> >>
> >> 
> >> Hmm... This may be a bug somehwere, I'll have to take a 
> look at it. But,
> >> all of this information is available directly without having to use
> >> subprocess_env, as part of the request object or req.headers_in.
> >> Subprocess_env is an inefficient way of doing it since it 
> is artificially
> >> constructed from the same sources to which mod_python 
> allows you direct
> >> access.
> >> 
> >> Grisha
> >  
> >
> 
> > The req.headers_in variable does not contain the REMOTE_ADDR or the
> > SCRIPT_NAME variables which can not be passed in using PythonOption.
> > 
> > -Edwin
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From neel at mediapulse.com  Tue Jan 13 12:11:05 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 13 13:10:36 2004
Subject: [mod_python] setting multiple cookies
Message-ID: <C0FC22C08B82074A88B50061764157776B9996@johnson.mediapulse.net>

Instead of using the table object like a dict, use the add method:

req.headers_out.add('Set-Cookie','name=Cookie1');
req.headers_out.add('Set-Cookie','name=Cookie2');

HTH,
Mike

> -----Original Message-----
> From: Jesse Lawrence [mailto:lawrence_jesse@yahoo.ca] 
> Sent: Tuesday, January 13, 2004 12:02 PM
> To: mod_python@modpython.org
> Subject: [mod_python] setting multiple cookies
> 
> 
> Hello all,
> I scanned the archives a bit for mention of setting
> multiple cookies, but didn't come across anything.  I
> noticed that the documentation mentions this in regard
> to the "table" class.  Could someone give me some
> advice regarding this?  I'm not quite sure how to use
> the table class to accomplish this.  Thanks a million
> for any help, and I apologize if this has already been
> covered.
> 
> Thanks,
> 
> Jesse Lawrence
> 
> ______________________________________________________________
> ________ 
> Post your free ad now! http://personals.yahoo.ca
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From modpython at holovaty.com  Tue Jan 13 11:30:17 2004
From: modpython at holovaty.com (Adrian Holovaty)
Date: Tue Jan 13 13:31:05 2004
Subject: [mod_python] passing a relative URL to handler?
Message-ID: <200401131130.18069.modpython@holovaty.com>

Is there a way of passing the relative URL (relative to the httpd.conf 
"Location") to a mod_python handler?

For instance, say I have the following in httpd.conf:

<Location "/admin">
    SetHandler python-program
    PythonHandler apps.admin.handler
</Location>

If the client goes to /admin/storyeditor, how do I give mod_python access to 
the part of the URL that comes after "/admin"?. Ideally the handler wouldn't 
have to know that it was tied to /admin, so I could switch that to, say, 
/administration, and I'd just have to change it in httpd.conf.

I'm currently solving this problem by passing "/admin" to the handler via a 
PythonOption, then using this bit of handler code to get the relative path:

root_location = req.get_options()['rootpath']
relative_path = req.uri[len(root_location):]

That works, but it seems hackish. Is there a cleaner way to do it?

Adrian

From gah at research.att.com  Tue Jan 13 13:22:47 2004
From: gah at research.att.com (Glenn A. Hochberg)
Date: Tue Jan 13 14:22:14 2004
Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 15
In-Reply-To: <C0FC22C08B82074A88B500617641577787A80B@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A80B@johnson.mediapulse.net>
Message-ID: <40043777.5070209@research.att.com>

Good suggestion--thanks!

    -Glenn

Michael C. Neel wrote:

>I haven't seen anything that standardizes the way SSL should create
>vars, and I think there is difference even between Apache-SSL and
>mod_ssl in naming.  You can get the port, 443, which is the standard for
>SSL, but that doesn't mean SSL is in use.  However, given you need a
>separate virtural host on port 443 for the ssl configuration, you can
>easily add a PythonOption there as well to know if you are in SSL or
>not.
>
>Mike
>
>
>  
>
>>-----Original Message-----
>>From: Glenn A. Hochberg [mailto:gah@research.att.com] 
>>Sent: Tuesday, January 13, 2004 11:44 AM
>>To: mod_python@modpython.org
>>Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 15
>>
>>
>>REMOTE_ADDR is available as req.connection.remote_ip, 
>>SCRIPT_NAME as req.filename.
>>
>>Actually, one CGI env. var. that I have not been able to find 
>>via mod_python is HTTPS (set to "on" when using SSL).  
>>
>>Is there some way to determine whether your baseurl should 
>>start with https: versus http:?  I'm trying to pass my full 
>>URL to another site via a redirect; I can find out everything 
>>I need except for that.
>>
>>	-Glenn
>>
>>On Mon, 12 Jan 2004 15:36:42 -0600, Edwin Grubbs wrote:
>>
>>    
>>
>>>On Sun, Jan 11, 2004 at 11:27:12PM -0500, Gregory (Grisha) 
>>>      
>>>
>>Trubetskoy wrote:
>>
>>    
>>
>>>>On Sun, 11 Jan 2004, Edwin Grubbs wrote:
>>>>        
>>>>
>>> 
>>>
>>>      
>>>
>>>>>>The objective is to access the environment variables 
>>>>>>            
>>>>>>
>>that are unique to
>>    
>>
>>>>>>each request such as REMOTE_ADDR, HTTP_USER_AGENT, and 
>>>>>>            
>>>>>>
>>our own cookies
>>    
>>
>>>>>>such as SESSION_COOKIE.
>>>>>>
>>>>>>            
>>>>>>
>>>>   
>>>>
>>>>
>>>>Hmm... This may be a bug somehwere, I'll have to take a 
>>>>        
>>>>
>>look at it. But,
>>    
>>
>>>>all of this information is available directly without having to use
>>>>subprocess_env, as part of the request object or req.headers_in.
>>>>Subprocess_env is an inefficient way of doing it since it 
>>>>        
>>>>
>>is artificially
>>    
>>
>>>>constructed from the same sources to which mod_python 
>>>>        
>>>>
>>allows you direct
>>    
>>
>>>>access.
>>>>
>>>>Grisha
>>>>        
>>>>
>>> 
>>>
>>>      
>>>
>>>The req.headers_in variable does not contain the REMOTE_ADDR or the
>>>SCRIPT_NAME variables which can not be passed in using PythonOption.
>>>
>>>-Edwin
>>>      
>>>
>>_______________________________________________
>>Mod_python mailing list
>>Mod_python@modpython.org
>>http://mailman.modpython.org/mailman/listinfo/mod_python
>>
>>    
>>
>
>  
>

From paul at oz.net  Tue Jan 13 14:53:54 2004
From: paul at oz.net (Paul)
Date: Tue Jan 13 18:53:29 2004
Subject: [mod_python] cgihandler.py never returns 500
Message-ID: <Pine.LNX.4.58.0401131446260.9993@kodiak.oz.net>

The cgihandler.py in mod_python 3.0.4 and earlier never seems
to return an HTTP 500 error (internal server error).  Code
snippet from cgihandler.py:

            # this executes the module
            imp.load_module(module_name, fd, path, desc)

            return apache.OK

Shouldn't this be something like:

            # this executes the module
            try:
                imp.load_module(module_name, fd, path, desc)
            except Exception, e:
                if e.args and type(e.args[0]) == types.IntType:
                    return e.args[0]
                else:
                    return apache.HTTP_INTERNAL_SERVER_ERROR

            return apache.OK

publisher.py has something similar implemented.

-- Paul

From grisha at modpython.org  Tue Jan 13 21:52:38 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Jan 13 22:52:11 2004
Subject: [mod_python] Re: Mod_python 3.1.2b, sethandler + dir listning
 problem
In-Reply-To: <20031107100013.GB1233@itea.ntnu.no>
References: <3FA40C83.5050502@krap.dk> <20031102155855.P47316@onyx.ispol.com>
	<3FAAAEDE.3060804@krap.dk> <20031107100013.GB1233@itea.ntnu.no>
Message-ID: <20040113214739.Y54658@onyx.ispol.com>


Sorry for a late response, but this behaviour is (was - fixed in CVS) a
bug. The error message in the log should only show up (and only makes
sense) when you return OK, meaning the user has been authenticated, but
req.user has no value. The bug was that it didn't check for return value,
but always threw an error whenver req.user had no value.

P.S. You have a potential problem lurking in the code below. req.user is
initially None, so instead of:

  if user != "":

use

  if user:

because None is not equal to "" as far as Python is concerned.

Grisha

On Fri, 7 Nov 2003, Stian [iso-8859-1] S?iland wrote:

> We've found out with 3.1.2b that the AuthenHandler-thingie is not fully
> functional.
>
> We tried the simple example from the documentations, and even made it
> simpler:
>
> .htaccess
> ---------
> PythonPath "['/our/libs'] + sys.path"
> PythonAuthenHandler Cerebrum.web.login
> AuthType Basic
> AuthName "Cerebrum"
> require valid-user
>
>
> Cerebrum/web/login.py
> ---------------------
> from mod_python import apache
>
> def authenhandler(req):
>     pw = req.get_basic_auth_pw()
>     user = req.user
>     if user != "":
>         return apache.OK
>     return apache.HTTP_UNAUTHORIZED
>
>
>
> This failed with a 500 Server Error. Watching the apache log reveals a
> hint:
>
> [Fri Nov 07 10:49:42 2003] [error] [client 129.241.56.39]
> python_handler: After PythonAuthenHandler req->user is NULL. Assign
> req.user to avoid this error.
>
From grisha at modpython.org  Tue Jan 13 22:26:29 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Jan 13 23:26:08 2004
Subject: [mod_python] Session instances can't be stored in req?
In-Reply-To: <20031107103633.GC1233@itea.ntnu.no>
References: <20031107103633.GC1233@itea.ntnu.no>
Message-ID: <20040113222211.C54658@onyx.ispol.com>


Technically speaking the server doesn't hang, but your particular session
does.

The Session object contains a reference to a request object, and when you
assign a session to a request you get a circular reference, therefore, the
session unlock() method is never called.

I have patched up mod_python so that now whenever the Session.lock() is
called, it will register a cleanup to always unlock at the end of the
request.

This should address the hang, but I suspect that such a circular reference
may end up eating memory, so it's probably a good idea to explicitely
delete the [in this case] req.blupp attribute after you no longer need it
with something like:

req.blupp = None

Grisha

On Fri, 7 Nov 2003, Stian [iso-8859-1] S?iland wrote:

> Again with 3.1.2b..
>
> I've gone a bit tired of creating the session objects on every page, so
> I made a fixuphandler to do the trick. The problem is, Apache hangs for
> infinity:
>
> def fixuphandler(req):
>     # req.session = Session(req)
>     sezz = Session(req)
>     req.blapp = str(id(sezz))
>     req.blupp = sezz
>     open("/tmp/faentosk", "w")
>     return apache.OK
>
>
> Within index.py:  (result is a html document)
>
> try:
>     result.add(req.blapp)
>     result.add(str(id(req.blupp)))
>     result.add(str(req.sezz))
> except Exception, e:
>     result.add(str(e))
>
> Now, if I don't save the session instance (the sezz) - everything works. If I
> try to store sezz in req.blupp - everything fails - the apache process hangs,
> the file /tmp/faentosk is never created, ie. everything stops at the
> previous line.
>
> I've tried making a Dummy class and instanciating it instead, sezz =
> Dummy() - and writing out the id in same way, works like a charm, and
> the id confirms that it's the same object instanciated within
> fixuphandler.
>
> Any tip?
>
> --
> Stian S?iland               Work toward win-win situation. Win-lose
> Trondheim, Norway           is where you win and the other lose.
> http://www.soiland.no/      Lose-lose and lose-win are left as an
>                             exercise to the reader.  [Limoncelli/Hogan]
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From fowlertrainer at anonym.hu  Wed Jan 14 10:11:45 2004
From: fowlertrainer at anonym.hu (fowlertrainer@anonym.hu)
Date: Wed Jan 14 05:11:28 2004
Subject: [mod_python] DEBIAN SID problems
Message-ID: <1715961091.20040114101145@anonym.hu>

Hello !

I've been developed an site on windows. Py2.3/mod_python/KinterBasDB.
It is working good.

But if I want to port to Debian SID, it has been dropped internal
server errors.
The server log is like this:
Processing config directory: /etc/apache/conf.d
[Tue Jan 13 20:43:00 2004] [notice] Apache/1.3.29 (Debian GNU/Linux) configured -- resuming normal operations
[Tue Jan 13 20:43:00 2004] [notice] Accept mutex: sysvsem (Default: sysvsem)
[Wed Jan 14 06:25:33 2004] [notice] SIGUSR1 received.  Doing graceful restart
Processing config directory: /etc/apache/conf.d
[Wed Jan 14 06:25:34 2004] [notice] Apache/1.3.29 (Debian GNU/Linux) mod_python/2.7.10 Python/2.3.2 configured -- resuming no
[Wed Jan 14 06:25:34 2004] [notice] Accept mutex: sysvsem (Default: sysvsem)
[Wed Jan 14 10:53:31 2004] [notice] caught SIGTERM, shutting down
Processing config directory: /etc/apache/conf.d
[Wed Jan 14 10:55:53 2004] [notice] Apache/1.3.29 (Debian GNU/Linux) mod_python/2.7.10 Python/2.3.2 configured -- resuming no
[Wed Jan 14 10:55:53 2004] [notice] Accept mutex: sysvsem (Default: sysvsem)
[Wed Jan 14 11:57:08 2004] [notice] caught SIGTERM, shutting down
Processing config directory: /etc/apache/conf.d
[Wed Jan 14 11:57:15 2004] [notice] Apache/1.3.29 (Debian GNU/Linux) mod_python/2.7.10 Python/2.3.2 configured -- resuming no
[Wed Jan 14 11:57:15 2004] [notice] Accept mutex: sysvsem (Default: sysvsem)
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 14 11:58:08 2004] [error] [client 192.168.1.202] python_handler: make_obcallback returned no obCallBack!
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 14 11:58:11 2004] [error] [client 192.168.1.202] python_handler: make_obcallback returned no obCallBack!
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 14 12:05:27 2004] [error] [client 192.168.1.202] python_handler: make_obcallback returned no obCallBack!
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 14 12:05:28 2004] [error] [client 192.168.1.202] python_handler: make_obcallback returned no obCallBack!
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 14 12:05:29 2004] [error] [client 192.168.1.202] python_handler: make_obcallback returned no obCallBack!
make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init.
[Wed Jan 14 12:05:29 2004] [error] [client 192.168.1.202] python_handler: make_obcallback returned no obCallBack!

The main.py handler is like this:

from mod_python import apache
import os

def handler(req):
    req.write("OS": os.name)
    return apache.OK

Anybody have an idea to solution ?

Thanx for every answer !

-- 
Best regards,
 fowlertrainer                          mailto:fowlertrainer@anonym.hu

From colet at code-energy.com  Wed Jan 14 08:33:33 2004
From: colet at code-energy.com (Cole Tuininga)
Date: Wed Jan 14 09:35:39 2004
Subject: [mod_python] DEBIAN SID problems
In-Reply-To: <1715961091.20040114101145@anonym.hu>
References: <1715961091.20040114101145@anonym.hu>
Message-ID: <1074087213.4727.8.camel@trogdor>

On Wed, 2004-01-14 at 04:11, fowlertrainer@anonym.hu wrote:
> Hello !
> 
> I've been developed an site on windows. Py2.3/mod_python/KinterBasDB.
> It is working good.
> 
> But if I want to port to Debian SID, it has been dropped internal
> server errors.

Not to put to fine a point on it, but there is a reason Debian SID is
also known as "unstable".  That's not to say that this is the reason for
your difficulties, but have you tried it on Woody system?

-- 
"... one of the main causes of the fall of the Roman Empire was that,
 lacking zero, they had no way to indicate successful termination of
 their C programs."  --  Robert Firth

Cole Tuininga
Lead Developer
Code Energy, Inc
colet@code-energy.com
PGP Key ID: 0x43E5755D


From hrz at geodata.soton.ac.uk  Wed Jan 14 14:30:47 2004
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Wed Jan 14 10:30:43 2004
Subject: [mod_python] mod_python/mod_include integration
Message-ID: <200401141430.i0EEUmR18467@betsy.geodata.soton.ac.uk>

Hello,

I am interested in knowing if there is a python equivalent to Perl's
Apache::Include module which provides mod_perl/mod_include integration
(http://perl.apache.org/docs/1.0/api/Apache/Include.html). I'm
especially interested to know if I can accomplish what
Apache::Include->virtual($uri) does with mod_python. This is namely to
include the output of a given (local) uri in my mod_python script. In
other words I would like to do what the SSI element <!--#include
virtual=""--> does with but with python.

I would like to include, for instance, the output from PHP, a CGI
script or simple HTML file in my mod_python app. This will enable me
to build the generic templating system that I require. I had hoped
that I could use the internal_redirect method of the request object to
do the same thing but it appears that once an internal_redirect has
been initated the initial content handler is no longer valid.

Can this be done and, if so, how?

Any and all pointers gratefully received!

Homme Zwaagstra
From dpopowich at mtrsd.k12.ma.us  Wed Jan 14 10:10:57 2004
From: dpopowich at mtrsd.k12.ma.us (Daniel J. Popowich)
Date: Wed Jan 14 11:11:02 2004
Subject: [mod_python] setting content_type intelligently
In-Reply-To: <1074012657.5437.12.camel@ack.dwerg.net>
References: <16388.4485.164768.754148@gargle.gargle.HOWL>
	<1074012657.5437.12.camel@ack.dwerg.net>
Message-ID: <16389.23553.415519.457591@gargle.gargle.HOWL>


Manfred Stienstra writes:
> On Tue, 2004-01-13 at 16:40, Daniel J. Popowich wrote:
> >    1.  What does mod_python/apache do if content_type is not set by a
> >        handler?  Does it default to text/plain?
> 
> It defaults to the default Apache mimetype.
> 
> >    2.  I'm looking for an intelligent means of setting the
> >        content_type.  I know I can use mimetypes.guess_type(), but
> >        that is based only on the file's extension.  Apache does more
> >        than that, eg, if 'foo.gif' was named 'foo' apache still
> >        determines the content type correctly as image/gif.  Is there a
> >        way to tap into apache's content_type determination?
> 
> Apache uses the same resolution as the 'file' command on *nix, it uses a
> file with rules (/etc/apache*/mime.types) to resolve the mimetype. I'm
> not sure if there is a python frontend for this.

Thanks, after reading that I discovered mod_mime and mod_mime_magic.
It's not clear to me how to tap into those.  Anyone know?

Meanwhile I guess I'm stuck with mimetypes.guess_type() or moving my
app into a <Directory ...> directive.

Dan


From neel at mediapulse.com  Wed Jan 14 10:50:45 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Wed Jan 14 11:50:18 2004
Subject: [mod_python] mod_python/mod_include integration
Message-ID: <C0FC22C08B82074A88B50061764157776B99AE@johnson.mediapulse.net>

In theroy you can use the Apache 2.x chain handlers feature, where more
than one content handler can process the request.  I say in theroy
because I've read about it, but never tried it =)

Mike

> -----Original Message-----
> From: Homme Zwaagstra [mailto:hrz@geodata.soton.ac.uk] 
> Sent: Wednesday, January 14, 2004 9:31 AM
> To: mod_python@modpython.org
> Subject: [mod_python] mod_python/mod_include integration
> 
> 
> Hello,
> 
> I am interested in knowing if there is a python equivalent to Perl's
> Apache::Include module which provides mod_perl/mod_include integration
> (http://perl.apache.org/docs/1.0/api/Apache/Include.html). I'm
> especially interested to know if I can accomplish what
> Apache::Include->virtual($uri) does with mod_python. This is namely to
> include the output of a given (local) uri in my mod_python script. In
> other words I would like to do what the SSI element <!--#include
> virtual=""--> does with but with python.
> 
> I would like to include, for instance, the output from PHP, a CGI
> script or simple HTML file in my mod_python app. This will enable me
> to build the generic templating system that I require. I had hoped
> that I could use the internal_redirect method of the request object to
> do the same thing but it appears that once an internal_redirect has
> been initated the initial content handler is no longer valid.
> 
> Can this be done and, if so, how?
> 
> Any and all pointers gratefully received!
> 
> Homme Zwaagstra
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From dwmp at opti.cgi.net  Wed Jan 14 21:31:04 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Wed Jan 14 23:27:07 2004
Subject: [mod_python] Startup Options
Message-ID: <5.2.1.1.2.20040114210126.03307008@mail.pyxos.com>


mod_python's PythonImport is a neat feature; it allows you to run a script 
when an Apache process fires up.  However, it doesn't work under 
VirtualHosts, only the main server config (mod_python 3.0 and up).  I need 
to support multiple users all who have their own VirtualHosts and all whom 
need PythonImport to setup database connections under their VirtualHost's 
interpreter.  The startup scripts and handler code are naturally located 
under each users' home directory for privacy.

My first attempt was simply to use PythonPath and PythonImport under each 
VirtualHost.  This is straight forward and simple.  Append to the path so 
that the Import can find the startup code in the home directory of each 
user and then issue the PythonImport for their startup script.  This 
doesn't work because PythonImport only works in the main server config.

My second attempt was to use a generic loader with PythonImport (located in 
site-packages) and then use PythonOption to pass it the path and actual 
startup script for each interpreter (VirtualHost).  This doesn't work 
because you can't access PythonOption variables until a request is made.

My third thought was to setup individual scripts for each VirtualHost in 
the site-packages directory with the startup information for each 
user.  The problem here is that the startup scripts have to be owned by the 
user and not world readable (their database passwords are in there).  This 
causes a read problem for server processes run as the user nobody.

I'm not sure how else to make this happen and it's very frustrating.  I 
have all the elements I need, I just can't find a way to put them together 
to accomplish a seemingly simple task.

It sure would be nice if PyhtonImport could be made to run under 
VirtualHosts.  Failing that, a way to get to a VirtualHost's PythonOptions 
would do.  Grisha?

-Dan

From davidf at sjsoft.com  Thu Jan 15 07:48:04 2004
From: davidf at sjsoft.com (David Fraser)
Date: Thu Jan 15 01:47:37 2004
Subject: [mod_python] Startup Options
In-Reply-To: <5.2.1.1.2.20040114210126.03307008@mail.pyxos.com>
References: <5.2.1.1.2.20040114210126.03307008@mail.pyxos.com>
Message-ID: <40062994.8070703@sjsoft.com>

Daniel West wrote:

>
> mod_python's PythonImport is a neat feature; it allows you to run a 
> script when an Apache process fires up.  However, it doesn't work 
> under VirtualHosts, only the main server config (mod_python 3.0 and 
> up).  I need to support multiple users all who have their own 
> VirtualHosts and all whom need PythonImport to setup database 
> connections under their VirtualHost's interpreter.  The startup 
> scripts and handler code are naturally located under each users' home 
> directory for privacy.
>
> My first attempt was simply to use PythonPath and PythonImport under 
> each VirtualHost.  This is straight forward and simple.  Append to the 
> path so that the Import can find the startup code in the home 
> directory of each user and then issue the PythonImport for their 
> startup script.  This doesn't work because PythonImport only works in 
> the main server config.
>
> My second attempt was to use a generic loader with PythonImport 
> (located in site-packages) and then use PythonOption to pass it the 
> path and actual startup script for each interpreter (VirtualHost).  
> This doesn't work because you can't access PythonOption variables 
> until a request is made.
>
> My third thought was to setup individual scripts for each VirtualHost 
> in the site-packages directory with the startup information for each 
> user.  The problem here is that the startup scripts have to be owned 
> by the user and not world readable (their database passwords are in 
> there).  This causes a read problem for server processes run as the 
> user nobody.
>
> I'm not sure how else to make this happen and it's very frustrating.  
> I have all the elements I need, I just can't find a way to put them 
> together to accomplish a seemingly simple task.
>
> It sure would be nice if PyhtonImport could be made to run under 
> VirtualHosts.  Failing that, a way to get to a VirtualHost's 
> PythonOptions would do.  Grisha?
>
> -Dan

You can always write some code that calculates the import needed for 
each request, and imports it. Then you can cache all the imports in some 
way but the reimporting should be painless anyway. That's what we do, 
depending on PythonOptions.

David

From kamil at nvstudio.pl  Thu Jan 15 11:38:23 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Thu Jan 15 06:38:29 2004
Subject: [mod_python] mod_python and apache configuration problem
Message-ID: <20040115113823.44aef7cb.kamil@nvstudio.pl>


There was a similar question here some time ago, but the ansewer does
not help with my problem. I have apache virtual host (say,
http://testsite.local and mod_python handler handling _ALL_ 
requests to this url (like http://testsite.local/form, http://testsite.local/
and so on) - just like there was no filesystem.
The document root directory for it is, for example, 
/home/me/public_html/my_app, where handler.py file resides and all
files my application uses (like /img, /lib, /form and so on). Now, I put
this in my httpd.conf section of this <Virtual Host>:

<DocumentRoot /home/me/public_html/my_app>
<Location />
  <SetHandler python-program>
  <PythonHandler handler>
  <PythonPath "sys.path + ['/home/me/public_html/my_app']"
</Location>

now it seems to work as soon as I don't specify in my URL any directory
that physically exists in my document root (like /form, when I go to
http://testsite.local/form it shows directory index with files - I want
it to process _every_ request by my mod_python handler, and it seems
that Apache just ignores my wish and shows directory content. by the
way, http://testsite.local/form/somerandomstring works fine. I tried
everything, using <Directory> instead of <Location> in every possible
way and still it shows content, not what my handler returns.

Is there any way to prevent Apache from doing that and force it to 
really redirect every request to my python handler? I just want to skip
the phase where URL for this specified Virtual Host is translated to
filesystem, so I could use everything after http://servername/ without
worrying that if it maps to some directory in my application dir, 
apache will display it content, with Python code for example. :-/
I guess the simplest solution will be not creating any directories in my
document root, but I need them to have a nice structure of my app
code, not everything in one dir. This would be stupid. 

With regards,
 Kamil
From hrz at geodata.soton.ac.uk  Thu Jan 15 10:54:21 2004
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Thu Jan 15 06:54:12 2004
Subject: [mod_python] mod_python and apache configuration problem
In-Reply-To: <20040115113823.44aef7cb.kamil@nvstudio.pl> from "Kamil
	Niechajewicz" at Jan 15, 2004 11:38:23 AM
Message-ID: <200401151054.i0FAsLv01384@betsy.geodata.soton.ac.uk>

What happens if you use

Options -Indexes

to prevent directory indexing?

> 
> 
> There was a similar question here some time ago, but the ansewer does
> not help with my problem. I have apache virtual host (say,
> http://testsite.local and mod_python handler handling _ALL_ 
> requests to this url (like http://testsite.local/form, http://testsite.local/
> and so on) - just like there was no filesystem.
> The document root directory for it is, for example, 
> /home/me/public_html/my_app, where handler.py file resides and all
> files my application uses (like /img, /lib, /form and so on). Now, I put
> this in my httpd.conf section of this <Virtual Host>:
> 
> <DocumentRoot /home/me/public_html/my_app>
> <Location />
>   <SetHandler python-program>
>   <PythonHandler handler>
>   <PythonPath "sys.path + ['/home/me/public_html/my_app']"
> </Location>
> 
> now it seems to work as soon as I don't specify in my URL any directory
> that physically exists in my document root (like /form, when I go to
> http://testsite.local/form it shows directory index with files - I want
> it to process _every_ request by my mod_python handler, and it seems
> that Apache just ignores my wish and shows directory content. by the
> way, http://testsite.local/form/somerandomstring works fine. I tried
> everything, using <Directory> instead of <Location> in every possible
> way and still it shows content, not what my handler returns.
> 
> Is there any way to prevent Apache from doing that and force it to 
> really redirect every request to my python handler? I just want to skip
> the phase where URL for this specified Virtual Host is translated to
> filesystem, so I could use everything after http://servername/ without
> worrying that if it maps to some directory in my application dir, 
> apache will display it content, with Python code for example. :-/
> I guess the simplest solution will be not creating any directories in my
> document root, but I need them to have a nice structure of my app
> code, not everything in one dir. This would be stupid. 
> 
> With regards,
>  Kamil
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 


-- 
From kamil at nvstudio.pl  Thu Jan 15 12:10:39 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Thu Jan 15 07:10:44 2004
Subject: [mod_python] mod_python and apache configuration problem
In-Reply-To: <200401151054.i0FAsLv01384@betsy.geodata.soton.ac.uk>
References: <20040115113823.44aef7cb.kamil@nvstudio.pl>
	<200401151054.i0FAsLv01384@betsy.geodata.soton.ac.uk>
Message-ID: <20040115121039.489f3ccc.kamil@nvstudio.pl>

On Thu, 15 Jan 2004 10:54:21 +0000 (GMT)
Homme Zwaagstra <hrz@geodata.soton.ac.uk> wrote:

> What happens if you use
> 
> Options -Indexes
> 
> to prevent directory indexing?

I get 403 Forbidden error.

 

From gah at research.att.com  Thu Jan 15 14:18:48 2004
From: gah at research.att.com (Glenn A. Hochberg)
Date: Thu Jan 15 15:18:18 2004
Subject: [mod_python] Re: Mod_python Digest, Vol 10, Issue 19
In-Reply-To: <200401151700.i0FH061D077347@slash.mediapulse.com>
References: <200401151700.i0FH061D077347@slash.mediapulse.com>
Message-ID: <4006E798.4040108@research.att.com>

Perhaps you can just create an empty subdirectory and use that as the 
DocumentRoot, i.e. /home/me/public_html/my_app/docroot.  That way you 
can leave your app structure alone and not have to worry about 
directories under the doc root.

    -Glenn

>There was a similar question here some time ago, but the ansewer does
>not help with my problem. I have apache virtual host (say,
>http://testsite.local and mod_python handler handling _ALL_ 
>requests to this url (like http://testsite.local/form, http://testsite.local/
>and so on) - just like there was no filesystem.
>The document root directory for it is, for example, 
>/home/me/public_html/my_app, where handler.py file resides and all
>files my application uses (like /img, /lib, /form and so on). Now, I put
>this in my httpd.conf section of this <Virtual Host>:
>
><DocumentRoot /home/me/public_html/my_app>
><Location />
>  <SetHandler python-program>
>  <PythonHandler handler>
>  <PythonPath "sys.path + ['/home/me/public_html/my_app']"
></Location>
>
>now it seems to work as soon as I don't specify in my URL any directory
>that physically exists in my document root (like /form, when I go to
>http://testsite.local/form it shows directory index with files - I want
>it to process _every_ request by my mod_python handler, and it seems
>that Apache just ignores my wish and shows directory content. by the
>way, http://testsite.local/form/somerandomstring works fine. I tried
>everything, using <Directory> instead of <Location> in every possible
>way and still it shows content, not what my handler returns.
>
>Is there any way to prevent Apache from doing that and force it to 
>really redirect every request to my python handler? I just want to skip
>the phase where URL for this specified Virtual Host is translated to
>filesystem, so I could use everything after http://servername/ without
>worrying that if it maps to some directory in my application dir, 
>apache will display it content, with Python code for example. :-/
>I guess the simplest solution will be not creating any directories in my
>document root, but I need them to have a nice structure of my app
>code, not everything in one dir. This would be stupid. 
>
>With regards,
> Kamil
>  
>

From matt at overlook.homelinux.net  Thu Jan 15 15:10:53 2004
From: matt at overlook.homelinux.net (Matthew Wilson)
Date: Thu Jan 15 15:33:29 2004
Subject: [mod_python] How to do session-tracking and user-logins?
Message-ID: <20040115201053.GA29223@frank.overlook.homelinux.net>

I need a way to force users to log in, and then I need to track a
session, either with cookies, or session IDs.  I should probably learn
both methods, but right now I don't know either.

I've done this with PHP, but I don't really like PHP.  Can anyone give
me a description of how to handle sessions in mod_python?

I've been writing CGI scripts for a while, and I know how to use basic
http user authentication with .htaccess files. 

Thanks.

-- 
My public key:
gpg --recv-keys --keyserver www.mandrakesecure.net 0x8D10BFD5
From michael at dynamine.net  Thu Jan 15 11:56:59 2004
From: michael at dynamine.net (Michael S. Fischer)
Date: Thu Jan 15 15:56:39 2004
Subject: [mod_python] How to do session-tracking and user-logins?
In-Reply-To: <20040115201053.GA29223@frank.overlook.homelinux.net>
References: <20040115201053.GA29223@frank.overlook.homelinux.net>
Message-ID: <4006F08B.5070606@dynamine.net>

mod_python 3.1.2b has session support in the box.  Check out the 
documentation on the Web site.

--Michael

Matthew Wilson wrote:
> I need a way to force users to log in, and then I need to track a
> session, either with cookies, or session IDs.  I should probably learn
> both methods, but right now I don't know either.
> 
> I've done this with PHP, but I don't really like PHP.  Can anyone give
> me a description of how to handle sessions in mod_python?
> 
> I've been writing CGI scripts for a while, and I know how to use basic
> http user authentication with .htaccess files. 
> 
> Thanks.
> 
From modpython at holovaty.com  Thu Jan 15 16:13:27 2004
From: modpython at holovaty.com (Adrian Holovaty)
Date: Thu Jan 15 18:14:20 2004
Subject: [mod_python] passing a relative URL to handler?
In-Reply-To: <200401131130.18069.modpython@holovaty.com>
References: <200401131130.18069.modpython@holovaty.com>
Message-ID: <200401151613.27611.modpython@holovaty.com>

Earlier, I wrote:
> Is there a way of passing the relative URL (relative to the httpd.conf
> "Location") to a mod_python handler?

I just learned mod_perl request objects have a location() method that returns 
"the path of the <Location> section from which the current Perl*Handler is 
being called." 

http://perl.apache.org/docs/1.0/api/Apache.html#_r_E_gt_location

It'd be useful if mod_python request objects had a similar method...

Adrian

From gnb at itga.com.au  Fri Jan 16 11:03:19 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Thu Jan 15 20:02:53 2004
Subject: [mod_python] How to do session-tracking and user-logins? 
In-Reply-To: Your message of Thu, 15 Jan 2004 15:10:53 -0500.
Message-ID: <200401160003.LAA20727@lightning.itga.com.au>

Check the FAQ:
	http://www.modpython.org/FAQ/faqw.py?req=all#3.8

From cfox at cfconsulting.ca  Thu Jan 15 20:16:40 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Fri Jan 16 00:16:21 2004
Subject: [mod_python] Multiple handler question
Message-ID: <1074226600.882.48.camel@cube>

Hi, All.

I've been playing with mod_python for a little while, and I love it! I
do have one puzzle, though.

What would be the best way of executing an on-disk module? It would be
nice to be able to do  something like:

def handler(req):
    modname = req.filename
    if modname.endswith('.pyx'):
        import modname
        modname['main'](req)

(I know this is very pseudo. It's just to convey what I mean.)

But as far as I know, you can't use 'import' on a variable.

I'd prefer to do this over invoking the python interpreter, of course,
to keep everything within the mod_python execution environment.

Any suggestions?

Thanks,
   cf

-- 
Colin Fox <cfox@cfconsulting.ca>
CF Consulting Inc.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://oldchief.reply.net/pipermail/mod_python/attachments/20040115/6fd7bbd6/attachment.bin
From dwmp at opti.cgi.net  Thu Jan 15 22:31:55 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Fri Jan 16 00:27:58 2004
Subject: [mod_python] Multiple handler question
In-Reply-To: <1074226600.882.48.camel@cube>
Message-ID: <5.2.1.1.2.20040115222618.049012b8@mail.pyxos.com>

At 08:16 PM 1/15/2004 -0800, you wrote:
>Hi, All.
>
>I've been playing with mod_python for a little while, and I love it! I
>do have one puzzle, though.
>
>What would be the best way of executing an on-disk module? It would be
>nice to be able to do  something like:
>
>def handler(req):
>     modname = req.filename
>     if modname.endswith('.pyx'):
>         import modname
>         modname['main'](req)
>
>(I know this is very pseudo. It's just to convey what I mean.)
>
>But as far as I know, you can't use 'import' on a variable.

How about the import builtin?

def handler(req):
     modname = req.filename
     if modname.endswith('.pyx'):
         mod = __import__(modname)
         mod.main(req)


Although it's a little more complicated than this.  You'll have to add the 
path to sys.path and then split out the file name to import.  Also you 
might have to do something to get python to import a file with a pyx extension.

-Dan

From gnb at itga.com.au  Fri Jan 16 15:28:49 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Fri Jan 16 00:28:30 2004
Subject: [mod_python] Multiple handler question 
In-Reply-To: Your message of Thu, 15 Jan 2004 20:16:40 -0800.
Message-ID: <200401160428.PAA23377@lightning.itga.com.au>

> What would be the best way of executing an on-disk module?

Check the doco for the imp builtin module - it gives access to the guts of the 
python "import module" machinery.

From grisha at modpython.org  Thu Jan 15 23:29:44 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan 16 00:29:18 2004
Subject: [mod_python] Multiple handler question
In-Reply-To: <1074226600.882.48.camel@cube>
References: <1074226600.882.48.camel@cube>
Message-ID: <20040115232611.G93714@onyx.ispol.com>


from mod_python import apache
import os

def handler(req):

    modname, ext = os.path.split(req.filename)

    if ext == '.pyx':
        pyx_mod = apache.import_module(modname)


This code has not been tested :-)

BTW - You should check out the publisher handler, it probably already does
what you're trying to do.

Grisha


On Thu, 15 Jan 2004, Colin Fox wrote:

> Hi, All.
>
> I've been playing with mod_python for a little while, and I love it! I
> do have one puzzle, though.
>
> What would be the best way of executing an on-disk module? It would be
> nice to be able to do  something like:
>
> def handler(req):
>     modname = req.filename
>     if modname.endswith('.pyx'):
>         import modname
>         modname['main'](req)
>
> (I know this is very pseudo. It's just to convey what I mean.)
>
> But as far as I know, you can't use 'import' on a variable.
>
> I'd prefer to do this over invoking the python interpreter, of course,
> to keep everything within the mod_python execution environment.
>
> Any suggestions?
>
> Thanks,
>    cf
>
> --
> Colin Fox <cfox@cfconsulting.ca>
> CF Consulting Inc.
>
From cfox at cfconsulting.ca  Thu Jan 15 20:54:35 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Fri Jan 16 00:54:15 2004
Subject: [mod_python] Multiple handler question
In-Reply-To: <20040115232611.G93714@onyx.ispol.com>
References: <1074226600.882.48.camel@cube>
	 <20040115232611.G93714@onyx.ispol.com>
Message-ID: <1074228875.884.66.camel@cube>

On Thu, 2004-01-15 at 20:29, Gregory (Grisha) Trubetskoy wrote:
> from mod_python import apache
> import os
> 
> def handler(req):
> 
>     modname, ext = os.path.split(req.filename)
> 
>     if ext == '.pyx':
>         pyx_mod = apache.import_module(modname)
> 
> 
> This code has not been tested :-)
> 
> BTW - You should check out the publisher handler, it probably already does
> what you're trying to do.
> 
> Grisha

I can't believe I got three answers all within 3 minutes. Now that's
responsive!

This worked, with slight mods (the split actually is (path, file), not
(module, ext).

I didn't know about the apache import function. Thanks!

In case anyone's interested, I'm working on an Apache+XML based server.
I've looked at and used Zope, PHP & cocoon, and I feel that this is a
better way to go. Cocoon is probably closest to what I'm doing, but it's
all java, and I'm a python guy.

Once I've got the system on good footing, I'll open up the code for
anyone else who may want to get involved.

cf
-- 
Colin Fox <cfox@cfconsulting.ca>
CF Consulting Inc.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: This is a digitally signed message part
Url : http://oldchief.reply.net/pipermail/mod_python/attachments/20040115/730d6d41/attachment.bin
From grisha at modpython.org  Fri Jan 16 22:13:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan 16 23:12:41 2004
Subject: [mod_python] PSP Example
Message-ID: <20040116221158.F9788@onyx.ispol.com>


For those of you looking for PSP usage example, here is a little usage
sample I made, let me know if you find it useful:

http://www.modpython.org/examples/psp_site/

Grisha
From oliver at mellet.net  Sat Jan 17 00:08:34 2004
From: oliver at mellet.net (Oliver Mellet)
Date: Sat Jan 17 04:08:10 2004
Subject: [mod_python] apache log_error
Message-ID: <5885C038-48C4-11D8-8406-000A95962D62@mellet.net>

In using the log_error function, I'm not seeing any messages from 
python in the apache log when I use apache.APLOG_DEBUG or 
apache.APLOG_NOTICE.  All other warning levels higher than that seem to 
make it into the output ok.  (I see other debug messages from apache, 
and my LogLevel is set to debug, and PythonDebug is On).  Can anyone 
else confirm this?
This is on Mac OS X / Apache 2.0.48 / mod_python 3.1.2b

Thanks,
Oliver

From Saiello at Jentoo.com  Sat Jan 17 09:21:57 2004
From: Saiello at Jentoo.com (Saiello@Jentoo.com)
Date: Sat Jan 17 10:27:26 2004
Subject: [mod_python] ImportError: No module named index
Message-ID: <200401170921.57634."Saiello@Jentoo.com">

Using:
Apache-2.0.46
python-2.2.3-r5
mod_python-3.1b

Apache conf:
<Directory /home/httpd/htdocs/python>
        SetHandler mod_python
        PythonHandler mod_python.publisher
        #PythonDebug On
</Directory>

new.py
from mod_python import apache

def index(req):
	return "Hello World!"

Error_log:
PythonHandler mod_python.publisher: ImportError: No module named index


Any ideas ?

From grisha at modpython.org  Sat Jan 17 11:25:41 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sat Jan 17 12:25:17 2004
Subject: [mod_python] ImportError: No module named index
In-Reply-To: <200401170921.57634."Saiello@Jentoo.com">
References: <200401170921.57634."Saiello@Jentoo.com">
Message-ID: <20040117112519.V20541@onyx.ispol.com>


What's the URL you're trying to access?


On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:

> Using:
> Apache-2.0.46
> python-2.2.3-r5
> mod_python-3.1b
>
> Apache conf:
> <Directory /home/httpd/htdocs/python>
>         SetHandler mod_python
>         PythonHandler mod_python.publisher
>         #PythonDebug On
> </Directory>
>
> new.py
> from mod_python import apache
>
> def index(req):
> 	return "Hello World!"
>
> Error_log:
> PythonHandler mod_python.publisher: ImportError: No module named index
>
>
> Any ideas ?
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From Saiello at Jentoo.com  Sun Jan 18 08:10:43 2004
From: Saiello at Jentoo.com (Saiello@Jentoo.com)
Date: Sun Jan 18 09:16:17 2004
Subject: [mod_python] ImportError: No module named index
In-Reply-To: <20040117213100.X23718@onyx.ispol.com>
References: <200401170921.57634."Saiello@Jentoo.com">
	<200401172010.35922."Saiello@Jentoo.com">
	<20040117213100.X23718@onyx.ispol.com>
Message-ID: <200401180810.31505."Saiello@Jentoo.com">

Alright, I changed my apache.conf per the Quick Start guide on the 3.1b docs 
to "AddHandler mod_python .py". No I get the following debug error:

Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338, in 
HandlerDispatch
    result = object(req)

  File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line 131, 
in handler
    path=[path])

  File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 481, in 
import_module
    if mtime > oldmtime:

UnboundLocalError: local variable 'oldmtime' referenced before assignment


On Saturday 17 January 2004 09:32 pm, you wrote:
> http://server/python/new
> http://server/python/new/index
>
> Both of the above should work in your set up. I'd try those and see if
> there are any other clues in the error log.
>
> Grisha
>
> On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:
> > I have tried
> > http://server/python/new.py - brings up there error
> > http://server/python/new - 404 error
> > http://server/python/new.py/index - brings up error
> > http://server/python/new/index - 404 error
> >
> > I saw mentioned the url issue in mailinglist archives, I upgraded my
> > apache also.  So far no help.  My distribution is gentoo.
> >
> > Thanks
> >
> > On Saturday 17 January 2004 11:25 am, you wrote:
> > > What's the URL you're trying to access?
> > >
> > > On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:
> > > > Using:
> > > > Apache-2.0.46
> > > > python-2.2.3-r5
> > > > mod_python-3.1b
> > > >
> > > > Apache conf:
> > > > <Directory /home/httpd/htdocs/python>
> > > >         SetHandler mod_python
> > > >         PythonHandler mod_python.publisher
> > > >         #PythonDebug On
> > > > </Directory>
> > > >
> > > > new.py
> > > > from mod_python import apache
> > > >
> > > > def index(req):
> > > > 	return "Hello World!"
> > > >
> > > > Error_log:
> > > > PythonHandler mod_python.publisher: ImportError: No module named
> > > > index
> > > >
> > > >
> > > > Any ideas ?
> > > >
> > > > _______________________________________________
> > > > Mod_python mailing list
> > > > Mod_python@modpython.org
> > > > http://mailman.modpython.org/mailman/listinfo/mod_python

From Saiello at Jentoo.com  Sun Jan 18 08:48:04 2004
From: Saiello at Jentoo.com (Saiello@Jentoo.com)
Date: Sun Jan 18 09:53:36 2004
Subject: [mod_python] ImportError: No module named index
In-Reply-To: <200401180810.31505."Saiello@Jentoo.com">
References: <200401170921.57634."Saiello@Jentoo.com">
	<20040117213100.X23718@onyx.ispol.com>
	<200401180810.31505."Saiello@Jentoo.com">
Message-ID: <200401180848.04766."Saiello@Jentoo.com">

Just trying to get mod_python to work on some level I have done the following, 
per the documentation:

http.conf
<Directory /python>
	AddHandler mod_python .py
	PythonHandler new
	PythonDebug On
  </Directory>

python/new.py
from mod_python import apache

def handler(req):
	req.content_type = "text/plain"
	req.write("hello world!")
	return apache.OK

When I go to http://server/python/new.py, I get a text editor with the raw 
code, so it seems the server is parsing the script. Looking at the apache 
error_log I was seeing "[notice] mod_python: (Re)importing module 'new'", but 
now nothing is appearing in the error_log. Guess somehting is bad with my 
mod_pythong install ????

-Steven

On Sunday 18 January 2004 08:10 am, Saiello@Jentoo.com wrote:
> Alright, I changed my apache.conf per the Quick Start guide on the 3.1b
> docs to "AddHandler mod_python .py". No I get the following debug error:
>
> Mod_python error: "PythonHandler mod_python.publisher"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338,
> in HandlerDispatch
>     result = object(req)
>
>   File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line
> 131, in handler
>     path=[path])
>
>   File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 481,
> in import_module
>     if mtime > oldmtime:
>
> UnboundLocalError: local variable 'oldmtime' referenced before assignment
>
> On Saturday 17 January 2004 09:32 pm, you wrote:
> > http://server/python/new
> > http://server/python/new/index
> >
> > Both of the above should work in your set up. I'd try those and see if
> > there are any other clues in the error log.
> >
> > Grisha
> >
> > On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:
> > > I have tried
> > > http://server/python/new.py - brings up there error
> > > http://server/python/new - 404 error
> > > http://server/python/new.py/index - brings up error
> > > http://server/python/new/index - 404 error
> > >
> > > I saw mentioned the url issue in mailinglist archives, I upgraded my
> > > apache also.  So far no help.  My distribution is gentoo.
> > >
> > > Thanks
> > >
> > > On Saturday 17 January 2004 11:25 am, you wrote:
> > > > What's the URL you're trying to access?
> > > >
> > > > On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:
> > > > > Using:
> > > > > Apache-2.0.46
> > > > > python-2.2.3-r5
> > > > > mod_python-3.1b
> > > > >
> > > > > Apache conf:
> > > > > <Directory /home/httpd/htdocs/python>
> > > > >         SetHandler mod_python
> > > > >         PythonHandler mod_python.publisher
> > > > >         #PythonDebug On
> > > > > </Directory>
> > > > >
> > > > > new.py
> > > > > from mod_python import apache
> > > > >
> > > > > def index(req):
> > > > > 	return "Hello World!"
> > > > >
> > > > > Error_log:
> > > > > PythonHandler mod_python.publisher: ImportError: No module named
> > > > > index
> > > > >
> > > > >
> > > > > Any ideas ?
> > > > >
> > > > > _______________________________________________
> > > > > Mod_python mailing list
> > > > > Mod_python@modpython.org
> > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From Saiello at Jentoo.com  Sun Jan 18 09:38:00 2004
From: Saiello at Jentoo.com (Saiello@Jentoo.com)
Date: Sun Jan 18 10:43:34 2004
Subject: [mod_python] ImportError: No module named index
In-Reply-To: <200401180810.31505."Saiello@Jentoo.com">
References: <200401170921.57634."Saiello@Jentoo.com">
	<20040117213100.X23718@onyx.ispol.com>
	<200401180810.31505."Saiello@Jentoo.com">
Message-ID: <200401180938.01121."Saiello@Jentoo.com">

Sending again, correction, seems like the server ISN'T parsing the script.
Just trying to get mod_python to work on some level I have done the following, 
per the documentation:

http.conf
<Directory /python>
	AddHandler mod_python .py
	PythonHandler new
	PythonDebug On
  </Directory>

python/new.py
from mod_python import apache

def handler(req):
	req.content_type = "text/plain"
	req.write("hello world!")
	return apache.OK

When I go to http://server/python/new.py, I get a text editor with the raw 
code, so it <<CORRECTION: seems the server is parsing the script>>. Looking at 
the apache 
error_log I was seeing "[notice] mod_python: (Re)importing module 'new'", but 
now nothing is appearing in the error_log. Guess somehting is bad with my 
mod_pythong install ????

-Steven

On Sunday 18 January 2004 08:10 am, Saiello@Jentoo.com wrote:
> Alright, I changed my apache.conf per the Quick Start guide on the 3.1b
> docs to "AddHandler mod_python .py". No I get the following debug error:
>
> Mod_python error: "PythonHandler mod_python.publisher"
>
> Traceback (most recent call last):
>
>   File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 338,
> in HandlerDispatch
>     result = object(req)
>
>   File "/usr/lib/python2.2/site-packages/mod_python/publisher.py", line
> 131, in handler
>     path=[path])
>
>   File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 481,
> in import_module
>     if mtime > oldmtime:
>
> UnboundLocalError: local variable 'oldmtime' referenced before assignment
>
> On Saturday 17 January 2004 09:32 pm, you wrote:
> > http://server/python/new
> > http://server/python/new/index
> >
> > Both of the above should work in your set up. I'd try those and see if
> > there are any other clues in the error log.
> >
> > Grisha
> >
> > On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:
> > > I have tried
> > > http://server/python/new.py - brings up there error
> > > http://server/python/new - 404 error
> > > http://server/python/new.py/index - brings up error
> > > http://server/python/new/index - 404 error
> > >
> > > I saw mentioned the url issue in mailinglist archives, I upgraded my
> > > apache also.  So far no help.  My distribution is gentoo.
> > >
> > > Thanks
> > >
> > > On Saturday 17 January 2004 11:25 am, you wrote:
> > > > What's the URL you're trying to access?
> > > >
> > > > On Sat, 17 Jan 2004, Saiello@Jentoo.com wrote:
> > > > > Using:
> > > > > Apache-2.0.46
> > > > > python-2.2.3-r5
> > > > > mod_python-3.1b
> > > > >
> > > > > Apache conf:
> > > > > <Directory /home/httpd/htdocs/python>
> > > > >         SetHandler mod_python
> > > > >         PythonHandler mod_python.publisher
> > > > >         #PythonDebug On
> > > > > </Directory>
> > > > >
> > > > > new.py
> > > > > from mod_python import apache
> > > > >
> > > > > def index(req):
> > > > > 	return "Hello World!"
> > > > >
> > > > > Error_log:
> > > > > PythonHandler mod_python.publisher: ImportError: No module named
> > > > > index
> > > > >
> > > > >
> > > > > Any ideas ?
> > > > >
> > > > > _______________________________________________
> > > > > Mod_python mailing list
> > > > > Mod_python@modpython.org
> > > > > http://mailman.modpython.org/mailman/listinfo/mod_python
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Sun Jan 18 14:31:51 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sun Jan 18 15:31:29 2004
Subject: [mod_python] ImportError: No module named index
In-Reply-To: <200401180810.31505."Saiello@Jentoo.com">
References: <200401170921.57634."Saiello@Jentoo.com">
	<200401172010.35922."Saiello@Jentoo.com">
	<200401180810.31505."Saiello@Jentoo.com">
Message-ID: <20040118143027.D37407@onyx.ispol.com>



On Sun, 18 Jan 2004, Saiello@Jentoo.com wrote:

>   File "/usr/lib/python2.2/site-packages/mod_python/apache.py", line 481, in
> import_module
>     if mtime > oldmtime:

There is a typo-bug in apache.py - edit
your/usr/lib/python2.2/site-packages/mod_python/apache.py and look
somewhere above line 481, you'll see oldmtime misspelled. Fix it and all
will be well.

Alernatively - just get the latest CVS snapshot.

Grisha
From dwmp at opti.cgi.net  Sun Jan 18 02:47:04 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Sun Jan 18 16:45:49 2004
Subject: [mod_python] 3.1.2b and worker_mpm
Message-ID: <5.2.1.1.2.20040118023631.03ae3d98@mail.pyxos.com>


Is anyone else out there using mod_python with the worker_mpm on Apache 
2?  I'm having issues with requests getting mixed up.  I have an output 
filter which is gathering information about requests and storing them in a 
stats database and then it's calling filter.pass_on().  The problem is that 
when I request a big image, I get part of the image in the response body, 
and part of an unrelated html request in the response body.  So I have an 
invalid image and someone else probably has an invalid html page.  I've 
found this much easier to reproduce with larger files.  It only happens 
when there is simultaneous traffic on the server.  If I redirect the 
traffic to an older server and run tests on the mod_python server without 
outside traffic then it runs just fine.

I'm running the latest cvs as of a week ago.  Apache 2.0.48.

Has anyone else experienced this?

-Dan


From dwmp at opti.cgi.net  Sun Jan 18 05:52:11 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Sun Jan 18 19:50:23 2004
Subject: [mod_python] 3.1.2b and worker_mpm
In-Reply-To: <OFA0CF350A.B6921534-ON85256E1F.00802E14-85256E1F.00807642@
 EU.novartis.net>
Message-ID: <5.2.1.1.2.20040118054401.032a1de8@mail.pyxos.com>


Yeah, looks like I'm going to be recompiling for prefork before long.  It's 
a shame that mod_python isn't more stable under the worker mpm.  The worker 
mpm is more efficient memory wise and less ram for the web server means 
more left over for the database server.  This also eliminates the 
possibility of using the perchild mpm which should be of great interest to 
anyone running a server which services multiple unrelated users' accounts 
and web sites.

I wish I had more time and experience with C so I could help out.  Are 
these issues known and is anyone doing anything to address them?  I'm 
available for testing if so.

-Dan



At 06:24 PM 1/18/2004 -0500, you wrote:
>Daniel,
>     I just punted on using the worker mpm.  I was trying to use it with
>the jonpy modules and it went to pieces under stress testing.  I saw some
>wicked nasty recursion errors.  Now, I'm not dogging mod_python.  I'm
>using mod_python with the prefork model and I see NO errors and it
>screams.   (In fact, it's worked so well that my superiors want me to
>present python technology at our upcoming annual meeting with our
>corporate parents!).   However, it's been my experience that you'll
>encounter many more problems using the worker mpm.
>
>Thanks,
>Perry
>
>
>
>
>
>Is anyone else out there using mod_python with the worker_mpm on Apache
>2?  I'm having issues with requests getting mixed up.  I have an output
>filter which is gathering information about requests and storing them in a
>
>stats database and then it's calling filter.pass_on().  The problem is
>that
>when I request a big image, I get part of the image in the response body,
>and part of an unrelated html request in the response body.  So I have an
>invalid image and someone else probably has an invalid html page.  I've
>found this much easier to reproduce with larger files.  It only happens
>when there is simultaneous traffic on the server.  If I redirect the
>traffic to an older server and run tests on the mod_python server without
>outside traffic then it runs just fine.
>
>I'm running the latest cvs as of a week ago.  Apache 2.0.48.
>
>Has anyone else experienced this?
>
>-Dan
>
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python

From grisha at modpython.org  Mon Jan 19 00:13:13 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Jan 19 01:13:07 2004
Subject: [mod_python] apache log_error
In-Reply-To: <5885C038-48C4-11D8-8406-000A95962D62@mellet.net>
References: <5885C038-48C4-11D8-8406-000A95962D62@mellet.net>
Message-ID: <20040119001115.U45928@onyx.ispol.com>


Are you using apache.log_error, or req.log_error? Note that the former may
send its output to the bitbucket if you don't specify a server argument -
I'm pretty sure it's mentioned in the docs.

The rule of thumb is - always use req.log_error, use apache.log_error only
when you have no choice.

Grisha

On Sat, 17 Jan 2004, Oliver Mellet wrote:

> In using the log_error function, I'm not seeing any messages from
> python in the apache log when I use apache.APLOG_DEBUG or
> apache.APLOG_NOTICE.  All other warning levels higher than that seem to
> make it into the output ok.  (I see other debug messages from apache,
> and my LogLevel is set to debug, and PythonDebug is On).  Can anyone
> else confirm this?
> This is on Mac OS X / Apache 2.0.48 / mod_python 3.1.2b
>
> Thanks,
> Oliver
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From oliver at mellet.net  Sun Jan 18 22:06:52 2004
From: oliver at mellet.net (Oliver Mellet)
Date: Mon Jan 19 02:06:34 2004
Subject: [mod_python] apache log_error
In-Reply-To: <20040119001115.U45928@onyx.ispol.com>
References: <5885C038-48C4-11D8-8406-000A95962D62@mellet.net>
	<20040119001115.U45928@onyx.ispol.com>
Message-ID: <AD06BBF0-4A45-11D8-A904-000A95962D62@mellet.net>

That seems to have done the trick, thanks.   And you're right about the 
server param, according to the docs:
"When server is not specified, the setting of LogLevel does not apply, 
the LogLevel is dictated by an httpd compile-time default, usually 
warn."
RTFM for me, as usual.

On Jan 18, 2004, at 9:13 PM, Gregory (Grisha) Trubetskoy wrote:

>
> Are you using apache.log_error, or req.log_error? Note that the former 
> may
> send its output to the bitbucket if you don't specify a server 
> argument -
> I'm pretty sure it's mentioned in the docs.
>
> The rule of thumb is - always use req.log_error, use apache.log_error 
> only
> when you have no choice.
>
> Grisha
>
> On Sat, 17 Jan 2004, Oliver Mellet wrote:
>
>> In using the log_error function, I'm not seeing any messages from
>> python in the apache log when I use apache.APLOG_DEBUG or
>> apache.APLOG_NOTICE.  All other warning levels higher than that seem 
>> to
>> make it into the output ok.  (I see other debug messages from apache,
>> and my LogLevel is set to debug, and PythonDebug is On).  Can anyone
>> else confirm this?
>> This is on Mac OS X / Apache 2.0.48 / mod_python 3.1.2b
>>
>> Thanks,
>> Oliver
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>

From kamil at nvstudio.pl  Mon Jan 19 12:21:01 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Mon Jan 19 07:21:14 2004
Subject: [mod_python] redirect with location header
Message-ID: <20040119122101.147a572e.kamil@nvstudio.pl>


I want to do something like this:

- user go to url something/edit 
- ..fills form and submits it to the same url (something/edit)

then i catch this submitted form, validate it and if it passess
validation i want to do redirection to something/index (so
that user which submitted form, edited something is redirected
back to index page). but if the form is wrong i want user to stay
at edition page and refill this form - there is no redirection.

i have a problem with the first case. when user submits a form,
i go to url /add, do what i want to do and then i send a location
header which redirects me to /index. but when i do this, browser
asks me whether i want to repost my submitted form to this
new url (/index). is there any way to redirect totally 
transparently for user, so that browser won't ask this question?

/K
From stian at soiland.no  Mon Jan 19 21:06:25 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Mon Jan 19 16:06:01 2004
Subject: [mod_python] Re: ImportError: No module named index
In-Reply-To: <200401180938.01121."Saiello@Jentoo.com">
References: <200401170921.57634."Saiello@Jentoo.com">
	<20040117213100.X23718@onyx.ispol.com>
	<200401180810.31505."Saiello@Jentoo.com">
	<200401180938.01121."Saiello@Jentoo.com">
Message-ID: <20040119200625.GH12157@itea.ntnu.no>

On 2004-01-18 15:38:00, Saiello@Jentoo.com wrote:

> python/new.py
> from mod_python import apache
> 
> def handler(req):
> 	req.content_type = "text/plain"
> 	req.write("hello world!")
> 	return apache.OK

Btw, naming your module new.py might not be very smart, as new is an
internal python module. (Used to create new module objects, etc.)

-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From Saiello at Jentoo.com  Mon Jan 19 15:16:12 2004
From: Saiello at Jentoo.com (Saiello@Jentoo.com)
Date: Mon Jan 19 16:21:53 2004
Subject: [mod_python] Re: ImportError: No module named index
In-Reply-To: <20040119200625.GH12157@itea.ntnu.no>
References: <200401170921.57634."Saiello@Jentoo.com">
	<200401180938.01121."Saiello@Jentoo.com">
	<20040119200625.GH12157@itea.ntnu.no>
Message-ID: <200401191516.12240."Saiello@Jentoo.com">

On Monday 19 January 2004 03:06 pm, you wrote:
> On 2004-01-18 15:38:00, Saiello@Jentoo.com wrote:
> > python/new.py
> > from mod_python import apache
> >
> > def handler(req):
> > 	req.content_type = "text/plain"
> > 	req.write("hello world!")
> > 	return apache.OK
>
> Btw, naming your module new.py might not be very smart, as new is an
> internal python module. (Used to create new module objects, etc.)

I thought of that, so did exactly as the documetation says, with my script 
being called mptest.py. If I start python up manually, and do a "from mptest 
import index" it works fine......  Not sure exactly what the problem is.

From stian at soiland.no  Mon Jan 19 21:23:43 2004
From: stian at soiland.no (Stian =?iso-8859-1?Q?S=F8iland?=)
Date: Mon Jan 19 16:23:18 2004
Subject: [mod_python] Re: redirect with location header
In-Reply-To: <20040119122101.147a572e.kamil@nvstudio.pl>
References: <20040119122101.147a572e.kamil@nvstudio.pl>
Message-ID: <20040119202343.GI12157@itea.ntnu.no>

On 2004-01-19 12:21:01, Kamil Niechajewicz wrote:

> i have a problem with the first case. when user submits a form,
> i go to url /add, do what i want to do and then i send a location
> header which redirects me to /index. but when i do this, browser
> asks me whether i want to repost my submitted form to this
> new url (/index). is there any way to redirect totally 
> transparently for user, so that browser won't ask this question?

Yes, the problem is that you use the Location-header. Sending this
header as a response to a POST-request asks the browser to go somewhere
else with his form posting.

Here is a function we're using:

def redirect(req, url, temporary=False, seeOther=False):
    """
    Immediately redirects the request to the given url. If the
    seeOther parameter is set, 303 See Other response is sent, if the
    temporary parameter is set, the server issues a 307 Temporary
    Redirect. Otherwise a 301 Moved Permanently response is issued.
    """
    from mod_python import apache
                                                                                
    if seeOther:
        status = apache.HTTP_SEE_OTHER
    elif temporary:
        status = apache.HTTP_TEMPORARY_REDIRECT
    else:
        status = apache.HTTP_MOVED_PERMANENTLY
                                                                                
    req.headers_out['Location'] = url
    req.status = status
    raise apache.SERVER_RETURN, status

Using seeOther should work for POST-requests, making the browser
following the new link with GET, and without the form data.    

Quoting RFC2068 (HTTP 1.1):


10.3.4 303 See Other

   The response to the request can be found under a different URI and
   SHOULD be retrieved using a GET method on that resource. This method
   exists primarily to allow the output of a POST-activated script to
   redirect the user agent to a selected resource. The new URI is not a
   substitute reference for the originally requested resource. The 303
   response is not cachable, but the response to the second (redirected)
   request MAY be cachable.

   If the new URI is a location, its URL SHOULD be given by the Location
   field in the response. Unless the request method was HEAD, the entity
   of the response SHOULD contain a short hypertext note with a
   hyperlink to the new URI(s).



If this doesn't work, try the slightly more hackish:

   req.headers_out['Refresh'] = "0; url=http://something"


-- 
Stian S?iland               Work toward win-win situation. Win-lose
Trondheim, Norway           is where you win and the other lose.
http://www.soiland.no/      Lose-lose and lose-win are left as an
                            exercise to the reader.  [Limoncelli/Hogan]

From gdamjan at mail.net.mk  Tue Jan 20 04:46:32 2004
From: gdamjan at mail.net.mk (Damjan)
Date: Mon Jan 19 23:46:09 2004
Subject: [mod_python] XMLRPCpublisher ver 0.1
Message-ID: <20040120034632.GA32115@legolas.on.net.mk>

I've made a mod_python handler very similar to the publisher, but
actually doing xmlrpc. The idea is like this:
Put several python scripts in "/opt/www/RPC2", setup an apache handler
like this:
    <Directory /opt/www/RPC2>
        SetHandler python-program
        PythonHandler mod_python.xmlrpcpublisher
    </Directory>

Now every python script in /opt/www/RPC2 is callable with XML-RPC...

Assuming there's a test.py file in /opt/www/RPC2, with a function
helloworld, this is how one would call it:

import xmlrpclib
x = xmlrpclib.ServerProxy('http://localhost/RPC2/test')
print x.helloworld()

This is very crude first version... mainly choped of modpython.publisher
itself... 

If you like it, nice - tell me what you like. 
If you don't - tell me what.

-- 
Damjan Georgievski
jabberID: damjan@bagra.net.mk
-------------- next part --------------
A non-text attachment was scrubbed...
Name: xmlrpcpublisher.py.gz
Type: application/x-gunzip
Size: 2500 bytes
Desc: not available
Url : http://mailman.modpython.org/pipermail/mod_python/attachments/20040120/108883be/xmlrpcpublisher.py.bin
From kamil at nvstudio.pl  Tue Jan 20 11:42:10 2004
From: kamil at nvstudio.pl (Kamil Niechajewicz)
Date: Tue Jan 20 06:42:24 2004
Subject: [mod_python] Re: redirect with location header
In-Reply-To: <20040119202343.GI12157@itea.ntnu.no>
References: <20040119122101.147a572e.kamil@nvstudio.pl>
	<20040119202343.GI12157@itea.ntnu.no>
Message-ID: <20040120114210.70da03da.kamil@nvstudio.pl>

On Mon, 19 Jan 2004 21:23:43 +0100
Stian S <stian@soiland.no> wrote:

> def redirect(req, url, temporary=False, seeOther=False):
> ...

yes, thats exactly what i needed. i ran into it yesterday, trying to
make it working and accidentaly i changed return code to '303' 
(i didn't know what it is, i thought it was something like *_MOVED),
and i noticed that it does not repost form, exactly as i wanted.
thanks for explaining this :)

/K
From llsousa at ualg.pt  Wed Jan 21 15:22:05 2004
From: llsousa at ualg.pt (Luis Sousa)
Date: Wed Jan 21 11:21:57 2004
Subject: [mod_python] Session
Message-ID: <400E991D.3020401@ualg.pt>

Hi all,

Does mod_python have something similar to PHP session?

Thanks in advance.
Luis Sousa


From llsousa at ualg.pt  Wed Jan 21 15:28:37 2004
From: llsousa at ualg.pt (Luis Sousa)
Date: Wed Jan 21 11:28:18 2004
Subject: [mod_python] Session
Message-ID: <400E9AA5.1030001@ualg.pt>

PLEASE IGNORE THIS MESSAGE!
I MISSED TO CONSULT LIST BEFORE :-[

Hi all,

Does mod_python have something similar to PHP session?

Thanks in advance.
Luis Sousa



From lists at jimramsay.com  Wed Jan 21 14:50:23 2004
From: lists at jimramsay.com (Jim Ramsay)
Date: Wed Jan 21 17:00:06 2004
Subject: [mod_python] 
	Porting from python cgi module - with backwards compatibility
Message-ID: <bumomf$fv6$1@sea.gmane.org>

I have a python program (tmda-cgi - http://www.tmda.net/tmda-cgi/) which 
I would like to start working with mod_python if possible, but I need to 
know two things:

1 - Depending on the configuration, some people run this script SUID 
root, as it must os.setuid() to other users.  Is it possible to do this 
with mod_python?  Or only if root runs the apache server?

2 - To get around this (and the fact that scripts themselves can't be 
executed SUID) in the existing implementation, we have written a tiny C 
wrapper which is SUID, which then loads the python interpreter which 
runs the real python program, which imports and uses the 'cgi' module. 
Is it possible (or easy) to write a mod_python wrapper which imports and 
executes this existing program without changing the existing program?

If it's not possible to do (1), at least the configurations which don't 
require the SUID functionality could run under mod_python with the 
wrapper in (2).

I saw an old archived email which suggested that:

os.env = req.subprocess_env

in a handler just before I run the existing methods would do it.  Is 
this still the case?  Will it work for both GET and POST HTTP methods?

-- 
Jim Ramsay
"Me fail English?  That's unpossible!"

From ross at karchner.com  Thu Jan 22 09:37:34 2004
From: ross at karchner.com (Ross M Karchner)
Date: Thu Jan 22 10:38:35 2004
Subject: [mod_python] Dies on Database connection?
Message-ID: <400FE02E.70705@karchner.com>

Hello,

I am working on porting some scripts over to mod_python, but my scripts 
die when I attempt to execute a MySQL query.

Here is a demonstration of the problem: 
http://localfeeds.com/near/display-rss.app

In mozilla, it loads a blank page, on Safari, I get a "page returned no 
data" error.

The code in display-rss.py is:
-------------------------------
DB = "db"
USER = "user"
PASS = "password"

import MySQLdb

def index(req):
   
    DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)
    C=DB_CONN.cursor()
    C.execute('select * from cities where id=17;')
    return "Something"
-------------------------------

I have also tried using the code from : 
http://www.modpython.org/FAQ/faqw.py?req=all#3.3

If I comment out the 'execute' statement, it works fine, the page that 
comes back displays the word "Something:", as expected.

I am using  Apache/2.0.48
Python 2.3.3
mod_python 3.0.4
on FreeBSD 4.9

My Apache configuration is:
AddHandler python-program .app
PythonHandler mod_python.publisher
PythonAutoReload On
PythonDebug On

I suspect this will be related to the Apache/FreeBSD threading can of 
worms... but I'm hoping there is another answer. If anyone has a spare 
clue to offer, I'd really appreciate it.

Thanks!,

-Ross
From ograf at rz-online.net  Thu Jan 22 15:59:36 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Thu Jan 22 10:59:15 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <400FE02E.70705@karchner.com>
References: <400FE02E.70705@karchner.com>
Message-ID: <20040122145936.GA28904@rz-online.net>

On Thu, Jan 22, 2004 at 09:37:34AM -0500, Ross M Karchner wrote:
> If I comment out the 'execute' statement, it works fine, the page that 
> comes back displays the word "Something:", as expected.

Did you take a look at your error_log and/or enable debug mode?

Oliver.

From ross at karchner.com  Thu Jan 22 10:18:55 2004
From: ross at karchner.com (Ross M Karchner)
Date: Thu Jan 22 11:19:57 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <20040122145936.GA28904@rz-online.net>
References: <400FE02E.70705@karchner.com>
	<20040122145936.GA28904@rz-online.net>
Message-ID: <400FE9DF.5050101@karchner.com>

Oliver Graf wrote:

>On Thu, Jan 22, 2004 at 09:37:34AM -0500, Ross M Karchner wrote:
>  
>
>>If I comment out the 'execute' statement, it works fine, the page that 
>>comes back displays the word "Something:", as expected.
>>    
>>
>
>Did you take a look at your error_log and/or enable debug mode?
>
>Oliver.
>  
>
Yes- debug is on and there is nothing in the error log.

-Ross
From manfred.stienstra at dwerg.net  Thu Jan 22 18:58:22 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Thu Jan 22 13:54:26 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <400FE02E.70705@karchner.com>
References: <400FE02E.70705@karchner.com>
Message-ID: <1074794302.29040.8.camel@ack.dwerg.net>

On Thu, 2004-01-22 at 15:37, Ross M Karchner wrote:
> In mozilla, it loads a blank page, on Safari, I get a "page returned no 
> data" error.

This is because you're not returning any data...

> The code in display-rss.py is:
> -------------------------------
> DB = "db"
> USER = "user"
> PASS = "password"
> 
> import MySQLdb
> 
> def index(req):
>    
>     DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)
>     C=DB_CONN.cursor()
>     C.execute('select * from cities where id=17;')
>     return "Something"

Maybe you should try something like this:


DB = "db"
USER = "user"
PASS = "password"

import MySQLdb
from mod_python import apache

def index(req):
   
    DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)
    C=DB_CONN.cursor()
    try:
      C.execute('select * from cities where id=17;')
      for row in c.fetchall():
        req.write(str(row))
      return apache.OK
    finally:
      C.close()
      DB_CONN.close()

Manfred

From neel at mediapulse.com  Thu Jan 22 13:13:00 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Thu Jan 22 14:12:42 2004
Subject: [mod_python] Dies on Database connection?
Message-ID: <C0FC22C08B82074A88B50061764157776B99F0@johnson.mediapulse.net>

I don't see where you are fetching the data from the cursor, did you
snip that part?

Also, data is sent though req.write, you should return apache.OK or
other status as needed.

Are you new to mod_python and/or python?  IIRC there are some tutorials
on mp in the docs you may want to check out.

Mike


> -----Original Message-----
> From: Ross M Karchner [mailto:ross@karchner.com] 
> Sent: Thursday, January 22, 2004 9:38 AM
> To: mod_python
> Subject: [mod_python] Dies on Database connection?
> 
> 
> Hello,
> 
> I am working on porting some scripts over to mod_python, but 
> my scripts 
> die when I attempt to execute a MySQL query.
> 
> Here is a demonstration of the problem: 
> http://localfeeds.com/near/display-rss.app
> 
> In mozilla, it loads a blank page, on Safari, I get a "page 
> returned no 
> data" error.
> 
> The code in display-rss.py is:
> -------------------------------
> DB = "db"
> USER = "user"
> PASS = "password"
> 
> import MySQLdb
> 
> def index(req):
>    
>     DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)
>     C=DB_CONN.cursor()
>     C.execute('select * from cities where id=17;')
>     return "Something"
> -------------------------------
> 
> I have also tried using the code from : 
> http://www.modpython.org/FAQ/faqw.py?req=all#3.3
> 
> If I comment out the 'execute' statement, it works fine, the 
> page that 
> comes back displays the word "Something:", as expected.
> 
> I am using  Apache/2.0.48
> Python 2.3.3
> mod_python 3.0.4
> on FreeBSD 4.9
> 
> My Apache configuration is:
> AddHandler python-program .app
> PythonHandler mod_python.publisher
> PythonAutoReload On
> PythonDebug On
> 
> I suspect this will be related to the Apache/FreeBSD threading can of 
> worms... but I'm hoping there is another answer. If anyone 
> has a spare 
> clue to offer, I'd really appreciate it.
> 
> Thanks!,
> 
> -Ross
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From ross at karchner.com  Thu Jan 22 15:23:48 2004
From: ross at karchner.com (Ross M Karchner)
Date: Thu Jan 22 16:45:33 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <1074794302.29040.8.camel@ack.dwerg.net>
References: <400FE02E.70705@karchner.com>
	<1074794302.29040.8.camel@ack.dwerg.net>
Message-ID: <40103154.7030900@karchner.com>

Manfred Stienstra wrote:

>On Thu, 2004-01-22 at 15:37, Ross M Karchner wrote:
>  
>
>>In mozilla, it loads a blank page, on Safari, I get a "page returned no 
>>data" error.
>>    
>>
>
>This is because you're not returning any data...
>  
>
Sure I am. This is just the simplest case I could make to illustrate the 
problem.

If I comment the C.execute line our, the word "something" is returned.

Here it is: http://localfeeds.com/near/display-rss-fixed.app

Calling "execute" on the cursor object breaks the script.

>>The code in display-rss.py is:
>>-------------------------------
>>DB = "db"
>>USER = "user"
>>PASS = "password"
>>
>>import MySQLdb
>>
>>def index(req):
>>   
>>    DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)
>>    C=DB_CONN.cursor()
>>    C.execute('select * from cities where id=17;')
>>    return "Something"
>>    
>>
>
>Maybe you should try something like this:
>
>
>DB = "db"
>USER = "user"
>PASS = "password"
>
>import MySQLdb
>from mod_python import apache
>
>def index(req):
>   
>    DB_CONN = MySQLdb.connect(db=DB, user=USER, passwd=PASS)
>    C=DB_CONN.cursor()
>    try:
>      C.execute('select * from cities where id=17;')
>      for row in c.fetchall():
>        req.write(str(row))
>      return apache.OK
>    finally:
>      C.close()
>      DB_CONN.close()
>
>  
>
I uploaded this script (adding the correct name and password) to 
http://localfeeds.com/near/manfred-test.app

'select * from cities where id=17;' returns exactly one row.


Thanks, everyone,  for your assistance so far-

-Ross
From manfred.stienstra at dwerg.net  Thu Jan 22 22:07:21 2004
From: manfred.stienstra at dwerg.net (Manfred Stienstra)
Date: Thu Jan 22 17:03:20 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <40103154.7030900@karchner.com>
References: <400FE02E.70705@karchner.com>
	<40103154.7030900@karchner.com>
Message-ID: <1074805641.29044.15.camel@ack.dwerg.net>

On Thu, 2004-01-22 at 21:23, Ross M Karchner wrote:
> >This is because you're not returning any data...
> >  
> Sure I am. This is just the simplest case I could make to illustrate the 
> problem.

What kind of handler are you using? I find it a little strange that you
don't have errors in your error log and no errors to the browser though
the code isn't working.

Manfred

From pkeshishian at yahoo.com  Thu Jan 22 14:46:54 2004
From: pkeshishian at yahoo.com (Petros Keshishian)
Date: Thu Jan 22 18:46:37 2004
Subject: [mod_python] Dies on Database connection?
Message-ID: <20040122224654.86549.qmail@web40017.mail.yahoo.com>

Ross:

I had the same problem in mod_python with MySQL:
Namely the script was working from python shell, but
not in mod_python. I discovered that when I query only
one column  , e.g. 
C.execute('select id from cities where id=17;')
than it worked in mod_python as well, but when I try
for more that one column it dies. Unfortunatly I could
not find a solution and since my database is very
small I wrote a script that queries the database for
each column separately and then combines and returns
the result. This is not really a solution because it
does not address the problem and can slow down your
program significantly if your database is large.

Try to see whether your script works when you query
only one column. I am very intersted in the solution
of this problem.

-Petros


= = = Original message = = =

Hello,

I am working on porting some scripts over to
mod_python, but my scripts 
die when I attempt to execute a MySQL query.

Here is a demonstration of the problem: 
http://localfeeds.com/near/display-rss.app

In mozilla, it loads a blank page, on Safari, I get a
"page returned no 
data" error.

The code in display-rss.py is:
-------------------------------
DB = "db"
USER = "user"
PASS = "password"

import MySQLdb

def index(req):
   
    DB_CONN = MySQLdb.connect(db=DB, user=USER,
passwd=PASS)
    C=DB_CONN.cursor()
    C.execute('select * from cities where id=17;')
    return "Something"
-------------------------------

I have also tried using the code from : 
http://www.modpython.org/FAQ/faqw.py?req=all#3.3

If I comment out the 'execute' statement, it works
fine, the page that 
comes back displays the word "Something:", as
expected.

I am using  Apache/2.0.48
Python 2.3.3
mod_python 3.0.4
on FreeBSD 4.9

My Apache configuration is:
AddHandler python-program .app
PythonHandler mod_python.publisher
PythonAutoReload On
PythonDebug On

I suspect this will be related to the Apache/FreeBSD
threading can of 
worms... but I'm hoping there is another answer. If
anyone has a spare 
clue to offer, I'd really appreciate it.

Thanks!,

-Ross
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

___________________________________________________________
Sent by ePrompter, the premier email notification
software.
Free download at http://www.ePrompter.com.

__________________________________
Do you Yahoo!?
Yahoo! SiteBuilder - Free web site building tool. Try it!
http://webhosting.yahoo.com/ps/sb/
From grisha at apache.org  Thu Jan 22 19:14:15 2004
From: grisha at apache.org (Gregory (Grisha) Trubetskoy)
Date: Thu Jan 22 20:14:17 2004
Subject: [mod_python] [ANNOUNCE] Mod_python 2.7.10
Message-ID: <20040122190718.D6531@onyx.ispol.com>


The Apache Software Foundation and The Apache HTTP Server Project are
pleased to announce the release of version 2.7.10 of mod_python.

This release addresses a vulnerability in mod_python 2.7.9 whereby a
specific query string processed by mod_python would cause the httpd
process to crash.

The previously released version 2.7.9 was supposed to correct this issue,
but is still vulnerable.

There are no other changes or improvements from the previous version in
this release.

If you are currently using mod_python 2.7.9 or earlier, it is highly
recommended that you upgrade to 2.7.10 as soon as possible.

If you are using mod_python 3.0.4, no action is necessary.

Mod_python is available for download from:

http://httpd.apache.org/modules/python-download.cgi

For more information about mod_python visit
http://www.modpython.org/

Regards,

Grisha Trubetskoy

From ross at karchner.com  Thu Jan 22 20:12:44 2004
From: ross at karchner.com (Ross Karchner)
Date: Thu Jan 22 21:12:24 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <20040122224654.86549.qmail@web40017.mail.yahoo.com>
References: <20040122224654.86549.qmail@web40017.mail.yahoo.com>
Message-ID: <3FD5E4D5-4D41-11D8-B89F-003065F9CDA8@karchner.com>

On Jan 22, 2004, at 5:46 PM, Petros Keshishian wrote:
> Try to see whether your script works when you query
> only one column. I am very intersted in the solution
> of this problem.

YES! Thank you-

This is the same behavior.  If I change the query to only select one 
field, it works fine.

If it's a number...

As if things couldn't get stranger...

This works fine: C.execute('select id from cities where id=17;')
(id is an integer)
But this:
C.execute('select place from cities where id=17;')
(place is a string)
Throws:
Mod_python error: "PythonHandler mod_python.publisher"

Traceback (most recent call last):

   File "/usr/local/lib/python2.3/site-packages/mod_python/apache.py", 
line 332, in HandlerDispatch
     result = object(req)

   File 
"/usr/local/lib/python2.3/site-packages/mod_python/publisher.py", line 
198, in handler
     result = apply(object, (), args)

   File "/usr/home/localfeeds/htdocs/near/display-rss.py", line 19, in 
index
     C.execute('select place from cities where id=17;')

   File "/usr/local/lib/python2.3/site-packages/MySQLdb/cursors.py", 
line 95, in execute
     return self._execute(query, args)

   File "/usr/local/lib/python2.3/site-packages/MySQLdb/cursors.py", 
line 114, in _execute
     self.errorhandler(self, exc, value)

   File "/usr/local/lib/python2.3/site-packages/MySQLdb/connections.py", 
line 33, in defaulterrorhandler
     raise errorclass, errorvalue

ValueError: invalid literal for float(): New York

What on earth could be trying to mangle the results of the query into a 
float? The traceback makes it pretty clear that this error happens when 
the query is executed.

The rest of Localfeeds.com  does a similar query thousands of times a 
day from Python CGI scripts. Same Python, same MySQLdb module, same 
everything.

Right now, I am going to see if I have better luck with the Apache and 
mod_python from the FreeBSD ports system

-Ross


From ross at karchner.com  Thu Jan 22 21:42:42 2004
From: ross at karchner.com (Ross Karchner)
Date: Thu Jan 22 22:42:23 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <007101c3e158$5c5b6110$0200a8c0@CLAPTON>
References: <007101c3e158$5c5b6110$0200a8c0@CLAPTON>
Message-ID: <D17A8F7A-4D4D-11D8-9CA6-003065F9CDA8@karchner.com>

As much as I'd *love* to follow this particular rabbit down this 
particular hole...

I got it working! I installed the Apache2 and ModPython3 from the 
FreeBSD ports, moved over my apache configuration, and IT WORKS.

Thank you, Michael, Petron, Manfred, and Oliver!

Now that things are working, I look forward to bugging you all with 
more questions in the future ;)

-Ross

On Jan 22, 2004, at 9:26 PM, Michael C. Neel wrote:

> I had mentioned this prior on these odd mysql issues, and not see 
> anyone
> go down this road, but the string part now give more credence to this
> being the cause.
>
> There are some posts that point to MySQLdb having issue with locale
> settings, and it surfaced in the float on a string error being thrown.
> I've only played with the locale module in passing, so how python
> handles locales and unicode as well, which could be a cause here to.  
> At
> least if it was my system with this issue I'd go down this road =)
>
> Mike
>
>> -----Original Message-----
>> From: mod_python-bounces@modpython.org
>> [mailto:mod_python-bounces@modpython.org] On Behalf Of Ross Karchner
>> Sent: Thursday, January 22, 2004 8:13 PM
>> To: Mod_python@modpython.org
>> Subject: Re: [mod_python] Dies on Database connection?
>>
>>
>> On Jan 22, 2004, at 5:46 PM, Petros Keshishian wrote:
>>> Try to see whether your script works when you query
>>> only one column. I am very intersted in the solution
>>> of this problem.
>>
>> YES! Thank you-
>>
>> This is the same behavior.  If I change the query to only select one
>> field, it works fine.
>>
>> If it's a number...
>>
>> As if things couldn't get stranger...
>>
>> This works fine: C.execute('select id from cities where id=17;')
>> (id is an integer)
>> But this:
>> C.execute('select place from cities where id=17;')
>> (place is a string)
>> Throws:
>> Mod_python error: "PythonHandler mod_python.publisher"
>>
>> Traceback (most recent call last):
>>
>>    File
>> "/usr/local/lib/python2.3/site-packages/mod_python/apache.py",
>> line 332, in HandlerDispatch
>>      result = object(req)
>>
>>    File
>> "/usr/local/lib/python2.3/site-packages/mod_python/publisher.p
>> y", line
>> 198, in handler
>>      result = apply(object, (), args)
>>
>>    File "/usr/home/localfeeds/htdocs/near/display-rss.py",
>> line 19, in
>> index
>>      C.execute('select place from cities where id=17;')
>>
>>    File "/usr/local/lib/python2.3/site-packages/MySQLdb/cursors.py",
>> line 95, in execute
>>      return self._execute(query, args)
>>
>>    File "/usr/local/lib/python2.3/site-packages/MySQLdb/cursors.py",
>> line 114, in _execute
>>      self.errorhandler(self, exc, value)
>>
>>    File
>> "/usr/local/lib/python2.3/site-packages/MySQLdb/connections.py",
>> line 33, in defaulterrorhandler
>>      raise errorclass, errorvalue
>>
>> ValueError: invalid literal for float(): New York
>>
>> What on earth could be trying to mangle the results of the
>> query into a
>> float? The traceback makes it pretty clear that this error
>> happens when
>> the query is executed.
>>
>> The rest of Localfeeds.com  does a similar query thousands of times a
>> day from Python CGI scripts. Same Python, same MySQLdb module, same
>> everything.
>>
>> Right now, I am going to see if I have better luck with the
>> Apache and
>> mod_python from the FreeBSD ports system
>>
>> -Ross
>>
>>
>> _______________________________________________
>> Mod_python mailing list
>> Mod_python@modpython.org
>> http://mailman.modpython.org/mailman/listinfo/mod_python
>>

From grisha at modpython.org  Fri Jan 23 01:23:17 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Fri Jan 23 02:23:00 2004
Subject: [mod_python] Dies on Database connection?
In-Reply-To: <D17A8F7A-4D4D-11D8-9CA6-003065F9CDA8@karchner.com>
References: <007101c3e158$5c5b6110$0200a8c0@CLAPTON>
 <D17A8F7A-4D4D-11D8-9CA6-003065F9CDA8@karchner.com>
Message-ID: <20040123012211.S9824@onyx.ispol.com>



On Thu, 22 Jan 2004, Ross Karchner wrote:

> I got it working! I installed the Apache2 and ModPython3 from the
> FreeBSD ports, moved over my apache configuration, and IT WORKS.
                                                         ^^^^^^^^
That's what I love about FreeBSD ports :-)

Grisha
From ograf at rz-online.net  Fri Jan 23 07:45:42 2004
From: ograf at rz-online.net (Oliver Graf)
Date: Fri Jan 23 02:45:23 2004
Subject: [mod_python] Re: [ANNOUNCE] Mod_python 2.7.10
In-Reply-To: <20040122190718.D6531@onyx.ispol.com>
References: <20040122190718.D6531@onyx.ispol.com>
Message-ID: <20040123064542.GA10736@rz-online.net>

On Thu, Jan 22, 2004 at 07:14:15PM -0500, Gregory (Grisha) Trubetskoy wrote:
> 
> The Apache Software Foundation and The Apache HTTP Server Project are
> pleased to announce the release of version 2.7.10 of mod_python.

The traversion problem I discovered in 3.X is also in 2.7.

cause the loop always checks module with hasattr, any dotted module
paths (such as mylib.mymodule::MyClass.MyMethod) will fail.

Patch attached. Not tested, but the code seems unchanged in 3.X, so it
should fix the problem with the old version, too.

Oliver.

-------------- next part --------------
--- mod_python-2.7.10/lib/python/mod_python/apache.py.orig	2004-01-23 07:42:42.000000000 +0100
+++ mod_python-2.7.10/lib/python/mod_python/apache.py	2004-01-23 07:43:01.000000000 +0100
@@ -384,7 +384,7 @@
         parent = obj
 
         # don't throw attribute errors when silent
-        if silent and not hasattr(module, obj_str):
+        if silent and not hasattr(obj, obj_str):
             return None
 
         # this adds a little clarity if we have an attriute error
From menion at asylumwear.com  Fri Jan 23 11:58:22 2004
From: menion at asylumwear.com (Joshua Schmidlkofer)
Date: Fri Jan 23 15:58:08 2004
Subject: [mod_python] Mod_python + arguments
Message-ID: <1074887901.5984.93.camel@bubbles.imr-net.com>

My mod_python script is not getting any arguments.  I have googled a
bit, and looked my small archive of the mailing list.  I don't see the
problem being references.

Stock RedHat 9:
   mod_python-3.0.1-3
   httpd-2.0.40-21.9
   python-2.2.2-26

I can upgrade if needed, but I just wondered if that is necessary.

Apache config:
<snip>

<Location /proxy>
    SetHandler python-program
    PythonPath "sys.path + ['/var/www/html/proxy']"
    PythonHandler handler
    #PythonHandler mod_python.publisher
</Location>

<snip>



Here is my url:
http://localhost/proxy/handler?crow=bar&name=foo

here are a few things:
uri: (None, None, None, None, None, None, '/proxy/handler', 'crow=bar&name=foo', None)

I can't get named arguments, and *args, and **kwargs reveals nothing:

<snip>
  kwargs:{}
    args:()
<snip>


my script:

<snip>
from mod_python import apache

def handler(req, *args, **kwargs):
    req.content_type = "text/html"
    req.send_http_header()

    extra = ""
    for k,v in locals().items():
        if k == 'extra': continue
        extra += "<p>%s:%s\n" % (str(k),str(v))
        continue

    extra += "<br><hr>\n"
    extra += "Args:<p>len: %d<br><p>contents: %s\n" % (len(args),str(args))
    
    extra += "<br><hr>\n"
    extra += "uri: %s<br><br>\n" % str(req.parsed_uri)
    extra += "args: %s<br><br>\n" % str(req.args)
    extra += "req: %s\n" % str(dir(req))
   
    extra += "<br><hr>\n"
    extra += "<br>Apache: %s\n" % str(dir(apache))

    req.write(content % extra)

    return apache.OK
<snip>



From gah at research.att.com  Sat Jan 24 15:47:35 2004
From: gah at research.att.com (Glenn A. Hochberg)
Date: Sat Jan 24 16:47:18 2004
Subject: [mod_python] Mod_python + arguments
In-Reply-To: <200401241700.i0OH041D084614@slash.mediapulse.com>
References: <200401241700.i0OH041D084614@slash.mediapulse.com>
Message-ID: <4012D9E7.9050802@research.att.com>

That's not how you get access to query args.  You need to use the 
FieldStorage class; see the documentation at modpython.org.

    -Glenn

>Date: Fri, 23 Jan 2004 11:58:22 -0800
>From: Joshua Schmidlkofer <menion@asylumwear.com>
>Subject: [mod_python] Mod_python + arguments
>To: ModPython mailing List <mod_python@modpython.org>
>Message-ID: <1074887901.5984.93.camel@bubbles.imr-net.com>
>Content-Type: text/plain
>
>My mod_python script is not getting any arguments.  I have googled a
>bit, and looked my small archive of the mailing list.  I don't see the
>problem being references.
>
>Stock RedHat 9:
>   mod_python-3.0.1-3
>   httpd-2.0.40-21.9
>   python-2.2.2-26
>
>I can upgrade if needed, but I just wondered if that is necessary.
>
>Apache config:
><snip>
>
><Location /proxy>
>    SetHandler python-program
>    PythonPath "sys.path + ['/var/www/html/proxy']"
>    PythonHandler handler
>    #PythonHandler mod_python.publisher
></Location>
>
><snip>
>
>
>
>Here is my url:
>http://localhost/proxy/handler?crow=bar&name=foo
>
>here are a few things:
>uri: (None, None, None, None, None, None, '/proxy/handler', 'crow=bar&name=foo', None)
>
>I can't get named arguments, and *args, and **kwargs reveals nothing:
>
><snip>
>  kwargs:{}
>    args:()
><snip>
>
>
>my script:
>
><snip>
>from mod_python import apache
>
>def handler(req, *args, **kwargs):
>    req.content_type = "text/html"
>    req.send_http_header()
>
>    extra = ""
>    for k,v in locals().items():
>        if k == 'extra': continue
>        extra += "<p>%s:%s\n" % (str(k),str(v))
>        continue
>
>    extra += "<br><hr>\n"
>    extra += "Args:<p>len: %d<br><p>contents: %s\n" % (len(args),str(args))
>    
>    extra += "<br><hr>\n"
>    extra += "uri: %s<br><br>\n" % str(req.parsed_uri)
>    extra += "args: %s<br><br>\n" % str(req.args)
>    extra += "req: %s\n" % str(dir(req))
>   
>    extra += "<br><hr>\n"
>    extra += "<br>Apache: %s\n" % str(dir(apache))
>
>    req.write(content % extra)
>
>    return apache.OK
><snip>
>
>
>  
>

From dg at sponsera.com  Sat Jan 24 17:14:45 2004
From: dg at sponsera.com (David Geller)
Date: Sat Jan 24 18:14:31 2004
Subject: [mod_python] mod_python and mysql - problem solved!
In-Reply-To: <20040122224654.86549.qmail@web40017.mail.yahoo.com>
References: <20040122224654.86549.qmail@web40017.mail.yahoo.com>
Message-ID: <4012EE55.5050500@sponsera.com>

All:

Awhile ago I posted an issue under "mod_python and mysql - wierd 
problem!' 1/8/2004

I was having similar problems to those described here:

1. python program with sql queries worked fine in "console" mode
2. under mod_python, when I called "c.execute()", httpd would get a 
"segmentation fault"  (this was apparent in the httpd error log)
3. sometimes, instead, I would get weird, inconsistant errors, like 
Petros decribes.

Paul Querna actually hinted at what was wrong - but it took me awhile to 
find it (what was especially strange, and still unexplained, is why  
things worked fine under mod_python on my redhat8 machine, but then 
failed on the redhat9 server).

Explanation(?):

 In my httpd.conf I was loading two DSO modules: mod_python and php4. It 
turns out, when I removed the reference to php4, the mod_python worked 
perfectly. Now, why was this? Well, I went back to the php4 module, and 
checked out "configure" - if you know anything about php, it was being 
configured with the "--with-mysql" flag, which tells it to use an 
"internal" version of mysql libs. Apparently, this is fine - as long as 
*no other modules use mysql* (the php configure tells you this at the 
end). If they do, you should specify the actual mysql library directory. 
Well, mod_python was basically another module using mysql. Duuuuh! 
(well, not so obvious to me, really). When I specified the actual mysql 
library to php configure,  and recompiled and reinstalled the PHP, I 
could have LoadModules for both php and mod_python and both *appear* to 
work.

Not completely sure why this is, but it seems to have solved the problem.

David


Petros Keshishian wrote:

>Ross:
>
>I had the same problem in mod_python with MySQL:
>Namely the script was working from python shell, but
>not in mod_python. I discovered that when I query only
>one column  , e.g. 
>C.execute('select id from cities where id=17;')
>than it worked in mod_python as well, but when I try
>for more that one column it dies. Unfortunatly I could
>not find a solution and since my database is very
>small I wrote a script that queries the database for
>each column separately and then combines and returns
>the result. This is not really a solution because it
>does not address the problem and can slow down your
>program significantly if your database is large.
>
>Try to see whether your script works when you query
>only one column. I am very intersted in the solution
>of this problem.
>
>-Petros
>
>
>= = = Original message = = =
>
>Hello,
>
>I am working on porting some scripts over to
>mod_python, but my scripts 
>die when I attempt to execute a MySQL query.
>
>Here is a demonstration of the problem: 
>http://localfeeds.com/near/display-rss.app
>
>In mozilla, it loads a blank page, on Safari, I get a
>"page returned no 
>data" error.
>
>The code in display-rss.py is:
>-------------------------------
>DB = "db"
>USER = "user"
>PASS = "password"
>
>import MySQLdb
>
>def index(req):
>   
>    DB_CONN = MySQLdb.connect(db=DB, user=USER,
>passwd=PASS)
>    C=DB_CONN.cursor()
>    C.execute('select * from cities where id=17;')
>    return "Something"
>-------------------------------
>
>I have also tried using the code from : 
>http://www.modpython.org/FAQ/faqw.py?req=all#3.3
>
>If I comment out the 'execute' statement, it works
>fine, the page that 
>comes back displays the word "Something:", as
>expected.
>
>I am using  Apache/2.0.48
>Python 2.3.3
>mod_python 3.0.4
>on FreeBSD 4.9
>
>My Apache configuration is:
>AddHandler python-program .app
>PythonHandler mod_python.publisher
>PythonAutoReload On
>PythonDebug On
>
>I suspect this will be related to the Apache/FreeBSD
>threading can of 
>worms... but I'm hoping there is another answer. If
>anyone has a spare 
>clue to offer, I'd really appreciate it.
>
>Thanks!,
>
>-Ross
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>___________________________________________________________
>Sent by ePrompter, the premier email notification
>software.
>Free download at http://www.ePrompter.com.
>
>__________________________________
>Do you Yahoo!?
>Yahoo! SiteBuilder - Free web site building tool. Try it!
>http://webhosting.yahoo.com/ps/sb/
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>
>  
>

-- 
David Geller
Sponsera, LLC
dg at sponsera.com
www.sponsera.com
Phone: 703.532.6812
Fax: 703.532.6058



From khurram at renai-soft.com  Sun Jan 25 18:52:12 2004
From: khurram at renai-soft.com (Khurram)
Date: Sun Jan 25 07:50:39 2004
Subject: [mod_python] Re: Mod_python + arguments
In-Reply-To: <200401241700.i0OH041D084614@slash.mediapulse.com>
References: <200401241700.i0OH041D084614@slash.mediapulse.com>
Message-ID: <1075078332.401464bc5c2f7@webmail.renai-soft.com>

Please look in PythonHandler directive documentation. The function accepts a
single argument and that is the request object. Use Publisher handler for the
task you are doing.

All request handler directives have the following syntax: 

Python*Handler handler [handler ...] [ | .ext [.ext ...] ] 

Where handler is a callable object that accepts a single argument - request
object, and .ext is a file extension


Khurram Ijaz,
Renaissance Software.
http://www.renai-soft.com

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

From neel at mediapulse.com  Sun Jan 25 09:03:40 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Sun Jan 25 10:03:26 2004
Subject: [mod_python] mod_python and mysql - problem solved!
Message-ID: <C0FC22C08B82074A88B50061764157776B9A00@johnson.mediapulse.net>

Grisha, given how often this hits the list, maybe the should be in the
FAQ/Docs.

Let's all have an uninstall php day!

Mike

> -----Original Message-----
> From: David Geller [mailto:dg@sponsera.com] 
> Sent: Saturday, January 24, 2004 5:15 PM
> To: Mod_python@modpython.org
> Subject: [mod_python] mod_python and mysql - problem solved!
> 
> 
> All:
> 
> Awhile ago I posted an issue under "mod_python and mysql - wierd 
> problem!' 1/8/2004
> 
> I was having similar problems to those described here:
> 
> 1. python program with sql queries worked fine in "console" mode
> 2. under mod_python, when I called "c.execute()", httpd would get a 
> "segmentation fault"  (this was apparent in the httpd error log)
> 3. sometimes, instead, I would get weird, inconsistant errors, like 
> Petros decribes.
> 
> Paul Querna actually hinted at what was wrong - but it took 
> me awhile to 
> find it (what was especially strange, and still unexplained, is why  
> things worked fine under mod_python on my redhat8 machine, but then 
> failed on the redhat9 server).
> 
> Explanation(?):
> 
>  In my httpd.conf I was loading two DSO modules: mod_python 
> and php4. It 
> turns out, when I removed the reference to php4, the 
> mod_python worked 
> perfectly. Now, why was this? Well, I went back to the php4 
> module, and 
> checked out "configure" - if you know anything about php, it 
> was being 
> configured with the "--with-mysql" flag, which tells it to use an 
> "internal" version of mysql libs. Apparently, this is fine - 
> as long as 
> *no other modules use mysql* (the php configure tells you this at the 
> end). If they do, you should specify the actual mysql library 
> directory. 
> Well, mod_python was basically another module using mysql. Duuuuh! 
> (well, not so obvious to me, really). When I specified the 
> actual mysql 
> library to php configure,  and recompiled and reinstalled the PHP, I 
> could have LoadModules for both php and mod_python and both 
> *appear* to 
> work.
> 
> Not completely sure why this is, but it seems to have solved 
> the problem.
> 
> David
> 
> 
> Petros Keshishian wrote:
> 
> >Ross:
> >
> >I had the same problem in mod_python with MySQL:
> >Namely the script was working from python shell, but
> >not in mod_python. I discovered that when I query only
> >one column  , e.g. 
> >C.execute('select id from cities where id=17;')
> >than it worked in mod_python as well, but when I try
> >for more that one column it dies. Unfortunatly I could
> >not find a solution and since my database is very
> >small I wrote a script that queries the database for
> >each column separately and then combines and returns
> >the result. This is not really a solution because it
> >does not address the problem and can slow down your
> >program significantly if your database is large.
> >
> >Try to see whether your script works when you query
> >only one column. I am very intersted in the solution
> >of this problem.
> >
> >-Petros
> >
> >
> >= = = Original message = = =
> >
> >Hello,
> >
> >I am working on porting some scripts over to
> >mod_python, but my scripts 
> >die when I attempt to execute a MySQL query.
> >
> >Here is a demonstration of the problem: 
> >http://localfeeds.com/near/display-rss.app
> >
> >In mozilla, it loads a blank page, on Safari, I get a
> >"page returned no 
> >data" error.
> >
> >The code in display-rss.py is:
> >-------------------------------
> >DB = "db"
> >USER = "user"
> >PASS = "password"
> >
> >import MySQLdb
> >
> >def index(req):
> >   
> >    DB_CONN = MySQLdb.connect(db=DB, user=USER,
> >passwd=PASS)
> >    C=DB_CONN.cursor()
> >    C.execute('select * from cities where id=17;')
> >    return "Something"
> >-------------------------------
> >
> >I have also tried using the code from : 
> >http://www.modpython.org/FAQ/faqw.py?req=all#3.3
> >
> >If I comment out the 'execute' statement, it works
> >fine, the page that 
> >comes back displays the word "Something:", as
> >expected.
> >
> >I am using  Apache/2.0.48
> >Python 2.3.3
> >mod_python 3.0.4
> >on FreeBSD 4.9
> >
> >My Apache configuration is:
> >AddHandler python-program .app
> >PythonHandler mod_python.publisher
> >PythonAutoReload On
> >PythonDebug On
> >
> >I suspect this will be related to the Apache/FreeBSD
> >threading can of 
> >worms... but I'm hoping there is another answer. If
> >anyone has a spare 
> >clue to offer, I'd really appreciate it.
> >
> >Thanks!,
> >
> >-Ross
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >___________________________________________________________
> >Sent by ePrompter, the premier email notification
> >software.
> >Free download at http://www.ePrompter.com.
> >
> >__________________________________
> >Do you Yahoo!?
> >Yahoo! SiteBuilder - Free web site building tool. Try it!
> >http://webhosting.yahoo.com/ps/sb/
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >
> >  
> >
> 
> -- 
> David Geller
> Sponsera, LLC
> dg at sponsera.com
> www.sponsera.com
> Phone: 703.532.6812
> Fax: 703.532.6058
> 
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From catalin at bounce-software.com  Sun Jan 25 20:43:13 2004
From: catalin at bounce-software.com (Catalin Constantin)
Date: Sun Jan 25 14:44:28 2004
Subject: [mod_python] mod_python Session problem
Message-ID: <543525691.20040125204313@bounce-software.com>

Configuration:

SetHandler mod_python
AddHandler python-program .py
PythonHandler mod_python.publisher
PythonDebug On

index.py file:

import os
from mod_python import apache, Session, psp

def index(req):
        sess=Session.Session(req)
        return "Hello"

after the Session.Session(req) call
the script hangs.

i've tryed to see where it hangs and here is what i've found:
insise Session(req, sid=0, secret=None, timeout=0): (Session.py)
the DbmSession is selected
return DbmSession(req, sid=sid, secret=secret,
                          timeout=timeout)

In the DbmSession constructor __init__ there is a call to
BaseSession.__init__(...)
The session is new (never created before) so it reaches the part
with _new...
Check below.

        if self._new:
            # make a new session
            if self._sid: self.unlock() # unlock old sid
            self._sid = _new_sid(self._req)

            # here it hangs
            
            self.lock()                 # lock new sid

            Cookie.add_cookie(self._req, self.make_cookie())
            self._created = time.time()
            if timeout:
                self._timeout = timeout
            else:
                self._timeout = DFT_TIMEOUT


Is the Sesison handler working ?
Am i doing something wrong ?

Thank you !

-- 
Catalin Constantin
Bounce Software
www.bounce-software.com

From dwmp at opti.cgi.net  Sun Jan 25 18:12:41 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Sun Jan 25 20:11:53 2004
Subject: [mod_python] Interpreters and Filters
Message-ID: <5.2.1.1.2.20040125180918.04821e28@mail.pyxos.com>


According to the 3.0 (and 3.1.2b) documentation, PythonOutputFilter only 
works in the server config (not vhost).  If you have two vhosts (two 
interpreters by default) and a filter from the server config handles a 
request, does the filter have it's own interpreter which handles the 
request or does it run in the interpreter space of the vhost originating 
the request?

-Dan

From grisha at modpython.org  Mon Jan 26 11:31:04 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Jan 26 12:30:58 2004
Subject: [mod_python] Interpreters and Filters
In-Reply-To: <5.2.1.1.2.20040125180918.04821e28@mail.pyxos.com>
References: <5.2.1.1.2.20040125180918.04821e28@mail.pyxos.com>
Message-ID: <20040126112846.L68546@onyx.ispol.com>


I haven't verified this, but I think the filter will execute in an
interpreter for the virtual host in which the the AddOutputFilter is
specified.

Grisha

On Sun, 25 Jan 2004, Daniel West wrote:

>
> According to the 3.0 (and 3.1.2b) documentation, PythonOutputFilter only
> works in the server config (not vhost).  If you have two vhosts (two
> interpreters by default) and a filter from the server config handles a
> request, does the filter have it's own interpreter which handles the
> request or does it run in the interpreter space of the vhost originating
> the request?
>
> -Dan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From grisha at modpython.org  Mon Jan 26 13:00:58 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Mon Jan 26 14:01:23 2004
Subject: [mod_python] get_options() problem
In-Reply-To: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>
References: <5.2.1.1.2.20040109001032.036bf9e0@mail.pyxos.com>
Message-ID: <20040126130023.Q68546@onyx.ispol.com>


It's a typo in the docs - it should be get_config()

Grisha

On Fri, 9 Jan 2004, Daniel West wrote:

>
> According to the 3.1.2b documentation there should be a get_options()
> method on the server object.  When trying to access it I get a traceback.
>
> code (under psp):
>
> req.log_error('options: %s' % `req.server.get_options()`)
>
> error:
>
> AttributeError: 'mp_server' object has no attribute 'get_options'
>
>
> Does the server.get_options() method no longer exist and is the
> documentation (section 4.5.6.1) just out of date?
>
> I'm trying to get to the DocumentRoot value for the virtual server handling
> the current request and was hoping I might find it in there.
>
> -Dan
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From listmail at gearyweb.com  Mon Jan 26 22:59:53 2004
From: listmail at gearyweb.com (michael geary)
Date: Tue Jan 27 01:59:24 2004
Subject: [mod_python] running mod_python on Panther?
Message-ID: <06A1D11C-508E-11D8-B98F-000A95685638@gearyweb.com>

is anyone doing it?

I had some problems with a missing libpython file in the Apple Python 
install, so I downloaded 2.3 source and compiled that with no problems. 
Installed it to /usr/local/. Then compiled mod_python from source with 
no problems. It installed to my apache running at /usr/local/apache/.

However, I'm getting a different error in my Apache log:

make_obcallback(): could not import mod_python.apache.
make_obcallback(): could not call init

I naively thought that mod_python was pretty much like mod_php, and I'm 
finding it's rather more complex. Not that this is a bad thing, but I'm 
struggling to get my feet under me, and I'd appreciate a hand up.

I've got these lines in my httpd.conf, is this correct:

AddType application/x-httpd-py .py
AddHandler python-program .py

I've also got this in a .htaccess file in the test directory:

PythonHandler mptest
PythonDebug On

and this test file (mptest.py):

from mod_python import apache

def handler(req):
	req.send_http_header()
	req.write("Hello World!")
	return apache.OK

anyone have any ideas where to look for a solution...? I'd appreciate 
it,

michael

From listmail at gearyweb.com  Mon Jan 26 23:29:07 2004
From: listmail at gearyweb.com (michael geary)
Date: Tue Jan 27 02:28:34 2004
Subject: [mod_python] running mod_python on Panther? 
In-Reply-To: <200401270608.RAA21806@lightning.itga.com.au>
References: <200401270608.RAA21806@lightning.itga.com.au>
Message-ID: <1C5652C2-5092-11D8-B98F-000A95685638@gearyweb.com>

Hi Greg,

thanks for getting back to me. I don't see a FAQ in the docs at all 
(strange). Are you referring to a specific file/URL?

which directory should these environment variables point to? 
/usr/local/lib/python/2.3 ?

Thanks for any further info,

michael

On Jan 26, 2004, at 11:08 PM, Gregory Bond wrote:

>> make_obcallback(): could not import mod_python.apache.
>> make_obcallback(): could not call init
>
> Have a look at the FAQ - this is usually because the apache process 
> cannot find
> the python libraries.  Usually either a LD_LIBRARY_PATH or PYTHONPATH 
> - type
> problem or a "apache nobody user cannot read the file" - type problem.
>
>
>

From gnb at itga.com.au  Tue Jan 27 17:42:34 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Tue Jan 27 02:42:21 2004
Subject: [mod_python] running mod_python on Panther? 
In-Reply-To: Your message of Mon, 26 Jan 2004 23:29:07 -0700.
Message-ID: <200401270642.RAA23627@lightning.itga.com.au>



> thanks for getting back to me. I don't see a FAQ in the docs at all 
> (strange). Are you referring to a specific file/URL?

The FAQ is on the web page:
 
	http://www.modpython.org/FAQ/faqw.py

> which directory should these environment variables point to? 
> /usr/local/lib/python/2.3 ?

Exact details depend on your installation.  In _theory_, no environment
variables should be needed.  In _practice_, especially when there are multiple 
python installations or if the compile host has different paths to the run 
host, some fiddling is sometimes needed.  

I'm not an OS-X user (boss won't buy me an I-Mac :<) so I'm not sure what would
be needed in that environment, but running ldd on the mod_python.so might be
instructive.  Or (as the FAQ suggests) running apache under truss to see what 
files it tries (and fails) to open just before it quits.



From gnb at itga.com.au  Tue Jan 27 18:01:09 2004
From: gnb at itga.com.au (Gregory Bond)
Date: Tue Jan 27 03:00:58 2004
Subject: [mod_python] mod_python and mysql - problem solved! 
In-Reply-To: Your message of Sun, 25 Jan 2004 09:03:40 -0500.
Message-ID: <200401270701.SAA24356@lightning.itga.com.au>

> Grisha, given how often this hits the list, maybe the should be in the
> FAQ/Docs.

Done!

http://www.modpython.org/FAQ/faqw.py?req=all#2.13


From oliver at mellet.net  Tue Jan 27 06:28:04 2004
From: oliver at mellet.net (Oliver Mellet)
Date: Tue Jan 27 10:28:00 2004
Subject: [mod_python] running mod_python on Panther?
In-Reply-To: <06A1D11C-508E-11D8-B98F-000A95685638@gearyweb.com>
Message-ID: <20040127142804.5989D2AEA99@meatwad.modul.us>

I'm running the latest (3.12b) against the fink distribution of python, on
Apache2 (mpm-worker).  Like you, I had the same issue of the missing dso in
the
Apple distribution of python.  One problem I had was that even though it was
linked against the fink version of python, it was still starting the apple
version
in /usr/bin; you might try moving the apple version out of the way and
adding a
symlink to yours.

> -----Original Message-----
> From: mod_python-bounces@modpython.org 
> [mailto:mod_python-bounces@modpython.org] On Behalf Of michael geary
> Sent: Monday, January 26, 2004 10:00 PM
> To: mod_python@modpython.org
> Subject: [mod_python] running mod_python on Panther?
> 
> is anyone doing it?
> 
> I had some problems with a missing libpython file in the 
> Apple Python install, so I downloaded 2.3 source and compiled 
> that with no problems. 
> Installed it to /usr/local/. Then compiled mod_python from 
> source with no problems. It installed to my apache running at 
> /usr/local/apache/.
> 
> However, I'm getting a different error in my Apache log:
> 
> make_obcallback(): could not import mod_python.apache.
> make_obcallback(): could not call init
> 
> I naively thought that mod_python was pretty much like 
> mod_php, and I'm finding it's rather more complex. Not that 
> this is a bad thing, but I'm struggling to get my feet under 
> me, and I'd appreciate a hand up.
> 
> I've got these lines in my httpd.conf, is this correct:
> 
> AddType application/x-httpd-py .py
> AddHandler python-program .py
> 
> I've also got this in a .htaccess file in the test directory:
> 
> PythonHandler mptest
> PythonDebug On
> 
> and this test file (mptest.py):
> 
> from mod_python import apache
> 
> def handler(req):
> 	req.send_http_header()
> 	req.write("Hello World!")
> 	return apache.OK
> 
> anyone have any ideas where to look for a solution...? I'd 
> appreciate it,
> 
> michael
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From neel at mediapulse.com  Tue Jan 27 11:55:22 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 27 12:55:09 2004
Subject: [mod_python] Child process init handler
Message-ID: <C0FC22C08B82074A88B500617641577787A827@johnson.mediapulse.net>

What I want to do:

	Run some initialization code when Apache spawns the child
process.  I do not want to call this handler for every request, but I do
want to have access to the configuration, specifically PythonOptions

In looking though the docs, I'm not sure PythonInitHandler works this
way, and PythonImport may not be able to access the PythonOption
directives.  Is there something I'm overlooking?

Mike

From dwmp at opti.cgi.net  Tue Jan 27 11:53:53 2004
From: dwmp at opti.cgi.net (Daniel West)
Date: Tue Jan 27 13:53:09 2004
Subject: [mod_python] Child process init handler
In-Reply-To: <C0FC22C08B82074A88B500617641577787A827@johnson.mediapulse.
 net>
Message-ID: <5.2.1.1.2.20040127113750.032f6e10@mail.pyxos.com>


Mike,

Unfortunately mod_python is a little lacking when it comes to 
initialization capabilities.  If you've missed something in the docs then 
I've missed it too.  As it turns out, it's not such a bad thing to do 
initialization on the first request.  Subsequent requests run in the same 
post-initialized environment (interpreter).  For instance, make a db module 
for your database interface.  On the first request, make a database 
connection and store the connection object in the database module.  On the 
next request, your database connection will still be there, alive and ready 
to use.

I think it would be very nice, convenient and helpful to new developers to 
have PythonImport work under virtual domains and to provide a method for 
accessing the PythonOptions of the domain under which PythonImport was 
called.  I know I spent several frustrating evenings, while taking up 
mod_python, trying to figure out how to make initialization work elegantly.

-Dan



At 11:55 AM 1/27/2004 -0500, you wrote:
>What I want to do:
>
>         Run some initialization code when Apache spawns the child
>process.  I do not want to call this handler for every request, but I do
>want to have access to the configuration, specifically PythonOptions
>
>In looking though the docs, I'm not sure PythonInitHandler works this
>way, and PythonImport may not be able to access the PythonOption
>directives.  Is there something I'm overlooking?
>
>Mike
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python


From neel at mediapulse.com  Tue Jan 27 13:17:15 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 27 14:17:02 2004
Subject: [mod_python] Child process init handler
Message-ID: <C0FC22C08B82074A88B50061764157776B9A14@johnson.mediapulse.net>

I do this now for db connections:

def db_connect(db="", user="", passwd="", host=""):
    global connection
    try:
        db = connection
        return db
    except NameError:
        connection = MySQLdb.connect( db=db, user=user, passwd=passwd,
host=host)

    return connection

(course this won't work in a 2.0 threaded MPM, as MySQLdb cursors are
one-one with db connections).

What I'm wanting to do as well is init my albatross app once to take
advantage of it's template and page module caching.

I admit this is an area where python starts to get fuzzy for me, so I'm
not even sure if the above code is doing what I think it is.  I can
write an app wrapper like the one above for albatross no sweat, just if
someone can give me a reassurance this is working like I think I'd feel
better =)

Mike


> -----Original Message-----
> From: Daniel West [mailto:dwmp@opti.cgi.net] 
> Sent: Tuesday, January 27, 2004 12:54 PM
> To: mod_python@modpython.org
> Subject: Re: [mod_python] Child process init handler
> 
> 
> 
> Mike,
> 
> Unfortunately mod_python is a little lacking when it comes to 
> initialization capabilities.  If you've missed something in 
> the docs then 
> I've missed it too.  As it turns out, it's not such a bad thing to do 
> initialization on the first request.  Subsequent requests run 
> in the same 
> post-initialized environment (interpreter).  For instance, 
> make a db module 
> for your database interface.  On the first request, make a database 
> connection and store the connection object in the database 
> module.  On the 
> next request, your database connection will still be there, 
> alive and ready 
> to use.
> 
> I think it would be very nice, convenient and helpful to new 
> developers to 
> have PythonImport work under virtual domains and to provide a 
> method for 
> accessing the PythonOptions of the domain under which 
> PythonImport was 
> called.  I know I spent several frustrating evenings, while taking up 
> mod_python, trying to figure out how to make initialization 
> work elegantly.
> 
> -Dan
> 
> 
> 
> At 11:55 AM 1/27/2004 -0500, you wrote:
> >What I want to do:
> >
> >         Run some initialization code when Apache spawns the child
> >process.  I do not want to call this handler for every 
> request, but I do
> >want to have access to the configuration, specifically PythonOptions
> >
> >In looking though the docs, I'm not sure PythonInitHandler works this
> >way, and PythonImport may not be able to access the PythonOption
> >directives.  Is there something I'm overlooking?
> >
> >Mike
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> 
> 
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
> 

From grisha at modpython.org  Tue Jan 27 16:08:47 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Tue Jan 27 17:57:33 2004
Subject: [mod_python] Child process init handler
In-Reply-To: <C0FC22C08B82074A88B500617641577787A827@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A827@johnson.mediapulse.net>
Message-ID: <20040127155901.L89046@onyx.ispol.com>


Apache doesn't really lend itself to this kind of thinking. I've never
been able to clearly pinpoint what the problem is, but it basically has to
do with a lot of request parameters being generated on the fly as a result
of the combination of the particular's of the request and the apache
configuration directives applicable to that request (which too are
determined at runtime).

Or, to put it another way - Apache's approach is "reactive" rather than
"proactive". When it parses its config it takes very little action on the
things it sees in it. Virtual servers just get piled into a hash list, and
only when a request for that particular server comes in is a meaningful
combination of a server and request object created. It's not like it
"intializes" virtual servers at any point during start up, so there is no
"virtual server init" hook.

In theory, when a child is spawned, mod_python could try to walk the
config and try to make sense of it and create and call some sort of a
per-server init hook, but that would more trouble than it's worth IMO.

Grisha

On Tue, 27 Jan 2004, Michael C. Neel wrote:

> What I want to do:
>
> 	Run some initialization code when Apache spawns the child
> process.  I do not want to call this handler for every request, but I do
> want to have access to the configuration, specifically PythonOptions
>
> In looking though the docs, I'm not sure PythonInitHandler works this
> way, and PythonImport may not be able to access the PythonOption
> directives.  Is there something I'm overlooking?
>
> Mike
>
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
From neel at mediapulse.com  Tue Jan 27 17:12:26 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 27 18:12:14 2004
Subject: [mod_python] Child process init handler
Message-ID: <C0FC22C08B82074A88B50061764157776B9A1D@johnson.mediapulse.net>

Mod_perl is able is so this somehow:

PerlChildInitHandler and PerlChildExitHandler do not refer to parts of
the request loop, they are to allow your modules to initialize data
structures and to clean up at the child process start-up and shutdown
respectively, for example by allocating and deallocating memory.


--
Michael C. Neel
Mediapulse, Inc. 

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Tuesday, January 27, 2004 4:09 PM
> To: Michael C. Neel
> Cc: Mod_python@modpython.org
> Subject: Re: [mod_python] Child process init handler
> 
> 
> 
> Apache doesn't really lend itself to this kind of thinking. I've never
> been able to clearly pinpoint what the problem is, but it 
> basically has to
> do with a lot of request parameters being generated on the 
> fly as a result
> of the combination of the particular's of the request and the apache
> configuration directives applicable to that request (which too are
> determined at runtime).
> 
> Or, to put it another way - Apache's approach is "reactive" 
> rather than
> "proactive". When it parses its config it takes very little 
> action on the
> things it sees in it. Virtual servers just get piled into a 
> hash list, and
> only when a request for that particular server comes in is a 
> meaningful
> combination of a server and request object created. It's not like it
> "intializes" virtual servers at any point during start up, so 
> there is no
> "virtual server init" hook.
> 
> In theory, when a child is spawned, mod_python could try to walk the
> config and try to make sense of it and create and call some sort of a
> per-server init hook, but that would more trouble than it's worth IMO.
> 
> Grisha
> 
> On Tue, 27 Jan 2004, Michael C. Neel wrote:
> 
> > What I want to do:
> >
> > 	Run some initialization code when Apache spawns the child
> > process.  I do not want to call this handler for every 
> request, but I do
> > want to have access to the configuration, specifically PythonOptions
> >
> > In looking though the docs, I'm not sure PythonInitHandler 
> works this
> > way, and PythonImport may not be able to access the PythonOption
> > directives.  Is there something I'm overlooking?
> >
> > Mike
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 

From neel at mediapulse.com  Tue Jan 27 17:28:26 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Tue Jan 27 18:28:14 2004
Subject: [mod_python] Child process init handler
Message-ID: <C0FC22C08B82074A88B500617641577787A828@johnson.mediapulse.net>

sorry, hit some crtl combo and my email was sent early... :/

Mod_perl is able is so this somehow:

'''
PerlChildInitHandler and PerlChildExitHandler do not refer to parts of
the request loop, they are to allow your modules to initialize data
structures and to clean up at the child process start-up and shutdown
respectively, for example by allocating and deallocating memory.

PerlInitHandler changes its behaviour depending upon where it is used.
In any case it is the first handler to be invoked in serving a request.
If found outside any <Location>, <Directory> or <Files> section (at the
top level), it is an alias for PerlPostReadRequestHandler. When inside
any such section it is an alias for PerlHeaderParserHandler.
'''

So I think this could be used in a virual host setting, and be able to
get options in that scope.  Though it's been a while since I mod_perl'd
anything...

My C is rusty, but they might be pulling this from some combo of the
Apache Api functions:

static void modulename_child_init(server_rec *s, pool *p);

and maybe something in 
static void *modulename_create_server_config(pool *p, server_rec *s);
static void *modulename_merge_server_config(pool *p, void *server1_conf,
void *server2_conf);

...at work right now, but when I get home I'll browse source and abuse
my apache home box with my unstable C code =)

Mike

> -----Original Message-----
> From: Gregory (Grisha) Trubetskoy [mailto:grisha@modpython.org] 
> Sent: Tuesday, January 27, 2004 4:09 PM
> To: Michael C. Neel
> Cc: Mod_python@modpython.org
> Subject: Re: [mod_python] Child process init handler
> 
> 
> 
> Apache doesn't really lend itself to this kind of thinking. I've never
> been able to clearly pinpoint what the problem is, but it 
> basically has to
> do with a lot of request parameters being generated on the 
> fly as a result
> of the combination of the particular's of the request and the apache
> configuration directives applicable to that request (which too are
> determined at runtime).
> 
> Or, to put it another way - Apache's approach is "reactive" 
> rather than
> "proactive". When it parses its config it takes very little 
> action on the
> things it sees in it. Virtual servers just get piled into a 
> hash list, and
> only when a request for that particular server comes in is a 
> meaningful
> combination of a server and request object created. It's not like it
> "intializes" virtual servers at any point during start up, so 
> there is no
> "virtual server init" hook.
> 
> In theory, when a child is spawned, mod_python could try to walk the
> config and try to make sense of it and create and call some sort of a
> per-server init hook, but that would more trouble than it's worth IMO.
> 
> Grisha
> 
> On Tue, 27 Jan 2004, Michael C. Neel wrote:
> 
> > What I want to do:
> >
> > 	Run some initialization code when Apache spawns the child
> > process.  I do not want to call this handler for every 
> request, but I do
> > want to have access to the configuration, specifically PythonOptions
> >
> > In looking though the docs, I'm not sure PythonInitHandler 
> works this
> > way, and PythonImport may not be able to access the PythonOption
> > directives.  Is there something I'm overlooking?
> >
> > Mike
> >
> > _______________________________________________
> > Mod_python mailing list
> > Mod_python@modpython.org
> > http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> 

From binarybrain at phreaker.net  Fri Jan 23 10:30:00 2004
From: binarybrain at phreaker.net (Jim)
Date: Tue Jan 27 23:10:35 2004
Subject: [mod_python] Browser saves script output to file instead
Message-ID: <1074871800.838.29.camel@debbie>

Mod_Python'ers,

I am having a problem with mod_python. Basically whats happening is when
I attempt to load a script in the web browser rather then execute the
script and display the output in the browser, I am prompted to save the
script. If you save the script you will find the output you would have
expected to be displayed in the browser. In other words, it doesn't save
the script, it parses the script and saves the output.

I followed the directions in the html documentation.
       
	   <Directory /var/www/test/python>
                AddHandler python-program .py
                #PythonHandler mod_python.publisher
                PythonHandler mptest
                PythonDebug On
        </Directory>

note: When I try the above with the publisher uncommented I get a 404.

I have tried the below. I have tried with the application type set to
x-python and x-httpd.py and I have tried with no AddType at all. Neither
make a difference.

AddType appliction/x-httpd-py .py  
AddType appliction/x-python .py

The error.log for apache looks like this. The below line is displayed
over and over again.

[Tue Jan 27 21:26:56 2004] [notice] mod_python: (Re)importing module
'mptest'

The script mptest is exactly as it is explained in the online docs.

This is the output from starting python2.3 in the command line and
trying the same import from mptest. I don't know if this should be
expected or not.

>>> from mod_python import apache
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 67,
in ?
    import _apache
ImportError: No module named _apache

I am running Debian unstable. mod_python 3.0.4-2 on apache 2.0.48-4

Any suggestions would be very much appreciated.

- Jim

From davidf at sjsoft.com  Wed Jan 28 08:02:50 2004
From: davidf at sjsoft.com (David Fraser)
Date: Wed Jan 28 02:02:45 2004
Subject: [mod_python] Browser saves script output to file instead
In-Reply-To: <1074871800.838.29.camel@debbie>
References: <1074871800.838.29.camel@debbie>
Message-ID: <4017508A.2090307@sjsoft.com>

Jim wrote:

>Mod_Python'ers,
>
>I am having a problem with mod_python. Basically whats happening is when
>I attempt to load a script in the web browser rather then execute the
>script and display the output in the browser, I am prompted to save the
>script. If you save the script you will find the output you would have
>expected to be displayed in the browser. In other words, it doesn't save
>the script, it parses the script and saves the output.
>
>I followed the directions in the html documentation.
>       
>	   <Directory /var/www/test/python>
>                AddHandler python-program .py
>                #PythonHandler mod_python.publisher
>                PythonHandler mptest
>                PythonDebug On
>        </Directory>
>
>note: When I try the above with the publisher uncommented I get a 404.
>
>I have tried the below. I have tried with the application type set to
>x-python and x-httpd.py and I have tried with no AddType at all. Neither
>make a difference.
>
>AddType appliction/x-httpd-py .py  
>AddType appliction/x-python .py
>  
>
Maybe you want AddType text/plain .py
Otherwise your browser won't know what to do with it?

>The error.log for apache looks like this. The below line is displayed
>over and over again.
>
>[Tue Jan 27 21:26:56 2004] [notice] mod_python: (Re)importing module
>'mptest'
>
>The script mptest is exactly as it is explained in the online docs.
>
>This is the output from starting python2.3 in the command line and
>trying the same import from mptest. I don't know if this should be
>expected or not.
>
>  
>
>>>>from mod_python import apache
>>>>        
>>>>
>Traceback (most recent call last):
>  File "<stdin>", line 1, in ?
>  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 67,
>in ?
>    import _apache
>ImportError: No module named _apache
>
>I am running Debian unstable. mod_python 3.0.4-2 on apache 2.0.48-4
>
>Any suggestions would be very much appreciated.
>
>- Jim
>
>_______________________________________________
>Mod_python mailing list
>Mod_python@modpython.org
>http://mailman.modpython.org/mailman/listinfo/mod_python
>
>  
>

From binarybrain at phreaker.net  Fri Jan 23 18:43:21 2004
From: binarybrain at phreaker.net (Jim)
Date: Wed Jan 28 07:23:57 2004
Subject: [mod_python] Browser saves script output to file instead
In-Reply-To: <4017508A.2090307@sjsoft.com>
References: <1074871800.838.29.camel@debbie>  <4017508A.2090307@sjsoft.com>
Message-ID: <1074901401.838.33.camel@debbie>

That worked. Thanks David. I worked on this for days. It seems strange
to me that that was the solution. 

Thanks again,

Jim

On Wed, 2004-01-28 at 01:02, David Fraser wrote:
> Jim wrote:
> 
> >Mod_Python'ers,
> >
> >I am having a problem with mod_python. Basically whats happening is when
> >I attempt to load a script in the web browser rather then execute the
> >script and display the output in the browser, I am prompted to save the
> >script. If you save the script you will find the output you would have
> >expected to be displayed in the browser. In other words, it doesn't save
> >the script, it parses the script and saves the output.
> >
> >I followed the directions in the html documentation.
> >       
> >	   <Directory /var/www/test/python>
> >                AddHandler python-program .py
> >                #PythonHandler mod_python.publisher
> >                PythonHandler mptest
> >                PythonDebug On
> >        </Directory>
> >
> >note: When I try the above with the publisher uncommented I get a 404.
> >
> >I have tried the below. I have tried with the application type set to
> >x-python and x-httpd.py and I have tried with no AddType at all. Neither
> >make a difference.
> >
> >AddType appliction/x-httpd-py .py  
> >AddType appliction/x-python .py
> >  
> >
> Maybe you want AddType text/plain .py
> Otherwise your browser won't know what to do with it?
> 
> >The error.log for apache looks like this. The below line is displayed
> >over and over again.
> >
> >[Tue Jan 27 21:26:56 2004] [notice] mod_python: (Re)importing module
> >'mptest'
> >
> >The script mptest is exactly as it is explained in the online docs.
> >
> >This is the output from starting python2.3 in the command line and
> >trying the same import from mptest. I don't know if this should be
> >expected or not.
> >
> >  
> >
> >>>>from mod_python import apache
> >>>>        
> >>>>
> >Traceback (most recent call last):
> >  File "<stdin>", line 1, in ?
> >  File "/usr/lib/python2.3/site-packages/mod_python/apache.py", line 67,
> >in ?
> >    import _apache
> >ImportError: No module named _apache
> >
> >I am running Debian unstable. mod_python 3.0.4-2 on apache 2.0.48-4
> >
> >Any suggestions would be very much appreciated.
> >
> >- Jim
> >
> >_______________________________________________
> >Mod_python mailing list
> >Mod_python@modpython.org
> >http://mailman.modpython.org/mailman/listinfo/mod_python
> >
> >  
> >
> 

From ross at karchner.com  Wed Jan 28 12:02:42 2004
From: ross at karchner.com (Ross M Karchner)
Date: Wed Jan 28 13:04:07 2004
Subject: [mod_python] gzip and conditional get
Message-ID: <4017EB32.3010301@karchner.com>

Hello-

When writing Python CGI's, I had been using cgi_buffer to compress web 
output and generate/validate Etags:

http://www.mnot.net/cgi_buffer/

Does anyone know of a similar module for mod_python?

Absent that-- can anyone suggest the best way to get thos features in 
mod_python?


-Ross
From neel at mediapulse.com  Wed Jan 28 12:36:16 2004
From: neel at mediapulse.com (Michael C. Neel)
Date: Wed Jan 28 13:36:05 2004
Subject: [mod_python] gzip and conditional get
Message-ID: <C0FC22C08B82074A88B500617641577787A829@johnson.mediapulse.net>

In apache you have a compression module called mod_gzip (I think that is
the name) to compress output, which will be transparent to your code.
Also, it can work on everything, not just dynamic output - images,
static content, non-python scripts, etc.  I've always been wary of this
though, is it faster ot send compressed data in which CPU cycles are
used on both ends to handle the format, or just send straight output.
One take more time processing, the other more time sending, and there is
probably a point of no return in which a heavy traffic server could be
so backed up with compression requests it beings about it's own doom.
Seems like a DoS waiting to happen, but I've not tested out each option
so in pratice it may not be realistic.

The Etag thing is new to me, but I suppose if you looked at cgi_buffer's
source it wouldn't be too hard to extract that piece, sing it will just
be some string work.

Hth,
Mike

> -----Original Message-----
> From: Ross M Karchner [mailto:ross@karchner.com] 
> Sent: Wednesday, January 28, 2004 12:03 PM
> To: mod_python@modpython.org
> Subject: [mod_python] gzip and conditional get
> 
> 
> Hello-
> 
> When writing Python CGI's, I had been using cgi_buffer to 
> compress web 
> output and generate/validate Etags:
> 
http://www.mnot.net/cgi_buffer/

Does anyone know of a similar module for mod_python?

Absent that-- can anyone suggest the best way to get thos features in 
mod_python?


-Ross
_______________________________________________
Mod_python mailing list
Mod_python@modpython.org
http://mailman.modpython.org/mailman/listinfo/mod_python

From ross at karchner.com  Wed Jan 28 12:51:22 2004
From: ross at karchner.com (Ross M Karchner)
Date: Wed Jan 28 13:52:47 2004
Subject: [mod_python] gzip and conditional get
In-Reply-To: <C0FC22C08B82074A88B500617641577787A829@johnson.mediapulse.net>
References: <C0FC22C08B82074A88B500617641577787A829@johnson.mediapulse.net>
Message-ID: <4017F69A.80705@karchner.com>

Michael C. Neel wrote:

>In apache you have a compression module called mod_gzip (I think that is
>the name) to compress output, which will be transparent to your code.
>Also, it can work on everything, not just dynamic output - images,
>static content, non-python scripts, etc.  
>
Ah- I had the opposite misconception then, I though mod_gzip (and 
mod_deflate) were only useful for static content.

-Ross
From JLaPlante at challiance.org  Wed Jan 28 16:25:04 2004
From: JLaPlante at challiance.org (LaPlante, James)
Date: Wed Jan 28 17:24:54 2004
Subject: [mod_python] make_obcallback: could not import mod_python.apache
Message-ID: <899E08CB788DAE40AB33F688B5588AD1051FEE3C@chamail3.cphc.local>

I'm getting the following error in the apache err_logs when I try to run the
mptest.py script:
[Wed Jan 28 14:55:14 2004] [error] make_obcallback: could not import
mod_python.apache.

My Google searches have turned up quite a few people that have gotten the
same error, but I still haven't found a fix for the problem.  Any help would
be appreciated.  My latest attempts used mod_python 3.1.3b.  I got the same
error using mod_python 3.0.4.  Here is what I've done so far.


Compiled, installed, and tested Apache 2.0.48
./configure --prefix=/usr/local/apache2
make
make install

Compiled, installed, and tested Python 2.2.3
./configure -prefix=/usr/local/python2.2.3
make
make install

Compiled and Installed DSO for Mod_Python
./configure --with-apxs=/usr/local/apache2/bin/apxs
--with-python=/usr/local/python2.2.3/bin/python2.2
make
make install


Configured httpd.conf by adding the following:
LoadModule python_module /usr/local/apache2/modules/mod_python.so

<Directory /usr/local/apache2/htdocs/test>
  AddHandler python-program .py
  PythonHandler mptest
  PythonDebug On
</Directory>

Created /usr/local/apache2/htdocs/test/mptest.py and set world execute
from mod_python import apache

def handler(req):
    req.write("Hello World!")
    return apache.OK


Apache Error Log After Startup
[Wed Jan 28 14:55:14 2004] [notice] Apache/2.0.48 (Unix) mod_python/3.1.2b
Python/2.2.3 configured -- resuming normal operations

Apache Error Log after http://servername/test/mptest.py is called
[Wed Jan 28 14:55:14 2004] [notice] Apache/2.0.48 (Unix) mod_python/3.1.2b
Python/2.2.3 configured -- resuming normal operations
[Wed Jan 28 14:55:14 2004] [error] make_obcallback: could not import
mod_python.apache.


From loper at ananzi.co.za  Thu Jan 29 02:38:59 2004
From: loper at ananzi.co.za (Gerhard Venter)
Date: Wed Jan 28 20:38:19 2004
Subject: [mod_python] Hello World - problem
Message-ID: <web-11071759@mail01.ananzi.com>

Hi

I have followed the instructions on the modpython web-site,
but can still not get the test script at
http://www.modpython.org/live/current/doc-html/inst-testing.html
to work - the browser just tries to download the file.
Yet mod-python is running, because if I change the script:

from mod_python import apache

to

from mod_python import 123thisisatest

I get a Python traceback which includes:

ImportError: cannot import name 123thisisatest, which
proves to me that the Python Debug is working

I have tried both libapache-mod-python-2.2  and
libapache-mod-python-2.3 Debian packages.  This was
initially under apache2-mpm-worker, but I thought perhaps
mod_python might work under apache2-mpm-prefork, but this
also did not work.

Any ideas would be appreciated

Gerhard
 
==
Download ringtones, logos and picture messages at Ananzi Mobile Fun.
http://www.ananzi.co.za/cgi-bin/goto.pl?mobile
From terry.macdonald at dsl.pipex.com  Thu Jan 29 18:42:26 2004
From: terry.macdonald at dsl.pipex.com (Terry MacDonald)
Date: Thu Jan 29 14:42:13 2004
Subject: [mod_python] 
	RE: make_obcallback: could not import mod_python.apache
In-Reply-To: <200401291700.i0TH061D003558@slash.mediapulse.com>
References: <200401291700.i0TH061D003558@slash.mediapulse.com>
Message-ID: <1075401746.4235.18.camel@bigmac.taumu.com>

On Thu, 2004-01-29 at 17:00, mod_python-request@modpython.org wrote:

> I'm getting the following error in the apache err_logs when I try to run the
> mptest.py script:
> [Wed Jan 28 14:55:14 2004] [error] make_obcallback: could not import
> mod_python.apache.
> 
> My Google searches have turned up quite a few people that have gotten the
> same error, but I still haven't found a fix for the problem.  Any help would
> be appreciated.  My latest attempts used mod_python 3.1.3b.  I got the same
> error using mod_python 3.0.4.  Here is what I've done so far.
> 
> 
> Compiled, installed, and tested Apache 2.0.48
> ./configure --prefix=/usr/local/apache2
> make
> make install
> 
> Compiled, installed, and tested Python 2.2.3
> ./configure -prefix=/usr/local/python2.2.3
> make
> make install
> 
> Compiled and Installed DSO for Mod_Python
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/python2.2.3/bin/python2.2
> make
> make install
> 
> 
> Configured httpd.conf by adding the following:
> LoadModule python_module /usr/local/apache2/modules/mod_python.so
> 
> <Directory /usr/local/apache2/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> 
> Created /usr/local/apache2/htdocs/test/mptest.py and set world execute
> from mod_python import apache
> 
> def handler(req):
>     req.write("Hello World!")
>     return apache.OK
> 
> 
> Apache Error Log After Startup
> [Wed Jan 28 14:55:14 2004] [notice] Apache/2.0.48 (Unix) mod_python/3.1.2b
> Python/2.2.3 configured -- resuming normal operations
> 
> Apache Error Log after http://servername/test/mptest.py is called
> [Wed Jan 28 14:55:14 2004] [notice] Apache/2.0.48 (Unix) mod_python/3.1.2b
> Python/2.2.3 configured -- resuming normal operations
> [Wed Jan 28 14:55:14 2004] [error] make_obcallback: could not import
> mod_python.apache.
> 

Does adding the following to the Apache config help:

    PythonPath "['/usr/local/apache2/htdocs/test']+sys.path"

Place it in the Directory directive.

This is not documented (probably should be especially for newbies as I
was!) but after a lot of headaches and experimenting it got my
implementation to work. It appears mod_python/python needs to be told
informed of every directory a python scripts frequent.

cheers

-- 
Terry
www.taumu.com

From JLaPlante at challiance.org  Thu Jan 29 14:36:29 2004
From: JLaPlante at challiance.org (LaPlante, James)
Date: Thu Jan 29 15:36:29 2004
Subject: [mod_python] 
	RE: make_obcallback: could not import mod_python.apache
Message-ID: <899E08CB788DAE40AB33F688B5588AD1051FEE42@chamail3.cphc.local>

Unfortunately this didn't help.

-----Original Message-----
From: Terry MacDonald [mailto:terry.macdonald@dsl.pipex.com] 
Sent: Thursday, January 29, 2004 1:42 PM
To: JLaPlante@challiance.org
Cc: mod_python@modpython.org
Subject: RE: make_obcallback: could not import mod_python.apache

On Thu, 2004-01-29 at 17:00, mod_python-request@modpython.org wrote:

> I'm getting the following error in the apache err_logs when I try to run
the
> mptest.py script:
> [Wed Jan 28 14:55:14 2004] [error] make_obcallback: could not import
> mod_python.apache.
> 
> My Google searches have turned up quite a few people that have gotten the
> same error, but I still haven't found a fix for the problem.  Any help
would
> be appreciated.  My latest attempts used mod_python 3.1.3b.  I got the
same
> error using mod_python 3.0.4.  Here is what I've done so far.
> 
> 
> Compiled, installed, and tested Apache 2.0.48
> ./configure --prefix=/usr/local/apache2
> make
> make install
> 
> Compiled, installed, and tested Python 2.2.3
> ./configure -prefix=/usr/local/python2.2.3
> make
> make install
> 
> Compiled and Installed DSO for Mod_Python
> ./configure --with-apxs=/usr/local/apache2/bin/apxs
> --with-python=/usr/local/python2.2.3/bin/python2.2
> make
> make install
> 
> 
> Configured httpd.conf by adding the following:
> LoadModule python_module /usr/local/apache2/modules/mod_python.so
> 
> <Directory /usr/local/apache2/htdocs/test>
>   AddHandler python-program .py
>   PythonHandler mptest
>   PythonDebug On
> </Directory>
> 
> Created /usr/local/apache2/htdocs/test/mptest.py and set world execute
> from mod_python import apache
> 
> def handler(req):
>     req.write("Hello World!")
>     return apache.OK
> 
> 
> Apache Error Log After Startup
> [Wed Jan 28 14:55:14 2004] [notice] Apache/2.0.48 (Unix) mod_python/3.1.2b
> Python/2.2.3 configured -- resuming normal operations
> 
> Apache Error Log after http://servername/test/mptest.py is called
> [Wed Jan 28 14:55:14 2004] [notice] Apache/2.0.48 (Unix) mod_python/3.1.2b
> Python/2.2.3 configured -- resuming normal operations
> [Wed Jan 28 14:55:14 2004] [error] make_obcallback: could not import
> mod_python.apache.
> 

Does adding the following to the Apache config help:

    PythonPath "['/usr/local/apache2/htdocs/test']+sys.path"

Place it in the Directory directive.

This is not documented (probably should be especially for newbies as I
was!) but after a lot of headaches and experimenting it got my
implementation to work. It appears mod_python/python needs to be told
informed of every directory a python scripts frequent.

cheers

-- 
Terry
www.taumu.com
From cfox at cfconsulting.ca  Thu Jan 29 13:27:03 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Thu Jan 29 17:27:00 2004
Subject: [mod_python] POST form data retrieval
Message-ID: <40197AA7.5060307@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi, all.

I'm trying to read form data from a post, and the method I used for a
CGI doesn't work - that is, reading the Content-Length, then reading
that number of bytes from stdin.

I want to go down to this level because I've created my own form parsing
system, and it requires lower level access than the CGI module (and the
FieldStorage stuff) provides.

So how do you read the raw form data from a post?

Thanks,
~  cf

- --
Colin Fox
President, CF Consulting Inc.
cfox@cfconsulting.ca
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAGXqnoaQ1/feGlJoRAmcYAJ9rbTDb+RB5DCVzxMhsPkpWPDvUGwCfeZWh
TNmqYCq4bixeZ88ghAorra8=
=KaYr
-----END PGP SIGNATURE-----
From khurram at renai-soft.com  Sat Jan 31 13:24:25 2004
From: khurram at renai-soft.com (Khurram)
Date: Sat Jan 31 02:22:50 2004
Subject: [mod_python] POST form data retrieval&In-Reply-To=
Message-ID: <1075577065.401c00e93ee45@webmail.renai-soft.com>

Please read the cgi source for handling form data. I think that would be the
best example.

Khurram Ijaz,
Renaissance Software.
http://www.renai-soft.com

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

From cfox at cfconsulting.ca  Sat Jan 31 00:56:34 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Sat Jan 31 04:57:03 2004
Subject: [mod_python] POST form data retrieval&In-Reply-To=
In-Reply-To: <1075577065.401c00e93ee45@webmail.renai-soft.com>
References: <1075577065.401c00e93ee45@webmail.renai-soft.com>
Message-ID: <401B6DC2.5020504@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Khurram wrote:
| Please read the cgi source for handling form data. I think that would
be the
| best example.

I'm sorry - which cgi source? Something to do with mod_python, or cgis
in general?

I have CGIs already which handle form data. My problem is that I'm
trying to write a mod-python handler which can deal with form data, and
it doesn't work the way the CGI does.

In a FORM->POST, the Content-Length is set to the number of bytes in the
form data, and the CGI reads that much from stdin.

I tried that technique with my mod_python handler, and I get nothing.

Any suggestions?

cf

- --
Colin Fox
President, CF Consulting Inc.
cfox@cfconsulting.ca
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAG23CoaQ1/feGlJoRApEZAKCK5kbKGbcHYwrI3LESW8GHfxk5DgCdHuy7
26QPbT4O8luLKVRXe9/T6wE=
=lgJp
-----END PGP SIGNATURE-----
From mark at gsoa.net  Sat Jan 31 10:24:41 2004
From: mark at gsoa.net (Mark McClain)
Date: Sat Jan 31 11:24:27 2004
Subject: [mod_python] POST form data retrieval&In-Reply-To=
In-Reply-To: <401B6DC2.5020504@cfconsulting.ca>
References: <1075577065.401c00e93ee45@webmail.renai-soft.com>
	<401B6DC2.5020504@cfconsulting.ca>
Message-ID: <975FC360-5401-11D8-ABC3-000A95B33D28@gsoa.net>

You want to use a combination of:

req.clength member and req.read() method look at the request object 
documentation for more information.

mark


On Jan 31, 2004, at 3:56 AM, Colin Fox wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Khurram wrote:
> | Please read the cgi source for handling form data. I think that would
> be the
> | best example.
>
> I'm sorry - which cgi source? Something to do with mod_python, or cgis
> in general?
>
> I have CGIs already which handle form data. My problem is that I'm
> trying to write a mod-python handler which can deal with form data, and
> it doesn't work the way the CGI does.
>
> In a FORM->POST, the Content-Length is set to the number of bytes in 
> the
> form data, and the CGI reads that much from stdin.
>
> I tried that technique with my mod_python handler, and I get nothing.
>
> Any suggestions?
>
> cf
>
> - --
> Colin Fox
> President, CF Consulting Inc.
> cfox@cfconsulting.ca
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.3 (GNU/Linux)
> Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org
>
> iD8DBQFAG23CoaQ1/feGlJoRApEZAKCK5kbKGbcHYwrI3LESW8GHfxk5DgCdHuy7
> 26QPbT4O8luLKVRXe9/T6wE=
> =lgJp
> -----END PGP SIGNATURE-----
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>

From cfox at cfconsulting.ca  Sat Jan 31 09:01:56 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Sat Jan 31 13:02:02 2004
Subject: [mod_python] POST form data retrieval&In-Reply-To=
In-Reply-To: <975FC360-5401-11D8-ABC3-000A95B33D28@gsoa.net>
References: <1075577065.401c00e93ee45@webmail.renai-soft.com>
	<401B6DC2.5020504@cfconsulting.ca>
	<975FC360-5401-11D8-ABC3-000A95B33D28@gsoa.net>
Message-ID: <401BDF84.1040203@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Mark McClain wrote:
| You want to use a combination of:
|
| req.clength member and req.read() method look at the request object
| documentation for more information.
|
| mark
|

Perfect! I should have realized that I need to use req.read() instead of
sys.stdin.read(). Thanks!

cf

- --
Colin Fox
President, CF Consulting Inc.
cfox@cfconsulting.ca
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAG9+EoaQ1/feGlJoRAl+tAJ9RH8HtMt15nZKpMObRBJVFQhHoYQCfTWLX
amOQiqMn02otp3Tmh1ZMri0=
=wQ+p
-----END PGP SIGNATURE-----
From cfox at cfconsulting.ca  Sat Jan 31 09:14:25 2004
From: cfox at cfconsulting.ca (Colin Fox)
Date: Sat Jan 31 13:14:41 2004
Subject: [mod_python] POST form data retrieval&In-Reply-To=
In-Reply-To: <975FC360-5401-11D8-ABC3-000A95B33D28@gsoa.net>
References: <1075577065.401c00e93ee45@webmail.renai-soft.com>
	<401B6DC2.5020504@cfconsulting.ca>
	<975FC360-5401-11D8-ABC3-000A95B33D28@gsoa.net>
Message-ID: <401BE271.3070709@cfconsulting.ca>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Mark McClain wrote:
| You want to use a combination of:
|
| req.clength member and req.read() method look at the request object
| documentation for more information.
|
| mark

Interestingly, req.clength is 0 - I have to get the length to read by:
len = int(req.headers_in['Content-Length'])

Is clength cleared after some operation (but before the read), or is
there a bug here?

cf

- --
Colin Fox
President, CF Consulting Inc.
cfox@cfconsulting.ca
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org

iD8DBQFAG+JxoaQ1/feGlJoRAkZ3AKCLy0UB7+F7o3vlXOPazVP4qq7R3wCfe6OV
4hWhhH6GFcAPmLWIydZJXRw=
=YY4F
-----END PGP SIGNATURE-----
From grisha at modpython.org  Sat Jan 31 21:40:06 2004
From: grisha at modpython.org (Gregory (Grisha) Trubetskoy)
Date: Sat Jan 31 22:39:59 2004
Subject: [mod_python] POST form data retrieval&In-Reply-To=
In-Reply-To: <401BE271.3070709@cfconsulting.ca>
References: <1075577065.401c00e93ee45@webmail.renai-soft.com>
	<975FC360-5401-11D8-ABC3-000A95B33D28@gsoa.net>
	<401BE271.3070709@cfconsulting.ca>
Message-ID: <20040131213930.G56076@onyx.ispol.com>


I believe clength applies only to the stuff going out not coming in.

Grisha

On Sat, 31 Jan 2004, Colin Fox wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Mark McClain wrote:
> | You want to use a combination of:
> |
> | req.clength member and req.read() method look at the request object
> | documentation for more information.
> |
> | mark
>
> Interestingly, req.clength is 0 - I have to get the length to read by:
> len = int(req.headers_in['Content-Length'])
>
> Is clength cleared after some operation (but before the read), or is
> there a bug here?
>
> cf
>
> - --
> Colin Fox
> President, CF Consulting Inc.
> cfox@cfconsulting.ca
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.2.3 (GNU/Linux)
> Comment: Using GnuPG with Thunderbird - http://enigmail.mozdev.org
>
> iD8DBQFAG+JxoaQ1/feGlJoRAkZ3AKCLy0UB7+F7o3vlXOPazVP4qq7R3wCfe6OV
> 4hWhhH6GFcAPmLWIydZJXRw=
> =YY4F
> -----END PGP SIGNATURE-----
> _______________________________________________
> Mod_python mailing list
> Mod_python@modpython.org
> http://mailman.modpython.org/mailman/listinfo/mod_python
>
