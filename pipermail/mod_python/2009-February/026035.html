<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Matplotlib error from a mod_python script &quot;root is 
	not a writable dir... &quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Matplotlib%20error%20from%20a%20mod_python%20script%20%22root%20is%20%0A%09not%20a%20writable%20dir...%20%22&In-Reply-To=-6465265059533872257%40unknownmsgid">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026034.html">
   <LINK REL="Next"  HREF="026036.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Matplotlib error from a mod_python script &quot;root is 
	not a writable dir... &quot;</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Matplotlib%20error%20from%20a%20mod_python%20script%20%22root%20is%20%0A%09not%20a%20writable%20dir...%20%22&In-Reply-To=-6465265059533872257%40unknownmsgid"
       TITLE="[mod_python] Matplotlib error from a mod_python script &quot;root is 
	not a writable dir... &quot;">graham.dumpleton at gmail.com
       </A><BR>
    <I>Sat Feb 21 18:51:01 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="026034.html">[mod_python] Matplotlib error from a mod_python script &quot;root is not
	a writable dir... &quot;
</A></li>
        <LI>Next message: <A HREF="026036.html">[mod_python] Matplotlib error from a mod_python script &quot;root is 
	not a writable dir... &quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26035">[ date ]</a>
              <a href="thread.html#26035">[ thread ]</a>
              <a href="subject.html#26035">[ subject ]</a>
              <a href="author.html#26035">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>2009/2/22 Ron Phelps &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">rphelps at redshift.com</A>&gt;:
&gt;<i> I have successfully configured mod_python and using some python scripts
</I>&gt;<i> am accessing a database for the purpose of generating plots using
</I>&gt;<i> matplotlib.
</I>&gt;<i>
</I>&gt;<i> The problem is that when I try to save a plot to a subdir of the Apache
</I>&gt;<i> document root I get the following error.
</I>&gt;<i>
</I>&gt;<i> '/root' is not a writable dir; you must set the environment variable
</I>&gt;<i> HOME to be a writable dir
</I>&gt;<i>
</I>&gt;<i> echo $HOME  returns '/root' but setting it to the correct path and even
</I>&gt;<i> changing the dir permissions does no good.
</I>&gt;<i>
</I>&gt;<i> Tried useing the MPLCONFIGDIR to point to a MATPLOTLIBRC file but no
</I>&gt;<i> luck there either.
</I>&gt;<i>
</I>&gt;<i> Does anyone know What HOME variable is this error message referring to?
</I>&gt;<i>
</I>&gt;<i> BTW Graham, I came across your article on &quot;modwsgi&quot; though it may not be
</I>&gt;<i> directly related I will read it in hopes it gives me some insight.
</I>
The following environment variables can/will all be set wrong if using
mod_python.

  HOME
  LOGNAME
  USERNAME
  USER

If any Python code uses those directly, or indirectly via
os.path.expanduser() function, then the results will be wrong.

The only way that is guaranteed to give correct values are to use
os.geteuid() and then 'pwd' module to look up user details in password
database.

Even then, the result will then reflect what is correct for the user
that Apache runs as. The home directory of that account isn't usually
writable either.

You thus need to find a way of telling matplotlib to look use
alternate location. You appear to have tried that, but the question is
how have you tried to do that? You cannot use SetEnv or PythonOption
directives as they do not set environment variables in Apache server
child processes.

What you do to do is set os.environ dictionary explicitly in your
mod_python handler entry point module, or possibly in a special module
imported using PythonImport directive.

Graham
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026034.html">[mod_python] Matplotlib error from a mod_python script &quot;root is not
	a writable dir... &quot;
</A></li>
	<LI>Next message: <A HREF="026036.html">[mod_python] Matplotlib error from a mod_python script &quot;root is 
	not a writable dir... &quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26035">[ date ]</a>
              <a href="thread.html#26035">[ thread ]</a>
              <a href="subject.html#26035">[ subject ]</a>
              <a href="author.html#26035">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
