<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] problem with input filter and POST data (fileupload)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20problem%20with%20input%20filter%20and%20POST%20data%20%28fileupload%29&In-Reply-To=200902160040.17158.jerch%40rockborn.de">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026018.html">
   <LINK REL="Next"  HREF="026020.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] problem with input filter and POST data (fileupload)</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Joerg</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20problem%20with%20input%20filter%20and%20POST%20data%20%28fileupload%29&In-Reply-To=200902160040.17158.jerch%40rockborn.de"
       TITLE="[mod_python] problem with input filter and POST data (fileupload)">jerch at rockborn.de
       </A><BR>
    <I>Sun Feb 15 20:27:02 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="026018.html">[mod_python] problem with input filter and POST data (fileupload)
</A></li>
        <LI>Next message: <A HREF="026020.html">[mod_python] problem with input filter and POST data (fileupload)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26019">[ date ]</a>
              <a href="thread.html#26019">[ thread ]</a>
              <a href="subject.html#26019">[ subject ]</a>
              <a href="author.html#26019">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hello,

ive dumped a fileupload (original size = 231KB) with the following results:

without filter:
	- req.read() --&gt; 231KB
	- req.readline() --&gt; 231KB
	- req.readline(64000) --&gt; 231KB
	- via util.py --&gt; 231KB

with filter:
	- req.read() --&gt; 231KB
	- req.readline() --&gt; 231KB
	- req.readline(64000) --&gt; 64KB
	- via util.py --&gt; 64KB

the filter:
def inputfilter(filter):
	s = filter.read()
	while s:
		filter.write(s)
		s = filter.read()
	if s is None:
		filter.close()

somehow the the req.readline(size) method doesnt like input filters. since i 
tested it with a binary file the file content would be in one line, but the 
unread part of this line gets lost. weird thing, but all the other lines 
after the file content (the closing boundery) gets lost, too.
this problem points definitely into the c-written part of mod_python, util.py 
just inherits it from there.
any suggestions?

jerch
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026018.html">[mod_python] problem with input filter and POST data (fileupload)
</A></li>
	<LI>Next message: <A HREF="026020.html">[mod_python] problem with input filter and POST data (fileupload)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26019">[ date ]</a>
              <a href="thread.html#26019">[ thread ]</a>
              <a href="subject.html#26019">[ subject ]</a>
              <a href="author.html#26019">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
