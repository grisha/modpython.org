<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] 	invalid pointer, child process dies,
	broken connections
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%09invalid%20pointer%2C%20child%20process%20dies%2C%0A%09broken%20connections&In-Reply-To=200611231044.28832.richardlewis%40fastmail.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022674.html">
   <LINK REL="Next"  HREF="022675.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] 	invalid pointer, child process dies,
	broken connections</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Jim Gallacher</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20%09invalid%20pointer%2C%20child%20process%20dies%2C%0A%09broken%20connections&In-Reply-To=200611231044.28832.richardlewis%40fastmail.co.uk"
       TITLE="[mod_python] 	invalid pointer, child process dies,
	broken connections">jpg at jgassociates.ca
       </A><BR>
    <I>Thu Nov 23 16:39:15 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022674.html">[mod_python] 
	invalid pointer, child process dies, broken connections
</A></li>
        <LI>Next message: <A HREF="022675.html">[mod_python] Changing server signature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22680">[ date ]</a>
              <a href="thread.html#22680">[ thread ]</a>
              <a href="subject.html#22680">[ subject ]</a>
              <a href="author.html#22680">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Richard Lewis wrote:
&gt;<i> Hi there,
</I>&gt;<i> 
</I>&gt;<i> Debian unstable; apache: 2.2.3; modpython: 3.2.10; python: 2.4.4; lxml 1.1.1: 
</I>&gt;<i> libxml: 2.6.16; libxslt: 1.1.8.
</I>
&gt;<i> I posted on 2nd Nov about some invalid pointer errors in my Apache error log. 
</I>&gt;<i> At the time I thought they were coming from MySQL and received some 
</I>&gt;<i> interesting replies regarding the incompatibility of the mysql client 
</I>&gt;<i> libraries compiled into various apache modules.
</I>&gt;<i> 
</I>&gt;<i> However, since then I've decided to cut MySQL out of my web application and, 
</I>&gt;<i> instead of dynamically converting database records into XML, use 
</I>&gt;<i> filesystem-cached XML files which are generated periodically from the 
</I>&gt;<i> database by a separate
</I>
Were you using lxml, libxml and libxslt previously from within 
mod_python? If you can reduce things to the simplest possible test case 
I can check it on my Debian test setup.

&gt;<i> While there are a couple of other advantages to this approach, it hasn't 
</I>&gt;<i> solved my initial problem! I still have numerous errors like this in my 
</I>&gt;<i> Apache error log:
</I>&gt;<i> 
</I>&gt;<i> [Mon Nov 20 10:51:58 2006] [notice] child pid 7087 exit signal Aborted (6)
</I>&gt;<i> *** glibc detected *** free(): invalid pointer: 0x0835ab26 ***
</I>&gt;<i> *** glibc detected *** free(): invalid pointer: 0x0835ab26 ***
</I>&gt;<i> *** glibc detected *** free(): invalid pointer: 0x0835ab26 ***
</I>&gt;<i> *** glibc detected *** free(): invalid pointer: 0x0835ab26 ***
</I>&gt;<i> [Mon Nov 20 10:54:28 2006] [notice] child pid 7088 exit signal Aborted (6)
</I>&gt;<i> [Mon Nov 20 10:54:28 2006] [notice] child pid 7089 exit signal Aborted (6)
</I>&gt;<i> [Mon Nov 20 10:54:28 2006] [notice] child pid 7098 exit signal Aborted (6)
</I>&gt;<i>
</I>&gt;<i> It seems to handle several requests and then you get an error message from the 
</I>&gt;<i> client (browser) saying that &quot;the connection is broken&quot;. You can then retry 
</I>&gt;<i> the request and it works after one or two attempts.
</I>&gt;<i> 
</I>&gt;<i> I /think/ there is no direct correlation between the invalid pointer errors 
</I>&gt;<i> messages and the dropped connections; the times of the messages seem to be 
</I>&gt;<i> pretty evenly distributed and don't all result in a broken connection.
</I>&gt;<i> 
</I>&gt;<i> Also, the memory addresses of the invalid pointers are often (but not always) 
</I>&gt;<i> the same. While the child process ids are always different. What is the child 
</I>&gt;<i> process? Is it python?
</I>
The child process refers to the Apache child process. The python 
interpreter is embedded in that process. The fact that the pids are 
different indicates that they are being killed off, which is generally a 
bad thing performance wise. Generally you want them to be long lived to 
avoid the overhead of forking a new process.

&gt;<i> I've checked to make sure that I'm always returning the content length and 
</I>&gt;<i> Apache status code; I'm pretty sure I am! My application is using a frameset 
</I>&gt;<i> where the frame document and its four frames are all generated using 
</I>&gt;<i> mod_python. Is there anything special I should do to help mod_python with 
</I>&gt;<i> this? (Like returning special Apache status codes?)
</I>
Nope. There is nothing special about framesets. As far as apache or 
mod_python are concerned it's just regular content. The only thing to be 
aware of is if you are accessing session data in each page of the 
frameset. You'll want to manually unlock the session as soon as possible 
for maximum performance. However this totally unrelated to your problem.

Jim



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022674.html">[mod_python] 
	invalid pointer, child process dies, broken connections
</A></li>
	<LI>Next message: <A HREF="022675.html">[mod_python] Changing server signature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22680">[ date ]</a>
              <a href="thread.html#22680">[ thread ]</a>
              <a href="subject.html#22680">[ subject ]</a>
              <a href="author.html#22680">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
