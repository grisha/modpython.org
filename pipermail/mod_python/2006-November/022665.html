<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] meets_conditions does not seem to work
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20meets_conditions%20does%20not%20seem%20to%20work&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022663.html">
   <LINK REL="Next"  HREF="022666.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] meets_conditions does not seem to work</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Graham Dumpleton</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20meets_conditions%20does%20not%20seem%20to%20work&In-Reply-To="
       TITLE="[mod_python] meets_conditions does not seem to work">grahamd at dscpl.com.au
       </A><BR>
    <I>Wed Nov 22 15:57:21 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022663.html">[mod_python] Session problem
</A></li>
        <LI>Next message: <A HREF="022666.html">[mod_python] Session problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22665">[ date ]</a>
              <a href="thread.html#22665">[ thread ]</a>
              <a href="subject.html#22665">[ subject ]</a>
              <a href="author.html#22665">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>sliderw hotmail wrote ..
&gt;<i> &gt; &gt; &gt; &gt; Anyway, having said all that, what are you expecting to happen
</I>&gt;<i> and
</I>&gt;<i> &gt; &gt; how
</I>&gt;<i> &gt; &gt; &gt; &gt; do you expect to be able to use req.meets_condition()?
</I>&gt;<i> 
</I>&gt;<i> With update_mtime in 3.3, meets_conditions can be used like this:
</I>&gt;<i> 
</I>&gt;<i>     req.headers_out['ETag'] = '&quot;12345&quot;'
</I>&gt;<i>     req.headers_out['Expires'] = 'Fri, 13 Feb 2009 01:00:00 GMT'
</I>&gt;<i>     mtime = 1000000000
</I>&gt;<i>     req.update_mtime(mtime)
</I>&gt;<i>     req.headers_out['Last-Modified'] = rfc822.formatdate(mtime)
</I>&gt;<i> 
</I>&gt;<i>     status = req.meets_conditions()
</I>&gt;<i>     if status != apache.OK:
</I>&gt;<i>         return status
</I>&gt;<i> 
</I>&gt;<i> But I would prefer this (though not a strong preference):
</I>&gt;<i> 
</I>&gt;<i>     req.headers_out['ETag'] = '&quot;12345&quot;'
</I>&gt;<i>     req.headers_out['Expires'] = 'Fri, 13 Feb 2009 01:00:00 GMT'
</I>&gt;<i>     mtime = 1000000000
</I>&gt;<i>     req.set_last_modified(mtime)
</I>&gt;<i>
</I>&gt;<i>     status = req.meets_conditions()
</I>&gt;<i>     if status != apache.OK:
</I>&gt;<i>         return status
</I>&gt;<i> 
</I>&gt;<i> where set_last_modified takes care of setting both mtime and Last-Modified
</I>&gt;<i> header. This is also how mod_perl does it.
</I>&gt;<i> 
</I>&gt;<i> // from mod_perl source
</I>&gt;<i> static MP_INLINE void
</I>&gt;<i> mpxs_Apache2__RequestRec_set_last_modified(request_rec *r, apr_time_t mtime)
</I>&gt;<i> {
</I>&gt;<i>     if (mtime) {
</I>&gt;<i>         ap_update_mtime(r, mtime);
</I>&gt;<i>     }
</I>&gt;<i>     ap_set_last_modified(r);
</I>&gt;<i> }
</I>
You can do:

  req.update_mtime(mtime)
  req.set_last_modified()

This will achieve the same effect. Unless there is a good reason, where we
do expose underlying Apache functions, we tend to have them behave in the
same way, rather than adding additional functionality. That way people can
to a degree refer to Apache documentation and expect that it will work
the same way.

If you feel strongly about it, best thing to do is to log an 'improvement'
suggestion against issue tracking system so it can be considered in the
future at some point. Address is:

  <A HREF="http://issues.apache.org/jira/browse/MODPYTHON">http://issues.apache.org/jira/browse/MODPYTHON</A>
 
&gt;<i> Either way, the documentation of meets_conditions needs to be fixed in
</I>&gt;<i> 3.3.
</I>
If you want to provide a better example that is more complete and works, just
post it here and I will update the documentation. I haven't really fiddled with
this sort of stuff and so would only be assuming any example I put together
worked. If you have any suggestions for text changes to explain it better, by
all means send them along as well.

Graham
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022663.html">[mod_python] Session problem
</A></li>
	<LI>Next message: <A HREF="022666.html">[mod_python] Session problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22665">[ date ]</a>
              <a href="thread.html#22665">[ thread ]</a>
              <a href="subject.html#22665">[ subject ]</a>
              <a href="author.html#22665">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
