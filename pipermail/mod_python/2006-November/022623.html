<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Getting Hostname
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Getting%20Hostname&In-Reply-To=F5737BA7-060D-4BB8-ADDE-70BC626C7CAD%40dscpl.com.au">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022617.html">
   <LINK REL="Next"  HREF="022625.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Getting Hostname</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Lee Brown</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Getting%20Hostname&In-Reply-To=F5737BA7-060D-4BB8-ADDE-70BC626C7CAD%40dscpl.com.au"
       TITLE="[mod_python] Getting Hostname">administrator at leebrown.org
       </A><BR>
    <I>Thu Nov 16 09:25:28 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022617.html">[mod_python] Getting Hostname
</A></li>
        <LI>Next message: <A HREF="022625.html">[mod_python] Getting Hostname
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22623">[ date ]</a>
              <a href="thread.html#22623">[ thread ]</a>
              <a href="subject.html#22623">[ subject ]</a>
              <a href="author.html#22623">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings!

One way to avoid attacks of all kinds is to use Mod Security, which checks
the entire request against a security rule set.  Rule sets are defined
within the main Apache configuration file and look like this (highly
abbreviated) example:

SecFilter &quot;\.\./&quot; &quot;deny,log,status:666&quot;
SecFilterSelective REQUEST_METHOD &quot;SEARCH&quot; &quot;deny,log,status:405&quot;
SecFilterSelective REQUEST_URI &quot;\.exe&quot;  &quot;deny,log,status:666&quot;

The first rule shown protects against symbolic directory traversal for any
kind of request.  If &quot;..&quot; is found, the rule causes Apache to deny access,
log the request, and return an HTTPD status code of 666.  The second rule
denies any request with HTTPD method &quot;search.&quot;  The last rule denies any
request with &quot;.exe&quot; in the URI.  You can write a rule for any HTTPD header
field or URI form, and define the action to take and what status code to
return.

I'm not sure about this, but I think that Mod Security works in Apache's
PostReadRequest phase, so it (probably) won't interfere with a Mod Python
Translation phase handler.  Mod Security is exhaustively documented and they
are very responsive to e-mail queries.

I can't say enough good things about Mod Security.  See www.modsecurity.org

Best Regards,
Lee E. Brown
(<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">administrator at leebrown.org</A>)

-----Original Message-----
From: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>
[mailto:<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python-bounces at modpython.org</A>] On Behalf Of Graham Dumpleton
Sent: Wednesday, November 15, 2006 4:12 PM
To: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">g.farina at pharaondev.com</A>
Cc: <A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>
Subject: Re: [mod_python] Getting Hostname

NOTE, the above code may have to cleanup req.uri and normalise it before it
uses it to avoid attacks whereby people use '..' in a URI to try and get
access to files outside of the document tree. It might also normalise the
path after creating the combined path and ensuring the result still resides
within the document tree. If Apache has cleaned up req.uri already, this
will not be needed. I need to check for myself what Apache has already done
at that point as not sure.


</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022617.html">[mod_python] Getting Hostname
</A></li>
	<LI>Next message: <A HREF="022625.html">[mod_python] Getting Hostname
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22623">[ date ]</a>
              <a href="thread.html#22623">[ thread ]</a>
              <a href="subject.html#22623">[ subject ]</a>
              <a href="author.html#22623">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
