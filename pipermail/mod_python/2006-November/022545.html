<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] Trouble with multiple class objects in publisher model
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20with%20multiple%20class%20objects%20in%20publisher%20model&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="022544.html">
   <LINK REL="Next"  HREF="022546.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] Trouble with multiple class objects in publisher model</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Martin Stoufer</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20Trouble%20with%20multiple%20class%20objects%20in%20publisher%20model&In-Reply-To="
       TITLE="[mod_python] Trouble with multiple class objects in publisher model">MCStoufer at lbl.gov
       </A><BR>
    <I>Wed Nov  8 16:52:54 EST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="022544.html">[mod_python] Re: mod_python, the ITK MPM and sessions
</A></li>
        <LI>Next message: <A HREF="022546.html">[mod_python] Trouble with multiple class objects in publisher
	model
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22545">[ date ]</a>
              <a href="thread.html#22545">[ thread ]</a>
              <a href="subject.html#22545">[ subject ]</a>
              <a href="author.html#22545">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am moving a set of python classes out of the Apache CGI model and into 
mod_python. There is both inheritance and composition going on among 
these classes. A few factory classes as well. It seems that when it 
comes time to pull the generated content from the hierarchy of classes, 
the string object returned to the initial class end up 'None'.

I have stripped down my work as an example. If there is some larger 
example of how this class structure should work, I would love to see it.

from mod_python import apache

class Dom:
    def __call__(self, req):
        from DomProdLibOutput import Html
        self.form = req.form
        self.output = Html('modPython')
        self.host = self.form['host'].value
        self.sortBy = self.form['sortby'].value
        self.mode = self.form['mode'].value
        if self.form.has_key('term'):
           self.term=self.form['term'].value
        else:
           self.term = &quot;&quot;
        req.content_type = &quot;text/html&quot;
        req.send_http_header()
        result = self.generate()
        req.write(result)
        return apache.OK

    def generate(self):
        result = self.output.generate()
        return result

dom = Dom()

In the DomProdLibOutput file in the same dir:

class Html:
    def __init__(self, destination='screen'):
        self.output = HtmlOutputFactory(destination).getOutput()
        return

    def generate(self):
        #result = &quot;Foo in Html&quot;
        result = self.output.generate()
        return result

class HtmlModPython:
    def __init__(self):
        self.content = &quot;&quot;&quot;Empty content in HtmlModPython&quot;&quot;&quot;
        return
   
    def update(self, content):
        self.content += content
        return

    def generate(self):
        return &quot;Foo in HtmlModPython&quot;
        #return self.content

class HtmlOutputFactory:
    def __init__(self, destination):
        self.dest = destination
        return

    def getOutput(self):
        if self.dest == 'screen': return HtmlScreen()
        elif self.dest == 'modPython': return HtmlModPython()
        elif self.dest == 'file': return HtmlFile()
        else:
            raise InvalidHtmlOutputDest, \
        &quot;%s is not a supported output&quot; % self.dest
        return

As an interesting side note, if I have the generate() in Html return 
just the string, things work fine. Its when I try and resolve the string 
stored by the HtmlModPython class instance that the resulting string 
comes back 'None' irregardless of what the deepest generate() returns. 
Do all these classes have to define __call__ as well?

-- 
* Martin C. Stoufer              *
* DIDC/DSD/ITG                   *
* Lawrence Berkeley National Lab *
* MS 50B-2215 510-486-8662       *

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3423 bytes
Desc: S/MIME Cryptographic Signature
Url : <A HREF="http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20061108/2a36f5b5/smime.bin">http://mm_cfg_has_not_been_edited_to_set_host_domains/pipermail/mod_python/attachments/20061108/2a36f5b5/smime.bin</A>
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="022544.html">[mod_python] Re: mod_python, the ITK MPM and sessions
</A></li>
	<LI>Next message: <A HREF="022546.html">[mod_python] Trouble with multiple class objects in publisher
	model
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#22545">[ date ]</a>
              <a href="thread.html#22545">[ thread ]</a>
              <a href="subject.html#22545">[ subject ]</a>
              <a href="author.html#22545">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="DISABLEhttp://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
