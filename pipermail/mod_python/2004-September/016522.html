<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP content-type problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20content-type%20problem&In-Reply-To=redirect-14050051%40vse.cz">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016521.html">
   <LINK REL="Next"  HREF="016523.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP content-type problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Martin Slouf</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20content-type%20problem&In-Reply-To=redirect-14050051%40vse.cz"
       TITLE="[mod_python] PSP content-type problem">xslom03 at vse.cz
       </A><BR>
    <I>Sun Sep 26 10:59:57 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016521.html">[mod_python] HostNameLookups
</A></li>
        <LI>Next message: <A HREF="016523.html">[mod_python] using callable classes instead of plain functions in
	handlers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16522">[ date ]</a>
              <a href="thread.html#16522">[ thread ]</a>
              <a href="subject.html#16522">[ subject ]</a>
              <a href="author.html#16522">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, Sep 25, 2004 at 10:51:45PM +0200, Kamil Niechajewicz wrote:
&gt;<i> On Sat, 25 Sep 2004 17:33:11 +0200, Robert Fendt &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">rmfendt at web.de</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;I would suggest changing it to what the publisher handler does (if this
</I>&gt;<i> &gt;does not break anything, but at least it seems to work for me), e.g.:
</I>&gt;<i> 
</I>&gt;<i> yeah, i agree with you. this should be changed.
</I>&gt;<i> i have different matter that concerns me. actually psp instantly
</I>&gt;<i> does req.write while processing the template, so its possible that
</I>&gt;<i> only part of the page will be displayed due some processing errors
</I>&gt;<i> (like using not supported by 'vars = {}' key name etc.) when it
</I>&gt;<i> occurs we get an ugly error inside our page that was partially
</I>&gt;<i> displayed to the user. that is not a very pretty solution.
</I>
well, i agree that buffer would be nice, but you can do all the nescessary
error checking in handler and than just use vars to pass the html strings
generated

there is also possible to pregenerate the page and store it whole in a string

def registration(req, err = None):
    err_tmpl = get_err_tmpl(req, err)
    args = {&quot;title&quot;: _(&quot;Registration&quot;),
            &quot;data&quot; : get_reg_data(req),
            &quot;err_tmpl&quot; : err_tmpl}
    tmpl = TEMPLATES_DIR + &quot;registration.html&quot;
    return psp.PSP(req, tmpl, vars = args)

def get_err_tmpl(req, reg_err):
    tmpl = &quot;&quot;
    if (reg_err == None): pass
    else: tmpl = psp.PSP(req, TEMPLATES_DIR + &quot;error.tmpl&quot;,
                         vars = {&quot;err&quot;: reg_err})
    return tmpl

the 1st func is handler, err_tmpl contains any errors that are reported to user
and I use in the 2nd func

tmpl = psp.PSP(req, TEMPLATES_DIR + &quot;error.tmpl&quot;,
               vars = {&quot;err&quot;: reg_err})

'tmpl' is not an standalone page -- just a part of it and this code will
return its string representation (a layer actually)

i guess its pretty clear how you can use try...except around the code and catch
the exceptions, in fact, i use special handler that checks the data for me and
if ok, calls registration(reg) and if not it calls registration(reg, err) as
the last thing in its processing

m.
</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016521.html">[mod_python] HostNameLookups
</A></li>
	<LI>Next message: <A HREF="016523.html">[mod_python] using callable classes instead of plain functions in
	handlers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16522">[ date ]</a>
              <a href="thread.html#16522">[ thread ]</a>
              <a href="subject.html#16522">[ subject ]</a>
              <a href="author.html#16522">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script type="text/javascript"><!--
google_ad_client = "pub-9718360309690383";
google_ad_width = 120;
google_ad_height = 600;
google_ad_format = "120x600_as";
google_color_border = "CCCCCC";
google_color_bg = "FFFFFF";
google_color_link = "000000";
google_color_url = "666666";
google_color_text = "333333";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
