<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] R: servlet form against publisher
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20R%3A%20servlet%20form%20against%20publisher&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016355.html">
   <LINK REL="Next"  HREF="016360.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] R: servlet form against publisher</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Manera, Villiam</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20R%3A%20servlet%20form%20against%20publisher&In-Reply-To="
       TITLE="[mod_python] R: servlet form against publisher">vmanera at manord.com
       </A><BR>
    <I>Tue Sep  7 10:52:49 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016355.html">[mod_python] bake-off use cases
</A></li>
        <LI>Next message: <A HREF="016360.html">[mod_python] R: servlet form against publisher
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16356">[ date ]</a>
              <a href="thread.html#16356">[ thread ]</a>
              <a href="subject.html#16356">[ subject ]</a>
              <a href="author.html#16356">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Date: 03 Sep 2004 11:18:18 -0400
From: Daniel Popowich &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">dpopowich at comcast.net</A>&gt;
Subject: Re: [mod_python] servlet form against publisher
To: mod_python user mailing list &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>&gt;
Message-ID: &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">m23c1zbcud.fsf at fenway.local.</A>&gt;


Manera, Villiam writes:

&gt;&gt;<i> ........
</I>&gt;&gt;<i> Difference in retrieve fields from Form between publisher and servlet:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> In publischer : req.form = util.FieldStorage(req, keep_blank_values=1)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> In servlet : self.form = util.FieldStorage(self.req)        
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> So in servlet the fields not filled are not inserted in  self.form.list
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Why this choice??
</I>
&gt;<i>Two reasons:
</I>
&gt;<i>1) Assuming you're going to retrieve the field like this:
</I>&gt;<i>
</I>&gt;<i>     field = self.form.getfirst('fieldname', somedefault)
</I>&gt;<i>
</I>&gt;<i>   then returning blank values is meaningless: regardless of whether
</I>&gt;<i>   or not the field was blank you'll get your default.
</I>
&gt;<i>2) With the mechanics of query_vars and form_vars in mpservlets, re
</I>&gt;<i>   automatic retrieval of fields and setting them as instance
</I>&gt;<i>   variables and setting defaults for missing fields, there is no
</I>&gt;<i>   need to keep blank values.
</I>
&gt;<i>Daniel Popowich
</I>
===================================== remark ==================================

Ok, I suppose this reason, and I agree.
But for me will be useful to have a variable in order to choose keep_blank_values=1 when I need it.

And I need it for most of the routine already written that I'm modifying in order to work fine if they are called from publisher or from servlet.
This is un example of help_cliente.mps:

------------------------------
from _docBase_mps import *

class help_cliente(docBase_mps_FinestreHelp):
	def write_content(self):
		doc = finestre_help.help_cliente(self)
		self.writeln(str(doc) %self.session)
------------------------------
this is a wrap around finestre_help.help_cliente that work under publisher

and below a class with the prep redefined because there no choice for keep_blank_values=1.
With keep_blank_values = 1 will be possible do in high level:
		pard = self.session
		for F in self.form.list:
				if pard.has_key(F.name): 
					if type(pard[F.name]) == ListType: pard[F.name].append(F.value)
					else : pard[F.name] = [pard[F.name],F.value]
				else: pard[F.name] = F.value 
and all the fields of the form are inserted in self.session, that is the scenario that old 
publisher program expect	
#=========================== docBase_mps_FinestreHelp ==============================
class docBase_mps_FinestreHelp(docBase_mps):
	title = ''
	.....
	
	def prep(self):
		docBase_mps.prep(self)
		self.session['suffisso_funzione_js'] = self.form.getfirst('suffisso_funzione_js')
		self.session['nome_colonna_input'] = self.form.getlist('nome_colonna_input')
		self.session['nome_returnback'] = self.form.getlist('nome_returnback')
		for el in self.form.getlist('nome_returnback'):
			self.session[el] = self.form.getfirst(el,'')


Villiam Manera

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016355.html">[mod_python] bake-off use cases
</A></li>
	<LI>Next message: <A HREF="016360.html">[mod_python] R: servlet form against publisher
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16356">[ date ]</a>
              <a href="thread.html#16356">[ thread ]</a>
              <a href="subject.html#16356">[ subject ]</a>
              <a href="author.html#16356">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
