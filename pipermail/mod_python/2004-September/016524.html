<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [mod_python] PSP content-type problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20content-type%20problem&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="016533.html">
   <LINK REL="Next"  HREF="016521.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mod_python] PSP content-type problem</H1>
<table border=0 width="100%"><tr><td valign="top">
    <B>Lee E. Brown</B> 
    <A HREF="mailto:mod_python%40modpython.org?Subject=%5Bmod_python%5D%20PSP%20content-type%20problem&In-Reply-To="
       TITLE="[mod_python] PSP content-type problem">Administrator at leebrown.org
       </A><BR>
    <I>Sun Sep 26 12:05:03 EDT 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="016533.html">[mod_python] PSP content-type problem
</A></li>
        <LI>Next message: <A HREF="016521.html">[mod_python] HostNameLookups
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16524">[ date ]</a>
              <a href="thread.html#16524">[ thread ]</a>
              <a href="subject.html#16524">[ subject ]</a>
              <a href="author.html#16524">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
From: &quot;Kamil Niechajewicz&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">kamil at nvstudio.pl</A>&gt;
To: &quot;mod_python user mailing list&quot; &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">mod_python at modpython.org</A>&gt;
Sent: Saturday, September 25, 2004 4:42 PM
Subject: Re: [mod_python] PSP content-type problem


&gt;<i> On Sat, 25 Sep 2004 17:33:11 +0200, Robert Fendt &lt;<A HREF="http://mailman.modpython.org/mailman/listinfo/mod_python">rmfendt at web.de</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I would suggest changing it to what the publisher handler does (if this
</I>&gt;&gt;<i> does not break anything, but at least it seems to work for me), e.g.:
</I>&gt;<i>
</I>&gt;<i> yeah, i agree with you. this should be changed.
</I>&gt;<i> i have different matter that concerns me. actually psp instantly
</I>&gt;<i> does req.write while processing the template, so its possible that
</I>&gt;<i> only part of the page will be displayed due some processing errors
</I>&gt;<i> (like using not supported by 'vars = {}' key name etc.) when it
</I>&gt;<i> occurs we get an ugly error inside our page that was partially
</I>&gt;<i> displayed to the user. that is not a very pretty solution.
</I>
The problem of leaving a user staring at half of a 'broken' page had me 
worried as well.
I have found several 'low-tech' solutions to that, though, that work 
perfectly well with the Publisher Handler.
(My examples are simplistic for brevity.)

Solution 1:  Apache's SSI module can be used in a 'pseudo-PSP' manner:

Within the HTML document:
&lt;h1&gt;Welcome &lt;!--#include virtual=&quot;myscript.py/supply_pagetitle&quot; --&gt;!&lt;h1&gt;

Within the script:
return 'to my Herpetology page'

When the script works, the user sees &quot;Welcome to my Herpetology page!&quot;
If the script fails to run and PythonDebug is Off, the user just sees 
&quot;Welcome!&quot; without realizing that anything is missing.

***

Solution 2: Use python's string formatting '%' function to insert data at 
specific point in an HTML document:

Within the HTML document:
&lt;p&gt;You are visitor number %s.  Welcome!&lt;p&gt;

Within the script:
docfile = open(htmlfile, 'r')
filestr = docfile.read()
return filestr % hitcounter()

***

Solution 3: Use Python's string replace function to replace a placeholder 
that also serves as a meaningful error message:

Within the HTML document:
&lt;h1&gt;Today's winning Lottery Number:&lt;h1&gt;
&lt;p&gt;(Server temporarily unavailable)&lt;/p&gt;

Within the script:
docfile = open(htmlfile, 'r')
filestr = docfile.read()
return filestr.replace('(Server temporarily unavailable)', winning_number)

***

The overall strategy that I've been following is to 'fail gracefully' by 
building my HTML document templates so that they would make sense to the 
user even if the document template was the only thing returned.  In other 
words, the web site is augmented by the Python back-end instead of being 
completely dependant upon it. 

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="016533.html">[mod_python] PSP content-type problem
</A></li>
	<LI>Next message: <A HREF="016521.html">[mod_python] HostNameLookups
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#16524">[ date ]</a>
              <a href="thread.html#16524">[ thread ]</a>
              <a href="subject.html#16524">[ subject ]</a>
              <a href="author.html#16524">[ author ]</a>
         </LI>
       </UL>

</td>
<td align="right" valign="top">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42971867-2', 'modpython.org');
  ga('send', 'pageview');
</script>

</td>
</table>

<hr>
<a href="http://mailman.modpython.org/mailman/listinfo/mod_python">More information about the Mod_python
mailing list</a><br>
</body></html>
